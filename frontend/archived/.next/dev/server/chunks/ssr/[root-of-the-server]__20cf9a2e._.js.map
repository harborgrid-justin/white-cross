{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/config/queryClient.ts"],"sourcesContent":["/**\r\n * WF-COMP-QUERYCLIENT-001 | queryClient.ts - React Query Client Configuration\r\n * Purpose: Enterprise-grade TanStack Query configuration with Next.js integration\r\n *\r\n * Features:\r\n * - SSR/SSG compatible configuration\r\n * - Granular cache invalidation strategies\r\n * - Error handling and retry logic\r\n * - Query deduplication\r\n * - Healthcare-specific caching rules\r\n *\r\n * Security:\r\n * - PHI data excluded from persistence\r\n * - Secure error handling\r\n *\r\n * Last Updated: 2025-10-26 | File Type: .ts\r\n */\r\n\r\nimport { QueryClient, QueryCache, MutationCache, DefaultOptions, Query, Mutation } from '@tanstack/react-query';\r\nimport toast from 'react-hot-toast';\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS\r\n// ==========================================\r\n\r\ninterface QueryMeta extends Record<string, unknown> {\r\n  /**\r\n   * Whether this query contains PHI data\r\n   * PHI data will not be persisted to localStorage\r\n   */\r\n  containsPHI?: boolean;\r\n\r\n  /**\r\n   * Custom cache tags for granular invalidation\r\n   */\r\n  cacheTags?: string[];\r\n\r\n  /**\r\n   * Custom error message for user display\r\n   */\r\n  errorMessage?: string;\r\n\r\n  /**\r\n   * Whether to audit this query\r\n   */\r\n  auditLog?: boolean;\r\n\r\n  /**\r\n   * Custom retry logic\r\n   */\r\n  customRetry?: boolean;\r\n}\r\n\r\ninterface MutationMeta {\r\n  /**\r\n   * Whether this mutation affects PHI data\r\n   */\r\n  affectsPHI?: boolean;\r\n\r\n  /**\r\n   * Audit action type\r\n   */\r\n  auditAction?: string;\r\n\r\n  /**\r\n   * Success message to display\r\n   */\r\n  successMessage?: string;\r\n\r\n  /**\r\n   * Error message to display\r\n   */\r\n  errorMessage?: string;\r\n}\r\n\r\n// ==========================================\r\n// CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Default TanStack Query options with healthcare-specific caching and retry settings.\r\n *\r\n * Configures conservative caching strategies appropriate for healthcare data,\r\n * balancing data freshness with performance. Implements intelligent retry logic\r\n * that distinguishes between transient failures and permanent errors.\r\n *\r\n * Query Configuration:\r\n * - staleTime: 5 minutes (data freshness threshold)\r\n * - gcTime: 30 minutes (garbage collection time, previously cacheTime)\r\n * - Automatic refetch on: window focus, reconnect, mount\r\n * - Retry logic: Up to 3 attempts for 5xx errors, no retry for 4xx except 408/429\r\n * - Exponential backoff: Starts at 1s, max 30s with doubling delay\r\n *\r\n * Mutation Configuration:\r\n * - Single retry attempt for mutations (idempotency concerns)\r\n * - Requires online network mode\r\n *\r\n * @constant {DefaultOptions}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Query with default options:\r\n * const { data } = useQuery({\r\n *   queryKey: ['students'],\r\n *   queryFn: fetchStudents,\r\n *   // Inherits: 5min staleTime, 3 retries, background refetch\r\n * });\r\n *\r\n * // Mutation with default options:\r\n * const { mutate } = useMutation({\r\n *   mutationFn: createStudent,\r\n *   // Inherits: 1 retry, online mode\r\n * });\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/react/guides/important-defaults\r\n */\r\nconst defaultOptions: DefaultOptions = {\r\n  queries: {\r\n    // Conservative stale time for healthcare data\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    \r\n    // Longer cache time for non-critical data\r\n    gcTime: 30 * 60 * 1000, // 30 minutes (was cacheTime in v4)\r\n    \r\n    // Enable background refetch for critical data\r\n    refetchOnWindowFocus: true,\r\n    refetchOnReconnect: true,\r\n    refetchOnMount: true,\r\n    \r\n    // Retry configuration for transient failures\r\n    retry: (failureCount: number, error: any) => {\r\n      // Don't retry on 4xx client errors except 408, 429\r\n      if (error && typeof error === 'object' && 'status' in error) {\r\n        const status = (error as any).status;\r\n        if (status >= 400 && status < 500 && status !== 408 && status !== 429) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      // Retry up to 3 times with exponential backoff\r\n      return failureCount < 3;\r\n    },\r\n\r\n    retryDelay: (attemptIndex: number) => Math.min(1000 * 2 ** attemptIndex, 30000),\r\n    \r\n    // Network mode for offline support\r\n    networkMode: 'online',\r\n  },\r\n  \r\n  mutations: {\r\n    // Conservative retry for mutations\r\n    retry: 1,\r\n    \r\n    // Network mode for mutations\r\n    networkMode: 'online',\r\n  },\r\n};\r\n\r\n/**\r\n * TanStack Query cache with centralized error handling and audit logging.\r\n *\r\n * Provides lifecycle hooks for query success and failure, enabling consistent\r\n * error notifications, PHI access auditing, and debugging support. Integrates\r\n * with toast notifications for user-friendly error messages.\r\n *\r\n * Error Handling:\r\n * - Displays toast notifications for failed queries (except background refetches)\r\n * - Uses custom errorMessage from query meta if provided\r\n * - Logs errors with query keys and metadata for debugging\r\n * - Suppresses toasts when query has existing data (background refresh failed)\r\n *\r\n * Audit Logging:\r\n * - Tracks PHI data access when auditLog and containsPHI flags are set\r\n * - Logs query keys and data sizes for compliance\r\n * - Client-side only (respects SSR constraints)\r\n *\r\n * @constant {QueryCache}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Query with audit logging:\r\n * const { data } = useQuery({\r\n *   queryKey: ['patient', patientId],\r\n *   queryFn: fetchPatient,\r\n *   meta: {\r\n *     containsPHI: true,\r\n *     auditLog: true,\r\n *     errorMessage: 'Failed to load patient data'\r\n *   }\r\n * });\r\n * // On success: Logs PHI access audit\r\n * // On error: Shows custom error message, logs to console\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/reference/QueryCache\r\n */\r\nconst queryCache = new QueryCache({\r\n  onError: (error: any, query: Query<any, any, any>) => {\r\n    const meta = query.meta as QueryMeta | undefined;\r\n\r\n    console.error('[QueryCache] Query failed:', {\r\n      queryKey: query.queryKey,\r\n      error,\r\n      meta,\r\n    });\r\n\r\n    // Display user-friendly error message\r\n    const errorMessage = meta?.errorMessage || 'Failed to load data. Please try again.';\r\n\r\n    // Don't show toast for background refetches of successful queries\r\n    if (query.state.data === undefined) {\r\n      toast.error(errorMessage);\r\n    }\r\n\r\n    // Log audit trail for PHI-related queries\r\n    if (meta?.auditLog && typeof window !== 'undefined') {\r\n      console.log('[Audit] Query failed', {\r\n        queryKey: query.queryKey,\r\n        error: error.message,\r\n        containsPHI: meta?.containsPHI,\r\n      });\r\n    }\r\n  },\r\n\r\n  onSuccess: (data: any, query: Query<any, any, any>) => {\r\n    const meta = query.meta as QueryMeta | undefined;\r\n\r\n    // Log audit trail for PHI-related queries\r\n    if (meta?.auditLog && meta?.containsPHI && typeof window !== 'undefined') {\r\n      console.log('[Audit] PHI data accessed', {\r\n        queryKey: query.queryKey,\r\n        dataSize: JSON.stringify(data).length,\r\n      });\r\n    }\r\n  },\r\n});\r\n\r\n/**\r\n * TanStack Mutation cache with success/error handling and PHI audit logging.\r\n *\r\n * Provides lifecycle hooks for mutation success and failure, enabling automatic\r\n * success notifications, error handling, and audit trails for data modifications\r\n * affecting Protected Health Information (PHI).\r\n *\r\n * Success Handling:\r\n * - Displays custom successMessage from mutation meta as toast\r\n * - Logs PHI modifications for compliance auditing\r\n * - Records mutation keys and data sizes\r\n *\r\n * Error Handling:\r\n * - Displays custom errorMessage or default error toast\r\n * - Logs failed mutations with variables for debugging\r\n * - Tracks failed PHI modifications for security auditing\r\n *\r\n * @constant {MutationCache}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Mutation with audit and notifications:\r\n * const { mutate } = useMutation({\r\n *   mutationFn: updatePatient,\r\n *   meta: {\r\n *     affectsPHI: true,\r\n *     auditAction: 'UPDATE_PATIENT',\r\n *     successMessage: 'Patient updated successfully',\r\n *     errorMessage: 'Failed to update patient'\r\n *   }\r\n * });\r\n * // On success: Shows success toast, logs PHI audit\r\n * // On error: Shows error toast, logs failure audit\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/reference/MutationCache\r\n */\r\nconst mutationCache = new MutationCache({\r\n  onSuccess: (data: any, variables: any, context: any, mutation: Mutation<any, any, any, any>) => {\r\n    const meta = mutation.meta as MutationMeta | undefined;\r\n\r\n    // Show success message\r\n    if (meta?.successMessage) {\r\n      toast.success(meta.successMessage);\r\n    }\r\n\r\n    // Log audit trail for PHI-affecting mutations\r\n    if (meta?.affectsPHI && typeof window !== 'undefined') {\r\n      console.log('[Audit] PHI data modified', {\r\n        action: meta.auditAction,\r\n        mutationKey: mutation.options.mutationKey,\r\n        dataSize: JSON.stringify(variables).length,\r\n      });\r\n    }\r\n  },\r\n\r\n  onError: (error: any, variables: any, context: any, mutation: Mutation<any, any, any, any>) => {\r\n    const meta = mutation.meta as MutationMeta | undefined;\r\n\r\n    console.error('[MutationCache] Mutation failed:', {\r\n      mutationKey: mutation.options.mutationKey,\r\n      error,\r\n      variables,\r\n      meta,\r\n    });\r\n\r\n    // Display user-friendly error message\r\n    const errorMessage = meta?.errorMessage || 'Operation failed. Please try again.';\r\n    toast.error(errorMessage);\r\n\r\n    // Log audit trail for failed PHI mutations\r\n    if (meta?.affectsPHI && typeof window !== 'undefined') {\r\n      console.log('[Audit] PHI mutation failed', {\r\n        action: meta.auditAction,\r\n        error: error.message,\r\n        mutationKey: mutation.options.mutationKey,\r\n      });\r\n    }\r\n  },\r\n});\r\n\r\n// ==========================================\r\n// QUERY CLIENT\r\n// ==========================================\r\n\r\n/**\r\n * Creates a new QueryClient instance with configured caches and default options.\r\n *\r\n * Factory function for instantiating TanStack Query clients with healthcare-specific\r\n * configuration. Used for both server-side rendering (new instance per request) and\r\n * client-side (singleton instance).\r\n *\r\n * @returns {QueryClient} Configured QueryClient instance\r\n * @private\r\n *\r\n * @example\r\n * ```typescript\r\n * // Server-side: new client per request\r\n * const client = createQueryClient();\r\n *\r\n * // Client-side: singleton pattern via getQueryClient()\r\n * ```\r\n */\r\nfunction createQueryClient(): QueryClient {\r\n  return new QueryClient({\r\n    queryCache,\r\n    mutationCache,\r\n    defaultOptions,\r\n  });\r\n}\r\n\r\n/**\r\n * Global QueryClient singleton instance for browser/client-side usage.\r\n *\r\n * Cached client instance that persists across component renders on the client.\r\n * Undefined on server to ensure fresh instances per SSR request.\r\n *\r\n * @type {QueryClient | undefined}\r\n * @private\r\n */\r\nlet browserQueryClient: QueryClient | undefined = undefined;\r\n\r\n/**\r\n * Retrieves the appropriate QueryClient instance for the current environment.\r\n *\r\n * Implements SSR-compatible client management:\r\n * - Server (SSR): Creates a new QueryClient for each request to avoid data leakage\r\n * - Browser: Returns singleton QueryClient instance, creating if necessary\r\n *\r\n * This pattern ensures:\r\n * - No shared state between SSR requests (security)\r\n * - Optimal performance on client with persistent cache\r\n * - Compatibility with Next.js App Router and React Server Components\r\n *\r\n * @returns {QueryClient} QueryClient instance appropriate for current environment\r\n *\r\n * @example\r\n * ```typescript\r\n * // In React Server Component (SSR)\r\n * const queryClient = getQueryClient();\r\n * await queryClient.prefetchQuery({\r\n *   queryKey: ['students'],\r\n *   queryFn: fetchStudents\r\n * });\r\n *\r\n * // In Client Component\r\n * const queryClient = getQueryClient();\r\n * // Same instance across component renders\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/react/guides/advanced-ssr\r\n */\r\nexport function getQueryClient(): QueryClient {\r\n  if (typeof window === 'undefined') {\r\n    // Server: always make a new query client\r\n    return createQueryClient();\r\n  } else {\r\n    // Browser: make a new query client if we don't already have one\r\n    if (!browserQueryClient) {\r\n      browserQueryClient = createQueryClient();\r\n    }\r\n    return browserQueryClient;\r\n  }\r\n}\r\n\r\n/**\r\n * Default export for backwards compatibility\r\n */\r\nexport const queryClient = getQueryClient();\r\n\r\n// ==========================================\r\n// CACHE MANAGEMENT\r\n// ==========================================\r\n\r\n/**\r\n * Invalidates queries matching specified cache tags for granular cache management.\r\n *\r\n * Provides tag-based cache invalidation strategy for related queries. Searches all\r\n * cached queries for matching tags in their meta.cacheTags array and invalidates\r\n * them, triggering refetches for active queries.\r\n *\r\n * Use Cases:\r\n * - After student mutation: invalidate ['students', 'student-list', 'student-count']\r\n * - After medication update: invalidate ['medications', 'inventory']\r\n * - After document upload: invalidate ['documents', 'document-folders']\r\n *\r\n * @param {string[]} tags - Array of cache tag strings to invalidate\r\n * @returns {Promise<void>} Resolves when all matching queries are invalidated\r\n *\r\n * @example\r\n * ```typescript\r\n * // Define queries with cache tags:\r\n * const studentsQuery = useQuery({\r\n *   queryKey: ['students'],\r\n *   queryFn: fetchStudents,\r\n *   meta: { cacheTags: ['students', 'student-list'] }\r\n * });\r\n *\r\n * const studentCountQuery = useQuery({\r\n *   queryKey: ['studentCount'],\r\n *   queryFn: fetchStudentCount,\r\n *   meta: { cacheTags: ['students', 'student-count'] }\r\n * });\r\n *\r\n * // Invalidate all student-related queries:\r\n * await invalidateByTags(['students']);\r\n * // Both studentsQuery and studentCountQuery will refetch\r\n *\r\n * // Invalidate only count query:\r\n * await invalidateByTags(['student-count']);\r\n * // Only studentCountQuery will refetch\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/react/guides/query-invalidation\r\n */\r\nexport async function invalidateByTags(tags: string[]): Promise<void> {\r\n  const client = getQueryClient();\r\n\r\n  // Find all queries that match any of the provided tags\r\n  const queriesToInvalidate = client.getQueryCache().findAll({\r\n    predicate: (query: Query<any, any, any>) => {\r\n      const meta = query.meta as QueryMeta | undefined;\r\n      const queryTags = meta?.cacheTags || [];\r\n      return tags.some(tag => queryTags.includes(tag));\r\n    },\r\n  });\r\n\r\n  // Invalidate matching queries\r\n  const invalidationPromises = queriesToInvalidate.map((query: Query<any, any, any>) =>\r\n    client.invalidateQueries({ queryKey: query.queryKey })\r\n  );\r\n\r\n  await Promise.all(invalidationPromises);\r\n}\r\n\r\n/**\r\n * Clears all cached query and mutation data from the QueryClient.\r\n *\r\n * Completely removes all cached data, resetting the QueryClient to initial state.\r\n * Critical for logout flows to ensure no PHI or user-specific data remains in memory.\r\n * All active queries will enter loading state and refetch when next accessed.\r\n *\r\n * Operations Performed:\r\n * - Removes all query data from cache\r\n * - Clears all mutation states\r\n * - Resets cache to empty state\r\n * - Does NOT remove observers (subscriptions persist)\r\n *\r\n * @returns {Promise<void>} Resolves immediately (synchronous clear wrapped in Promise)\r\n *\r\n * @example\r\n * ```typescript\r\n * // Logout flow\r\n * async function handleLogout() {\r\n *   await clearAllData();\r\n *   await resetApolloClient(); // Clear GraphQL cache too\r\n *   router.push('/login');\r\n * }\r\n *\r\n * // Account switching\r\n * async function switchAccount(newUserId: string) {\r\n *   await clearAllData();\r\n *   await authenticateAs(newUserId);\r\n *   router.refresh();\r\n * }\r\n * ```\r\n *\r\n * @see https://tanstack.com/query/latest/docs/reference/QueryClient#queryclientclear\r\n */\r\nexport async function clearAllData(): Promise<void> {\r\n  const client = getQueryClient();\r\n  client.clear();\r\n}\r\n\r\n/**\r\n * Retrieves statistics about the current TanStack Query cache state.\r\n *\r\n * Provides diagnostic information about cached queries for debugging, monitoring,\r\n * and performance analysis. Useful for understanding cache utilization and\r\n * identifying potential issues with stale data or PHI retention.\r\n *\r\n * Statistics Returned:\r\n * - totalQueries: Total number of queries in cache\r\n * - activeQueries: Queries with active observers (components using them)\r\n * - staleQueries: Queries past their staleTime threshold\r\n * - phiQueries: Queries marked as containing PHI in metadata\r\n *\r\n * @returns {object} Cache statistics object\r\n * @returns {number} return.totalQueries - Total cached queries\r\n * @returns {number} return.activeQueries - Queries with active subscriptions\r\n * @returns {number} return.staleQueries - Queries marked stale\r\n * @returns {number} return.phiQueries - Queries containing PHI data\r\n *\r\n * @example\r\n * ```typescript\r\n * const stats = getCacheStats();\r\n * console.log('Cache Statistics:', stats);\r\n * // {\r\n * //   totalQueries: 45,\r\n * //   activeQueries: 12,\r\n * //   staleQueries: 8,\r\n * //   phiQueries: 15\r\n * // }\r\n *\r\n * // Use in performance monitoring\r\n * if (stats.staleQueries > 20) {\r\n *   console.warn('High number of stale queries, consider adjusting staleTime');\r\n * }\r\n *\r\n * // Audit PHI data retention\r\n * if (stats.phiQueries > 0 && !userIsAuthenticated) {\r\n *   console.error('PHI queries cached while unauthenticated!');\r\n *   await clearAllData();\r\n * }\r\n * ```\r\n */\r\nexport function getCacheStats() {\r\n  const client = getQueryClient();\r\n  const queries = client.getQueryCache().getAll();\r\n\r\n  return {\r\n    totalQueries: queries.length,\r\n    activeQueries: queries.filter((q: Query<any, any, any>) => q.getObserversCount() > 0).length,\r\n    staleQueries: queries.filter((q: Query<any, any, any>) => q.isStale()).length,\r\n    phiQueries: queries.filter((q: Query<any, any, any>) => (q.meta as QueryMeta)?.containsPHI).length,\r\n  };\r\n}\r\n\r\nexport default queryClient;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/constants/config.ts"],"sourcesContent":["/**\r\n * Application Configuration Constants\r\n * \r\n * Centralized configuration values for the Next.js application\r\n * Environment-aware settings for API connections, timeouts, and feature flags\r\n */\r\n\r\n/**\r\n * API Configuration\r\n * Base URL and timeout settings for backend API calls\r\n */\r\nexport const API_CONFIG = {\r\n  /**\r\n   * Base URL for API requests\r\n   * - Docker environment: Uses backend service name (http://backend:3001)\r\n   * - Local development: Uses localhost (http://localhost:3001)\r\n   * - Can be overridden via NEXT_PUBLIC_API_URL environment variable\r\n   */\r\n  BASE_URL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001',\r\n\r\n  /**\r\n   * Internal API URL for server-side requests in Docker\r\n   * Used for API routes and server-side rendering\r\n   */\r\n  INTERNAL_API_URL: process.env.INTERNAL_API_URL || process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001',\r\n  \r\n  /**\r\n   * Request timeout in milliseconds\r\n   * Default: 30 seconds\r\n   */\r\n  TIMEOUT: 30000,\r\n  \r\n  /**\r\n   * Retry configuration for failed requests\r\n   */\r\n  RETRY: {\r\n    MAX_RETRIES: 3,\r\n    RETRY_DELAY: 1000, // ms\r\n    RETRY_CODES: [408, 429, 500, 502, 503, 504],\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Application Environment\r\n */\r\nexport const APP_ENV = {\r\n  IS_DEVELOPMENT: process.env.NODE_ENV === 'development',\r\n  IS_PRODUCTION: process.env.NODE_ENV === 'production',\r\n  IS_TEST: process.env.NODE_ENV === 'test',\r\n} as const;\r\n\r\n/**\r\n * Feature Flags\r\n * Toggle features on/off based on environment or configuration\r\n */\r\nexport const FEATURE_FLAGS = {\r\n  ENABLE_DEBUG_LOGGING: process.env.NEXT_PUBLIC_ENABLE_DEBUG === 'true',\r\n  ENABLE_ANALYTICS: process.env.NEXT_PUBLIC_ENABLE_ANALYTICS === 'true',\r\n} as const;\r\n\r\n/**\r\n * Security Configuration\r\n * HIPAA-compliant security settings for token management and session handling\r\n */\r\nexport const SECURITY_CONFIG = {\r\n  /**\r\n   * Token storage location\r\n   * 'sessionStorage' for enhanced security (lost on tab close)\r\n   * 'localStorage' for persistent sessions (survives tab close)\r\n   */\r\n  STORAGE_TYPE: 'sessionStorage' as 'localStorage' | 'sessionStorage',\r\n  \r\n  /**\r\n   * Token expiration settings\r\n   */\r\n  TOKEN_EXPIRY: {\r\n    /** Default token lifetime in milliseconds (1 hour) */\r\n    DEFAULT: 60 * 60 * 1000,\r\n    /** Maximum token lifetime in milliseconds (8 hours) */\r\n    MAX: 8 * 60 * 60 * 1000,\r\n    /** Refresh token lifetime (7 days) */\r\n    REFRESH: 7 * 24 * 60 * 60 * 1000,\r\n  },\r\n  \r\n  /**\r\n   * Inactivity timeout in milliseconds (30 minutes)\r\n   * User will be logged out after this period of inactivity\r\n   */\r\n  INACTIVITY_TIMEOUT: 30 * 60 * 1000,\r\n  \r\n  /**\r\n   * Session activity check interval (1 minute)\r\n   */\r\n  ACTIVITY_CHECK_INTERVAL: 60 * 1000,\r\n  \r\n  /**\r\n   * Encryption settings\r\n   */\r\n  ENCRYPTION: {\r\n    /** Whether to encrypt tokens in storage */\r\n    ENABLED: process.env.NEXT_PUBLIC_ENCRYPT_TOKENS === 'true',\r\n    /** Algorithm for encryption */\r\n    ALGORITHM: 'AES-GCM',\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Validation Configuration\r\n * Field validation constraints and limits\r\n */\r\nexport const VALIDATION_CONFIG = {\r\n  /**\r\n   * Maximum field length for text inputs\r\n   * Prevents excessive data input and potential storage issues\r\n   */\r\n  MAX_FIELD_LENGTH: 5000,\r\n\r\n  /**\r\n   * Maximum file upload size in bytes (10MB)\r\n   */\r\n  MAX_FILE_SIZE: 10 * 1024 * 1024,\r\n\r\n  /**\r\n   * Allowed file types for uploads\r\n   */\r\n  ALLOWED_FILE_TYPES: [\r\n    'image/jpeg',\r\n    'image/png',\r\n    'image/gif',\r\n    'application/pdf',\r\n    'application/msword',\r\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n  ],\r\n\r\n  /**\r\n   * Password requirements\r\n   */\r\n  PASSWORD: {\r\n    MIN_LENGTH: 8,\r\n    MAX_LENGTH: 128,\r\n    REQUIRE_UPPERCASE: true,\r\n    REQUIRE_LOWERCASE: true,\r\n    REQUIRE_NUMBER: true,\r\n    REQUIRE_SPECIAL_CHAR: true,\r\n  },\r\n} as const;\r\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED;;;CAGC;;;;;;;;;;;;AACM,MAAM,aAAa;IACxB;;;;;GAKC,GACD,UAAU,6DAAmC;IAE7C;;;GAGC,GACD,kBAAkB,QAAQ,GAAG,CAAC,gBAAgB,iEAAuC;IAErF;;;GAGC,GACD,SAAS;IAET;;GAEC,GACD,OAAO;QACL,aAAa;QACb,aAAa;QACb,aAAa;YAAC;YAAK;YAAK;YAAK;YAAK;YAAK;SAAI;IAC7C;AACF;AAKO,MAAM,UAAU;IACrB,gBAAgB,oDAAyB;IACzC,eAAe,oDAAyB;IACxC,SAAS,oDAAyB;AACpC;AAMO,MAAM,gBAAgB;IAC3B,sBAAsB,QAAQ,GAAG,CAAC,wBAAwB,KAAK;IAC/D,kBAAkB,QAAQ,GAAG,CAAC,4BAA4B,KAAK;AACjE;AAMO,MAAM,kBAAkB;IAC7B;;;;GAIC,GACD,cAAc;IAEd;;GAEC,GACD,cAAc;QACZ,oDAAoD,GACpD,SAAS,KAAK,KAAK;QACnB,qDAAqD,GACrD,KAAK,IAAI,KAAK,KAAK;QACnB,oCAAoC,GACpC,SAAS,IAAI,KAAK,KAAK,KAAK;IAC9B;IAEA;;;GAGC,GACD,oBAAoB,KAAK,KAAK;IAE9B;;GAEC,GACD,yBAAyB,KAAK;IAE9B;;GAEC,GACD,YAAY;QACV,yCAAyC,GACzC,SAAS,QAAQ,GAAG,CAAC,0BAA0B,KAAK;QACpD,6BAA6B,GAC7B,WAAW;IACb;AACF;AAMO,MAAM,oBAAoB;IAC/B;;;GAGC,GACD,kBAAkB;IAElB;;GAEC,GACD,eAAe,KAAK,OAAO;IAE3B;;GAEC,GACD,oBAAoB;QAClB;QACA;QACA;QACA;QACA;QACA;KACD;IAED;;GAEC,GACD,UAAU;QACR,YAAY;QACZ,YAAY;QACZ,mBAAmB;QACnB,mBAAmB;QACnB,gBAAgB;QAChB,sBAAsB;IACxB;AACF","debugId":null}},
    {"offset": {"line": 532, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/constants/api.ts"],"sourcesContent":["/**\r\n * @fileoverview API Endpoints Constants - Comprehensive endpoint definitions\r\n * @module constants/api\r\n * @version 2.0.0 - Maximized Edition\r\n *\r\n * Centralized API endpoint definitions for the White Cross healthcare platform.\r\n * All backend routes are defined here to prevent hardcoded strings and improve maintainability.\r\n *\r\n * **Architecture**:\r\n * - Backend Base: Direct routes (no /api/v1 prefix)\r\n * - Next.js rewrites handle `/api/v1/*` â†’ Backend `/*` proxying\r\n * - All endpoints use template literal types for type-safe route generation\r\n * - Organized by domain for easy navigation and maintenance\r\n *\r\n * **Key Features**:\r\n * - 700+ endpoint constants covering all platform features\r\n * - Type-safe endpoint functions with parameter validation\r\n * - Comprehensive PHI-compliant healthcare operations\r\n * - HIPAA-compliant audit logging endpoints\r\n * - Multi-channel communication endpoints\r\n * - Advanced reporting and analytics\r\n * - Complete medication management workflow\r\n * - Student health records and tracking\r\n * - Appointment scheduling and reminders\r\n * - Incident reporting and follow-up\r\n * - Financial and procurement management\r\n *\r\n * **Endpoint Categories**:\r\n * 1. Authentication & Authorization (AUTH, RBAC, MFA)\r\n * 2. Users & Access Control (USERS, RBAC)\r\n * 3. Students (STUDENTS with 25+ endpoints)\r\n * 4. Appointments (APPOINTMENTS, WAITLIST, NURSE_AVAILABILITY)\r\n * 5. Health Records (HEALTH_RECORDS, VITAL_SIGNS, CHRONIC_CONDITIONS, ALLERGIES)\r\n * 6. Immunizations & Vaccinations (IMMUNIZATIONS)\r\n * 7. Medications (MEDICATIONS, PRESCRIPTIONS, INVENTORY, ADMINISTRATION_LOG)\r\n * 8. Emergency Contacts (EMERGENCY_CONTACTS)\r\n * 9. Incidents (INCIDENTS with witness and follow-up)\r\n * 10. Documents (DOCUMENTS with signing and verification)\r\n * 11. Compliance & Audit (COMPLIANCE, AUDIT)\r\n * 12. Communications (MESSAGES, BROADCASTS, ALERTS, NOTIFICATIONS, CONVERSATIONS, TEMPLATES)\r\n * 13. Dashboard & Analytics (DASHBOARD, ANALYTICS, REPORTS)\r\n * 14. System Administration (ADMIN, SYSTEM, INTEGRATIONS)\r\n * 15. Billing & Financial (BILLING, BUDGET, VENDORS, PURCHASE_ORDERS)\r\n * 16. Forms & Settings (FORMS, SETTINGS)\r\n *\r\n * **Usage Examples**:\r\n * ```typescript\r\n * import { API_ENDPOINTS } from '@/constants/api';\r\n *\r\n * // Simple endpoint\r\n * const url = API_ENDPOINTS.STUDENTS.BASE; // '/students'\r\n *\r\n * // Parameterized endpoint\r\n * const studentUrl = API_ENDPOINTS.STUDENTS.BY_ID('123'); // '/students/123'\r\n *\r\n * // Nested endpoint\r\n * const medUrl = API_ENDPOINTS.STUDENTS.MEDICATIONS('123'); // '/students/123/medications'\r\n *\r\n * // In API client\r\n * const response = await apiClient.get(API_ENDPOINTS.STUDENTS.BY_ID(studentId));\r\n * ```\r\n *\r\n * **Type Safety**:\r\n * All endpoints are typed as const for literal type inference and autocomplete support.\r\n *\r\n * **Maintenance**:\r\n * When adding new endpoints:\r\n * 1. Add to appropriate domain section\r\n * 2. Use consistent naming patterns (BASE, BY_ID, etc.)\r\n * 3. Add JSDoc comments for complex endpoints\r\n * 4. Update this file header with new categories\r\n *\r\n * @see /backend/src/routes/ for backend route definitions\r\n * @see /frontend/src/lib/api/client.ts for API client implementation\r\n * @see /frontend/src/lib/server/api-client.ts for server-side API client\r\n */\r\n\r\n\r\nexport const API_ENDPOINTS = {\r\n  // ==========================================\r\n  // AUTHENTICATION & AUTHORIZATION\r\n  // ==========================================\r\n  AUTH: {\r\n    LOGIN: `/auth/login`,\r\n    LOGOUT: `/auth/logout`,\r\n    REFRESH: `/auth/refresh`,\r\n    VERIFY: `/auth/verify`,\r\n    REGISTER: `/auth/register`,\r\n    PROFILE: `/auth/me`,\r\n    CHANGE_PASSWORD: `/auth/change-password`,\r\n    FORGOT_PASSWORD: `/auth/forgot-password`,\r\n    RESET_PASSWORD: `/auth/reset-password`,\r\n  },\r\n\r\n  // ==========================================\r\n  // USERS & ACCESS CONTROL\r\n  // ==========================================\r\n  USERS: {\r\n    BASE: `/users`,\r\n    BY_ID: (id: string) => `/users/${id}`,\r\n    ME: `/users/me`,\r\n    PROFILE: `/users/profile`,\r\n    UPDATE_PROFILE: `/users/profile`,\r\n  },\r\n\r\n  RBAC: {\r\n    ROLES: `/access-control/roles`,\r\n    PERMISSIONS: `/access-control/permissions`,\r\n    USER_ROLES: (userId: string) => `/access-control/users/${userId}/roles`,\r\n    USER_PERMISSIONS: (userId: string) => `/access-control/users/${userId}/permissions`,\r\n  },\r\n\r\n  // ==========================================\r\n  // STUDENTS\r\n  // ==========================================\r\n  STUDENTS: {\r\n    BASE: `/students`,\r\n    BY_ID: (id: string) => `/students/${id}`,\r\n    DEACTIVATE: (id: string) => `/students/${id}/deactivate`,\r\n    REACTIVATE: (id: string) => `/students/${id}/reactivate`,\r\n    TRANSFER: (id: string) => `/students/${id}/transfer`,\r\n    ASSIGN: (id: string) => `/students/${id}/assign`,\r\n    ASSIGN_BULK: `/students/assign-bulk`,\r\n    PHOTO: (id: string) => `/students/${id}/photo`,\r\n    EXPORT: (id: string) => `/students/${id}/export`,\r\n    REPORT_CARD: (id: string) => `/students/${id}/report-card`,\r\n    VERIFY_ELIGIBILITY: (id: string) => `/students/${id}/verify-eligibility`,\r\n    SEARCH: `/students/search`,\r\n    SEARCH_BY_QUERY: (query: string) => `/students/search/${encodeURIComponent(query)}`,\r\n    BY_GRADE: (grade: string) => `/students/grade/${grade}`,\r\n    BY_NURSE: (nurseId: string) => `/students/nurse/${nurseId}`,\r\n    ASSIGNED: `/students/assigned`,\r\n    STATISTICS: (id: string) => `/students/${id}/statistics`,\r\n    BULK_UPDATE: `/students/bulk-update`,\r\n    PERMANENT_DELETE: (id: string) => `/students/${id}/permanent`,\r\n    GRADES: `/students/grades`,\r\n    HEALTH_RECORDS: (id: string) => `/students/${id}/health-records`,\r\n    MENTAL_HEALTH_RECORDS: (id: string) => `/students/${id}/mental-health-records`,\r\n    MEDICATIONS: (id: string) => `/students/${id}/medications`,\r\n    IMMUNIZATIONS: (id: string) => `/students/${id}/immunizations`,\r\n    ALLERGIES: (id: string) => `/students/${id}/allergies`,\r\n    APPOINTMENTS: (id: string) => `/students/${id}/appointments`,\r\n    INCIDENTS: (id: string) => `/students/${id}/incidents`,\r\n    EMERGENCY_CONTACTS: (id: string) => `/students/${id}/emergency-contacts`,\r\n  },\r\n\r\n  // ==========================================\r\n  // APPOINTMENTS\r\n  // ==========================================\r\n  APPOINTMENTS: {\r\n    BASE: `/appointments`,\r\n    BY_ID: (id: string) => `/appointments/${id}`,\r\n    RESCHEDULE: (id: string) => `/appointments/${id}/reschedule`,\r\n    CANCEL: (id: string) => `/appointments/${id}/cancel`,\r\n    COMPLETE: (id: string) => `/appointments/${id}/complete`,\r\n    NO_SHOW: (id: string) => `/appointments/${id}/no-show`,\r\n    CONFIRM: (id: string) => `/appointments/${id}/confirm`,\r\n    START: (id: string) => `/appointments/${id}/start`,\r\n    SEND_REMINDER: (id: string) => `/appointments/${id}/send-reminder`,\r\n    AVAILABILITY: `/appointments/availability`,\r\n    CONFLICTS: `/appointments/conflicts`,\r\n    CHECK_CONFLICTS: `/appointments/check-conflicts`,\r\n    REMINDERS: `/appointments/reminders`,\r\n    PROCESS_REMINDERS: `/appointments/process-reminders`,\r\n    BY_STUDENT: (studentId: string) => `/appointments/student/${studentId}`,\r\n    BY_NURSE: (nurseId: string) => `/appointments/nurse/${nurseId}`,\r\n    BY_DATE: `/appointments/by-date`,\r\n    UPCOMING: `/appointments/upcoming`,\r\n    STATISTICS: `/appointments/statistics`,\r\n    RECURRING: `/appointments/recurring`,\r\n    CREATE_RECURRING: `/appointments/recurring/create`,\r\n    EXPORT_CALENDAR: `/appointments/export/calendar`,\r\n    REPORTS: `/appointments/reports`,\r\n  },\r\n\r\n  // ==========================================\r\n  // HEALTH RECORDS\r\n  // ==========================================\r\n  HEALTH_RECORDS: {\r\n    BASE: `/health-records`,\r\n    BY_ID: (id: string) => `/health-records/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/health-records`,\r\n    BY_TYPE: (type: string) => `/health-records/type/${type}`,\r\n    SEARCH: `/health-records/search`,\r\n    EXPORT: (id: string) => `/health-records/${id}/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // IMMUNIZATIONS / VACCINATIONS\r\n  // ==========================================\r\n  IMMUNIZATIONS: {\r\n    BASE: `/vaccinations`,\r\n    BY_ID: (id: string) => `/vaccinations/${id}`,\r\n    SCHEDULE: `/vaccinations/schedule`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/immunizations`,\r\n    DUE: `/vaccinations/due`,\r\n    OVERDUE: `/vaccinations/overdue`,\r\n    COMPLIANCE: `/vaccinations/compliance`,\r\n    EXEMPTIONS: `/vaccinations/exemptions`,\r\n    VERIFY: (id: string) => `/vaccinations/${id}/verify`,\r\n    EXPORT: (studentId: string) => `/vaccinations/export/${studentId}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // HEALTH SCREENINGS\r\n  // ==========================================\r\n  SCREENINGS: {\r\n    BASE: `/screenings`,\r\n    BY_ID: (id: string) => `/screenings/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/screenings`,\r\n    BY_TYPE: (type: string) => `/screenings/type/${type}`,\r\n    DUE: `/screenings/due`,\r\n    SCHEDULE: `/screenings/schedule`,\r\n    RESULTS: (id: string) => `/screenings/${id}/results`,\r\n  },\r\n\r\n  // ==========================================\r\n  // GROWTH MEASUREMENTS\r\n  // ==========================================\r\n  GROWTH_MEASUREMENTS: {\r\n    BASE: `/growth-measurements`,\r\n    BY_ID: (id: string) => `/growth-measurements/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/growth-measurements`,\r\n    TRENDS: (studentId: string) => `/students/${studentId}/growth-measurements/trends`,\r\n    BMI: (studentId: string) => `/students/${studentId}/bmi`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ALLERGIES\r\n  // ==========================================\r\n  ALLERGIES: {\r\n    BASE: `/allergies`,\r\n    BY_ID: (id: string) => `/allergies/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/allergies`,\r\n    CRITICAL: `/allergies/critical`,\r\n    ACTIVE: `/allergies/active`,\r\n  },\r\n\r\n  // ==========================================\r\n  // VITAL SIGNS\r\n  // ==========================================\r\n  VITAL_SIGNS: {\r\n    BASE: `/vital-signs`,\r\n    BY_ID: (id: string) => `/vital-signs/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/vital-signs`,\r\n    BY_HEALTH_RECORD: (healthRecordId: string) => `/health-records/${healthRecordId}/vital-signs`,\r\n    LATEST: (studentId: string) => `/students/${studentId}/vital-signs/latest`,\r\n    TRENDS: (studentId: string) => `/students/${studentId}/vital-signs/trends`,\r\n  },\r\n\r\n  // ==========================================\r\n  // CHRONIC CONDITIONS\r\n  // ==========================================\r\n  CHRONIC_CONDITIONS: {\r\n    BASE: `/chronic-conditions`,\r\n    BY_ID: (id: string) => `/chronic-conditions/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/chronic-conditions`,\r\n    ACTIVE: `/chronic-conditions/active`,\r\n    REVIEW_DUE: `/chronic-conditions/review-due`,\r\n  },\r\n\r\n  // ==========================================\r\n  // MEDICATIONS\r\n  // ==========================================\r\n  MEDICATIONS: {\r\n    BASE: `/medications`,\r\n    BY_ID: (id: string) => `/medications/${id}`,\r\n    DETAIL: (id: string) => `/medications/${id}`,\r\n    ADMINISTER: (id: string) => `/medications/${id}/administer`,\r\n    DISCONTINUE: (id: string) => `/medications/${id}/discontinue`,\r\n    REFILL: (id: string) => `/medications/${id}/refill`,\r\n    MISSED_DOSE: (id: string) => `/medications/${id}/missed-dose`,\r\n    ADVERSE_REACTION: (id: string) => `/medications/${id}/adverse-reaction`,\r\n    ADJUST_INVENTORY: (id: string) => `/medications/${id}/adjust-inventory`,\r\n    REMINDER: (id: string) => `/medications/${id}/reminder`,\r\n    SCHEDULE: (id: string) => `/medications/${id}/schedule`,\r\n    INTERACTIONS: (id: string) => `/medications/${id}/interactions`,\r\n    CALENDAR: `/medications/calendar`,\r\n    DUE: `/medications/due`,\r\n    OVERDUE: `/medications/overdue`,\r\n    MISSED: `/medications/missed`,\r\n    COMPLETED: `/medications/completed`,\r\n    AS_NEEDED: `/medications/as-needed`,\r\n    EMERGENCY: `/medications/emergency`,\r\n    CONTROLLED: `/medications/controlled-substances`,\r\n    OTC: `/medications/over-the-counter`,\r\n    CATEGORIES: `/medications/categories`,\r\n    RULES: `/medications/administration-rules`,\r\n    CHECK_INTERACTIONS: `/medications/check-interactions`,\r\n    FORMULARY: `/medications/formulary`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/medications`,\r\n  },\r\n\r\n  // ==========================================\r\n  // PRESCRIPTIONS\r\n  // ==========================================\r\n  PRESCRIPTIONS: {\r\n    BASE: `/prescriptions`,\r\n    BY_ID: (id: string) => `/prescriptions/${id}`,\r\n    DETAIL: (id: string) => `/prescriptions/${id}`,\r\n    REFILL: (id: string) => `/prescriptions/${id}/refill`,\r\n    ACTIVE: `/prescriptions/active`,\r\n    EXPIRING: `/prescriptions/expiring`,\r\n  },\r\n\r\n  // ==========================================\r\n  // INVENTORY\r\n  // ==========================================\r\n  INVENTORY: {\r\n    BASE: `/inventory`,\r\n    BY_ID: (id: string) => `/inventory/${id}`,\r\n    DETAIL: (id: string) => `/inventory/${id}`,\r\n    ADJUST: (id: string) => `/inventory/${id}/adjust`,\r\n    LOW_STOCK: `/inventory/low-stock`,\r\n    EXPIRING: `/inventory/expiring`,\r\n    REORDER: `/inventory/reorder`,\r\n    AUDIT: `/inventory/audit`,\r\n    ITEMS: `/inventory/items`,\r\n    ALERTS: `/inventory/alerts`,\r\n    ANALYTICS: `/inventory/analytics`,\r\n    DASHBOARD: `/inventory/dashboard`,\r\n    REPORTS: `/inventory/reports`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ADMINISTRATION LOG\r\n  // ==========================================\r\n  ADMINISTRATION_LOG: {\r\n    BASE: `/administration-log`,\r\n    BY_ID: (id: string) => `/administration-log/${id}`,\r\n    DETAIL: (id: string) => `/administration-log/${id}`,\r\n    BY_MEDICATION: (medicationId: string) => `/medications/${medicationId}/administration-log`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/administration-log`,\r\n    TODAY: `/administration-log/today`,\r\n    MISSED: `/administration-log/missed`,\r\n  },\r\n\r\n  // ==========================================\r\n  // EMERGENCY CONTACTS\r\n  // ==========================================\r\n  EMERGENCY_CONTACTS: {\r\n    BASE: `/emergency-contacts`,\r\n    BY_ID: (id: string) => `/emergency-contacts/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/emergency-contacts`,\r\n    PRIMARY: (studentId: string) => `/students/${studentId}/emergency-contacts/primary`,\r\n    VERIFY: (id: string) => `/emergency-contacts/${id}/verify`,\r\n    NOTIFY: (id: string) => `/emergency-contacts/${id}/notify`,\r\n  },\r\n\r\n  // ==========================================\r\n  // INCIDENTS\r\n  // ==========================================\r\n  INCIDENTS: {\r\n    BASE: `/incident-report`,\r\n    BY_ID: (id: string) => `/incident-report/${id}`,\r\n    WITNESSES: (incidentId: string) => `/incident-report/${incidentId}/witnesses`,\r\n    WITNESS_STATEMENT: (incidentId: string, witnessId: string) =>\r\n      `/incident-report/${incidentId}/witnesses/${witnessId}/statement`,\r\n    VERIFY_STATEMENT: (statementId: string) => `/incident-report/statements/${statementId}/verify`,\r\n    FOLLOW_UP: (incidentId: string) => `/incident-report/${incidentId}/follow-up`,\r\n    FOLLOW_UP_PROGRESS: (followUpId: string) => `/incident-report/follow-up/${followUpId}/progress`,\r\n    FOLLOW_UP_COMPLETE: (followUpId: string) => `/incident-report/follow-up/${followUpId}/complete`,\r\n    ANALYTICS: `/incident-report/analytics`,\r\n    TRENDING: `/incident-report/trending`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/incidents`,\r\n    BY_TYPE: (type: string) => `/incident-report/type/${type}`,\r\n    BY_SEVERITY: (severity: string) => `/incident-report/severity/${severity}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // DOCUMENTS\r\n  // ==========================================\r\n  DOCUMENTS: {\r\n    BASE: `/documents`,\r\n    BY_ID: (id: string) => `/documents/${id}`,\r\n    UPLOAD: `/documents/upload`,\r\n    DOWNLOAD: (id: string) => `/documents/${id}/download`,\r\n    PREVIEW: (id: string) => `/documents/${id}/preview`,\r\n    SIGN: (id: string) => `/documents/${id}/sign`,\r\n    VERIFY_SIGNATURE: (id: string) => `/documents/${id}/verify-signature`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/documents`,\r\n    BY_TYPE: (type: string) => `/documents/type/${type}`,\r\n    TEMPLATES: `/documents/templates`,\r\n  },\r\n\r\n  // ==========================================\r\n  // COMPLIANCE & AUDIT\r\n  // ==========================================\r\n  COMPLIANCE: {\r\n    REPORTS: `/compliance/reports`,\r\n    AUDIT_LOGS: `/compliance/audit-logs`,\r\n    PHI_DISCLOSURES: `/compliance/phi-disclosures`,\r\n    ACCESS_LOG: `/compliance/access-log`,\r\n    DATA_RETENTION: `/compliance/data-retention`,\r\n    EXPORT: `/compliance/export`,\r\n  },\r\n\r\n  AUDIT: {\r\n    LOGS: `/audit-logs`,\r\n    BY_ID: (id: string) => `/audit-logs/${id}`,\r\n    BY_USER: (userId: string) => `/audit-logs/user/${userId}`,\r\n    BY_RESOURCE: (resourceType: string, resourceId: string) =>\r\n      `/audit-logs/resource/${resourceType}/${resourceId}`,\r\n    BY_ACTION: (action: string) => `/audit-logs/action/${action}`,\r\n    PHI_ACCESS: `/audit-logs/phi-access`,\r\n    PHI_ACCESS_LOG: `/audit/phi-access`,\r\n    EXPORT: `/audit-logs/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // COMMUNICATIONS\r\n  // ==========================================\r\n  MESSAGES: {\r\n    BASE: `/messages`,\r\n    BY_ID: (id: string) => `/messages/${id}`,\r\n    SEND: `/messages/send`,\r\n    INBOX: `/messages/inbox`,\r\n    SENT: `/messages/sent`,\r\n    UNREAD: `/messages/unread`,\r\n    MARK_READ: (id: string) => `/messages/${id}/mark-read`,\r\n    MARK_UNREAD: (id: string) => `/messages/${id}/mark-unread`,\r\n    DELETE: (id: string) => `/messages/${id}`,\r\n    THREAD: (id: string) => `/messages/thread/${id}`,\r\n    ATTACHMENTS: (id: string) => `/messages/${id}/attachments`,\r\n  },\r\n\r\n  BROADCASTS: {\r\n    BASE: `/broadcasts`,\r\n    BY_ID: (id: string) => `/broadcasts/${id}`,\r\n    SEND: `/broadcasts/send`,\r\n    SCHEDULE: `/broadcasts/schedule`,\r\n    RECIPIENTS: (id: string) => `/broadcasts/${id}/recipients`,\r\n    CANCEL: (id: string) => `/broadcasts/${id}/cancel`,\r\n    DUPLICATE: (id: string) => `/broadcasts/${id}/duplicate`,\r\n    DELIVERY_STATUS: (id: string) => `/broadcasts/${id}/delivery-status`,\r\n    DRAFTS: `/broadcasts/drafts`,\r\n    SCHEDULED: `/broadcasts/scheduled`,\r\n  },\r\n\r\n  ALERTS: {\r\n    BASE: `/alerts`,\r\n    BY_ID: (id: string) => `/alerts/${id}`,\r\n    ACTIVE: `/alerts/active`,\r\n    ACKNOWLEDGE: (id: string) => `/alerts/${id}/acknowledge`,\r\n    DISMISS: (id: string) => `/alerts/${id}/dismiss`,\r\n    MEDICATION_REMINDERS: `/alerts/medication-reminders`,\r\n    APPOINTMENT_REMINDERS: `/alerts/appointment-reminders`,\r\n    EMERGENCY: `/alerts/emergency`,\r\n    BY_TYPE: (type: string) => `/alerts/type/${type}`,\r\n  },\r\n\r\n  NOTIFICATIONS: {\r\n    BASE: `/notifications`,\r\n    BY_ID: (id: string) => `/notifications/${id}`,\r\n    UNREAD: `/notifications/unread`,\r\n    MARK_READ: (id: string) => `/notifications/${id}/mark-read`,\r\n    MARK_ALL_READ: `/notifications/mark-all-read`,\r\n    PREFERENCES: `/notifications/preferences`,\r\n    TEST_PUSH: `/notifications/test-push`,\r\n    PUSH_SUBSCRIBE: `/notifications/push-subscribe`,\r\n    PUSH_UNSUBSCRIBE: `/notifications/push-unsubscribe`,\r\n    PUSH_SUBSCRIPTION: `/notifications/push-subscription`,\r\n  },\r\n\r\n  CONVERSATIONS: {\r\n    BASE: `/conversations`,\r\n    BY_ID: (id: string) => `/conversations/${id}`,\r\n    BY_USER: (userId: string) => `/conversations/user/${userId}`,\r\n    MESSAGES: (conversationId: string) => `/conversations/${conversationId}/messages`,\r\n    PARTICIPANTS: (conversationId: string) => `/conversations/${conversationId}/participants`,\r\n    ADD_PARTICIPANT: (conversationId: string) => `/conversations/${conversationId}/participants`,\r\n    REMOVE_PARTICIPANT: (conversationId: string, userId: string) =>\r\n      `/conversations/${conversationId}/participants/${userId}`,\r\n    ARCHIVE: (id: string) => `/conversations/${id}/archive`,\r\n    UNARCHIVE: (id: string) => `/conversations/${id}/unarchive`,\r\n  },\r\n\r\n  TEMPLATES: {\r\n    BASE: `/templates`,\r\n    BY_ID: (id: string) => `/templates/${id}`,\r\n    BY_CATEGORY: (category: string) => `/templates/category/${category}`,\r\n    RENDER: (id: string) => `/templates/${id}/render`,\r\n    CATEGORIES: `/templates/categories`,\r\n  },\r\n\r\n  // ==========================================\r\n  // DASHBOARD\r\n  // ==========================================\r\n  DASHBOARD: {\r\n    STATS: `/dashboard/stats`,\r\n    RECENT_ACTIVITIES: `/dashboard/recent-activities`,\r\n    UPCOMING_APPOINTMENTS: `/dashboard/upcoming-appointments`,\r\n    CHART_DATA: `/dashboard/chart-data`,\r\n    WIDGETS: (dashboardId: string) => `/dashboard/${dashboardId}/widgets`,\r\n    REFRESH: `/dashboard/refresh-cache`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ANALYTICS & REPORTING\r\n  // ==========================================\r\n  ANALYTICS: {\r\n    METRICS: `/analytics/metrics`,\r\n    DASHBOARD: `/analytics/dashboard`,\r\n    DASHBOARD_WIDGETS: (dashboardId: string) => `/analytics/dashboard/${dashboardId}/widgets`,\r\n    REPORTS: `/analytics/reports`,\r\n    CHART_DATA: `/analytics/chart-data`,\r\n    HEALTH_METRICS: `/analytics/health-metrics`,\r\n    MEDICATION_COMPLIANCE: `/analytics/medication-compliance`,\r\n    APPOINTMENT_METRICS: `/analytics/appointment-metrics`,\r\n    INCIDENT_ANALYTICS: `/analytics/incident-analytics`,\r\n    CUSTOM_REPORT: `/analytics/custom-report`,\r\n  },\r\n\r\n  REPORTS: {\r\n    // Base Reports\r\n    BASE: `/reports`,\r\n    CUSTOM: `/reports/custom`,\r\n    TEMPLATES: `/reports/templates`,\r\n    SCHEDULED: `/reports/scheduled`,\r\n    SCHEDULE: `/reports/schedule`,\r\n    EXPORT: `/reports/export`,\r\n    HISTORY: `/reports/history`,\r\n    SHARE: (reportId: string) => `/reports/${reportId}/share`,\r\n\r\n    // Health Trend Analysis\r\n    HEALTH_TRENDS: `/reports/health-trends`,\r\n    HEALTH_TRENDS_BY_CATEGORY: (category: string) => `/reports/health-trends/${category}`,\r\n\r\n    // Medication Reports\r\n    MEDICATIONS: {\r\n      ADMINISTRATION: `/reports/medications/administration`,\r\n      COMPLIANCE: `/reports/medications/compliance`,\r\n      EXPIRATION: `/reports/medications/expiration`,\r\n      INVENTORY: `/reports/medications/inventory`,\r\n      REFILLS: `/reports/medications/refills`,\r\n      USAGE: `/reports/medication-usage`,\r\n      EFFECTIVENESS: `/reports/medication-effectiveness`,\r\n    },\r\n\r\n    // Immunization Reports\r\n    IMMUNIZATIONS: {\r\n      COMPLIANCE: `/reports/immunizations/compliance`,\r\n      DUE: `/reports/immunizations/due`,\r\n      OVERDUE: `/reports/immunizations/overdue`,\r\n      EXEMPTIONS: `/reports/immunizations/exemptions`,\r\n    },\r\n\r\n    // Appointment Reports\r\n    APPOINTMENTS: {\r\n      ATTENDANCE: `/reports/appointments/attendance`,\r\n      NO_SHOWS: `/reports/appointments/no-shows`,\r\n      CANCELLATIONS: `/reports/appointments/cancellations`,\r\n    },\r\n\r\n    // Incident Reports\r\n    INCIDENTS: {\r\n      SUMMARY: `/reports/incidents/summary`,\r\n      BY_TYPE: `/reports/incidents/by-type`,\r\n      TRENDS: `/reports/incidents/trends`,\r\n      STATISTICS: `/reports/incident-statistics`,\r\n      BY_LOCATION: `/reports/incidents-by-location`,\r\n    },\r\n\r\n    // Student Reports\r\n    STUDENTS: {\r\n      ENROLLMENT: `/reports/students/enrollment`,\r\n      HEALTH_SUMMARY: `/reports/students/health-summary`,\r\n      DEMOGRAPHICS: `/reports/students/demographics`,\r\n    },\r\n\r\n    // Attendance & Absenteeism\r\n    ATTENDANCE_CORRELATION: `/reports/attendance-correlation`,\r\n    ABSENTEEISM_PATTERNS: `/reports/absenteeism-patterns`,\r\n\r\n    // Performance & Analytics\r\n    PERFORMANCE_METRICS: `/reports/performance-metrics`,\r\n    NURSE_PERFORMANCE: `/reports/nurse-performance`,\r\n    SYSTEM_USAGE: `/reports/system-usage`,\r\n    USAGE_ANALYTICS: `/reports/analytics/usage`,\r\n    POPULARITY: `/reports/analytics/popularity`,\r\n    INSIGHTS: `/reports/analytics/insights`,\r\n\r\n    // Dashboard Reports\r\n    DASHBOARD: `/reports/dashboard`,\r\n    DASHBOARD_WIDGETS: `/reports/dashboard/widgets`,\r\n    DASHBOARD_LAYOUT: `/reports/dashboard/layout`,\r\n\r\n    // Compliance Reports\r\n    COMPLIANCE: `/reports/compliance`,\r\n    COMPLIANCE_HISTORY: `/reports/compliance/history`,\r\n    COMPLIANCE_AUDIT: `/reports/compliance/audit`,\r\n  },\r\n\r\n  // ==========================================\r\n  // SYSTEM & ADMINISTRATION\r\n  // ==========================================\r\n  SYSTEM: {\r\n    HEALTH: `/health`,\r\n    STATUS: `/system/status`,\r\n    CONFIGURATION: `/system/configuration`,\r\n    SETTINGS: `/system/settings`,\r\n    BACKUP: `/system/backup`,\r\n    RESTORE: `/system/restore`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ADMIN - District, School, User Management\r\n  // ==========================================\r\n  ADMIN: {\r\n    // System Settings\r\n    SETTINGS: `/admin/settings`,\r\n\r\n    // Users\r\n    USERS: `/admin/users`,\r\n    USER_BY_ID: (id: string) => `/admin/users/${id}`,\r\n\r\n    // Districts\r\n    DISTRICTS: `/admin/districts`,\r\n    DISTRICT_BY_ID: (id: string) => `/admin/districts/${id}`,\r\n\r\n    // Schools\r\n    SCHOOLS: `/admin/schools`,\r\n    SCHOOL_BY_ID: (id: string) => `/admin/schools/${id}`,\r\n\r\n    // System Health\r\n    SYSTEM_HEALTH: `/admin/system/health`,\r\n\r\n    // Backups\r\n    BACKUPS: `/admin/backups`,\r\n    BACKUP_BY_ID: (id: string) => `/admin/backups/${id}`,\r\n\r\n    // Licenses\r\n    LICENSES: `/admin/licenses`,\r\n    LICENSE_BY_ID: (id: string) => `/admin/licenses/${id}`,\r\n    LICENSE_DEACTIVATE: (id: string) => `/admin/licenses/${id}/deactivate`,\r\n\r\n    // Configurations\r\n    CONFIGURATIONS: `/admin/configurations`,\r\n    CONFIGURATION_BY_KEY: (key: string) => `/admin/configurations/${key}`,\r\n\r\n    // Performance Metrics\r\n    METRICS: `/admin/metrics`,\r\n    METRIC_BY_ID: (id: string) => `/admin/metrics/${id}`,\r\n\r\n    // Training\r\n    TRAINING: `/admin/training`,\r\n    TRAINING_BY_ID: (id: string) => `/admin/training/${id}`,\r\n    TRAINING_COMPLETE: (id: string) => `/admin/training/${id}/complete`,\r\n    TRAINING_PROGRESS: (userId: string) => `/admin/training/progress/${userId}`,\r\n\r\n    // Audit Logs\r\n    AUDIT_LOGS: `/admin/audit-logs`,\r\n    AUDIT_LOG_BY_ID: (id: string) => `/admin/audit-logs/${id}`,\r\n  },\r\n\r\n  INTEGRATIONS: {\r\n    BASE: `/integrations`,\r\n    BY_ID: (id: string) => `/integrations/${id}`,\r\n    CONFIGURE: (id: string) => `/integrations/${id}/configure`,\r\n    TEST: (id: string) => `/integrations/${id}/test`,\r\n    SYNC: (id: string) => `/integrations/${id}/sync`,\r\n    ENABLE: (id: string) => `/integrations/${id}/enable`,\r\n    DISABLE: (id: string) => `/integrations/${id}/disable`,\r\n    LOGS: (id: string) => `/integrations/${id}/logs`,\r\n  },\r\n\r\n  // ==========================================\r\n  // MULTI-FACTOR AUTHENTICATION (MFA)\r\n  // ==========================================\r\n  MFA: {\r\n    SETUP: `/mfa/setup`,\r\n    VERIFY: `/mfa/verify`,\r\n    ENABLE: `/mfa/enable`,\r\n    DISABLE: `/mfa/disable`,\r\n    BACKUP_CODES: `/mfa/backup-codes`,\r\n    REGENERATE_CODES: `/mfa/backup-codes/regenerate`,\r\n    VERIFY_BACKUP_CODE: `/mfa/verify-backup-code`,\r\n    QR_CODE: `/mfa/qr-code`,\r\n    STATUS: `/mfa/status`,\r\n  },\r\n\r\n  // ==========================================\r\n  // APPOINTMENT WAITLIST\r\n  // ==========================================\r\n  WAITLIST: {\r\n    BASE: `/waitlist`,\r\n    BY_ID: (id: string) => `/waitlist/${id}`,\r\n    ADD: `/waitlist/add`,\r\n    REMOVE: (id: string) => `/waitlist/${id}/remove`,\r\n    POSITION: (id: string) => `/waitlist/${id}/position`,\r\n    NOTIFY: (id: string) => `/waitlist/${id}/notify`,\r\n    UPDATE_PRIORITY: (id: string) => `/waitlist/${id}/priority`,\r\n    BY_STUDENT: (studentId: string) => `/waitlist/student/${studentId}`,\r\n    BY_NURSE: (nurseId: string) => `/waitlist/nurse/${nurseId}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // NURSE AVAILABILITY & SCHEDULING\r\n  // ==========================================\r\n  NURSE_AVAILABILITY: {\r\n    BASE: `/nurse-availability`,\r\n    BY_ID: (id: string) => `/nurse-availability/${id}`,\r\n    BY_NURSE: (nurseId: string) => `/nurse-availability/nurse/${nurseId}`,\r\n    SLOTS: `/nurse-availability/slots`,\r\n    SET: `/nurse-availability/set`,\r\n    UPDATE: (id: string) => `/nurse-availability/${id}`,\r\n    DELETE: (id: string) => `/nurse-availability/${id}`,\r\n    BY_DATE: (date: string) => `/nurse-availability/date/${date}`,\r\n    CHECK_CONFLICTS: `/nurse-availability/check-conflicts`,\r\n  },\r\n\r\n  // ==========================================\r\n  // FORMS\r\n  // ==========================================\r\n  FORMS: {\r\n    BASE: `/forms`,\r\n    BY_ID: (id: string) => `/forms/${id}`,\r\n    TEMPLATES: `/forms/templates`,\r\n    SUBMIT: `/forms/submit`,\r\n    RESPONSES: (formId: string) => `/forms/${formId}/responses`,\r\n    SUBMISSIONS: (formId: string) => `/forms/${formId}/submissions`,\r\n    EXPORT: (formId: string) => `/forms/${formId}/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // PURCHASE ORDERS & PROCUREMENT\r\n  // ==========================================\r\n  PURCHASE_ORDERS: {\r\n    BASE: `/purchase-orders`,\r\n    BY_ID: (id: string) => `/purchase-orders/${id}`,\r\n    APPROVE: (id: string) => `/purchase-orders/${id}/approve`,\r\n    REJECT: (id: string) => `/purchase-orders/${id}/reject`,\r\n    RECEIVE: (id: string) => `/purchase-orders/${id}/receive`,\r\n    RECEIVE_ITEMS: (id: string) => `/purchase-orders/${id}/receive-items`,\r\n    CANCEL: (id: string) => `/purchase-orders/${id}/cancel`,\r\n    STATISTICS: `/purchase-orders/statistics`,\r\n    PENDING: `/purchase-orders/pending`,\r\n    APPROVED: `/purchase-orders/approved`,\r\n    RECEIVED: `/purchase-orders/received`,\r\n    BY_VENDOR: (vendorId: string) => `/purchase-orders/vendor/${vendorId}`,\r\n    REORDER_ITEMS: `/purchase-orders/reorder-items`,\r\n    VENDOR_HISTORY: (vendorId: string) => `/purchase-orders/vendor/${vendorId}/history`,\r\n  },\r\n\r\n  // ==========================================\r\n  // BILLING & FINANCIAL MANAGEMENT\r\n  // ==========================================\r\n  BILLING: {\r\n    // Invoices\r\n    INVOICES: `/billing/invoices`,\r\n    INVOICE_BY_ID: (id: string) => `/billing/invoices/${id}`,\r\n    INVOICE_PDF: (id: string) => `/billing/invoices/${id}/pdf`,\r\n    INVOICE_SEND: (id: string) => `/billing/invoices/${id}/send`,\r\n    INVOICE_VOID: (id: string) => `/billing/invoices/${id}/void`,\r\n    \r\n    // Payments\r\n    PAYMENTS: `/billing/payments`,\r\n    PAYMENT_BY_ID: (id: string) => `/billing/payments/${id}`,\r\n    PAYMENT_REFUND: (id: string) => `/billing/payments/${id}/refund`,\r\n    PAYMENT_VOID: (id: string) => `/billing/payments/${id}/void`,\r\n    \r\n    // Analytics\r\n    ANALYTICS: `/billing/analytics`,\r\n    REVENUE_TRENDS: `/billing/analytics/revenue-trends`,\r\n    PAYMENT_ANALYTICS: `/billing/analytics/payments`,\r\n    COLLECTION_METRICS: `/billing/analytics/collections`,\r\n    \r\n    // Reports\r\n    REPORTS: `/billing/reports`,\r\n    AGING_REPORT: `/billing/reports/aging`,\r\n    REVENUE_REPORT: `/billing/reports/revenue`,\r\n    PAYMENT_REPORT: `/billing/reports/payments`,\r\n    TAX_REPORT: `/billing/reports/tax`,\r\n    \r\n    // Settings\r\n    SETTINGS: `/billing/settings`,\r\n    \r\n    // Notifications\r\n    NOTIFICATIONS: `/billing/notifications`,\r\n    SEND_REMINDER: `/billing/notifications/reminder`,\r\n    SEND_STATEMENT: `/billing/notifications/statement`,\r\n  },\r\n\r\n  // ==========================================\r\n  // BUDGET MANAGEMENT\r\n  // ==========================================\r\n  BUDGET: {\r\n    // Budget Categories\r\n    CATEGORIES: `/budget/categories`,\r\n    CATEGORY_BY_ID: (id: string) => `/budget/categories/${id}`,\r\n\r\n    // Budget Summary\r\n    SUMMARY: `/budget/summary`,\r\n\r\n    // Budget Transactions\r\n    TRANSACTIONS: `/budget/transactions`,\r\n    TRANSACTION_BY_ID: (id: string) => `/budget/transactions/${id}`,\r\n\r\n    // Analytics & Reporting\r\n    TRENDS: `/budget/trends`,\r\n    YEAR_COMPARISON: `/budget/year-comparison`,\r\n    OVER_BUDGET: `/budget/over-budget`,\r\n    RECOMMENDATIONS: `/budget/recommendations`,\r\n    EXPORT: `/budget/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // VENDORS\r\n  // ==========================================\r\n  VENDORS: {\r\n    BASE: `/vendors`,\r\n    BY_ID: (id: string) => `/vendors/${id}`,\r\n    SEARCH: (query: string) => `/vendors/search/${encodeURIComponent(query)}`,\r\n    COMPARE: (itemName: string) => `/vendors/compare/${encodeURIComponent(itemName)}`,\r\n    TOP: `/vendors/top`,\r\n    STATISTICS: `/vendors/statistics`,\r\n    REACTIVATE: (id: string) => `/vendors/${id}/reactivate`,\r\n    RATING: (id: string) => `/vendors/${id}/rating`,\r\n    BULK_RATINGS: `/vendors/ratings/bulk`,\r\n    BY_PAYMENT_TERMS: (terms: string) => `/vendors/payment-terms/${encodeURIComponent(terms)}`,\r\n    METRICS: (id: string) => `/vendors/${id}/metrics`,\r\n    PERMANENT_DELETE: (id: string) => `/vendors/${id}/permanent`,\r\n  },\r\n\r\n  // ==========================================\r\n  // SETTINGS\r\n  // ==========================================\r\n  SETTINGS: {\r\n    USER: `/settings/user`,\r\n    SCHOOL: `/settings/school`,\r\n    NOTIFICATIONS: `/settings/notifications`,\r\n    PREFERENCES: `/settings/preferences`,\r\n    PRIVACY: `/settings/privacy`,\r\n    SECURITY: `/settings/security`,\r\n  },\r\n} as const;\r\n\r\n/**\r\n * HTTP Status Codes\r\n */\r\nexport const HTTP_STATUS = {\r\n  OK: 200,\r\n  CREATED: 201,\r\n  ACCEPTED: 202,\r\n  NO_CONTENT: 204,\r\n  BAD_REQUEST: 400,\r\n  UNAUTHORIZED: 401,\r\n  FORBIDDEN: 403,\r\n  NOT_FOUND: 404,\r\n  CONFLICT: 409,\r\n  UNPROCESSABLE_ENTITY: 422,\r\n  TOO_MANY_REQUESTS: 429,\r\n  INTERNAL_SERVER_ERROR: 500,\r\n  BAD_GATEWAY: 502,\r\n  SERVICE_UNAVAILABLE: 503,\r\n  GATEWAY_TIMEOUT: 504,\r\n} as const;\r\n\r\n/**\r\n * API Response Types\r\n */\r\nexport type ApiSuccessResponse<T = unknown> = {\r\n  success: true;\r\n  data: T;\r\n  message?: string;\r\n};\r\n\r\nexport type ApiErrorResponse = {\r\n  success: false;\r\n  error: string;\r\n  code?: string;\r\n  details?: Record<string, unknown>;\r\n  traceId?: string;\r\n};\r\n\r\nexport type ApiResponse<T = unknown> = ApiSuccessResponse<T> | ApiErrorResponse;\r\n\r\n/**\r\n * Pagination Types\r\n */\r\nexport type PaginationParams = {\r\n  page?: number;\r\n  limit?: number;\r\n  sort?: string;\r\n  order?: 'asc' | 'desc';\r\n};\r\n\r\nexport type PaginatedResponse<T> = {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrev: boolean;\r\n  };\r\n};\r\n\r\nexport default API_ENDPOINTS;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1323, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/security/CsrfProtection.ts"],"sourcesContent":["/**\r\n * WF-COMP-SEC-002 | CsrfProtection.ts - CSRF Token Protection Service\r\n * Purpose: Cross-Site Request Forgery protection for healthcare platform\r\n * Security: Implements CSRF token validation for all state-changing requests\r\n * Upstream: None | Dependencies: axios\r\n * Downstream: apiInstance, API interceptors | Called by: HTTP request interceptors\r\n * Related: apiConfig.ts, ApiClient.ts\r\n * Exports: CsrfProtection class, csrfProtection singleton, setupCsrfProtection function\r\n * Last Updated: 2025-10-21 | File Type: .ts\r\n * Critical Path: Request initiation â†’ CSRF token injection â†’ Server validation\r\n * LLM Context: Security-critical module for healthcare platform, prevents CSRF attacks on PHI\r\n */\r\n\r\nimport type { AxiosInstance, AxiosRequestConfig, InternalAxiosRequestConfig } from 'axios';\r\n\r\n/**\r\n * CSRF token storage interface for cached token management.\r\n *\r\n * Tracks CSRF token value, creation time, and expiration for automatic\r\n * token refresh and validation.\r\n *\r\n * @property {string} token - CSRF token value from meta tag or cookie\r\n * @property {number} timestamp - When token was cached (milliseconds since epoch)\r\n * @property {number} expiresAt - When cached token expires (milliseconds since epoch)\r\n */\r\ninterface CsrfToken {\r\n  token: string;\r\n  timestamp: number;\r\n  expiresAt: number;\r\n}\r\n\r\n/**\r\n * HTTP methods that require CSRF protection\r\n * GET, HEAD, OPTIONS are considered safe methods\r\n */\r\nconst STATE_CHANGING_METHODS = ['POST', 'PUT', 'PATCH', 'DELETE'] as const;\r\n\r\n/**\r\n * Enterprise-grade CSRF protection for healthcare platform\r\n *\r\n * Features:\r\n * - Automatic CSRF token injection for state-changing requests\r\n * - Token retrieval from meta tags or cookies\r\n * - Token refresh and validation\r\n * - Thread-safe singleton pattern\r\n * - Configurable token header name\r\n *\r\n * Security Benefits:\r\n * - Prevents cross-site request forgery attacks\r\n * - Protects PHI from unauthorized modifications\r\n * - Complies with OWASP security guidelines\r\n * - Defense-in-depth for healthcare data\r\n *\r\n * Implementation:\r\n * - Checks meta tag: <meta name=\"csrf-token\" content=\"token\">\r\n * - Falls back to cookie: XSRF-TOKEN or CSRF-TOKEN\r\n * - Injects token in X-CSRF-Token header\r\n *\r\n * @example\r\n * ```typescript\r\n * // Setup with axios instance\r\n * import { setupCsrfProtection } from '@/services/security/CsrfProtection';\r\n * import { apiInstance } from '@/services/config/apiConfig';\r\n *\r\n * setupCsrfProtection(apiInstance);\r\n * ```\r\n *\r\n * Backend Requirements:\r\n * - Server must set CSRF token in:\r\n *   1. Meta tag: <meta name=\"csrf-token\" content=\"token\">\r\n *   2. Cookie: XSRF-TOKEN or CSRF-TOKEN\r\n * - Server must validate X-CSRF-Token header\r\n * - Token should rotate on authentication changes\r\n */\r\nexport class CsrfProtection {\r\n  private static instance: CsrfProtection | null = null;\r\n  private tokenCache: CsrfToken | null = null;\r\n  private readonly TOKEN_HEADER = 'X-CSRF-Token';\r\n  private readonly META_TAG_NAME = 'csrf-token';\r\n  private readonly COOKIE_NAMES = ['XSRF-TOKEN', 'CSRF-TOKEN'];\r\n  private readonly TOKEN_TTL = 60 * 60 * 1000; // 1 hour\r\n\r\n  private constructor() {\r\n    // Initialize token on construction\r\n    this.refreshToken();\r\n  }\r\n\r\n  /**\r\n   * Get singleton instance of CsrfProtection.\r\n   *\r\n   * Implements thread-safe singleton pattern to ensure consistent CSRF\r\n   * protection across the application. First call initializes token cache.\r\n   *\r\n   * Security Benefits:\r\n   * - Centralized CSRF token management\r\n   * - Consistent token injection across all API calls\r\n   * - Single token refresh lifecycle\r\n   *\r\n   * @returns {CsrfProtection} Singleton instance of CsrfProtection\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const csrfProtection = CsrfProtection.getInstance();\r\n   * const token = csrfProtection.getToken();\r\n   * ```\r\n   */\r\n  public static getInstance(): CsrfProtection {\r\n    if (!CsrfProtection.instance) {\r\n      CsrfProtection.instance = new CsrfProtection();\r\n    }\r\n    return CsrfProtection.instance;\r\n  }\r\n\r\n  /**\r\n   * Setup CSRF protection on an Axios instance.\r\n   *\r\n   * Registers a request interceptor that automatically injects CSRF token\r\n   * into state-changing HTTP requests (POST, PUT, PATCH, DELETE). Safe\r\n   * methods (GET, HEAD, OPTIONS) are not modified.\r\n   *\r\n   * Security Features:\r\n   * - Automatic token injection for protected methods\r\n   * - Transparent to application code\r\n   * - Configurable via interceptor pattern\r\n   * - Fails gracefully on token absence\r\n   *\r\n   * OWASP Compliance:\r\n   * - Implements synchronizer token pattern\r\n   * - Follows CSRF protection best practices\r\n   * - Validates state-changing operations only\r\n   *\r\n   * @param {AxiosInstance} axiosInstance - Axios instance to protect with CSRF\r\n   * @returns {number} Interceptor ID for later removal if needed\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * import axios from 'axios';\r\n   * import { csrfProtection } from './CsrfProtection';\r\n   *\r\n   * const apiClient = axios.create({ baseURL: '/api' });\r\n   * const interceptorId = csrfProtection.setupInterceptor(apiClient);\r\n   *\r\n   * // All POST/PUT/PATCH/DELETE requests now include CSRF token\r\n   * await apiClient.post('/users', data); // Includes X-CSRF-Token header\r\n   *\r\n   * // Later, remove interceptor if needed\r\n   * apiClient.interceptors.request.eject(interceptorId);\r\n   * ```\r\n   *\r\n   * @see {@link injectCsrfToken} for token injection logic\r\n   */\r\n  public setupInterceptor(axiosInstance: AxiosInstance): number {\r\n    return axiosInstance.interceptors.request.use(\r\n      (config) => this.injectCsrfToken(config),\r\n      (error) => Promise.reject(error)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Inject CSRF token into request headers.\r\n   *\r\n   * Automatically adds X-CSRF-Token header to state-changing HTTP requests.\r\n   * Safe methods (GET, HEAD, OPTIONS) are not modified. Fails gracefully\r\n   * if token is unavailable, logging warning but allowing request.\r\n   *\r\n   * Protected Methods:\r\n   * - POST: Create operations\r\n   * - PUT: Full resource updates\r\n   * - PATCH: Partial resource updates\r\n   * - DELETE: Resource deletion\r\n   *\r\n   * Security Features:\r\n   * - Selective injection (state-changing methods only)\r\n   * - Graceful degradation on token absence\r\n   * - Debug logging for monitoring\r\n   * - Non-invasive error handling\r\n   *\r\n   * Threat Protection:\r\n   * - Prevents CSRF attacks on PHI modifications\r\n   * - Validates request origin via token\r\n   * - Complements same-origin policy\r\n   * - Defense-in-depth security layer\r\n   *\r\n   * @param {InternalAxiosRequestConfig} config - Axios request configuration\r\n   * @returns {InternalAxiosRequestConfig} Modified request configuration with CSRF token\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Manually inject token (usually done by interceptor)\r\n   * const config = {\r\n   *   method: 'POST',\r\n   *   url: '/api/patients',\r\n   *   data: patientData\r\n   * };\r\n   * const protectedConfig = csrfProtection.injectCsrfToken(config);\r\n   * // protectedConfig now includes X-CSRF-Token header\r\n   * ```\r\n   *\r\n   * @see {@link STATE_CHANGING_METHODS} for list of protected methods\r\n   */\r\n  public injectCsrfToken(config: InternalAxiosRequestConfig): InternalAxiosRequestConfig {\r\n    try {\r\n      const method = config.method?.toUpperCase();\r\n\r\n      // Only inject token for state-changing methods\r\n      if (!method || !this.isStateChangingMethod(method)) {\r\n        return config;\r\n      }\r\n\r\n      const token = this.getToken();\r\n      if (token) {\r\n        config.headers = config.headers || {};\r\n        config.headers[this.TOKEN_HEADER] = token;\r\n\r\n        console.debug('[CsrfProtection] CSRF token injected', {\r\n          method,\r\n          url: config.url,\r\n        });\r\n      } else {\r\n        console.warn('[CsrfProtection] No CSRF token available for request', {\r\n          method,\r\n          url: config.url,\r\n        });\r\n      }\r\n\r\n      return config;\r\n    } catch (error) {\r\n      console.error('[CsrfProtection] Failed to inject CSRF token:', error);\r\n      return config;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current CSRF token.\r\n   *\r\n   * Returns cached CSRF token if valid, otherwise refreshes from document.\r\n   * Token is cached for 1 hour (TOKEN_TTL) to minimize DOM access overhead.\r\n   *\r\n   * Token Sources (priority order):\r\n   * 1. Meta tag: <meta name=\"csrf-token\" content=\"token\">\r\n   * 2. Cookies: XSRF-TOKEN or CSRF-TOKEN\r\n   *\r\n   * Security Features:\r\n   * - Automatic cache validation and refresh\r\n   * - Multiple fallback sources for compatibility\r\n   * - Fail-safe returns null on errors\r\n   * - Performance optimization via caching\r\n   *\r\n   * @returns {string | null} CSRF token string, or null if unavailable\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const token = csrfProtection.getToken();\r\n   * if (token) {\r\n   *   // Include token in custom request\r\n   *   fetch('/api/endpoint', {\r\n   *     method: 'POST',\r\n   *     headers: { 'X-CSRF-Token': token }\r\n   *   });\r\n   * } else {\r\n   *   console.warn('CSRF token not available');\r\n   * }\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * Most applications don't call this directly - use setupInterceptor()\r\n   * for automatic token injection.\r\n   */\r\n  public getToken(): string | null {\r\n    try {\r\n      // Check if cached token is still valid\r\n      if (this.tokenCache && Date.now() < this.tokenCache.expiresAt) {\r\n        return this.tokenCache.token;\r\n      }\r\n\r\n      // Refresh token\r\n      this.refreshToken();\r\n\r\n      return this.tokenCache?.token || null;\r\n    } catch (error) {\r\n      console.error('[CsrfProtection] Failed to get CSRF token:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh CSRF token from meta tag or cookie.\r\n   *\r\n   * Extracts fresh CSRF token from document and updates internal cache\r\n   * with new expiration time (1 hour TTL). Call this method after\r\n   * authentication changes or when token becomes stale.\r\n   *\r\n   * Token Extraction Order:\r\n   * 1. Meta tag (preferred): <meta name=\"csrf-token\" content=\"...\">\r\n   * 2. Cookie fallback: XSRF-TOKEN or CSRF-TOKEN\r\n   *\r\n   * Use Cases:\r\n   * - After user login/logout\r\n   * - On authentication state changes\r\n   * - Manual token refresh for long-running sessions\r\n   * - Recovery from token mismatch errors\r\n   *\r\n   * Security Features:\r\n   * - Updates cache with fresh server-provided token\r\n   * - Prevents token staleness issues\r\n   * - Maintains token synchronization with backend\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Refresh token after login\r\n   * async function login(credentials) {\r\n   *   await authApi.login(credentials);\r\n   *   csrfProtection.refreshToken(); // Get new token for session\r\n   * }\r\n   *\r\n   * // Refresh on 403 CSRF error\r\n   * apiClient.interceptors.response.use(\r\n   *   response => response,\r\n   *   error => {\r\n   *     if (error.response?.status === 403) {\r\n   *       csrfProtection.refreshToken();\r\n   *       return retryRequest(error.config);\r\n   *     }\r\n   *     return Promise.reject(error);\r\n   *   }\r\n   * );\r\n   * ```\r\n   */\r\n  public refreshToken(): void {\r\n    try {\r\n      const token = this.extractTokenFromDocument();\r\n\r\n      if (token) {\r\n        const now = Date.now();\r\n        this.tokenCache = {\r\n          token,\r\n          timestamp: now,\r\n          expiresAt: now + this.TOKEN_TTL,\r\n        };\r\n\r\n        console.info('[CsrfProtection] CSRF token refreshed');\r\n      } else {\r\n        this.tokenCache = null;\r\n        console.warn('[CsrfProtection] No CSRF token found in document or cookies');\r\n      }\r\n    } catch (error) {\r\n      console.error('[CsrfProtection] Failed to refresh CSRF token:', error);\r\n      this.tokenCache = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear cached CSRF token.\r\n   *\r\n   * Removes cached token from memory. Call this method on logout or\r\n   * authentication state changes to prevent token reuse across sessions.\r\n   *\r\n   * Security Benefits:\r\n   * - Prevents token reuse after logout\r\n   * - Clears stale tokens on auth changes\r\n   * - Forces fresh token fetch on next request\r\n   *\r\n   * Use Cases:\r\n   * - User logout\r\n   * - Session expiration\r\n   * - Authentication errors\r\n   * - Token invalidation on server\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Clear token on logout\r\n   * async function logout() {\r\n   *   await authApi.logout();\r\n   *   csrfProtection.clearToken();\r\n   *   secureTokenManager.clearTokens();\r\n   *   redirectToLogin();\r\n   * }\r\n   *\r\n   * // Clear on authentication change\r\n   * authStore.subscribe((state) => {\r\n   *   if (!state.isAuthenticated) {\r\n   *     csrfProtection.clearToken();\r\n   *   }\r\n   * });\r\n   * ```\r\n   */\r\n  public clearToken(): void {\r\n    this.tokenCache = null;\r\n    console.info('[CsrfProtection] CSRF token cleared');\r\n  }\r\n\r\n  /**\r\n   * Extract CSRF token from document sources.\r\n   *\r\n   * Attempts to retrieve CSRF token from multiple sources in priority order.\r\n   * First checks meta tag (preferred), then falls back to cookies.\r\n   *\r\n   * Token Sources:\r\n   * 1. Meta tag: More secure, not sent with every request\r\n   * 2. Cookies: Fallback for compatibility, sent automatically\r\n   *\r\n   * @private\r\n   *\r\n   * @returns {string | null} CSRF token string or null if not found\r\n   *\r\n   * @see {@link getTokenFromMetaTag} for meta tag extraction\r\n   * @see {@link getTokenFromCookie} for cookie extraction\r\n   */\r\n  private extractTokenFromDocument(): string | null {\r\n    // Try meta tag first\r\n    const metaToken = this.getTokenFromMetaTag();\r\n    if (metaToken) {\r\n      return metaToken;\r\n    }\r\n\r\n    // Fall back to cookies\r\n    const cookieToken = this.getTokenFromCookie();\r\n    if (cookieToken) {\r\n      return cookieToken;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Get CSRF token from meta tag.\r\n   *\r\n   * Searches DOM for meta tag with name=\"csrf-token\" and extracts content\r\n   * attribute. This is the preferred method as meta tags are not automatically\r\n   * sent with requests (unlike cookies).\r\n   *\r\n   * Expected HTML:\r\n   * ```html\r\n   * <meta name=\"csrf-token\" content=\"token-value-here\">\r\n   * ```\r\n   *\r\n   * Security Benefits:\r\n   * - Token not sent automatically with requests\r\n   * - Explicit inclusion prevents certain attack vectors\r\n   * - More control over token exposure\r\n   *\r\n   * @private\r\n   *\r\n   * @returns {string | null} Token string from meta tag content, or null if not found\r\n   */\r\n  private getTokenFromMetaTag(): string | null {\r\n    try {\r\n      // Check if we're in a browser environment\r\n      if (typeof document === 'undefined') {\r\n        return null;\r\n      }\r\n\r\n      const metaTag = document.querySelector<HTMLMetaElement>(\r\n        `meta[name=\"${this.META_TAG_NAME}\"]`\r\n      );\r\n\r\n      if (metaTag && metaTag.content) {\r\n        return metaTag.content.trim();\r\n      }\r\n\r\n      return null;\r\n    } catch (error) {\r\n      console.warn('[CsrfProtection] Failed to get token from meta tag:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get CSRF token from cookies.\r\n   *\r\n   * Searches document.cookie for CSRF token using multiple standard cookie\r\n   * names for framework compatibility. Tries XSRF-TOKEN (Angular/Laravel)\r\n   * and CSRF-TOKEN (Django/Rails) in order.\r\n   *\r\n   * Standard Cookie Names:\r\n   * - XSRF-TOKEN: Used by Angular, Laravel\r\n   * - CSRF-TOKEN: Used by Django, Rails\r\n   *\r\n   * Security Note:\r\n   * - Cookies are automatically sent with requests (less secure than meta tag)\r\n   * - Use httpOnly=false so JavaScript can read token\r\n   * - SameSite attribute should be Strict or Lax\r\n   *\r\n   * @private\r\n   *\r\n   * @returns {string | null} Decoded token string from cookie, or null if not found\r\n   *\r\n   * @remarks\r\n   * Token is URI-decoded before return to handle encoded special characters.\r\n   */\r\n  private getTokenFromCookie(): string | null {\r\n    try {\r\n      // Check if we're in a browser environment\r\n      if (typeof document === 'undefined') {\r\n        return null;\r\n      }\r\n\r\n      const cookies = document.cookie.split(';');\r\n\r\n      for (const cookieName of this.COOKIE_NAMES) {\r\n        for (const cookie of cookies) {\r\n          const [name, value] = cookie.trim().split('=');\r\n\r\n          if (name === cookieName && value) {\r\n            return decodeURIComponent(value);\r\n          }\r\n        }\r\n      }\r\n\r\n      return null;\r\n    } catch (error) {\r\n      console.warn('[CsrfProtection] Failed to get token from cookies:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if HTTP method requires CSRF protection.\r\n   *\r\n   * Determines if the given HTTP method is state-changing and requires\r\n   * CSRF token. Safe methods (GET, HEAD, OPTIONS) are not protected\r\n   * as they should not modify server state per HTTP specifications.\r\n   *\r\n   * Protected Methods:\r\n   * - POST: Create new resources\r\n   * - PUT: Replace existing resources\r\n   * - PATCH: Partial resource updates\r\n   * - DELETE: Remove resources\r\n   *\r\n   * Safe Methods (not protected):\r\n   * - GET: Read resources\r\n   * - HEAD: Get resource metadata\r\n   * - OPTIONS: Discover allowed methods\r\n   *\r\n   * @private\r\n   *\r\n   * @param {string} method - HTTP method in uppercase (e.g., 'POST', 'GET')\r\n   * @returns {boolean} True if method requires CSRF protection, false otherwise\r\n   *\r\n   * @see {@link STATE_CHANGING_METHODS} for complete list of protected methods\r\n   */\r\n  private isStateChangingMethod(method: string): boolean {\r\n    return STATE_CHANGING_METHODS.includes(method as typeof STATE_CHANGING_METHODS[number]);\r\n  }\r\n\r\n  /**\r\n   * Get token cache information.\r\n   *\r\n   * Returns diagnostic information about the cached CSRF token for debugging\r\n   * and monitoring purposes. Useful for troubleshooting CSRF issues and\r\n   * monitoring token lifecycle.\r\n   *\r\n   * Returned Information:\r\n   * - hasToken: Whether a token is currently cached\r\n   * - expiresAt: When cached token expires (milliseconds)\r\n   * - age: How long token has been cached (milliseconds)\r\n   *\r\n   * Use Cases:\r\n   * - Debug CSRF token issues\r\n   * - Monitor token refresh frequency\r\n   * - Health check implementations\r\n   * - Token lifecycle analysis\r\n   *\r\n   * @returns {{ hasToken: boolean; expiresAt?: number; age?: number } | null} Token cache diagnostics\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const info = csrfProtection.getTokenInfo();\r\n   * if (info.hasToken) {\r\n   *   console.log('Token age:', info.age, 'ms');\r\n   *   console.log('Expires at:', new Date(info.expiresAt));\r\n   *   console.log('Time until expiry:', info.expiresAt - Date.now(), 'ms');\r\n   * } else {\r\n   *   console.log('No token cached');\r\n   * }\r\n   * ```\r\n   */\r\n  public getTokenInfo(): { hasToken: boolean; expiresAt?: number; age?: number } | null {\r\n    if (!this.tokenCache) {\r\n      return { hasToken: false };\r\n    }\r\n\r\n    const now = Date.now();\r\n    return {\r\n      hasToken: true,\r\n      expiresAt: this.tokenCache.expiresAt,\r\n      age: now - this.tokenCache.timestamp,\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Singleton instance of CsrfProtection\r\n * Use this throughout the application\r\n *\r\n * @example\r\n * ```typescript\r\n * import { csrfProtection } from '@/services/security/CsrfProtection';\r\n *\r\n * // Get current token\r\n * const token = csrfProtection.getToken();\r\n *\r\n * // Refresh token\r\n * csrfProtection.refreshToken();\r\n * ```\r\n */\r\nexport const csrfProtection = CsrfProtection.getInstance();\r\n\r\n/**\r\n * Helper function to setup CSRF protection on an Axios instance\r\n * Recommended approach for most use cases\r\n *\r\n * @param axiosInstance - Axios instance to protect\r\n * @returns Interceptor ID\r\n *\r\n * @example\r\n * ```typescript\r\n * import { setupCsrfProtection } from '@/services/security/CsrfProtection';\r\n * import { apiInstance } from '@/services/config/apiConfig';\r\n *\r\n * // Setup CSRF protection\r\n * const interceptorId = setupCsrfProtection(apiInstance);\r\n *\r\n * // Later, if needed to remove:\r\n * // apiInstance.interceptors.request.eject(interceptorId);\r\n * ```\r\n */\r\nexport function setupCsrfProtection(axiosInstance: AxiosInstance): number {\r\n  return csrfProtection.setupInterceptor(axiosInstance);\r\n}\r\n\r\nexport default csrfProtection;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1837, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/security/SecureTokenManager.ts"],"sourcesContent":["/**\r\n * WF-COMP-SEC-001 | SecureTokenManager.ts - Secure Token Management Service\r\n * Purpose: HIPAA-compliant token storage and validation with automatic expiration\r\n * Security: Uses sessionStorage for enhanced security, implements inactivity timeout\r\n * Upstream: ../../constants/config | Dependencies: SECURITY_CONFIG\r\n * Downstream: Authentication services, API clients | Called by: Auth flows, API interceptors\r\n * Related: authApi.ts, apiConfig.ts, ApiClient.ts\r\n * Exports: SecureTokenManager class, secureTokenManager singleton | Key Features: Session-based storage, auto-cleanup\r\n * Last Updated: 2025-10-21 | File Type: .ts\r\n * Critical Path: Token storage â†’ Validation â†’ Automatic cleanup â†’ Session management\r\n * LLM Context: Security-critical module for healthcare platform, HIPAA compliance required\r\n */\r\n\r\nimport { SECURITY_CONFIG } from '../../constants/config';\r\nimport type { ITokenManager } from '../core/interfaces/ITokenManager';\r\n\r\n/**\r\n * Token metadata stored alongside the authentication token.\r\n *\r\n * This interface tracks token lifecycle, expiration, and user activity\r\n * for HIPAA-compliant session management and automatic timeout enforcement.\r\n *\r\n * @property {string} token - JWT access token for API authentication\r\n * @property {string} [refreshToken] - Optional refresh token for token renewal\r\n * @property {number} issuedAt - Timestamp when token was stored (milliseconds since epoch)\r\n * @property {number} expiresAt - Timestamp when token expires (milliseconds since epoch)\r\n * @property {number} lastActivity - Timestamp of last user activity for inactivity timeout\r\n */\r\ninterface TokenMetadata {\r\n  token: string;\r\n  refreshToken?: string;\r\n  issuedAt: number;\r\n  expiresAt: number;\r\n  lastActivity: number;\r\n}\r\n\r\n/**\r\n * Zustand auth storage structure for backward compatibility.\r\n *\r\n * Maintains compatibility with legacy Zustand-based authentication state\r\n * management while transitioning to secure token manager.\r\n *\r\n * @property {object} state - Authentication state object\r\n * @property {string | null} state.token - JWT access token or null\r\n * @property {unknown | null} state.user - User object or null\r\n * @property {number} version - State version for migration tracking\r\n */\r\ninterface ZustandAuthStorage {\r\n  state: {\r\n    token: string | null;\r\n    user: unknown | null;\r\n    [key: string]: unknown;\r\n  };\r\n  version: number;\r\n}\r\n\r\n/**\r\n * Enterprise-grade secure token manager for healthcare platform\r\n *\r\n * Features:\r\n * - Uses sessionStorage instead of localStorage for enhanced security\r\n * - Automatic token expiration validation\r\n * - Inactivity timeout (8 hours from SECURITY_CONFIG)\r\n * - Automatic cleanup on expiration\r\n * - JWT expiration parsing and validation\r\n * - Thread-safe singleton pattern\r\n *\r\n * Security Benefits:\r\n * - sessionStorage is cleared when browser/tab closes\r\n * - Prevents token persistence across sessions\r\n * - Implements defense-in-depth for PHI protection\r\n * - Complies with HIPAA security requirements\r\n *\r\n * @example\r\n * ```typescript\r\n * const tokenManager = secureTokenManager;\r\n *\r\n * // Store token\r\n * tokenManager.setToken('jwt-token', 'refresh-token');\r\n *\r\n * // Validate token\r\n * const isValid = tokenManager.isTokenValid();\r\n *\r\n * // Get token (returns null if expired)\r\n * const token = tokenManager.getToken();\r\n *\r\n * // Clear all tokens\r\n * tokenManager.clearTokens();\r\n * ```\r\n */\r\nexport class SecureTokenManager implements ITokenManager {\r\n  private static instance: SecureTokenManager | null = null;\r\n  private readonly TOKEN_KEY = 'secure_auth_token';\r\n  private readonly REFRESH_TOKEN_KEY = 'secure_refresh_token';\r\n  private readonly METADATA_KEY = 'secure_token_metadata';\r\n  private readonly ZUSTAND_KEY = 'auth-storage';\r\n\r\n  // Legacy keys for migration\r\n  private readonly LEGACY_TOKEN_KEY = 'auth_token';\r\n  private readonly LEGACY_REFRESH_KEY = 'refresh_token';\r\n\r\n  private cleanupInterval: number | null = null;\r\n\r\n  private constructor() {\r\n    this.initializeCleanup();\r\n    this.migrateFromLocalStorage();\r\n  }\r\n\r\n  /**\r\n   * Get singleton instance of SecureTokenManager.\r\n   *\r\n   * Implements thread-safe singleton pattern to ensure only one token manager\r\n   * exists throughout the application lifecycle. First call initializes the\r\n   * instance with automatic cleanup and token migration from legacy storage.\r\n   *\r\n   * Security Benefits:\r\n   * - Centralized token management prevents inconsistent state\r\n   * - Single cleanup lifecycle for proper resource management\r\n   * - Consistent security policies across all API calls\r\n   *\r\n   * @returns {SecureTokenManager} Singleton instance of SecureTokenManager\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const tokenManager = SecureTokenManager.getInstance();\r\n   * tokenManager.setToken(accessToken, refreshToken);\r\n   * ```\r\n   */\r\n  public static getInstance(): SecureTokenManager {\r\n    if (!SecureTokenManager.instance) {\r\n      SecureTokenManager.instance = new SecureTokenManager();\r\n    }\r\n    return SecureTokenManager.instance;\r\n  }\r\n\r\n  /**\r\n   * Initialize automatic cleanup interval for expired token detection.\r\n   *\r\n   * Establishes a recurring check every 60 seconds to validate token status\r\n   * and automatically clear expired tokens. Also registers window unload\r\n   * handler to cleanup resources on browser close.\r\n   *\r\n   * Security Benefits:\r\n   * - Automatic removal of expired tokens prevents unauthorized access\r\n   * - Prevents memory leaks from orphaned tokens\r\n   * - Ensures timely session termination on inactivity\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Enforces automatic session timeout requirements\r\n   * - Prevents access after session expiration\r\n   * - Implements defense-in-depth for PHI protection\r\n   *\r\n   * @private\r\n   */\r\n  private initializeCleanup(): void {\r\n    // Check if we're in a browser environment\r\n    if (typeof window === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    // Check for expired tokens every minute\r\n    this.cleanupInterval = window.setInterval(() => {\r\n      if (!this.isTokenValid()) {\r\n        this.clearTokens();\r\n      }\r\n    }, 60 * 1000); // 60 seconds\r\n\r\n    // Cleanup on window unload\r\n    window.addEventListener('beforeunload', () => {\r\n      this.cleanup();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Migrate tokens from localStorage to sessionStorage.\r\n   *\r\n   * Performs one-time migration of legacy tokens stored in localStorage\r\n   * to the more secure sessionStorage. Validates token expiration before\r\n   * migration and removes expired tokens. This ensures backward compatibility\r\n   * while upgrading security posture.\r\n   *\r\n   * Security Upgrade:\r\n   * - localStorage persists across browser sessions (security risk)\r\n   * - sessionStorage is cleared when browser/tab closes (more secure)\r\n   * - Migration is automatic and transparent to users\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Reduces token persistence window\r\n   * - Limits exposure of authentication credentials\r\n   * - Aligns with minimum necessary access principle\r\n   *\r\n   * @private\r\n   *\r\n   * @remarks\r\n   * This method runs once during SecureTokenManager initialization.\r\n   * After migration, legacy tokens are removed from localStorage.\r\n   * Expired tokens are discarded without migration.\r\n   */\r\n  private migrateFromLocalStorage(): void {\r\n    // Check if we're in a browser environment\r\n    if (typeof window === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Check if tokens exist in localStorage\r\n      const legacyToken = localStorage.getItem(this.LEGACY_TOKEN_KEY);\r\n      const legacyRefresh = localStorage.getItem(this.LEGACY_REFRESH_KEY);\r\n\r\n      if (legacyToken && !sessionStorage.getItem(this.TOKEN_KEY)) {\r\n        // Parse JWT to get expiration\r\n        const expiration = this.parseJwtExpiration(legacyToken);\r\n\r\n        if (expiration && expiration > Date.now()) {\r\n          // Token is still valid, migrate it\r\n          this.setToken(legacyToken, legacyRefresh || undefined);\r\n\r\n          // Remove from localStorage\r\n          localStorage.removeItem(this.LEGACY_TOKEN_KEY);\r\n          if (legacyRefresh) {\r\n            localStorage.removeItem(this.LEGACY_REFRESH_KEY);\r\n          }\r\n\r\n          console.info('[SecureTokenManager] Successfully migrated tokens from localStorage to sessionStorage');\r\n        } else {\r\n          // Token expired, just remove it\r\n          localStorage.removeItem(this.LEGACY_TOKEN_KEY);\r\n          if (legacyRefresh) {\r\n            localStorage.removeItem(this.LEGACY_REFRESH_KEY);\r\n          }\r\n          console.info('[SecureTokenManager] Removed expired legacy tokens');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.warn('[SecureTokenManager] Failed to migrate tokens:', error);\r\n      // Clear legacy tokens on error\r\n      localStorage.removeItem(this.LEGACY_TOKEN_KEY);\r\n      localStorage.removeItem(this.LEGACY_REFRESH_KEY);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store authentication token securely in sessionStorage.\r\n   *\r\n   * Validates and stores JWT access token with metadata tracking for expiration\r\n   * and activity monitoring. Parses JWT to extract expiration time or uses\r\n   * provided expiresIn parameter. Rejects already-expired tokens.\r\n   *\r\n   * Storage Mechanism:\r\n   * - Token: sessionStorage (cleared on browser/tab close)\r\n   * - Metadata: Includes issuedAt, expiresAt, lastActivity timestamps\r\n   * - Backward compatibility: Updates Zustand storage for legacy code\r\n   *\r\n   * Security Features:\r\n   * - Validates token format and expiration before storage\r\n   * - Throws error on invalid or expired tokens\r\n   * - Uses sessionStorage to prevent cross-session persistence\r\n   * - Automatic activity tracking for inactivity timeout\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Implements secure token storage with automatic expiration\r\n   * - Limits token lifetime to prevent unauthorized access\r\n   * - Enforces session timeout requirements\r\n   *\r\n   * @param {string} token - JWT access token to store\r\n   * @param {string} [refreshToken] - Optional refresh token for token renewal\r\n   * @param {number} [expiresIn] - Optional custom expiration in seconds (defaults to JWT exp or 24 hours)\r\n   *\r\n   * @throws {Error} If token is invalid (not a string or empty)\r\n   * @throws {Error} If token is already expired\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Store token with refresh token\r\n   * secureTokenManager.setToken(accessToken, refreshToken);\r\n   *\r\n   * // Store token with custom expiration (1 hour)\r\n   * secureTokenManager.setToken(accessToken, undefined, 3600);\r\n   *\r\n   * // Handle errors\r\n   * try {\r\n   *   secureTokenManager.setToken(token);\r\n   * } catch (error) {\r\n   *   console.error('Failed to store token:', error);\r\n   * }\r\n   * ```\r\n   */\r\n  public setToken(token: string, refreshToken?: string, expiresIn?: number): void {\r\n    if (!token || typeof token !== 'string') {\r\n      throw new Error('[SecureTokenManager] Invalid token provided');\r\n    }\r\n\r\n    try {\r\n      const now = Date.now();\r\n\r\n      // Parse JWT expiration or use provided expiresIn\r\n      let expirationTime: number;\r\n\r\n      if (expiresIn) {\r\n        expirationTime = now + (expiresIn * 1000);\r\n      } else {\r\n        const jwtExpiration = this.parseJwtExpiration(token);\r\n        expirationTime = jwtExpiration || (now + (24 * 60 * 60 * 1000)); // Default 24 hours\r\n      }\r\n\r\n      // Validate token isn't already expired\r\n      if (expirationTime <= now) {\r\n        throw new Error('[SecureTokenManager] Cannot store expired token');\r\n      }\r\n\r\n      const metadata: TokenMetadata = {\r\n        token,\r\n        refreshToken,\r\n        issuedAt: now,\r\n        expiresAt: expirationTime,\r\n        lastActivity: now,\r\n      };\r\n\r\n      // Store in sessionStorage\r\n      sessionStorage.setItem(this.TOKEN_KEY, token);\r\n      if (refreshToken) {\r\n        sessionStorage.setItem(this.REFRESH_TOKEN_KEY, refreshToken);\r\n      }\r\n      sessionStorage.setItem(this.METADATA_KEY, JSON.stringify(metadata));\r\n\r\n      // Update Zustand storage for backward compatibility\r\n      this.updateZustandStorage(token);\r\n\r\n      console.info('[SecureTokenManager] Token stored successfully', {\r\n        expiresAt: new Date(expirationTime).toISOString(),\r\n        hasRefreshToken: !!refreshToken,\r\n      });\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to store token:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve authentication token if valid.\r\n   *\r\n   * Returns the stored JWT access token after validating expiration and\r\n   * inactivity timeout. Automatically updates last activity timestamp to\r\n   * track user session. Returns null if token is expired, invalid, or\r\n   * doesn't exist.\r\n   *\r\n   * Validation Checks:\r\n   * 1. Token exists in sessionStorage\r\n   * 2. Token hasn't reached expiration time (from JWT exp claim)\r\n   * 3. Session hasn't exceeded inactivity timeout (8 hours)\r\n   * 4. Metadata is valid and parseable\r\n   *\r\n   * Security Features:\r\n   * - Automatic validation prevents use of expired tokens\r\n   * - Activity tracking for inactivity timeout enforcement\r\n   * - Automatic cleanup on validation failure\r\n   * - Fail-safe returns null on any error\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Enforces session timeout after 8 hours of inactivity\r\n   * - Prevents access with expired credentials\r\n   * - Implements automatic session termination\r\n   *\r\n   * @returns {string | null} JWT access token if valid, null otherwise\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const token = secureTokenManager.getToken();\r\n   * if (token) {\r\n   *   // Use token for API request\r\n   *   apiClient.setAuthHeader(token);\r\n   * } else {\r\n   *   // Token expired or invalid, redirect to login\r\n   *   redirectToLogin();\r\n   * }\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * This method is called automatically by API interceptors before each\r\n   * authenticated request. It serves as the primary token validation\r\n   * mechanism for the application.\r\n   */\r\n  public getToken(): string | null {\r\n    try {\r\n      const metadata = this.getMetadata();\r\n      if (!metadata) {\r\n        return null;\r\n      }\r\n\r\n      // Validate token\r\n      if (!this.isTokenValid(metadata)) {\r\n        this.clearTokens();\r\n        return null;\r\n      }\r\n\r\n      // Update last activity\r\n      this.updateActivity();\r\n\r\n      return metadata.token;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to retrieve token:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve refresh token if valid.\r\n   *\r\n   * Returns the stored refresh token after validating the associated access\r\n   * token's expiration and inactivity status. Used for obtaining new access\r\n   * tokens without requiring user re-authentication.\r\n   *\r\n   * Security Features:\r\n   * - Validates access token before returning refresh token\r\n   * - Returns null if session is expired or inactive\r\n   * - Automatic cleanup on validation failure\r\n   * - Prevents use of orphaned refresh tokens\r\n   *\r\n   * Token Refresh Flow:\r\n   * 1. Access token expires\r\n   * 2. Get refresh token using this method\r\n   * 3. Send refresh token to auth endpoint\r\n   * 4. Receive new access token\r\n   * 5. Store new token using setToken()\r\n   *\r\n   * @returns {string | null} Refresh token if valid, null otherwise\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const refreshToken = secureTokenManager.getRefreshToken();\r\n   * if (refreshToken) {\r\n   *   // Use refresh token to get new access token\r\n   *   const newAccessToken = await authApi.refreshToken(refreshToken);\r\n   *   secureTokenManager.setToken(newAccessToken, refreshToken);\r\n   * } else {\r\n   *   // No valid refresh token, redirect to login\r\n   *   redirectToLogin();\r\n   * }\r\n   * ```\r\n   */\r\n  public getRefreshToken(): string | null {\r\n    try {\r\n      const metadata = this.getMetadata();\r\n      if (!metadata || !metadata.refreshToken) {\r\n        return null;\r\n      }\r\n\r\n      // Validate token\r\n      if (!this.isTokenValid(metadata)) {\r\n        this.clearTokens();\r\n        return null;\r\n      }\r\n\r\n      return metadata.refreshToken;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to retrieve refresh token:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if current token is valid.\r\n   *\r\n   * Performs comprehensive validation of token expiration and inactivity\r\n   * timeout. Used internally by getToken() and externally for manual\r\n   * session validation checks.\r\n   *\r\n   * Validation Criteria:\r\n   * 1. Token metadata exists and is parseable\r\n   * 2. Current time is before token expiration (JWT exp claim)\r\n   * 3. Session hasn't exceeded 8-hour inactivity timeout\r\n   *\r\n   * Security Features:\r\n   * - Dual validation: expiration + inactivity timeout\r\n   * - Logs validation failures for audit trail\r\n   * - Fail-safe returns false on any error\r\n   * - Configurable inactivity timeout from SECURITY_CONFIG\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Enforces automatic session timeout requirements\r\n   * - Implements defense-in-depth validation\r\n   * - Provides audit logging for session expiration\r\n   *\r\n   * @param {TokenMetadata} [metadata] - Optional metadata to validate (fetches current if not provided)\r\n   * @returns {boolean} True if token is valid, false otherwise\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Check token validity before sensitive operation\r\n   * if (secureTokenManager.isTokenValid()) {\r\n   *   await updatePatientRecord(data);\r\n   * } else {\r\n   *   showSessionExpiredModal();\r\n   * }\r\n   *\r\n   * // Validate specific metadata\r\n   * const metadata = getStoredMetadata();\r\n   * const isValid = secureTokenManager.isTokenValid(metadata);\r\n   * ```\r\n   *\r\n   * @see {@link SECURITY_CONFIG} for SESSION_TIMEOUT configuration\r\n   */\r\n  public isTokenValid(metadata?: TokenMetadata): boolean {\r\n    try {\r\n      const meta = metadata || this.getMetadata();\r\n      if (!meta) {\r\n        return false;\r\n      }\r\n\r\n      const now = Date.now();\r\n\r\n      // Check expiration\r\n      if (now >= meta.expiresAt) {\r\n        console.info('[SecureTokenManager] Token expired');\r\n        return false;\r\n      }\r\n\r\n      // Check inactivity timeout (8 hours from SECURITY_CONFIG)\r\n      const inactivityThreshold = meta.lastActivity + SECURITY_CONFIG.INACTIVITY_TIMEOUT;\r\n      if (now >= inactivityThreshold) {\r\n        console.info('[SecureTokenManager] Session timeout due to inactivity');\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to validate token:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get time remaining until token expiration.\r\n   *\r\n   * Calculates remaining time based on token's expiresAt timestamp.\r\n   * Useful for proactive token refresh and session expiration warnings.\r\n   *\r\n   * Use Cases:\r\n   * - Display countdown timers for session expiration\r\n   * - Trigger proactive token refresh before expiration\r\n   * - Schedule session timeout warnings\r\n   * - Monitor token lifetime for debugging\r\n   *\r\n   * @returns {number} Milliseconds until expiration, or 0 if expired/invalid\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const remaining = secureTokenManager.getTimeUntilExpiration();\r\n   *\r\n   * // Display minutes remaining\r\n   * const minutes = Math.floor(remaining / 60000);\r\n   * console.log(`Session expires in ${minutes} minutes`);\r\n   *\r\n   * // Refresh token if expiring soon (< 5 minutes)\r\n   * if (remaining < 5 * 60 * 1000 && remaining > 0) {\r\n   *   await refreshAccessToken();\r\n   * }\r\n   *\r\n   * // Show expiration warning\r\n   * if (remaining < 2 * 60 * 1000 && remaining > 0) {\r\n   *   showSessionExpirationWarning(remaining);\r\n   * }\r\n   * ```\r\n   */\r\n  public getTimeUntilExpiration(): number {\r\n    try {\r\n      const metadata = this.getMetadata();\r\n      if (!metadata) {\r\n        return 0;\r\n      }\r\n\r\n      const remaining = metadata.expiresAt - Date.now();\r\n      return remaining > 0 ? remaining : 0;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to get expiration time:', error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get time since last activity.\r\n   *\r\n   * Calculates elapsed time since last token access. Used for inactivity\r\n   * timeout monitoring and session timeout warnings.\r\n   *\r\n   * Activity Tracking:\r\n   * - Updated automatically on every getToken() call\r\n   * - Tracks user interaction with authenticated endpoints\r\n   * - Used to enforce 8-hour inactivity timeout\r\n   *\r\n   * Use Cases:\r\n   * - Display inactivity warnings to users\r\n   * - Monitor user session engagement\r\n   * - Debug session timeout issues\r\n   * - Implement custom inactivity logic\r\n   *\r\n   * @returns {number} Milliseconds since last activity, or 0 if no token\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const inactive = secureTokenManager.getTimeSinceActivity();\r\n   *\r\n   * // Display minutes of inactivity\r\n   * const minutes = Math.floor(inactive / 60000);\r\n   * console.log(`Inactive for ${minutes} minutes`);\r\n   *\r\n   * // Warn if inactive for 7.5 hours (close to 8-hour timeout)\r\n   * const WARNING_THRESHOLD = 7.5 * 60 * 60 * 1000;\r\n   * if (inactive > WARNING_THRESHOLD) {\r\n   *   showInactivityWarning();\r\n   * }\r\n   * ```\r\n   */\r\n  public getTimeSinceActivity(): number {\r\n    try {\r\n      const metadata = this.getMetadata();\r\n      if (!metadata) {\r\n        return 0;\r\n      }\r\n\r\n      return Date.now() - metadata.lastActivity;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to get activity time:', error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update last activity timestamp.\r\n   *\r\n   * Updates the lastActivity field in token metadata to current time.\r\n   * Called automatically by getToken() on each token retrieval. Can be\r\n   * called manually to extend session timeout after user interaction.\r\n   *\r\n   * Activity Tracking:\r\n   * - Automatically called on every authenticated API request\r\n   * - Resets the 8-hour inactivity timeout window\r\n   * - Prevents premature session expiration\r\n   *\r\n   * Security Features:\r\n   * - Implements sliding session timeout\r\n   * - Tracks genuine user activity\r\n   * - Prevents session hijacking by requiring active use\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Manually update activity after user interaction\r\n   * document.addEventListener('click', () => {\r\n   *   secureTokenManager.updateActivity();\r\n   * });\r\n   *\r\n   * // Update after custom user actions\r\n   * function onUserAction() {\r\n   *   secureTokenManager.updateActivity();\r\n   *   performAction();\r\n   * }\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * Most applications don't need to call this manually as getToken()\r\n   * automatically updates activity on each authenticated request.\r\n   */\r\n  public updateActivity(): void {\r\n    try {\r\n      const metadata = this.getMetadata();\r\n      if (!metadata) {\r\n        return;\r\n      }\r\n\r\n      metadata.lastActivity = Date.now();\r\n      sessionStorage.setItem(this.METADATA_KEY, JSON.stringify(metadata));\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to update activity:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all stored tokens and metadata.\r\n   *\r\n   * Removes all authentication tokens and metadata from sessionStorage,\r\n   * localStorage, and Zustand storage. Call this method on user logout,\r\n   * session expiration, or authentication errors.\r\n   *\r\n   * Cleared Storage:\r\n   * - sessionStorage: secure_auth_token, secure_refresh_token, secure_token_metadata\r\n   * - localStorage: auth-storage (Zustand), legacy tokens\r\n   *\r\n   * Security Features:\r\n   * - Complete removal of all authentication state\r\n   * - Prevents token reuse after logout\r\n   * - Clears both current and legacy storage locations\r\n   * - Implements secure logout best practices\r\n   *\r\n   * HIPAA Compliance:\r\n   * - Ensures complete session termination\r\n   * - Prevents unauthorized access after logout\r\n   * - Implements secure credential disposal\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Clear tokens on logout\r\n   * async function logout() {\r\n   *   await authApi.logout();\r\n   *   secureTokenManager.clearTokens();\r\n   *   redirectToLogin();\r\n   * }\r\n   *\r\n   * // Clear tokens on session expiration\r\n   * if (!secureTokenManager.isTokenValid()) {\r\n   *   secureTokenManager.clearTokens();\r\n   *   showSessionExpiredMessage();\r\n   * }\r\n   *\r\n   * // Clear tokens on authentication error\r\n   * apiClient.interceptors.response.use(\r\n   *   response => response,\r\n   *   error => {\r\n   *     if (error.response?.status === 401) {\r\n   *       secureTokenManager.clearTokens();\r\n   *       redirectToLogin();\r\n   *     }\r\n   *     return Promise.reject(error);\r\n   *   }\r\n   * );\r\n   * ```\r\n   */\r\n  public clearTokens(): void {\r\n    try {\r\n      sessionStorage.removeItem(this.TOKEN_KEY);\r\n      sessionStorage.removeItem(this.REFRESH_TOKEN_KEY);\r\n      sessionStorage.removeItem(this.METADATA_KEY);\r\n\r\n      // Clear Zustand storage\r\n      localStorage.removeItem(this.ZUSTAND_KEY);\r\n\r\n      // Clear legacy localStorage tokens if they exist\r\n      localStorage.removeItem(this.LEGACY_TOKEN_KEY);\r\n      localStorage.removeItem(this.LEGACY_REFRESH_KEY);\r\n\r\n      console.info('[SecureTokenManager] All tokens cleared');\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to clear tokens:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cleanup resources.\r\n   *\r\n   * Stops automatic cleanup interval and releases resources. Called\r\n   * automatically on window unload. Should be called manually only when\r\n   * destroying the token manager instance (rare in singleton pattern).\r\n   *\r\n   * Cleanup Actions:\r\n   * - Clears the 60-second token validation interval\r\n   * - Releases interval reference for garbage collection\r\n   * - Prevents memory leaks from orphaned timers\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Cleanup on component unmount (rare with singleton)\r\n   * useEffect(() => {\r\n   *   return () => {\r\n   *     secureTokenManager.cleanup();\r\n   *   };\r\n   * }, []);\r\n   *\r\n   * // Cleanup is automatic on window unload\r\n   * // Manual cleanup rarely needed due to singleton pattern\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * This method is automatically called on window 'beforeunload' event.\r\n   * Manual calls are rarely necessary except in testing scenarios.\r\n   */\r\n  public cleanup(): void {\r\n    if (this.cleanupInterval !== null) {\r\n      clearInterval(this.cleanupInterval);\r\n      this.cleanupInterval = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Parse JWT token to extract expiration time.\r\n   *\r\n   * Decodes JWT payload to extract 'exp' claim (expiration timestamp).\r\n   * Converts Unix timestamp (seconds) to JavaScript timestamp (milliseconds).\r\n   *\r\n   * JWT Structure:\r\n   * - Header: Algorithm and token type\r\n   * - Payload: Claims including exp (expiration)\r\n   * - Signature: Verification signature (not validated client-side)\r\n   *\r\n   * Security Note:\r\n   * - Client-side JWT parsing is for convenience only\r\n   * - Server MUST validate JWT signature and expiration\r\n   * - Never trust client-side expiration alone\r\n   * - This is defense-in-depth, not primary security\r\n   *\r\n   * @private\r\n   *\r\n   * @param {string} token - JWT token string (format: header.payload.signature)\r\n   * @returns {number | null} Expiration timestamp in milliseconds, or null if parsing fails\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // JWT token structure\r\n   * const token = 'eyJhbGc...payload...signature';\r\n   * const expiration = this.parseJwtExpiration(token);\r\n   * // Returns: 1735689600000 (timestamp in milliseconds)\r\n   * ```\r\n   */\r\n  private parseJwtExpiration(token: string): number | null {\r\n    try {\r\n      const parts = token.split('.');\r\n      if (parts.length !== 3) {\r\n        return null;\r\n      }\r\n\r\n      const payload = JSON.parse(atob(parts[1]));\r\n      if (payload.exp && typeof payload.exp === 'number') {\r\n        return payload.exp * 1000; // Convert seconds to milliseconds\r\n      }\r\n\r\n      return null;\r\n    } catch (error) {\r\n      console.warn('[SecureTokenManager] Failed to parse JWT expiration:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get stored token metadata from sessionStorage.\r\n   *\r\n   * Retrieves and parses token metadata JSON from sessionStorage.\r\n   * Returns null if metadata doesn't exist or parsing fails.\r\n   *\r\n   * @private\r\n   *\r\n   * @returns {TokenMetadata | null} Parsed token metadata or null\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const metadata = this.getMetadata();\r\n   * if (metadata) {\r\n   *   console.log('Token expires at:', new Date(metadata.expiresAt));\r\n   *   console.log('Last activity:', new Date(metadata.lastActivity));\r\n   * }\r\n   * ```\r\n   */\r\n  private getMetadata(): TokenMetadata | null {\r\n    // Check if we're in a browser environment\r\n    if (typeof window === 'undefined' || typeof sessionStorage === 'undefined') {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const metadataStr = sessionStorage.getItem(this.METADATA_KEY);\r\n      if (!metadataStr) {\r\n        return null;\r\n      }\r\n\r\n      return JSON.parse(metadataStr) as TokenMetadata;\r\n    } catch (error) {\r\n      console.error('[SecureTokenManager] Failed to parse metadata:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update Zustand auth storage for backward compatibility.\r\n   *\r\n   * Maintains synchronization with legacy Zustand-based authentication state\r\n   * in localStorage. Ensures existing code using Zustand store continues to\r\n   * function during migration to SecureTokenManager.\r\n   *\r\n   * Storage Format:\r\n   * - Key: 'auth-storage'\r\n   * - Location: localStorage (Zustand default)\r\n   * - Structure: { state: { token, user }, version }\r\n   *\r\n   * @private\r\n   *\r\n   * @param {string} token - JWT token to store in Zustand format\r\n   *\r\n   * @remarks\r\n   * This is a temporary compatibility layer. Future versions should migrate\r\n   * all code to use secureTokenManager directly and remove Zustand sync.\r\n   * Non-critical errors are logged but don't fail token storage.\r\n   */\r\n  private updateZustandStorage(token: string): void {\r\n    try {\r\n      const existingStorage = localStorage.getItem(this.ZUSTAND_KEY);\r\n      let storage: ZustandAuthStorage;\r\n\r\n      if (existingStorage) {\r\n        storage = JSON.parse(existingStorage) as ZustandAuthStorage;\r\n        storage.state.token = token;\r\n      } else {\r\n        storage = {\r\n          state: {\r\n            token,\r\n            user: null,\r\n          },\r\n          version: 0,\r\n        };\r\n      }\r\n\r\n      localStorage.setItem(this.ZUSTAND_KEY, JSON.stringify(storage));\r\n    } catch (error) {\r\n      console.warn('[SecureTokenManager] Failed to update Zustand storage:', error);\r\n      // Non-critical error, continue\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Singleton instance of SecureTokenManager\r\n * Use this throughout the application for token management\r\n *\r\n * @example\r\n * ```typescript\r\n * import { secureTokenManager } from '@/services/security/SecureTokenManager';\r\n *\r\n * // Store token\r\n * secureTokenManager.setToken(token, refreshToken);\r\n *\r\n * // Get token\r\n * const token = secureTokenManager.getToken();\r\n * ```\r\n */\r\nexport const secureTokenManager = SecureTokenManager.getInstance();\r\n\r\nexport default secureTokenManager;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2574, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/config/apiConfig.ts"],"sourcesContent":["/**\r\n * @fileoverview API Configuration and Axios Instance Factory\r\n * @module services/config/apiConfig\r\n * @category Services\r\n *\r\n * Provides centralized API configuration, Axios instance creation, and token management\r\n * utilities for the White Cross healthcare platform. Implements dependency injection\r\n * pattern to avoid circular dependencies while maintaining clean architecture.\r\n *\r\n * Key Features:\r\n * - Factory functions for creating configured Axios instances\r\n * - CSRF protection integration\r\n * - Token management utilities with ITokenManager interface\r\n * - Dependency injection to prevent circular dependencies\r\n * - Singleton instances for application-wide use\r\n *\r\n * Architecture Pattern:\r\n * This module uses factory functions (createApiInstance, createTokenUtils) that accept\r\n * dependencies as parameters, avoiding circular dependency issues while maintaining\r\n * testability and flexibility. Singleton instances are created at the bottom after\r\n * all imports are resolved.\r\n *\r\n * Security Features:\r\n * - CSRF protection automatically configured\r\n * - Secure token management integration\r\n * - withCredentials enabled for cookie-based auth\r\n * - Configurable timeout for request security\r\n *\r\n * Healthcare Compliance:\r\n * - HIPAA-compliant configuration\r\n * - Secure credential handling\r\n * - Audit-friendly request/response patterns\r\n * - PHI protection through secure transport\r\n *\r\n * @example\r\n * ```typescript\r\n * // Use singleton instance (most common)\r\n * import { apiInstance } from '@/services/config/apiConfig';\r\n *\r\n * const response = await apiInstance.get('/api/patients');\r\n * const patients = response.data;\r\n *\r\n * // Use token utilities\r\n * import { tokenUtils } from '@/services/config/apiConfig';\r\n *\r\n * const token = tokenUtils.getToken();\r\n * if (token) {\r\n *   // Token is valid\r\n * }\r\n *\r\n * // Create custom instance (advanced)\r\n * import { createApiInstance } from '@/services/config/apiConfig';\r\n * import { myCustomTokenManager } from './myTokenManager';\r\n *\r\n * const customInstance = createApiInstance(myCustomTokenManager);\r\n * ```\r\n *\r\n * @see {@link createApiInstance} for Axios instance creation\r\n * @see {@link createTokenUtils} for token utility creation\r\n * @see {@link ITokenManager} for token manager interface\r\n */\r\n\r\nimport axios, { AxiosInstance, AxiosResponse } from 'axios';\r\nimport { API_CONFIG } from '../../constants/config';\r\nimport {\r\n  API_ENDPOINTS,\r\n  HTTP_STATUS,\r\n} from '../../constants/api';\r\nimport type { ITokenManager } from '../core/interfaces/ITokenManager';\r\nimport { setupCsrfProtection } from '../security/CsrfProtection';\r\n\r\n/**\r\n * Factory function to create configured Axios instance with CSRF protection\r\n *\r\n * @param {ITokenManager} [tokenManager] - Optional token manager for authentication integration\r\n * @returns {AxiosInstance} Configured Axios instance ready for API requests\r\n *\r\n * @description\r\n * Creates an Axios instance with standard configuration for the healthcare platform API.\r\n * Uses dependency injection pattern to accept an optional token manager, avoiding\r\n * circular dependency issues while maintaining clean architecture.\r\n *\r\n * **Instance Configuration**:\r\n * - Base URL: Configured from API_CONFIG.BASE_URL\r\n * - Timeout: Configured from API_CONFIG.TIMEOUT\r\n * - Content-Type: application/json\r\n * - withCredentials: true (enables cookies for CSRF)\r\n * - CSRF Protection: Automatically configured via setupCsrfProtection\r\n *\r\n * **Dependency Injection Benefits**:\r\n * - Avoids circular dependencies with token manager\r\n * - Enables testing with mock token managers\r\n * - Supports multiple instances with different configurations\r\n * - Maintains separation of concerns\r\n *\r\n * **CSRF Protection**:\r\n * Automatically injects CSRF tokens into state-changing requests (POST, PUT, PATCH, DELETE)\r\n * via the setupCsrfProtection interceptor. Tokens are extracted from meta tags or cookies.\r\n *\r\n * **Security Features**:\r\n * - HTTPS-only in production (via BASE_URL)\r\n * - Request timeout prevents hanging requests\r\n * - withCredentials enables secure cookie handling\r\n * - CSRF protection against cross-site attacks\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create instance with default token manager\r\n * import { createApiInstance } from '@/services/config/apiConfig';\r\n * import { secureTokenManager } from '@/services/security';\r\n *\r\n * const apiClient = createApiInstance(secureTokenManager);\r\n *\r\n * // Make authenticated request\r\n * const response = await apiClient.get('/api/patients');\r\n *\r\n * // Create instance without token manager (public API)\r\n * const publicApiClient = createApiInstance();\r\n * const publicData = await publicApiClient.get('/api/public/info');\r\n *\r\n * // Create instance with custom token manager (testing)\r\n * const mockTokenManager = {\r\n *   getToken: () => 'mock-token',\r\n *   setToken: jest.fn(),\r\n *   clearTokens: jest.fn(),\r\n *   // ... other ITokenManager methods\r\n * };\r\n * const testClient = createApiInstance(mockTokenManager);\r\n * ```\r\n *\r\n * @see {@link setupCsrfProtection} for CSRF configuration\r\n * @see {@link ITokenManager} for token manager interface\r\n * @see {@link API_CONFIG} for base configuration\r\n */\r\nexport function createApiInstance(tokenManager?: ITokenManager): AxiosInstance {\r\n  const instance = axios.create({\r\n    baseURL: API_CONFIG.BASE_URL,\r\n    timeout: API_CONFIG.TIMEOUT,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    withCredentials: true,\r\n  });\r\n\r\n  // Setup CSRF protection for the instance\r\n  setupCsrfProtection(instance);\r\n\r\n  return instance;\r\n}\r\n\r\n/**\r\n * Factory function to create token utility functions wrapping a token manager\r\n *\r\n * @param {ITokenManager} tokenManager - Token manager instance to wrap with utility methods\r\n * @returns {TokenUtilityObject} Object with convenient token management methods\r\n *\r\n * @description\r\n * Creates a utility object that wraps an ITokenManager instance with convenient methods\r\n * for token operations. Provides a simplified API for common token management tasks\r\n * while maintaining compatibility with the underlying token manager interface.\r\n *\r\n * **Provided Utility Methods**:\r\n * - `getToken()`: Retrieve current access token\r\n * - `setToken(token, refreshToken?, expiresIn?)`: Store access and refresh tokens\r\n * - `removeToken()`: Clear all tokens\r\n * - `getRefreshToken()`: Retrieve current refresh token\r\n * - `setRefreshToken(token)`: Update only the refresh token\r\n * - `removeRefreshToken()`: Clear all tokens (same as removeToken)\r\n * - `clearAll()`: Clear all tokens (same as removeToken)\r\n * - `isTokenValid()`: Check if current token is valid\r\n * - `updateActivity()`: Update last activity timestamp\r\n *\r\n * **Dependency Injection Benefits**:\r\n * - Avoids circular dependencies\r\n * - Enables testing with mock token managers\r\n * - Supports multiple token utility instances\r\n * - Maintains clean separation of concerns\r\n *\r\n * **Use Cases**:\r\n * - Simplify token access in API interceptors\r\n * - Provide convenient token management in components\r\n * - Abstract token manager implementation details\r\n * - Enable easy token manager switching\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create token utilities with secure token manager\r\n * import { createTokenUtils } from '@/services/config/apiConfig';\r\n * import { secureTokenManager } from '@/services/security';\r\n *\r\n * const tokenUtils = createTokenUtils(secureTokenManager);\r\n *\r\n * // Store token after login\r\n * await login(credentials);\r\n * tokenUtils.setToken(accessToken, refreshToken);\r\n *\r\n * // Check token validity before operation\r\n * if (tokenUtils.isTokenValid()) {\r\n *   await performAuthenticatedOperation();\r\n * } else {\r\n *   redirectToLogin();\r\n * }\r\n *\r\n * // Get token for manual request\r\n * const token = tokenUtils.getToken();\r\n * if (token) {\r\n *   fetch('/api/endpoint', {\r\n *     headers: { Authorization: `Bearer ${token}` }\r\n *   });\r\n * }\r\n *\r\n * // Update only refresh token (after token refresh)\r\n * const newRefreshToken = await refreshAuthToken();\r\n * tokenUtils.setRefreshToken(newRefreshToken);\r\n *\r\n * // Clear tokens on logout\r\n * await logout();\r\n * tokenUtils.clearAll();\r\n *\r\n * // Create utilities with mock token manager (testing)\r\n * const mockTokenManager = {\r\n *   getToken: jest.fn().mockReturnValue('test-token'),\r\n *   setToken: jest.fn(),\r\n *   clearTokens: jest.fn(),\r\n *   isTokenValid: jest.fn().mockReturnValue(true),\r\n *   // ... other ITokenManager methods\r\n * };\r\n * const testTokenUtils = createTokenUtils(mockTokenManager);\r\n * ```\r\n *\r\n * @see {@link ITokenManager} for underlying token manager interface\r\n * @see {@link secureTokenManager} for default token manager implementation\r\n */\r\nexport function createTokenUtils(tokenManager: ITokenManager) {\r\n  return {\r\n    getToken: () => tokenManager.getToken(),\r\n    setToken: (token: string, refreshToken?: string, expiresIn?: number) =>\r\n      tokenManager.setToken(token, refreshToken, expiresIn),\r\n    removeToken: () => tokenManager.clearTokens(),\r\n    getRefreshToken: () => tokenManager.getRefreshToken(),\r\n    setRefreshToken: (token: string) => {\r\n      // Get current token and re-set with new refresh token\r\n      const currentToken = tokenManager.getToken();\r\n      if (currentToken) {\r\n        tokenManager.setToken(currentToken, token);\r\n      }\r\n    },\r\n    removeRefreshToken: () => tokenManager.clearTokens(),\r\n    clearAll: () => tokenManager.clearTokens(),\r\n    isTokenValid: () => tokenManager.isTokenValid(),\r\n    updateActivity: () => tokenManager.updateActivity(),\r\n  };\r\n}\r\n\r\n// Export API constants for use in other modules\r\nexport { API_ENDPOINTS, HTTP_STATUS };\r\n\r\n// Export API_CONFIG from constants\r\nexport { API_CONFIG } from '../../constants/config';\r\n\r\n// ==========================================\r\n// SINGLETON INSTANCES\r\n// ==========================================\r\n// Import secureTokenManager at bottom to avoid circular dependency\r\n// This follows the dependency injection pattern from ApiClient.ts\r\nimport { secureTokenManager } from '../security/SecureTokenManager';\r\n\r\n/**\r\n * Default Axios instance for application-wide API requests\r\n *\r\n * @type {AxiosInstance}\r\n *\r\n * @description\r\n * Singleton Axios instance configured with CSRF protection and secure token management.\r\n * This is the primary API client used throughout the application for making authenticated\r\n * requests to the backend API.\r\n *\r\n * **Configuration**:\r\n * - Base URL: From API_CONFIG.BASE_URL environment variable\r\n * - Timeout: From API_CONFIG.TIMEOUT configuration\r\n * - CSRF Protection: Automatically enabled\r\n * - Token Management: Integrated with secureTokenManager\r\n * - Credentials: Enabled for cookie-based authentication\r\n *\r\n * **Interceptors**:\r\n * - Request: CSRF token injection for state-changing methods\r\n * - Token management handled by secureTokenManager integration\r\n *\r\n * **Security Features**:\r\n * - HIPAA-compliant token handling via secureTokenManager\r\n * - CSRF protection against cross-site attacks\r\n * - Secure credential management\r\n * - Automatic session timeout enforcement\r\n *\r\n * @example\r\n * ```typescript\r\n * import { apiInstance } from '@/services/config/apiConfig';\r\n *\r\n * // GET request\r\n * const patients = await apiInstance.get('/api/patients');\r\n *\r\n * // POST request (CSRF token auto-injected)\r\n * const newPatient = await apiInstance.post('/api/patients', patientData);\r\n *\r\n * // PUT request with params\r\n * const updated = await apiInstance.put(`/api/patients/${id}`, updates);\r\n *\r\n * // DELETE request\r\n * await apiInstance.delete(`/api/patients/${id}`);\r\n *\r\n * // Request with custom headers\r\n * const data = await apiInstance.get('/api/data', {\r\n *   headers: { 'X-Custom-Header': 'value' }\r\n * });\r\n * ```\r\n *\r\n * @see {@link createApiInstance} for instance creation logic\r\n * @see {@link secureTokenManager} for token management\r\n */\r\nexport const apiInstance: AxiosInstance = createApiInstance(secureTokenManager);\r\n\r\n/**\r\n * Default token utility functions for application-wide token management\r\n *\r\n * @type {TokenUtilityObject}\r\n *\r\n * @description\r\n * Singleton token utility object that wraps the secureTokenManager with convenient\r\n * methods for token operations. This is the primary interface for token management\r\n * throughout the application.\r\n *\r\n * **Available Methods**:\r\n * - `getToken()`: Get current access token\r\n * - `setToken(token, refreshToken?, expiresIn?)`: Store tokens\r\n * - `removeToken()`: Clear all tokens\r\n * - `getRefreshToken()`: Get current refresh token\r\n * - `setRefreshToken(token)`: Update refresh token\r\n * - `clearAll()`: Clear all tokens\r\n * - `isTokenValid()`: Check token validity\r\n * - `updateActivity()`: Update activity timestamp\r\n *\r\n * **Security Features**:\r\n * - HIPAA-compliant token storage via secureTokenManager\r\n * - Automatic token expiration checking\r\n * - Session timeout enforcement (8 hours inactivity)\r\n * - Secure token lifecycle management\r\n *\r\n * @example\r\n * ```typescript\r\n * import { tokenUtils } from '@/services/config/apiConfig';\r\n *\r\n * // After login\r\n * const { accessToken, refreshToken } = await authApi.login(credentials);\r\n * tokenUtils.setToken(accessToken, refreshToken);\r\n *\r\n * // Before authenticated operation\r\n * if (!tokenUtils.isTokenValid()) {\r\n *   redirectToLogin();\r\n *   return;\r\n * }\r\n *\r\n * // Get token for manual request\r\n * const token = tokenUtils.getToken();\r\n * if (token) {\r\n *   // Use token\r\n * }\r\n *\r\n * // Update activity on user interaction\r\n * tokenUtils.updateActivity();\r\n *\r\n * // On logout\r\n * await authApi.logout();\r\n * tokenUtils.clearAll();\r\n * ```\r\n *\r\n * @see {@link createTokenUtils} for utility creation logic\r\n * @see {@link secureTokenManager} for underlying token manager\r\n */\r\nexport const tokenUtils = createTokenUtils(secureTokenManager);\r\n\r\n/**\r\n * Default export of apiInstance for backward compatibility\r\n *\r\n * @type {AxiosInstance}\r\n *\r\n * @description\r\n * Default export of the singleton apiInstance for modules that use default import syntax.\r\n * Prefer named imports (import { apiInstance }) for better IDE support and explicit naming.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Default import (backward compatibility)\r\n * import apiClient from '@/services/config/apiConfig';\r\n * const data = await apiClient.get('/api/endpoint');\r\n *\r\n * // Named import (preferred)\r\n * import { apiInstance } from '@/services/config/apiConfig';\r\n * const data = await apiInstance.get('/api/endpoint');\r\n * ```\r\n *\r\n * @see {@link apiInstance} for full documentation\r\n */\r\nexport default apiInstance;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA4DC;;;;;;;;;;;;AAED;AACA;AACA;AAKA;AA+LA,6CAA6C;AAC7C,sBAAsB;AACtB,6CAA6C;AAC7C,mEAAmE;AACnE,kEAAkE;AAClE;;;;;AAnIO,SAAS,kBAAkB,YAA4B;IAC5D,MAAM,WAAW,gJAAK,CAAC,MAAM,CAAC;QAC5B,SAAS,wIAAU,CAAC,QAAQ;QAC5B,SAAS,wIAAU,CAAC,OAAO;QAC3B,SAAS;YACP,gBAAgB;QAClB;QACA,iBAAiB;IACnB;IAEA,yCAAyC;IACzC,IAAA,oKAAmB,EAAC;IAEpB,OAAO;AACT;AAqFO,SAAS,iBAAiB,YAA2B;IAC1D,OAAO;QACL,UAAU,IAAM,aAAa,QAAQ;QACrC,UAAU,CAAC,OAAe,cAAuB,YAC/C,aAAa,QAAQ,CAAC,OAAO,cAAc;QAC7C,aAAa,IAAM,aAAa,WAAW;QAC3C,iBAAiB,IAAM,aAAa,eAAe;QACnD,iBAAiB,CAAC;YAChB,sDAAsD;YACtD,MAAM,eAAe,aAAa,QAAQ;YAC1C,IAAI,cAAc;gBAChB,aAAa,QAAQ,CAAC,cAAc;YACtC;QACF;QACA,oBAAoB,IAAM,aAAa,WAAW;QAClD,UAAU,IAAM,aAAa,WAAW;QACxC,cAAc,IAAM,aAAa,YAAY;QAC7C,gBAAgB,IAAM,aAAa,cAAc;IACnD;AACF;;;;AAmEO,MAAM,cAA6B,kBAAkB,uKAAkB;AA2DvE,MAAM,aAAa,iBAAiB,uKAAkB;uCAwB9C","debugId":null}},
    {"offset": {"line": 2702, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/errors.ts"],"sourcesContent":["/**\r\n * WF-COMP-ERROR | errors.ts - Centralized Error Handling\r\n * Purpose: Type-safe error classes and utilities for API error handling\r\n * Upstream: axios, API responses | Dependencies: None\r\n * Downstream: All API services, error boundaries | Called by: Service modules\r\n * Related: typeGuards.ts, ApiClient.ts, error boundaries\r\n * Exports: ApiError, ValidationError, NetworkError, error factories\r\n * Last Updated: 2025-10-23 | File Type: .ts\r\n * Critical Path: Error occurs â†’ Type guard â†’ Create typed error â†’ Propagate with context\r\n * LLM Context: HIPAA-compliant error handling, preserves debugging context, sanitizes sensitive data\r\n */\r\n\r\n/**\r\n * Base API Error Class\r\n *\r\n * Provides consistent error handling across all API services with:\r\n * - Original error preservation for debugging\r\n * - HTTP status code tracking\r\n * - Error code categorization\r\n * - Timestamp for logging/audit\r\n * - HIPAA-compliant message sanitization\r\n */\r\nexport class ApiError extends Error {\r\n  public readonly name = 'ApiError';\r\n  public readonly timestamp: Date;\r\n  public readonly originalError?: Error;\r\n  public readonly statusCode?: number;\r\n  public readonly code?: string;\r\n\r\n  constructor(\r\n    message: string,\r\n    originalError?: Error,\r\n    statusCode?: number,\r\n    code?: string\r\n  ) {\r\n    super(message);\r\n\r\n    // Maintain proper prototype chain\r\n    Object.setPrototypeOf(this, ApiError.prototype);\r\n\r\n    this.timestamp = new Date();\r\n    this.originalError = originalError;\r\n    this.statusCode = statusCode;\r\n    this.code = code;\r\n\r\n    // Capture stack trace, excluding constructor call\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, ApiError);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get sanitized error message (HIPAA-compliant)\r\n   * Removes potential PHI/PII from error messages\r\n   */\r\n  getSanitizedMessage(): string {\r\n    return sanitizeErrorMessage(this.message);\r\n  }\r\n\r\n  /**\r\n   * Serialize error for logging/monitoring\r\n   * Excludes originalError to prevent circular references\r\n   */\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      statusCode: this.statusCode,\r\n      code: this.code,\r\n      timestamp: this.timestamp.toISOString(),\r\n      stack: this.stack\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Validation Error\r\n * Used for data validation failures (Zod, form validation, etc.)\r\n */\r\nexport class ValidationError extends ApiError {\r\n  public readonly name = 'ValidationError';\r\n  public readonly field?: string;\r\n  public readonly validationErrors?: Record<string, string[]>;\r\n\r\n  constructor(\r\n    message: string,\r\n    field?: string,\r\n    validationErrors?: Record<string, string[]>,\r\n    originalError?: Error\r\n  ) {\r\n    super(message, originalError, 400, 'VALIDATION_ERROR');\r\n    Object.setPrototypeOf(this, ValidationError.prototype);\r\n\r\n    this.field = field;\r\n    this.validationErrors = validationErrors;\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      ...super.toJSON(),\r\n      field: this.field,\r\n      validationErrors: this.validationErrors\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Network Error\r\n * Used for network-level failures (timeout, connection refused, etc.)\r\n */\r\nexport class NetworkError extends ApiError {\r\n  public readonly name = 'NetworkError';\r\n  public readonly timeout?: number;\r\n  public readonly retryable: boolean;\r\n\r\n  constructor(\r\n    message: string,\r\n    originalError?: Error,\r\n    timeout?: number,\r\n    retryable: boolean = true\r\n  ) {\r\n    super(message, originalError, undefined, 'NETWORK_ERROR');\r\n    Object.setPrototypeOf(this, NetworkError.prototype);\r\n\r\n    this.timeout = timeout;\r\n    this.retryable = retryable;\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      ...super.toJSON(),\r\n      timeout: this.timeout,\r\n      retryable: this.retryable\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Authentication Error\r\n * Used for authentication and authorization failures\r\n */\r\nexport class AuthenticationError extends ApiError {\r\n  public readonly name = 'AuthenticationError';\r\n  public readonly requiresReauthentication: boolean;\r\n\r\n  constructor(\r\n    message: string,\r\n    statusCode: number = 401,\r\n    requiresReauthentication: boolean = true,\r\n    originalError?: Error\r\n  ) {\r\n    super(message, originalError, statusCode, 'AUTH_ERROR');\r\n    Object.setPrototypeOf(this, AuthenticationError.prototype);\r\n\r\n    this.requiresReauthentication = requiresReauthentication;\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      ...super.toJSON(),\r\n      requiresReauthentication: this.requiresReauthentication\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Error Factory Functions\r\n * Consistent error creation with proper typing\r\n */\r\n\r\n/**\r\n * Create API error from axios error or generic error\r\n */\r\nexport function createApiError(\r\n  error: unknown,\r\n  fallbackMessage: string = 'An error occurred'\r\n): ApiError {\r\n  // Handle axios errors\r\n  if (isAxiosError(error)) {\r\n    const message = error.response?.data?.message || error.message || fallbackMessage;\r\n    const statusCode = error.response?.status;\r\n    const code = error.code;\r\n\r\n    return new ApiError(message, error, statusCode, code);\r\n  }\r\n\r\n  // Handle existing ApiError instances\r\n  if (error instanceof ApiError) {\r\n    return error;\r\n  }\r\n\r\n  // Handle generic Error instances\r\n  if (error instanceof Error) {\r\n    return new ApiError(error.message || fallbackMessage, error);\r\n  }\r\n\r\n  // Handle unknown error types\r\n  return new ApiError(fallbackMessage);\r\n}\r\n\r\n/**\r\n * Create validation error from Zod or other validation failures\r\n */\r\nexport function createValidationError(\r\n  message: string,\r\n  field?: string,\r\n  validationErrors?: Record<string, string[]>,\r\n  originalError?: Error\r\n): ValidationError {\r\n  return new ValidationError(message, field, validationErrors, originalError);\r\n}\r\n\r\n/**\r\n * Create network error from connection failures\r\n */\r\nexport function createNetworkError(\r\n  message: string,\r\n  originalError?: Error,\r\n  timeout?: number,\r\n  retryable: boolean = true\r\n): NetworkError {\r\n  return new NetworkError(message, originalError, timeout, retryable);\r\n}\r\n\r\n/**\r\n * Create authentication error\r\n */\r\nexport function createAuthenticationError(\r\n  message: string,\r\n  statusCode: number = 401,\r\n  requiresReauthentication: boolean = true,\r\n  originalError?: Error\r\n): AuthenticationError {\r\n  return new AuthenticationError(message, statusCode, requiresReauthentication, originalError);\r\n}\r\n\r\n/**\r\n * Type guard for axios errors\r\n * Import axios type guard or implement if not available\r\n */\r\nfunction isAxiosError(error: unknown): error is {\r\n  response?: {\r\n    data?: { message?: string };\r\n    status?: number\r\n  };\r\n  message?: string;\r\n  code?: string\r\n} {\r\n  return (\r\n    typeof error === 'object' &&\r\n    error !== null &&\r\n    ('response' in error || 'message' in error || 'code' in error)\r\n  );\r\n}\r\n\r\n/**\r\n * Sanitize error message to remove potential PHI/PII\r\n * HIPAA Compliance: Remove common patterns that might expose sensitive data\r\n */\r\nfunction sanitizeErrorMessage(message: string): string {\r\n  if (!message) return 'An error occurred';\r\n\r\n  let sanitized = message;\r\n\r\n  // Remove email addresses\r\n  sanitized = sanitized.replace(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/g, '[email]');\r\n\r\n  // Remove phone numbers (various formats)\r\n  sanitized = sanitized.replace(/\\b\\d{3}[-.]?\\d{3}[-.]?\\d{4}\\b/g, '[phone]');\r\n\r\n  // Remove SSN patterns\r\n  sanitized = sanitized.replace(/\\b\\d{3}-\\d{2}-\\d{4}\\b/g, '[ssn]');\r\n\r\n  // Remove medical record numbers (assuming format like MRN-######)\r\n  sanitized = sanitized.replace(/\\b[A-Z]{2,4}-?\\d{6,}\\b/g, '[record-id]');\r\n\r\n  // Remove dates of birth (various formats)\r\n  sanitized = sanitized.replace(/\\b\\d{1,2}\\/\\d{1,2}\\/\\d{4}\\b/g, '[date]');\r\n\r\n  // Remove potential names (capitalized words that might be names)\r\n  // Note: This is conservative and may not catch all cases\r\n  // In production, consider more sophisticated NER/PII detection\r\n\r\n  return sanitized;\r\n}\r\n\r\n/**\r\n * Check if error should be retried\r\n * Used by resilience patterns (circuit breaker, retry logic)\r\n */\r\nexport function isRetryableError(error: unknown): boolean {\r\n  if (error instanceof NetworkError) {\r\n    return error.retryable;\r\n  }\r\n\r\n  if (error instanceof ApiError) {\r\n    // Retry on server errors (5xx) and some client errors\r\n    const retryableStatuses = [408, 429, 500, 502, 503, 504];\r\n    return error.statusCode ? retryableStatuses.includes(error.statusCode) : false;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Get user-friendly error message\r\n * Provides appropriate messages for different error types\r\n */\r\nexport function getUserFriendlyMessage(error: unknown): string {\r\n  if (error instanceof ValidationError) {\r\n    return error.field\r\n      ? `Invalid ${error.field}: ${error.message}`\r\n      : `Validation error: ${error.message}`;\r\n  }\r\n\r\n  if (error instanceof AuthenticationError) {\r\n    return error.requiresReauthentication\r\n      ? 'Your session has expired. Please log in again.'\r\n      : 'You do not have permission to perform this action.';\r\n  }\r\n\r\n  if (error instanceof NetworkError) {\r\n    return 'Network error. Please check your connection and try again.';\r\n  }\r\n\r\n  if (error instanceof ApiError) {\r\n    // Use sanitized message for user display\r\n    return error.getSanitizedMessage();\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    return error.message || 'An unexpected error occurred.';\r\n  }\r\n\r\n  return 'An unexpected error occurred.';\r\n}\r\n\r\n/**\r\n * Error logging helper\r\n * Provides structured error information for logging services\r\n */\r\nexport function getErrorLogData(error: unknown): Record<string, unknown> {\r\n  if (error instanceof ApiError) {\r\n    return error.toJSON();\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    return {\r\n      name: error.name,\r\n      message: error.message,\r\n      stack: error.stack\r\n    };\r\n  }\r\n\r\n  return {\r\n    error: String(error)\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2946, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/ApiClient.errors.ts"],"sourcesContent":["/**\r\n * @fileoverview Error handling for API Client\r\n * @module services/core/ApiClient.errors\r\n * @category Services\r\n *\r\n * Provides comprehensive error classification and normalization for API operations:\r\n * - Custom error class with automatic classification\r\n * - Network error detection\r\n * - Server error identification (5xx)\r\n * - Validation error handling (400)\r\n * - Error normalization from various sources\r\n */\r\n\r\nimport axios, { AxiosError } from 'axios';\r\nimport type { ApiErrorResponse } from './ApiClient.types';\r\n\r\n// ==========================================\r\n// ERROR CLASS\r\n// ==========================================\r\n\r\n/**\r\n * Custom error class for API client errors with error classification\r\n *\r\n * @class\r\n * @extends Error\r\n * @classdesc Wraps API errors with additional metadata and automatic classification\r\n * for easier error handling in application code.\r\n *\r\n * Error Types:\r\n * - isNetworkError: No response from server (connection failed, timeout, etc.)\r\n * - isServerError: Server returned 5xx status code\r\n * - isValidationError: Client error with validation details (400 status)\r\n *\r\n * @example\r\n * ```typescript\r\n * try {\r\n *   await apiClient.post('/endpoint', data);\r\n * } catch (error) {\r\n *   if (error instanceof ApiClientError) {\r\n *     if (error.isNetworkError) {\r\n *       showToast('Network error. Please check your connection.');\r\n *     } else if (error.isValidationError) {\r\n *       displayValidationErrors(error.details);\r\n *     } else if (error.isServerError) {\r\n *       showToast('Server error. Please try again later.');\r\n *       logToMonitoring(error.traceId);\r\n *     }\r\n *   }\r\n * }\r\n * ```\r\n */\r\nexport class ApiClientError extends Error {\r\n  public readonly code?: string;\r\n  public readonly status?: number;\r\n  public readonly details?: unknown;\r\n  public readonly traceId?: string;\r\n  public readonly isNetworkError: boolean;\r\n  public readonly isServerError: boolean;\r\n  public readonly isValidationError: boolean;\r\n\r\n  constructor(error: ApiErrorResponse) {\r\n    super(error.message);\r\n    this.name = 'ApiClientError';\r\n    this.code = error.code;\r\n    this.status = error.status;\r\n    this.details = error.details;\r\n    this.traceId = error.traceId;\r\n\r\n    // Classify error types\r\n    this.isNetworkError = error.code === 'NETWORK_ERROR';\r\n    this.isServerError = (error.status ?? 0) >= 500;\r\n    this.isValidationError = error.status === 400;\r\n\r\n    // Maintain proper stack trace\r\n    if (typeof Error.captureStackTrace === 'function') {\r\n      Error.captureStackTrace(this, ApiClientError);\r\n    }\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// ERROR NORMALIZATION\r\n// ==========================================\r\n\r\n/**\r\n * Normalize errors from various sources into ApiClientError\r\n *\r\n * Handles:\r\n * - Axios errors (with response, without response)\r\n * - Network errors\r\n * - Unknown errors\r\n * - Already normalized ApiClientError\r\n *\r\n * @param error - Error from any source\r\n * @returns Normalized ApiClientError with classification\r\n *\r\n * @example\r\n * ```typescript\r\n * try {\r\n *   await axios.get('/api/data');\r\n * } catch (error) {\r\n *   const normalizedError = normalizeError(error);\r\n *   if (normalizedError.isNetworkError) {\r\n *     // Handle network error\r\n *   }\r\n * }\r\n * ```\r\n */\r\nexport function normalizeError(error: unknown): ApiClientError {\r\n  // Already normalized\r\n  if (error instanceof ApiClientError) {\r\n    return error;\r\n  }\r\n\r\n  // Axios error\r\n  if (axios.isAxiosError(error)) {\r\n    const axiosError = error as AxiosError<{ message?: string; code?: string; errors?: unknown }>;\r\n\r\n    if (axiosError.response) {\r\n      // Server responded with error\r\n      return new ApiClientError({\r\n        message: axiosError.response.data?.message || `Request failed with status ${axiosError.response.status}`,\r\n        code: axiosError.response.data?.code,\r\n        status: axiosError.response.status,\r\n        details: axiosError.response.data?.errors,\r\n      });\r\n    } else if (axiosError.request) {\r\n      // Network error - no response received\r\n      return new ApiClientError({\r\n        message: 'Network error - please check your connection',\r\n        code: 'NETWORK_ERROR',\r\n      });\r\n    }\r\n  }\r\n\r\n  // Unknown error\r\n  return new ApiClientError({\r\n    message: error instanceof Error ? error.message : 'An unexpected error occurred',\r\n    code: 'UNKNOWN_ERROR',\r\n  });\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;CAWC;;;;;;AAED;;AAsCO,MAAM,uBAAuB;IAClB,KAAc;IACd,OAAgB;IAChB,QAAkB;IAClB,QAAiB;IACjB,eAAwB;IACxB,cAAuB;IACvB,kBAA2B;IAE3C,YAAY,KAAuB,CAAE;QACnC,KAAK,CAAC,MAAM,OAAO;QACnB,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;QACtB,IAAI,CAAC,MAAM,GAAG,MAAM,MAAM;QAC1B,IAAI,CAAC,OAAO,GAAG,MAAM,OAAO;QAC5B,IAAI,CAAC,OAAO,GAAG,MAAM,OAAO;QAE5B,uBAAuB;QACvB,IAAI,CAAC,cAAc,GAAG,MAAM,IAAI,KAAK;QACrC,IAAI,CAAC,aAAa,GAAG,CAAC,MAAM,MAAM,IAAI,CAAC,KAAK;QAC5C,IAAI,CAAC,iBAAiB,GAAG,MAAM,MAAM,KAAK;QAE1C,8BAA8B;QAC9B,IAAI,OAAO,MAAM,iBAAiB,KAAK,YAAY;YACjD,MAAM,iBAAiB,CAAC,IAAI,EAAE;QAChC;IACF;AACF;AA8BO,SAAS,eAAe,KAAc;IAC3C,qBAAqB;IACrB,IAAI,iBAAiB,gBAAgB;QACnC,OAAO;IACT;IAEA,cAAc;IACd,IAAI,gJAAK,CAAC,YAAY,CAAC,QAAQ;QAC7B,MAAM,aAAa;QAEnB,IAAI,WAAW,QAAQ,EAAE;YACvB,8BAA8B;YAC9B,OAAO,IAAI,eAAe;gBACxB,SAAS,WAAW,QAAQ,CAAC,IAAI,EAAE,WAAW,CAAC,2BAA2B,EAAE,WAAW,QAAQ,CAAC,MAAM,EAAE;gBACxG,MAAM,WAAW,QAAQ,CAAC,IAAI,EAAE;gBAChC,QAAQ,WAAW,QAAQ,CAAC,MAAM;gBAClC,SAAS,WAAW,QAAQ,CAAC,IAAI,EAAE;YACrC;QACF,OAAO,IAAI,WAAW,OAAO,EAAE;YAC7B,uCAAuC;YACvC,OAAO,IAAI,eAAe;gBACxB,SAAS;gBACT,MAAM;YACR;QACF;IACF;IAEA,gBAAgB;IAChB,OAAO,IAAI,eAAe;QACxB,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 3024, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/utils/logger.ts"],"sourcesContent":["/**\r\n * Structured logging service for the White Cross Healthcare Platform\r\n *\r\n * Provides consistent, level-based logging with context support.\r\n * Automatically respects environment (development vs production).\r\n *\r\n * @module services/utils/logger\r\n * @security HIPAA Compliance - Ensure no PHI/PII is logged in production\r\n */\r\n\r\n/**\r\n * Available log levels in order of severity\r\n */\r\nexport enum LogLevel {\r\n  DEBUG = 'debug',\r\n  INFO = 'info',\r\n  WARN = 'warn',\r\n  ERROR = 'error',\r\n}\r\n\r\n/**\r\n * Logger interface defining the contract for logging operations\r\n */\r\nexport interface Logger {\r\n  /**\r\n   * Log debug information (development only)\r\n   * @param message - The message to log\r\n   * @param context - Optional context object with additional data\r\n   */\r\n  debug(message: string, context?: Record<string, unknown>): void;\r\n\r\n  /**\r\n   * Log informational messages\r\n   * @param message - The message to log\r\n   * @param context - Optional context object with additional data\r\n   */\r\n  info(message: string, context?: Record<string, unknown>): void;\r\n\r\n  /**\r\n   * Log warning messages\r\n   * @param message - The message to log\r\n   * @param context - Optional context object with additional data\r\n   */\r\n  warn(message: string, context?: Record<string, unknown>): void;\r\n\r\n  /**\r\n   * Log error messages\r\n   * @param message - The message to log\r\n   * @param error - Optional Error object\r\n   * @param context - Optional context object with additional data\r\n   */\r\n  error(message: string, error?: Error, context?: Record<string, unknown>): void;\r\n}\r\n\r\n/**\r\n * Console-based logger implementation with level filtering\r\n */\r\nclass ConsoleLogger implements Logger {\r\n  private readonly minLevel: LogLevel;\r\n  private readonly levelOrder: LogLevel[] = [\r\n    LogLevel.DEBUG,\r\n    LogLevel.INFO,\r\n    LogLevel.WARN,\r\n    LogLevel.ERROR,\r\n  ];\r\n\r\n  constructor(minLevel: LogLevel = LogLevel.INFO) {\r\n    this.minLevel = minLevel;\r\n  }\r\n\r\n  debug(message: string, context?: Record<string, unknown>): void {\r\n    if (this.shouldLog(LogLevel.DEBUG)) {\r\n      const timestamp = new Date().toISOString();\r\n      if (context && Object.keys(context).length > 0) {\r\n        console.debug(`[${timestamp}] [DEBUG] ${message}`, context);\r\n      } else {\r\n        console.debug(`[${timestamp}] [DEBUG] ${message}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  info(message: string, context?: Record<string, unknown>): void {\r\n    if (this.shouldLog(LogLevel.INFO)) {\r\n      const timestamp = new Date().toISOString();\r\n      if (context && Object.keys(context).length > 0) {\r\n        console.info(`[${timestamp}] [INFO] ${message}`, context);\r\n      } else {\r\n        console.info(`[${timestamp}] [INFO] ${message}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  warn(message: string, context?: Record<string, unknown>): void {\r\n    if (this.shouldLog(LogLevel.WARN)) {\r\n      const timestamp = new Date().toISOString();\r\n      if (context && Object.keys(context).length > 0) {\r\n        console.warn(`[${timestamp}] [WARN] ${message}`, context);\r\n      } else {\r\n        console.warn(`[${timestamp}] [WARN] ${message}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  error(message: string, error?: Error, context?: Record<string, unknown>): void {\r\n    if (this.shouldLog(LogLevel.ERROR)) {\r\n      const timestamp = new Date().toISOString();\r\n      const errorInfo: Record<string, unknown> = {\r\n        ...(context || {}),\r\n      };\r\n\r\n      if (error) {\r\n        errorInfo.error = {\r\n          message: error.message,\r\n          stack: error.stack,\r\n          name: error.name,\r\n        };\r\n      }\r\n\r\n      if (Object.keys(errorInfo).length > 0) {\r\n        console.error(`[${timestamp}] [ERROR] ${message}`, errorInfo);\r\n      } else {\r\n        console.error(`[${timestamp}] [ERROR] ${message}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Determines if a message at the given level should be logged\r\n   */\r\n  private shouldLog(level: LogLevel): boolean {\r\n    const currentLevelIndex = this.levelOrder.indexOf(this.minLevel);\r\n    const messageLevelIndex = this.levelOrder.indexOf(level);\r\n    return messageLevelIndex >= currentLevelIndex;\r\n  }\r\n}\r\n\r\n/**\r\n * Determine the appropriate log level based on environment\r\n */\r\nfunction getLogLevel(): LogLevel {\r\n  const env = process.env.NODE_ENV;\r\n\r\n  // In development, show all logs including debug\r\n  if (env === 'development') {\r\n    return LogLevel.DEBUG;\r\n  }\r\n\r\n  // In test, only show warnings and errors\r\n  if (env === 'test') {\r\n    return LogLevel.WARN;\r\n  }\r\n\r\n  // In production, only show info and above (no debug)\r\n  return LogLevel.INFO;\r\n}\r\n\r\n/**\r\n * Singleton logger instance configured based on environment\r\n *\r\n * @example\r\n * ```typescript\r\n * import { logger } from '@/services/utils/logger';\r\n *\r\n * // Simple logging\r\n * logger.info('User logged in successfully');\r\n *\r\n * // With context\r\n * logger.debug('API request started', { url: '/api/students', method: 'GET' });\r\n *\r\n * // Error logging\r\n * try {\r\n *   // ... some operation\r\n * } catch (error) {\r\n *   logger.error('Failed to fetch students', error as Error, { userId: '123' });\r\n * }\r\n * ```\r\n */\r\nexport const logger: Logger = new ConsoleLogger(getLogLevel());\r\n\r\n/**\r\n * Create a logger with a specific context prefix\r\n * Useful for scoping logs to specific modules or services\r\n *\r\n * @param prefix - The prefix to prepend to all messages\r\n * @returns Logger instance with prefixed messages\r\n *\r\n * @example\r\n * ```typescript\r\n * const serviceLogger = createLogger('MedicationService');\r\n * serviceLogger.info('Fetching medications'); // Logs: [INFO] [MedicationService] Fetching medications\r\n * ```\r\n */\r\nexport function createLogger(prefix: string): Logger {\r\n  return {\r\n    debug: (message: string, context?: Record<string, unknown>) =>\r\n      logger.debug(`[${prefix}] ${message}`, context),\r\n    info: (message: string, context?: Record<string, unknown>) =>\r\n      logger.info(`[${prefix}] ${message}`, context),\r\n    warn: (message: string, context?: Record<string, unknown>) =>\r\n      logger.warn(`[${prefix}] ${message}`, context),\r\n    error: (message: string, error?: Error, context?: Record<string, unknown>) =>\r\n      logger.error(`[${prefix}] ${message}`, error, context),\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3144, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/ApiClient.interceptors.ts"],"sourcesContent":["/**\r\n * @fileoverview Interceptor setup and management for API Client\r\n * @module services/core/ApiClient.interceptors\r\n * @category Services\r\n *\r\n * Provides interceptor creation and configuration for API client:\r\n * - Request interceptors for authentication and headers\r\n * - Response interceptors for error handling and retry logic\r\n * - Token refresh handling\r\n * - Automatic retry with exponential backoff\r\n */\r\n\r\nimport type { AxiosInstance, AxiosRequestConfig, AxiosError, InternalAxiosRequestConfig } from 'axios';\r\nimport type { ITokenManager } from './interfaces/ITokenManager';\r\nimport { normalizeError } from './ApiClient.errors';\r\nimport { logger } from '../utils/logger';\r\nimport { HTTP_STATUS } from '../../constants/api';\r\n\r\n// ==========================================\r\n// REQUEST INTERCEPTOR\r\n// ==========================================\r\n\r\n/**\r\n * Create request interceptor for authentication and security headers\r\n *\r\n * Adds:\r\n * - Authorization header with Bearer token\r\n * - Security headers for HIPAA compliance\r\n * - Request ID for tracing\r\n * - Token validation before use\r\n *\r\n * @param tokenManager - Token manager instance\r\n * @param enableLogging - Enable request logging\r\n * @returns Interceptor ID for later removal\r\n */\r\nexport function createAuthRequestInterceptor(\r\n  instance: AxiosInstance,\r\n  tokenManager: ITokenManager | undefined,\r\n  enableLogging: boolean\r\n): number {\r\n  return instance.interceptors.request.use(\r\n    (config: InternalAxiosRequestConfig) => {\r\n      // Get token from token manager\r\n      const token = tokenManager?.getToken();\r\n      if (token) {\r\n        // Validate token before using it\r\n        if (tokenManager?.isTokenValid()) {\r\n          config.headers = config.headers || {};\r\n          config.headers.Authorization = `Bearer ${token}`;\r\n          // Update activity on token use\r\n          tokenManager.updateActivity();\r\n        } else {\r\n          // Token expired, clear it\r\n          logger.warn('ApiClient: Token expired, clearing tokens');\r\n          tokenManager?.clearTokens();\r\n        }\r\n      }\r\n\r\n      // Add request ID for tracing\r\n      config.headers = config.headers || {};\r\n      config.headers['X-Request-ID'] = generateRequestId();\r\n\r\n      // Ensure security headers are always present\r\n      config.headers['X-Content-Type-Options'] = 'nosniff';\r\n      config.headers['X-Frame-Options'] = 'DENY';\r\n      config.headers['X-XSS-Protection'] = '1; mode=block';\r\n\r\n      // Log request in development\r\n      if (enableLogging && process.env.NODE_ENV === 'development') {\r\n        logger.debug(`API Request: ${config.method?.toUpperCase()} ${config.url}`, {\r\n          headers: config.headers,\r\n          data: config.data,\r\n        });\r\n      }\r\n\r\n      return config;\r\n    },\r\n    (error) => {\r\n      if (enableLogging && process.env.NODE_ENV === 'development') {\r\n        logger.error('API Request Error', error as Error);\r\n      }\r\n      return Promise.reject(normalizeError(error));\r\n    }\r\n  );\r\n}\r\n\r\n// ==========================================\r\n// RESPONSE INTERCEPTOR\r\n// ==========================================\r\n\r\n/**\r\n * Options for response interceptor\r\n */\r\nexport interface ResponseInterceptorOptions {\r\n  instance: AxiosInstance;\r\n  tokenManager: ITokenManager | undefined;\r\n  enableLogging: boolean;\r\n  enableRetry: boolean;\r\n  maxRetries: number;\r\n  retryDelay: number;\r\n  onAuthFailure: () => void;\r\n  refreshAuthToken: () => Promise<string | null>;\r\n}\r\n\r\n/**\r\n * Create response interceptor for error handling and retry logic\r\n *\r\n * Handles:\r\n * - Token refresh on 401 Unauthorized\r\n * - Automatic retry with exponential backoff\r\n * - Error logging\r\n * - Error normalization\r\n *\r\n * @param options - Configuration options\r\n * @returns Interceptor ID for later removal\r\n */\r\nexport function createAuthResponseInterceptor(options: ResponseInterceptorOptions): number {\r\n  const {\r\n    instance,\r\n    enableLogging,\r\n    enableRetry,\r\n    maxRetries,\r\n    retryDelay,\r\n    onAuthFailure,\r\n    refreshAuthToken,\r\n  } = options;\r\n\r\n  return instance.interceptors.response.use(\r\n    (response) => {\r\n      // Log response in development\r\n      if (enableLogging && process.env.NODE_ENV === 'development') {\r\n        logger.debug(`API Response: ${response.config.method?.toUpperCase()} ${response.config.url}`, {\r\n          status: response.status,\r\n          data: response.data,\r\n        });\r\n      }\r\n      return response;\r\n    },\r\n    async (error: AxiosError) => {\r\n      const originalRequest = error.config as AxiosRequestConfig & { _retry?: boolean; _retryCount?: number };\r\n\r\n      // Handle 401 - Token refresh\r\n      // Skip token refresh for auth endpoints (login, register, refresh)\r\n      const isAuthEndpoint = originalRequest.url?.includes('/auth/login') ||\r\n                             originalRequest.url?.includes('/auth/register') ||\r\n                             originalRequest.url?.includes('/auth/refresh');\r\n\r\n      if (error.response?.status === HTTP_STATUS.UNAUTHORIZED && !originalRequest._retry && !isAuthEndpoint) {\r\n        originalRequest._retry = true;\r\n\r\n        try {\r\n          const newToken = await refreshAuthToken();\r\n          if (newToken && originalRequest.headers) {\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return instance(originalRequest);\r\n          }\r\n        } catch (refreshError) {\r\n          onAuthFailure();\r\n          return Promise.reject(normalizeError(refreshError));\r\n        }\r\n      }\r\n\r\n      // Handle retryable errors\r\n      if (enableRetry && isRetryableError(error) && !originalRequest._retry) {\r\n        const retryCount = originalRequest._retryCount || 0;\r\n\r\n        if (retryCount < maxRetries) {\r\n          originalRequest._retryCount = retryCount + 1;\r\n\r\n          // Exponential backoff\r\n          const delay = retryDelay * Math.pow(2, retryCount);\r\n          await sleep(delay);\r\n\r\n          if (enableLogging && process.env.NODE_ENV === 'development') {\r\n            logger.debug(`API Retry: Attempt ${retryCount + 1}/${maxRetries} for ${originalRequest.url}`);\r\n          }\r\n\r\n          return instance(originalRequest);\r\n        }\r\n      }\r\n\r\n      // Log error\r\n      if (enableLogging) {\r\n        logger.error('API Response Error', error as Error, {\r\n          url: error.config?.url,\r\n          method: error.config?.method,\r\n          status: error.response?.status,\r\n          message: error.message,\r\n          data: error.response?.data,\r\n        });\r\n      }\r\n\r\n      return Promise.reject(normalizeError(error));\r\n    }\r\n  );\r\n}\r\n\r\n// ==========================================\r\n// HELPER FUNCTIONS\r\n// ==========================================\r\n\r\n/**\r\n * Check if error is retryable\r\n *\r\n * Retryable errors include:\r\n * - Network errors (no response)\r\n * - Server errors (5xx)\r\n * - Rate limiting (429)\r\n *\r\n * @param error - Axios error\r\n * @returns True if error should be retried\r\n */\r\nexport function isRetryableError(error: AxiosError): boolean {\r\n  // Network errors\r\n  if (!error.response) {\r\n    return true;\r\n  }\r\n\r\n  // Server errors (5xx)\r\n  const status = error.response.status;\r\n  if (status >= 500 && status < 600) {\r\n    return true;\r\n  }\r\n\r\n  // Rate limiting\r\n  if (status === HTTP_STATUS.TOO_MANY_REQUESTS) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Generate unique request ID for tracing\r\n *\r\n * @returns Unique request ID string\r\n */\r\nexport function generateRequestId(): string {\r\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n}\r\n\r\n/**\r\n * Sleep for specified milliseconds\r\n *\r\n * @param ms - Milliseconds to sleep\r\n * @returns Promise that resolves after delay\r\n */\r\nexport function sleep(ms: number): Promise<void> {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3293, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/ApiClient.auth.ts"],"sourcesContent":["/**\r\n * @fileoverview Authentication utilities for API Client\r\n * @module services/core/ApiClient.auth\r\n * @category Services\r\n *\r\n * Provides authentication-related functionality:\r\n * - Token retrieval from token manager\r\n * - Token refresh logic\r\n * - Authentication failure handling\r\n * - Automatic redirection on auth failure\r\n */\r\n\r\nimport axios from 'axios';\r\nimport type { ITokenManager } from './interfaces/ITokenManager';\r\nimport { API_CONFIG } from '../../constants/config';\r\nimport { API_ENDPOINTS } from '../../constants/api';\r\n\r\n// ==========================================\r\n// TOKEN OPERATIONS\r\n// ==========================================\r\n\r\n/**\r\n * Get authentication token from token manager\r\n *\r\n * @param tokenManager - Token manager instance\r\n * @returns Access token or null if not available\r\n */\r\nexport function getAuthToken(tokenManager: ITokenManager | undefined): string | null {\r\n  return tokenManager?.getToken() ?? null;\r\n}\r\n\r\n/**\r\n * Refresh authentication token using refresh token\r\n *\r\n * Makes a direct API call to refresh endpoint, bypassing interceptors.\r\n * Updates token manager with new tokens on success.\r\n *\r\n * @param tokenManager - Token manager instance\r\n * @returns New access token or null if refresh failed\r\n * @throws Error if no refresh token available or refresh failed\r\n *\r\n * @example\r\n * ```typescript\r\n * try {\r\n *   const newToken = await refreshAuthToken(tokenManager);\r\n *   // Use new token for subsequent requests\r\n * } catch (error) {\r\n *   // Refresh failed, redirect to login\r\n *   handleAuthFailure(tokenManager);\r\n * }\r\n * ```\r\n */\r\nexport async function refreshAuthToken(tokenManager: ITokenManager | undefined): Promise<string | null> {\r\n  const refreshToken = tokenManager?.getRefreshToken();\r\n  if (!refreshToken) {\r\n    throw new Error('No refresh token available');\r\n  }\r\n\r\n  try {\r\n    const response = await axios.post<{ token: string; refreshToken?: string; expiresIn?: number }>(\r\n      `${API_CONFIG.BASE_URL}${API_ENDPOINTS.AUTH.REFRESH}`,\r\n      { refreshToken }\r\n    );\r\n\r\n    const { token, refreshToken: newRefreshToken, expiresIn } = response.data;\r\n\r\n    // Update token in TokenManager\r\n    tokenManager?.setToken(token, newRefreshToken || refreshToken, expiresIn);\r\n\r\n    return token;\r\n  } catch (error) {\r\n    // Refresh failed, handle auth failure\r\n    handleAuthFailure(tokenManager);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Handle authentication failure\r\n *\r\n * Clears all tokens and redirects to login page if not already there.\r\n * Called when token refresh fails or auth is permanently invalid.\r\n *\r\n * @param tokenManager - Token manager instance\r\n *\r\n * @example\r\n * ```typescript\r\n * if (error.status === 401 && !canRefresh) {\r\n *   handleAuthFailure(tokenManager);\r\n * }\r\n * ```\r\n */\r\nexport function handleAuthFailure(tokenManager: ITokenManager | undefined): void {\r\n  // Clear all tokens using TokenManager\r\n  tokenManager?.clearTokens();\r\n\r\n  // Redirect to login if not already there\r\n  if (window.location.pathname !== '/login') {\r\n    window.location.href = '/login';\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;CAUC;;;;;;;;AAED;AAEA;AACA;;;;AAYO,SAAS,aAAa,YAAuC;IAClE,OAAO,cAAc,cAAc;AACrC;AAuBO,eAAe,iBAAiB,YAAuC;IAC5E,MAAM,eAAe,cAAc;IACnC,IAAI,CAAC,cAAc;QACjB,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,gJAAK,CAAC,IAAI,CAC/B,GAAG,wIAAU,CAAC,QAAQ,GAAG,wIAAa,CAAC,IAAI,CAAC,OAAO,EAAE,EACrD;YAAE;QAAa;QAGjB,MAAM,EAAE,KAAK,EAAE,cAAc,eAAe,EAAE,SAAS,EAAE,GAAG,SAAS,IAAI;QAEzE,+BAA+B;QAC/B,cAAc,SAAS,OAAO,mBAAmB,cAAc;QAE/D,OAAO;IACT,EAAE,OAAO,OAAO;QACd,sCAAsC;QACtC,kBAAkB;QAClB,MAAM;IACR;AACF;AAiBO,SAAS,kBAAkB,YAAuC;IACvE,sCAAsC;IACtC,cAAc;IAEd,yCAAyC;IACzC,IAAI,OAAO,QAAQ,CAAC,QAAQ,KAAK,UAAU;QACzC,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;AACF","debugId":null}},
    {"offset": {"line": 3351, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/ApiClient.cancellation.ts"],"sourcesContent":["/**\r\n * @fileoverview Request cancellation utilities for API Client\r\n * @module services/core/ApiClient.cancellation\r\n * @category Services\r\n *\r\n * Provides utilities for cancelling in-flight HTTP requests:\r\n * - AbortController-based cancellation\r\n * - Easy integration with React useEffect cleanup\r\n * - Graceful handling of cancelled requests\r\n */\r\n\r\n// ==========================================\r\n// REQUEST CANCELLATION\r\n// ==========================================\r\n\r\n/**\r\n * Cancellable request handle\r\n *\r\n * Provides both the AbortSignal for request configuration\r\n * and a cancel function for easy cancellation.\r\n */\r\nexport interface CancellableRequest {\r\n  /** AbortSignal to pass to request config */\r\n  signal: AbortSignal;\r\n  /** Cancel function to abort the request */\r\n  cancel: (reason?: string) => void;\r\n}\r\n\r\n/**\r\n * Create a cancellable request with AbortController\r\n *\r\n * Provides easy-to-use request cancellation for long-running operations.\r\n * Useful for cleanup in React useEffect hooks or when users navigate away.\r\n *\r\n * @returns Object with signal for request config and cancel function\r\n *\r\n * @example\r\n * ```typescript\r\n * // In a React component\r\n * useEffect(() => {\r\n *   const { signal, cancel } = createCancellableRequest();\r\n *\r\n *   const fetchData = async () => {\r\n *     try {\r\n *       const data = await apiClient.get('/students', { signal });\r\n *       setStudents(data.data);\r\n *     } catch (error) {\r\n *       if (error.name === 'AbortError') {\r\n *         console.log('Request was cancelled');\r\n *       } else {\r\n *         console.error('Request failed:', error);\r\n *       }\r\n *     }\r\n *   };\r\n *\r\n *   fetchData();\r\n *\r\n *   // Cleanup: cancel request when component unmounts\r\n *   return () => cancel('Component unmounted');\r\n * }, []);\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Cancel after timeout\r\n * const { signal, cancel } = createCancellableRequest();\r\n *\r\n * setTimeout(() => {\r\n *   cancel('Request timeout');\r\n * }, 5000);\r\n *\r\n * try {\r\n *   const data = await apiClient.get('/slow-endpoint', { signal });\r\n * } catch (error) {\r\n *   if (error.name === 'AbortError') {\r\n *     console.log('Request was cancelled due to timeout');\r\n *   }\r\n * }\r\n * ```\r\n */\r\nexport function createCancellableRequest(): CancellableRequest {\r\n  const controller = new AbortController();\r\n\r\n  return {\r\n    signal: controller.signal,\r\n    cancel: (reason?: string) => {\r\n      controller.abort(reason);\r\n    },\r\n  };\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;CASC,GAED,6CAA6C;AAC7C,uBAAuB;AACvB,6CAA6C;AAE7C;;;;;CAKC;;;;AA4DM,SAAS;IACd,MAAM,aAAa,IAAI;IAEvB,OAAO;QACL,QAAQ,WAAW,MAAM;QACzB,QAAQ,CAAC;YACP,WAAW,KAAK,CAAC;QACnB;IACF;AACF","debugId":null}},
    {"offset": {"line": 3385, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/core/ApiClient.ts"],"sourcesContent":["/**\r\n * @fileoverview Enterprise-grade HTTP API client with resilience patterns for healthcare\r\n * @module services/core/ApiClient\r\n * @category Services\r\n *\r\n * Provides type-safe HTTP client with comprehensive error handling, retry logic,\r\n * authentication, CSRF protection, and integration with resilience patterns designed\r\n * for healthcare applications requiring high reliability and HIPAA compliance.\r\n *\r\n * Key Features:\r\n * - Type-safe HTTP methods (GET, POST, PUT, PATCH, DELETE) with generic type support\r\n * - Automatic authentication token injection with refresh handling\r\n * - CSRF protection headers for secure state-changing operations\r\n * - Request/response interceptors for cross-cutting concerns\r\n * - Automatic retry with exponential backoff for transient failures\r\n * - Comprehensive error handling and classification\r\n * - Integration with circuit breaker and bulkhead patterns\r\n * - Request/response logging for debugging (development only)\r\n * - Configurable timeout management\r\n * - Performance tracking with resilience hooks\r\n *\r\n * Error Classification:\r\n * - **Network errors:** No response from server (connection timeout, DNS failure)\r\n * - **Server errors:** 5xx status codes (internal server error, service unavailable)\r\n * - **Client errors:** 4xx status codes (bad request, not found, forbidden)\r\n * - **Validation errors:** 400 with field-specific error details\r\n * - **Authentication errors:** 401 Unauthorized (triggers token refresh)\r\n *\r\n * Healthcare Safety Features:\r\n * - HIPAA-compliant security headers (X-Content-Type-Options, X-Frame-Options, X-XSS-Protection)\r\n * - Automatic token refresh prevents authentication disruption\r\n * - Request deduplication prevents duplicate operations\r\n * - Comprehensive audit logging for compliance\r\n * - No PHI (Protected Health Information) in error messages or logs\r\n *\r\n * Performance Characteristics:\r\n * - O(1) request execution (excluding network time)\r\n * - Interceptors add minimal overhead (~1-2ms)\r\n * - Automatic retry adds latency only on failure (exponential backoff)\r\n * - Token validation cache hit: O(1), miss: O(1) with storage read\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create client with custom config for healthcare API\r\n * const client = new ApiClient({\r\n *   baseURL: 'https://api.hospital.com',\r\n *   timeout: 30000,             // 30 second timeout\r\n *   enableRetry: true,          // Retry transient failures\r\n *   maxRetries: 3,              // Max 3 retry attempts\r\n *   enableLogging: false,       // Disable in production (HIPAA)\r\n *   tokenManager: secureTokenManager\r\n * });\r\n *\r\n * // Make type-safe requests with full error handling\r\n * try {\r\n *   const patient = await client.get<Patient>('/patients/123');\r\n *   console.log('Patient loaded:', patient.data);\r\n * } catch (error) {\r\n *   if (error instanceof ApiClientError) {\r\n *     if (error.isNetworkError) {\r\n *       // Network failure - show offline message\r\n *       showOfflineNotification();\r\n *     } else if (error.status === 404) {\r\n *       // Patient not found\r\n *       showNotFoundError('Patient not found');\r\n *     } else if (error.isValidationError) {\r\n *       // Validation errors with field details\r\n *       showValidationErrors(error.validationErrors);\r\n *     } else {\r\n *       // Generic error\r\n *       showErrorNotification('Failed to load patient');\r\n *     }\r\n *   }\r\n * }\r\n *\r\n * // Create with validation handling\r\n * try {\r\n *   const medication = await client.post<Medication>('/medications', {\r\n *     name: 'Aspirin',\r\n *     dosage: '100mg',\r\n *     patientId: '123'\r\n *   });\r\n *   showSuccessNotification('Medication created');\r\n * } catch (error) {\r\n *   if (error instanceof ApiClientError && error.isValidationError) {\r\n *     // Handle validation errors field-by-field\r\n *     error.validationErrors?.forEach((message, field) => {\r\n *       showFieldError(field, message);\r\n *     });\r\n *   }\r\n * }\r\n *\r\n * // Delete with authentication handling\r\n * try {\r\n *   await client.delete('/medications/456');\r\n *   showSuccessNotification('Medication deleted');\r\n * } catch (error) {\r\n *   if (error instanceof ApiClientError && error.status === 401) {\r\n *     // Authentication failed after token refresh attempt\r\n *     redirectToLogin('Session expired');\r\n *   }\r\n * }\r\n * ```\r\n *\r\n * @see {@link ResilientApiClient} for circuit breaker and bulkhead integration\r\n * @see {@link BaseApiService} for CRUD operations built on ApiClient\r\n * @see {@link SecureTokenManager} for token management\r\n */\r\n\r\nimport axios, { AxiosInstance, AxiosResponse } from 'axios';\r\nimport { API_CONFIG } from '../../constants/config';\r\nimport type { ITokenManager } from './interfaces/ITokenManager';\r\nimport { setupCsrfProtection } from '../security/CsrfProtection';\r\n\r\n// Import types from extracted modules\r\nimport type {\r\n  ApiResponse,\r\n  ApiClientConfig,\r\n  CancellableRequestConfig,\r\n  RequestInterceptor,\r\n  ResponseInterceptor,\r\n  ResilienceHook,\r\n} from './ApiClient.types';\r\n\r\n// Import interceptor utilities from extracted module\r\nimport {\r\n  createAuthRequestInterceptor,\r\n  createAuthResponseInterceptor,\r\n} from './ApiClient.interceptors';\r\n\r\n// Import authentication utilities from extracted module\r\nimport {\r\n  refreshAuthToken,\r\n  handleAuthFailure,\r\n} from './ApiClient.auth';\r\n\r\n// Re-export types for backward compatibility\r\nexport type {\r\n  ApiResponse,\r\n  PaginatedResponse,\r\n  ApiErrorResponse,\r\n  ApiClientConfig,\r\n  CancellableRequestConfig,\r\n  RequestInterceptor,\r\n  ResponseInterceptor,\r\n  ResilienceHook,\r\n} from './ApiClient.types';\r\n\r\n// Re-export error class for backward compatibility\r\nexport { ApiClientError } from './ApiClient.errors';\r\n\r\n// Re-export cancellation utilities for backward compatibility\r\nexport { createCancellableRequest } from './ApiClient.cancellation';\r\n\r\n// ==========================================\r\n// API CLIENT CLASS\r\n// ==========================================\r\n\r\n/**\r\n * Enterprise HTTP API Client\r\n *\r\n * @class\r\n * @classdesc Full-featured HTTP client built on Axios with enterprise patterns designed\r\n * for healthcare applications: automatic authentication, CSRF protection, retry logic,\r\n * comprehensive error handling, and integration with resilience patterns (circuit breaker, bulkhead).\r\n *\r\n * Architecture:\r\n * - **Axios instance:** Base HTTP client with interceptors and security headers\r\n * - **Request interceptor:** Injects authentication tokens, CSRF tokens, security headers, request IDs\r\n * - **Response interceptor:** Handles token refresh (401), automatic retry, error transformation\r\n * - **Retry logic:** Exponential backoff for network/server errors (configurable)\r\n * - **Resilience hooks:** Integration points for circuit breaker, bulkhead, deduplication\r\n * - **Error handling:** Normalized error classification with detailed messages\r\n *\r\n * Request Flow:\r\n * 1. beforeRequest resilience hook (check circuit breaker, acquire bulkhead permit)\r\n * 2. Request interceptor (add auth token, CSRF, security headers)\r\n * 3. HTTP request via Axios\r\n * 4. Response interceptor (handle 401 with token refresh, retry on transient errors)\r\n * 5. afterSuccess/afterFailure resilience hook (record metrics, release permits)\r\n *\r\n * Thread Safety:\r\n * - **Concurrent requests:** Safe for multiple simultaneous requests\r\n * - **Token refresh:** Race condition protection (only one refresh at a time)\r\n * - **Failed request queue:** Automatically retries queued requests after token refresh\r\n *\r\n * Healthcare Safety:\r\n * - HIPAA-compliant security headers prevent common web vulnerabilities\r\n * - Automatic token refresh prevents session interruption during critical operations\r\n * - Request ID header enables complete audit trail\r\n * - No PHI in logs (configurable logging, disabled in production)\r\n *\r\n * Performance Considerations:\r\n * - Interceptors: O(1) overhead per request (~1-2ms)\r\n * - Token validation: Cached, O(1) check\r\n * - Retry: Only on failure, exponential backoff (1s, 2s, 4s)\r\n * - Memory: Minimal, no request caching in client (use CacheManager)\r\n *\r\n * @example\r\n * ```typescript\r\n * // Basic usage with default configuration\r\n * const client = new ApiClient();\r\n * const patients = await client.get<Patient[]>('/patients');\r\n *\r\n * // Healthcare API with custom configuration\r\n * const client = new ApiClient({\r\n *   baseURL: 'https://api.hospital.com',\r\n *   timeout: 30000,                    // 30s for slow operations\r\n *   enableRetry: true,                 // Retry transient failures\r\n *   maxRetries: 3,                     // Max 3 attempts\r\n *   retryDelay: 1000,                  // Start with 1s delay\r\n *   enableLogging: false,              // Disable for HIPAA compliance\r\n *   tokenManager: secureTokenManager,  // Inject token manager\r\n *   resilienceHook: {\r\n *     beforeRequest: async (config) => {\r\n *       // Check circuit breaker before request\r\n *       if (circuitBreaker.isOpen(config.url)) {\r\n *         throw new Error('Circuit breaker is open');\r\n *       }\r\n *     },\r\n *     afterFailure: (error) => {\r\n *       // Record failure for circuit breaker\r\n *       circuitBreaker.recordFailure(error.url);\r\n *     },\r\n *     afterSuccess: (result) => {\r\n *       // Record success for circuit breaker\r\n *       circuitBreaker.recordSuccess(result.url);\r\n *     }\r\n *   }\r\n * });\r\n *\r\n * // Add custom interceptor for tenant header\r\n * client.addRequestInterceptor({\r\n *   onFulfilled: (config) => {\r\n *     config.headers['X-Tenant-ID'] = getCurrentTenantId();\r\n *     return config;\r\n *   },\r\n *   onRejected: (error) => {\r\n *     logger.error('Request interceptor error', error);\r\n *     return Promise.reject(error);\r\n *   }\r\n * });\r\n *\r\n * // Add response interceptor for custom error handling\r\n * client.addResponseInterceptor({\r\n *   onFulfilled: (response) => {\r\n *     // Transform response data\r\n *     if (response.data.timestamp) {\r\n *       response.data.timestamp = new Date(response.data.timestamp);\r\n *     }\r\n *     return response;\r\n *   },\r\n *   onRejected: (error) => {\r\n *     // Handle custom error codes\r\n *     if (error.response?.status === 403) {\r\n *       showPermissionDeniedError();\r\n *     }\r\n *     return Promise.reject(error);\r\n *   }\r\n * });\r\n *\r\n * // Make requests with full type safety\r\n * try {\r\n *   const response = await client.get<Patient>('/patients/123');\r\n *   console.log('Patient:', response.data);\r\n * } catch (error) {\r\n *   if (error instanceof ApiClientError) {\r\n *     handleApiError(error);\r\n *   }\r\n * }\r\n * ```\r\n *\r\n * @see {@link ApiClientConfig} for configuration options\r\n * @see {@link ApiResponse} for response structure\r\n * @see {@link ApiClientError} for error handling\r\n * @see {@link ResilientApiClient} for circuit breaker/bulkhead integration\r\n */\r\nexport class ApiClient {\r\n  private instance: AxiosInstance;\r\n  private enableLogging: boolean;\r\n  private enableRetry: boolean;\r\n  private maxRetries: number;\r\n  private retryDelay: number;\r\n  private requestInterceptorIds: number[] = [];\r\n  private responseInterceptorIds: number[] = [];\r\n  private resilienceHook?: ResilienceHook;\r\n  private tokenManager?: ITokenManager;\r\n\r\n  constructor(config: ApiClientConfig = {}) {\r\n    this.tokenManager = config.tokenManager;\r\n    this.resilienceHook = config.resilienceHook;\r\n    this.enableLogging = config.enableLogging ?? true;\r\n    this.enableRetry = config.enableRetry ?? true;\r\n    this.maxRetries = config.maxRetries ?? API_CONFIG.RETRY.MAX_RETRIES;\r\n    this.retryDelay = config.retryDelay ?? API_CONFIG.RETRY.RETRY_DELAY;\r\n\r\n    // Create axios instance with security headers\r\n    this.instance = axios.create({\r\n      baseURL: config.baseURL ?? API_CONFIG.BASE_URL,\r\n      timeout: config.timeout ?? API_CONFIG.TIMEOUT,\r\n      withCredentials: config.withCredentials ?? true,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        // Security headers for HIPAA compliance\r\n        'X-Content-Type-Options': 'nosniff',\r\n        'X-Frame-Options': 'DENY',\r\n        'X-XSS-Protection': '1; mode=block',\r\n      },\r\n    });\r\n\r\n    // Setup default interceptors\r\n    this.setupDefaultInterceptors();\r\n\r\n    // Setup CSRF protection\r\n    setupCsrfProtection(this.instance);\r\n\r\n    // Add custom interceptors\r\n    if (config.requestInterceptors) {\r\n      config.requestInterceptors.forEach(interceptor => this.addRequestInterceptor(interceptor));\r\n    }\r\n    if (config.responseInterceptors) {\r\n      config.responseInterceptors.forEach(interceptor => this.addResponseInterceptor(interceptor));\r\n    }\r\n  }\r\n\r\n  // ==========================================\r\n  // INTERCEPTOR SETUP\r\n  // ==========================================\r\n\r\n  private setupDefaultInterceptors(): void {\r\n    // Request interceptor: Add auth token and security headers\r\n    const authRequestId = createAuthRequestInterceptor(\r\n      this.instance,\r\n      this.tokenManager,\r\n      this.enableLogging\r\n    );\r\n    this.requestInterceptorIds.push(authRequestId);\r\n\r\n    // Response interceptor: Handle token refresh and errors\r\n    const authResponseId = createAuthResponseInterceptor({\r\n      instance: this.instance,\r\n      tokenManager: this.tokenManager,\r\n      enableLogging: this.enableLogging,\r\n      enableRetry: this.enableRetry,\r\n      maxRetries: this.maxRetries,\r\n      retryDelay: this.retryDelay,\r\n      onAuthFailure: () => handleAuthFailure(this.tokenManager),\r\n      refreshAuthToken: () => refreshAuthToken(this.tokenManager),\r\n    });\r\n    this.responseInterceptorIds.push(authResponseId);\r\n  }\r\n\r\n  // ==========================================\r\n  // INTERCEPTOR MANAGEMENT\r\n  // ==========================================\r\n\r\n  public addRequestInterceptor(interceptor: RequestInterceptor): number {\r\n    const id = this.instance.interceptors.request.use(\r\n      interceptor.onFulfilled,\r\n      interceptor.onRejected\r\n    );\r\n    this.requestInterceptorIds.push(id);\r\n    return id;\r\n  }\r\n\r\n  public addResponseInterceptor(interceptor: ResponseInterceptor): number {\r\n    const id = this.instance.interceptors.response.use(\r\n      interceptor.onFulfilled,\r\n      interceptor.onRejected\r\n    );\r\n    this.responseInterceptorIds.push(id);\r\n    return id;\r\n  }\r\n\r\n  public removeRequestInterceptor(id: number): void {\r\n    this.instance.interceptors.request.eject(id);\r\n    this.requestInterceptorIds = this.requestInterceptorIds.filter(i => i !== id);\r\n  }\r\n\r\n  public removeResponseInterceptor(id: number): void {\r\n    this.instance.interceptors.response.eject(id);\r\n    this.responseInterceptorIds = this.responseInterceptorIds.filter(i => i !== id);\r\n  }\r\n\r\n  // ==========================================\r\n  // HTTP METHODS\r\n  // ==========================================\r\n\r\n  /**\r\n   * Generic request executor that handles all HTTP methods with resilience hooks\r\n   *\r\n   * This method consolidates common logic for all HTTP operations:\r\n   * - Performance tracking (start time, duration)\r\n   * - Resilience hook execution (beforeRequest, afterSuccess, afterFailure)\r\n   * - Error handling and propagation\r\n   *\r\n   * @private\r\n   * @template T - The response data type\r\n   * @param method - HTTP method to execute\r\n   * @param url - Request URL\r\n   * @param data - Request body data (optional, used by POST/PUT/PATCH)\r\n   * @param config - Axios request configuration (optional)\r\n   * @returns Promise resolving to API response\r\n   */\r\n  private async executeRequest<T = unknown>(\r\n    method: 'get' | 'post' | 'put' | 'patch' | 'delete',\r\n    url: string,\r\n    data?: unknown,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    const startTime = performance.now();\r\n    const methodUpper = method.toUpperCase();\r\n\r\n    try {\r\n      // Execute beforeRequest hook if configured\r\n      if (this.resilienceHook?.beforeRequest) {\r\n        await this.resilienceHook.beforeRequest({\r\n          method: methodUpper,\r\n          url,\r\n          data\r\n        });\r\n      }\r\n\r\n      // Execute the HTTP request based on method type\r\n      let response: AxiosResponse<ApiResponse<T>>;\r\n      switch (method) {\r\n        case 'get':\r\n        case 'delete':\r\n          // GET and DELETE don't accept body data\r\n          response = await this.instance[method]<ApiResponse<T>>(url, config);\r\n          break;\r\n        case 'post':\r\n        case 'put':\r\n        case 'patch':\r\n          // POST, PUT, and PATCH accept body data\r\n          response = await this.instance[method]<ApiResponse<T>>(url, data, config);\r\n          break;\r\n      }\r\n\r\n      // Execute afterSuccess hook if configured\r\n      if (this.resilienceHook?.afterSuccess) {\r\n        this.resilienceHook.afterSuccess({\r\n          method: methodUpper,\r\n          url,\r\n          duration: performance.now() - startTime\r\n        });\r\n      }\r\n\r\n      return response.data;\r\n    } catch (error) {\r\n      // Execute afterFailure hook if configured\r\n      if (this.resilienceHook?.afterFailure) {\r\n        this.resilienceHook.afterFailure({\r\n          method: methodUpper,\r\n          url,\r\n          duration: performance.now() - startTime,\r\n          error\r\n        });\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute GET request to retrieve data from the API\r\n   *\r\n   * @template T - The response data type expected from the API\r\n   * @param {string} url - Request URL (relative to baseURL or absolute)\r\n   * @param {CancellableRequestConfig} [config] - Request configuration with optional AbortSignal for cancellation\r\n   * @returns {Promise<ApiResponse<T>>} Promise resolving to API response with typed data\r\n   * @throws {ApiClientError} Network error (no response from server)\r\n   * @throws {ApiClientError} Authentication error (401 after token refresh fails)\r\n   * @throws {ApiClientError} Authorization error (403 forbidden)\r\n   * @throws {ApiClientError} Not found error (404 resource not found)\r\n   * @throws {ApiClientError} Server error (5xx internal server error)\r\n   * @throws {Error} Resilience hook error (circuit breaker open, bulkhead full)\r\n   *\r\n   * @description\r\n   * Executes a GET request through the full resilience stack:\r\n   * 1. beforeRequest hook (circuit breaker check, bulkhead acquire)\r\n   * 2. Request interceptor (auth token, CSRF, security headers)\r\n   * 3. HTTP GET request\r\n   * 4. Response interceptor (401 handling, retry logic)\r\n   * 5. afterSuccess/afterFailure hook (metrics, cleanup)\r\n   *\r\n   * Automatically retries on network/server errors with exponential backoff.\r\n   * Token refresh is automatic on 401 Unauthorized responses.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Simple GET request\r\n   * const response = await client.get<Patient>('/patients/123');\r\n   * console.log(response.data); // Patient object\r\n   *\r\n   * // GET with query parameters (use URLSearchParams or object)\r\n   * const response = await client.get<Patient[]>('/patients', {\r\n   *   params: { age: 30, status: 'active' }\r\n   * });\r\n   *\r\n   * // GET with cancellation support\r\n   * const controller = new AbortController();\r\n   * const promise = client.get<Patient>('/patients/123', {\r\n   *   signal: controller.signal\r\n   * });\r\n   * // Cancel request if needed\r\n   * controller.abort();\r\n   *\r\n   * // GET with error handling\r\n   * try {\r\n   *   const response = await client.get<MedicationList>('/medications');\r\n   *   displayMedications(response.data);\r\n   * } catch (error) {\r\n   *   if (error instanceof ApiClientError) {\r\n   *     if (error.isNetworkError) {\r\n   *       showOfflineMessage();\r\n   *     } else if (error.status === 404) {\r\n   *       showNotFoundMessage('Medications not found');\r\n   *     } else {\r\n   *       showErrorMessage('Failed to load medications');\r\n   *     }\r\n   *   }\r\n   * }\r\n   * ```\r\n   *\r\n   * @see {@link post} for creating resources\r\n   * @see {@link put} for full resource updates\r\n   * @see {@link patch} for partial resource updates\r\n   */\r\n  public async get<T = unknown>(\r\n    url: string,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    return this.executeRequest<T>('get', url, undefined, config);\r\n  }\r\n\r\n  /**\r\n   * Execute POST request to create a new resource or trigger an action\r\n   *\r\n   * @template T - The response data type expected from the API\r\n   * @param {string} url - Request URL (relative to baseURL or absolute)\r\n   * @param {unknown} [data] - Request body data to send (will be JSON-stringified)\r\n   * @param {CancellableRequestConfig} [config] - Request configuration with optional AbortSignal\r\n   * @returns {Promise<ApiResponse<T>>} Promise resolving to API response with created/updated data\r\n   * @throws {ApiClientError} Network error (no response from server)\r\n   * @throws {ApiClientError} Authentication error (401 after token refresh fails)\r\n   * @throws {ApiClientError} Authorization error (403 forbidden, insufficient permissions)\r\n   * @throws {ApiClientError} Validation error (400 with field-specific errors)\r\n   * @throws {ApiClientError} Conflict error (409 resource already exists)\r\n   * @throws {ApiClientError} Server error (5xx internal server error)\r\n   * @throws {Error} Resilience hook error (circuit breaker open, bulkhead full)\r\n   *\r\n   * @description\r\n   * Executes a POST request with full resilience and validation handling.\r\n   * Automatically includes CSRF token for state-changing operations.\r\n   * Request body is JSON-stringified automatically.\r\n   *\r\n   * POST is typically used for:\r\n   * - Creating new resources (e.g., new patient, new medication order)\r\n   * - Triggering actions (e.g., send email, generate report)\r\n   * - Bulk operations (e.g., bulk create, batch processing)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Create new patient\r\n   * try {\r\n   *   const response = await client.post<Patient>('/patients', {\r\n   *     firstName: 'John',\r\n   *     lastName: 'Doe',\r\n   *     dateOfBirth: '1990-01-15',\r\n   *     medicalRecordNumber: 'MRN-12345'\r\n   *   });\r\n   *   console.log('Patient created:', response.data);\r\n   *   showSuccessNotification('Patient created successfully');\r\n   * } catch (error) {\r\n   *   if (error instanceof ApiClientError && error.isValidationError) {\r\n   *     // Handle validation errors field-by-field\r\n   *     error.validationErrors?.forEach((message, field) => {\r\n   *       showFieldError(field, message);\r\n   *     });\r\n   *   } else if (error.status === 409) {\r\n   *     showErrorNotification('Patient with this MRN already exists');\r\n   *   }\r\n   * }\r\n   *\r\n   * // Trigger action (report generation)\r\n   * const response = await client.post<ReportResult>('/reports/generate', {\r\n   *   type: 'monthly-summary',\r\n   *   month: '2024-01',\r\n   *   format: 'pdf'\r\n   * });\r\n   *\r\n   * // Bulk create medications\r\n   * const response = await client.post<BulkResult>('/medications/bulk', {\r\n   *   medications: [\r\n   *     { name: 'Aspirin', dosage: '100mg' },\r\n   *     { name: 'Ibuprofen', dosage: '200mg' }\r\n   *   ]\r\n   * });\r\n   * console.log(`Created ${response.data.created} medications`);\r\n   *\r\n   * // POST with cancellation\r\n   * const controller = new AbortController();\r\n   * const promise = client.post<Patient>('/patients', data, {\r\n   *   signal: controller.signal\r\n   * });\r\n   * // Cancel if user navigates away\r\n   * controller.abort();\r\n   * ```\r\n   *\r\n   * @see {@link get} for retrieving resources\r\n   * @see {@link put} for full resource updates\r\n   * @see {@link patch} for partial resource updates\r\n   * @see {@link delete} for removing resources\r\n   */\r\n  public async post<T = unknown>(\r\n    url: string,\r\n    data?: unknown,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    return this.executeRequest<T>('post', url, data, config);\r\n  }\r\n\r\n  /**\r\n   * Execute PUT request for complete resource replacement\r\n   *\r\n   * @template T - The response data type expected from the API\r\n   * @param {string} url - Request URL (relative to baseURL or absolute)\r\n   * @param {unknown} [data] - Complete resource data to replace existing resource\r\n   * @param {CancellableRequestConfig} [config] - Request configuration with optional AbortSignal\r\n   * @returns {Promise<ApiResponse<T>>} Promise resolving to API response with updated resource\r\n   * @throws {ApiClientError} Network, authentication, authorization, validation, or server errors\r\n   * @throws {Error} Resilience hook errors\r\n   *\r\n   * @description\r\n   * PUT replaces the entire resource with the provided data. All fields should be included.\r\n   * Use PATCH for partial updates. Includes CSRF token automatically.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Full update of patient record (all fields required)\r\n   * const response = await client.put<Patient>('/patients/123', {\r\n   *   id: '123',\r\n   *   firstName: 'John',\r\n   *   lastName: 'Doe',\r\n   *   dateOfBirth: '1990-01-15',\r\n   *   medicalRecordNumber: 'MRN-12345',\r\n   *   // ... all other fields must be included\r\n   * });\r\n   * ```\r\n   *\r\n   * @see {@link patch} for partial updates\r\n   */\r\n  public async put<T = unknown>(\r\n    url: string,\r\n    data?: unknown,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    return this.executeRequest<T>('put', url, data, config);\r\n  }\r\n\r\n  /**\r\n   * Execute PATCH request for partial resource update\r\n   *\r\n   * @template T - The response data type expected from the API\r\n   * @param {string} url - Request URL (relative to baseURL or absolute)\r\n   * @param {unknown} [data] - Partial resource data (only fields to update)\r\n   * @param {CancellableRequestConfig} [config] - Request configuration with optional AbortSignal\r\n   * @returns {Promise<ApiResponse<T>>} Promise resolving to API response with updated resource\r\n   * @throws {ApiClientError} Network, authentication, authorization, validation, or server errors\r\n   * @throws {Error} Resilience hook errors\r\n   *\r\n   * @description\r\n   * PATCH updates only the specified fields, leaving other fields unchanged.\r\n   * Preferred over PUT when updating a subset of fields. Includes CSRF token.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Update only patient's phone number\r\n   * const response = await client.patch<Patient>('/patients/123', {\r\n   *   phoneNumber: '+1-555-123-4567'\r\n   * });\r\n   *\r\n   * // Update medication status\r\n   * const response = await client.patch<Medication>('/medications/456', {\r\n   *   status: 'administered',\r\n   *   administeredAt: new Date().toISOString()\r\n   * });\r\n   * ```\r\n   *\r\n   * @see {@link put} for full resource replacement\r\n   */\r\n  public async patch<T = unknown>(\r\n    url: string,\r\n    data?: unknown,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    return this.executeRequest<T>('patch', url, data, config);\r\n  }\r\n\r\n  /**\r\n   * Execute DELETE request to remove a resource\r\n   *\r\n   * @template T - The response data type (typically void or deletion confirmation)\r\n   * @param {string} url - Request URL (relative to baseURL or absolute)\r\n   * @param {CancellableRequestConfig} [config] - Request configuration with optional AbortSignal\r\n   * @returns {Promise<ApiResponse<T>>} Promise resolving to API response (typically empty)\r\n   * @throws {ApiClientError} Network error, authentication error, authorization error (403), not found (404), server error\r\n   * @throws {Error} Resilience hook errors\r\n   *\r\n   * @description\r\n   * DELETE removes a resource permanently. This operation cannot be undone in most cases.\r\n   * Includes CSRF token for security. Consider soft-delete for healthcare data.\r\n   *\r\n   * **Healthcare Warning:** Deleting medical records may violate retention policies.\r\n   * Prefer soft-delete (status update) over hard-delete for patient data.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Delete medication order (if allowed)\r\n   * try {\r\n   *   await client.delete('/medications/456');\r\n   *   showSuccessNotification('Medication deleted');\r\n   * } catch (error) {\r\n   *   if (error instanceof ApiClientError) {\r\n   *     if (error.status === 403) {\r\n   *       showErrorNotification('Cannot delete administered medication');\r\n   *     } else if (error.status === 404) {\r\n   *       showErrorNotification('Medication not found');\r\n   *     }\r\n   *   }\r\n   * }\r\n   *\r\n   * // Soft-delete preferred for patient data (use PATCH instead)\r\n   * await client.patch('/patients/123', { status: 'deleted', deletedAt: new Date() });\r\n   * ```\r\n   *\r\n   * @see {@link patch} for soft-delete via status update\r\n   */\r\n  public async delete<T = unknown>(\r\n    url: string,\r\n    config?: CancellableRequestConfig\r\n  ): Promise<ApiResponse<T>> {\r\n    return this.executeRequest<T>('delete', url, undefined, config);\r\n  }\r\n\r\n  // ==========================================\r\n  // ACCESSOR METHODS\r\n  // ==========================================\r\n\r\n  public getAxiosInstance(): AxiosInstance {\r\n    return this.instance;\r\n  }\r\n\r\n  public setLogging(enabled: boolean): void {\r\n    this.enableLogging = enabled;\r\n  }\r\n\r\n  public setRetry(enabled: boolean): void {\r\n    this.enableRetry = enabled;\r\n  }\r\n\r\n  /**\r\n   * Set resilience hook for integration with resilience patterns\r\n   */\r\n  public setResilienceHook(hook: ResilienceHook | undefined): void {\r\n    this.resilienceHook = hook;\r\n  }\r\n\r\n  /**\r\n   * Get current resilience hook\r\n   */\r\n  public getResilienceHook(): ResilienceHook | undefined {\r\n    return this.resilienceHook;\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// SINGLETON INSTANCE\r\n// ==========================================\r\n\r\n// Import secureTokenManager here to avoid circular dependency\r\n// (ApiClient no longer imports it directly, only via dependency injection)\r\nimport { secureTokenManager } from '../security/SecureTokenManager';\r\n\r\nexport const apiClient = new ApiClient({\r\n  enableLogging: process.env.NODE_ENV === 'development',\r\n  enableRetry: true,\r\n  tokenManager: secureTokenManager,\r\n});\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3959, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/services/authApi.ts"],"sourcesContent":["/**\r\n * @fileoverview Authentication API service with JWT-based secure credential validation\r\n * @module services/modules/authApi\r\n * @category Services - Authentication & Security\r\n *\r\n * Provides enterprise-grade authentication and authorization API endpoints for the\r\n * White Cross healthcare platform. Implements JWT-based authentication with OAuth 2.0\r\n * support, strong password validation, and comprehensive session management.\r\n *\r\n * Key Features:\r\n * - User authentication (login/logout) with JWT tokens\r\n * - User registration with role-based access control (RBAC)\r\n * - Token refresh mechanism for session continuity\r\n * - Strong password validation (12+ chars, uppercase, lowercase, number, special char)\r\n * - Email verification workflow\r\n * - Password reset flow with secure tokens\r\n * - Multi-factor authentication (MFA) integration\r\n * - OAuth 2.0 support (Google, Microsoft)\r\n * - Session management and token validation\r\n * - Development user listing (dev environment only)\r\n *\r\n * Security Features:\r\n * - Strong password requirements enforced client-side and server-side\r\n * - Zod schema validation for all authentication inputs\r\n * - Secure token storage via tokenUtils (sessionStorage)\r\n * - CSRF protection on state-changing operations\r\n * - Rate limiting on login attempts (backend-enforced)\r\n * - No PHI (Protected Health Information) in authentication data\r\n * - Automatic token expiration detection\r\n * - Secure password reset with time-limited tokens\r\n *\r\n * Token Management:\r\n * - Access tokens stored in sessionStorage for security\r\n * - Refresh tokens for automatic session renewal\r\n * - Token expiration handling with automatic cleanup\r\n * - Automatic logout on token expiry\r\n * - JWT payload parsing for expiration checking\r\n *\r\n * RBAC Roles:\r\n * - ADMIN: Full system access\r\n * - NURSE: Healthcare provider access\r\n * - SCHOOL_ADMIN: School-level administration\r\n * - DISTRICT_ADMIN: District-level administration\r\n * - VIEWER: Read-only access\r\n * - COUNSELOR: Student counseling access\r\n *\r\n * OAuth 2.0 Integration:\r\n * - Google OAuth for Google Workspace users\r\n * - Microsoft OAuth for Microsoft 365 users\r\n * - Automatic redirect-based authentication flow\r\n *\r\n * @example Login with email and password\r\n * ```typescript\r\n * import { authApi } from '@/services/modules/authApi';\r\n *\r\n * try {\r\n *   const { user, token } = await authApi.login({\r\n *     email: 'nurse@school.edu',\r\n *     password: 'SecurePass123!',\r\n *     rememberMe: true\r\n *   });\r\n *   console.log(`Logged in as ${user.firstName} ${user.lastName}`);\r\n *   console.log(`Role: ${user.role}`);\r\n * } catch (error) {\r\n *   console.error('Login failed:', error.message);\r\n * }\r\n * ```\r\n *\r\n * @example Register new user with role assignment\r\n * ```typescript\r\n * const response = await authApi.register({\r\n *   email: 'newuser@school.edu',\r\n *   password: 'SecurePass123!',\r\n *   firstName: 'Jane',\r\n *   lastName: 'Doe',\r\n *   role: 'NURSE',\r\n *   schoolId: 'school-uuid-here'\r\n * });\r\n * console.log(`User registered: ${response.user.email}`);\r\n * ```\r\n *\r\n * @example Refresh expired token\r\n * ```typescript\r\n * if (authApi.isTokenExpired()) {\r\n *   const { token: newToken } = await authApi.refreshToken();\r\n *   console.log('Token refreshed successfully');\r\n * }\r\n * ```\r\n *\r\n * @example Logout user\r\n * ```typescript\r\n * await authApi.logout();\r\n * console.log('User logged out, tokens cleared');\r\n * ```\r\n *\r\n * @example OAuth login with Google\r\n * ```typescript\r\n * // Redirects to Google OAuth consent screen\r\n * await authApi.loginWithGoogle();\r\n * ```\r\n *\r\n * @see {@link https://jwt.io/ JWT Documentation}\r\n * @see {@link https://oauth.net/2/ OAuth 2.0 Specification}\r\n * @see {@link tokenUtils} for token storage utilities\r\n */\r\n\r\nimport type { ApiClient } from '@/services/core/ApiClient';\r\nimport { API_ENDPOINTS, tokenUtils } from '@/services/config/apiConfig';\r\nimport { API_CONFIG } from '@/constants/config';\r\nimport { z } from 'zod';\r\nimport { User } from '../stores/types/auth.types';\r\nimport { createApiError, createValidationError } from '@/services/core/errors';\r\n\r\nexport interface LoginCredentials {\r\n  email: string;\r\n  password: string;\r\n  rememberMe?: boolean;\r\n}\r\n\r\nexport interface RegisterData {\r\n  email: string;\r\n  password: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  role: 'ADMIN' | 'NURSE' | 'SCHOOL_ADMIN' | 'DISTRICT_ADMIN' | 'VIEWER' | 'COUNSELOR';\r\n  schoolId?: string;\r\n  districtId?: string;\r\n  phone?: string;\r\n}\r\n\r\nexport interface AuthResponse {\r\n  user: User;\r\n  token: string;\r\n  refreshToken: string;\r\n  expiresIn: number;\r\n}\r\n\r\nexport interface RefreshTokenResponse {\r\n  token: string;\r\n  refreshToken: string;\r\n  expiresIn: number;\r\n}\r\n\r\n\r\n// Validation schemas\r\nconst loginSchema = z.object({\r\n  email: z.string().email('Invalid email address'),\r\n  password: z.string().min(8, 'Password must be at least 8 characters'),\r\n  rememberMe: z.boolean().optional(),\r\n});\r\n\r\nconst registerSchema = z.object({\r\n  email: z.string().email('Invalid email address'),\r\n  password: z.string().min(8, 'Password must be at least 8 characters'),\r\n  firstName: z.string().min(1, 'First name is required'),\r\n  lastName: z.string().min(1, 'Last name is required'),\r\n  role: z.enum(['ADMIN', 'NURSE', 'SCHOOL_ADMIN', 'DISTRICT_ADMIN', 'VIEWER', 'COUNSELOR']),\r\n  schoolId: z.string().optional(),\r\n});\r\n\r\n// Auth API class\r\nexport class AuthApi {\r\n  constructor(private readonly client: ApiClient) {}\r\n\r\n  /**\r\n   * Authenticate user with email and password credentials\r\n   *\r\n   * Validates user credentials against the backend authentication service and\r\n   * returns a JWT access token with user information. Automatically stores tokens\r\n   * in sessionStorage for subsequent authenticated requests.\r\n   *\r\n   * @param {LoginCredentials} credentials - User login credentials\r\n   * @param {string} credentials.email - User email address (validated format)\r\n   * @param {string} credentials.password - User password (minimum 12 characters)\r\n   * @param {boolean} [credentials.rememberMe] - Whether to remember user session\r\n   * @returns {Promise<AuthResponse>} Authentication response with user and tokens\r\n   * @returns {User} AuthResponse.user - Authenticated user object with role and permissions\r\n   * @returns {string} AuthResponse.token - JWT access token for API authentication\r\n   * @returns {string} AuthResponse.refreshToken - Refresh token for session renewal\r\n   * @returns {number} AuthResponse.expiresIn - Token expiration time in seconds (86400 = 24 hours)\r\n   * @throws {ValidationError} If email format is invalid or password is too short\r\n   * @throws {ApiError} If authentication fails due to invalid credentials\r\n   * @throws {ApiError} If backend service is unavailable or returns non-2xx status\r\n   *\r\n   * @example Successful login\r\n   * ```typescript\r\n   * const response = await authApi.login({\r\n   *   email: 'nurse@school.edu',\r\n   *   password: 'SecurePass123!',\r\n   *   rememberMe: true\r\n   * });\r\n   * console.log(`Welcome, ${response.user.firstName}!`);\r\n   * console.log(`Token expires in ${response.expiresIn} seconds`);\r\n   * ```\r\n   *\r\n   * @example Handle login errors\r\n   * ```typescript\r\n   * try {\r\n   *   await authApi.login({ email: 'test@example.com', password: 'short' });\r\n   * } catch (error) {\r\n   *   if (error.name === 'ValidationError') {\r\n   *     console.error('Invalid input:', error.validationErrors);\r\n   *   } else {\r\n   *     console.error('Login failed:', error.message);\r\n   *   }\r\n   * }\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * - Tokens are automatically stored in sessionStorage via tokenUtils\r\n   * - Backend enforces rate limiting (max attempts per IP address)\r\n   * - Successful login triggers audit log entry in backend\r\n   * - MFA-enabled accounts require additional verification step\r\n   * - Account lockout occurs after multiple failed attempts\r\n   *\r\n   * @see {@link logout} to end user session\r\n   * @see {@link refreshToken} to renew access token\r\n   * @see {@link verifyToken} to validate token status\r\n   */\r\n  async login(credentials: LoginCredentials): Promise<AuthResponse> {\r\n    try {\r\n      loginSchema.parse(credentials);\r\n\r\n      console.log('[AuthApi] Sending login request to:', API_ENDPOINTS.AUTH.LOGIN);\r\n\r\n      const response = await this.client.post<{\r\n        accessToken: string;\r\n        refreshToken: string;\r\n        user: User;\r\n        tokenType: string;\r\n        expiresIn: number;\r\n      }>(\r\n        API_ENDPOINTS.AUTH.LOGIN,\r\n        credentials\r\n      );\r\n\r\n      console.log('[AuthApi] Login response received:', {\r\n        response: response,\r\n        hasData: !!response.data,\r\n        responseKeys: Object.keys(response || {})\r\n      });\r\n\r\n      // ApiClient returns response.data from axios, which is already the backend response\r\n      // Backend returns { accessToken, refreshToken, user, tokenType, expiresIn }\r\n      const responseData = response.data || response;\r\n      console.log('[AuthApi] Response data:', {\r\n        hasAccessToken: !!responseData.accessToken,\r\n        hasRefreshToken: !!responseData.refreshToken,\r\n        hasUser: !!responseData.user,\r\n        dataKeys: Object.keys(responseData || {})\r\n      });\r\n\r\n      const { accessToken, refreshToken, user, expiresIn } = responseData;\r\n\r\n      if (!accessToken) {\r\n        console.error('[AuthApi] Missing accessToken in response');\r\n        throw new Error('Login failed - missing access token');\r\n      }\r\n\r\n      if (!refreshToken) {\r\n        console.error('[AuthApi] Missing refreshToken in response');\r\n        throw new Error('Login failed - missing refresh token');\r\n      }\r\n\r\n      console.log('[AuthApi] Storing tokens...');\r\n\r\n      // Store tokens\r\n      tokenUtils.setToken(accessToken);\r\n      tokenUtils.setRefreshToken(refreshToken);\r\n\r\n      console.log('[AuthApi] Login successful');\r\n\r\n      return {\r\n        user,\r\n        token: accessToken,\r\n        refreshToken: refreshToken,\r\n        expiresIn: expiresIn\r\n      };\r\n    } catch (error: unknown) {\r\n      console.error('[AuthApi] Login error:', error);\r\n\r\n      if (error instanceof z.ZodError) {\r\n        throw createValidationError(\r\n          error.issues[0]?.message || 'Validation error',\r\n          error.issues[0]?.path.join('.'),\r\n          error.issues.reduce((acc: Record<string, string[]>, err: z.ZodIssue) => {\r\n            const path = err.path.join('.');\r\n            if (!acc[path]) acc[path] = [];\r\n            acc[path].push(err.message);\r\n            return acc;\r\n          }, {} as Record<string, string[]>),\r\n          error\r\n        );\r\n      }\r\n      throw createApiError(error as Error, 'Login failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Register new user account with role-based access control\r\n   *\r\n   * Creates a new user account in the system with specified role and school assignment.\r\n   * Performs comprehensive validation of email uniqueness, password strength, and\r\n   * role permissions. Automatically authenticates the user and returns tokens upon\r\n   * successful registration.\r\n   *\r\n   * @param {RegisterData} userData - User registration data\r\n   * @param {string} userData.email - Unique email address (validated format, max 255 chars)\r\n   * @param {string} userData.password - Strong password (min 12 chars, uppercase, lowercase, number, special char)\r\n   * @param {string} userData.firstName - User first name (min 1 char, max 100 chars)\r\n   * @param {string} userData.lastName - User last name (min 1 char, max 100 chars)\r\n   * @param {string} userData.role - User role (ADMIN | NURSE | SCHOOL_ADMIN | DISTRICT_ADMIN | VIEWER | COUNSELOR)\r\n   * @param {string} [userData.schoolId] - Associated school UUID (required for NURSE, SCHOOL_ADMIN, COUNSELOR roles)\r\n   * @returns {Promise<AuthResponse>} Authentication response with new user and tokens\r\n   * @throws {ValidationError} If email is invalid, password is weak, or required fields are missing\r\n   * @throws {ApiError} If email already exists in system\r\n   * @throws {ApiError} If role assignment is not permitted\r\n   * @throws {ApiError} If school ID is invalid or not found\r\n   *\r\n   * @example Register nurse for specific school\r\n   * ```typescript\r\n   * const response = await authApi.register({\r\n   *   email: 'new.nurse@school.edu',\r\n   *   password: 'VerySecure123!@#',\r\n   *   firstName: 'Jane',\r\n   *   lastName: 'Doe',\r\n   *   role: 'NURSE',\r\n   *   schoolId: 'abc-123-def-456'\r\n   * });\r\n   * console.log(`Account created for ${response.user.email}`);\r\n   * ```\r\n   *\r\n   * @example Handle registration validation errors\r\n   * ```typescript\r\n   * try {\r\n   *   await authApi.register({\r\n   *     email: 'invalid-email',\r\n   *     password: 'weak',\r\n   *     firstName: 'John',\r\n   *     lastName: 'Smith',\r\n   *     role: 'NURSE'\r\n   *   });\r\n   * } catch (error) {\r\n   *   if (error.name === 'ValidationError') {\r\n   *     Object.entries(error.validationErrors).forEach(([field, messages]) => {\r\n   *       console.error(`${field}: ${messages.join(', ')}`);\r\n   *     });\r\n   *   }\r\n   * }\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * - Email must be unique across entire platform\r\n   * - Password requirements enforced: 12+ chars, uppercase, lowercase, digit, special char (@$!%*?&)\r\n   * - ADMIN and DISTRICT_ADMIN roles may require additional approval\r\n   * - New users receive email verification link (if email service configured)\r\n   * - Audit log created for all registration attempts\r\n   * - RBAC permissions automatically assigned based on role\r\n   *\r\n   * @see {@link login} to authenticate existing user\r\n   * @see {@link usersApi} for additional user management operations\r\n   */\r\n  async register(userData: RegisterData): Promise<AuthResponse> {\r\n    try {\r\n      registerSchema.parse(userData);\r\n\r\n      const response = await this.client.post<{\r\n        accessToken: string;\r\n        refreshToken: string;\r\n        user: User;\r\n        tokenType: string;\r\n        expiresIn: number;\r\n      }>(\r\n        API_ENDPOINTS.AUTH.REGISTER,\r\n        userData\r\n      );\r\n\r\n      const { accessToken, refreshToken, user, expiresIn } = response.data;\r\n\r\n      // Store tokens\r\n      tokenUtils.setToken(accessToken);\r\n      tokenUtils.setRefreshToken(refreshToken);\r\n\r\n      return {\r\n        user,\r\n        token: accessToken,\r\n        refreshToken: refreshToken,\r\n        expiresIn: expiresIn\r\n      };\r\n    } catch (error: unknown) {\r\n      if (error instanceof z.ZodError) {\r\n        throw createValidationError(\r\n          error.issues[0]?.message || 'Validation error',\r\n          error.issues[0]?.path.join('.'),\r\n          error.issues.reduce((acc: Record<string, string[]>, err: z.ZodIssue) => {\r\n            const path = err.path.join('.');\r\n            if (!acc[path]) acc[path] = [];\r\n            acc[path].push(err.message);\r\n            return acc;\r\n          }, {} as Record<string, string[]>),\r\n          error\r\n        );\r\n      }\r\n      throw createApiError(error as Error, 'Registration failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Verify current token validity\r\n   */\r\n  async verifyToken(): Promise<User> {\r\n    try {\r\n      const response = await this.client.post<{ user: User }>(\r\n        API_ENDPOINTS.AUTH.VERIFY\r\n      );\r\n\r\n      return response.data.user;\r\n    } catch (error: unknown) {\r\n      throw createApiError(error as Error, 'Token verification failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh access token using refresh token\r\n   */\r\n  async refreshToken(): Promise<RefreshTokenResponse> {\r\n    try {\r\n      const refreshToken = tokenUtils.getRefreshToken();\r\n      if (!refreshToken) {\r\n        throw new Error('No refresh token available');\r\n      }\r\n\r\n      const response = await this.client.post<{\r\n        accessToken: string;\r\n        refreshToken: string;\r\n        user: User;\r\n        tokenType: string;\r\n        expiresIn: number;\r\n      }>(\r\n        API_ENDPOINTS.AUTH.REFRESH,\r\n        { refreshToken }\r\n      );\r\n\r\n      const { accessToken, refreshToken: newRefreshToken, expiresIn } = response.data;\r\n\r\n      // Update stored tokens\r\n      tokenUtils.setToken(accessToken);\r\n      tokenUtils.setRefreshToken(newRefreshToken);\r\n\r\n      return {\r\n        token: accessToken,\r\n        refreshToken: newRefreshToken,\r\n        expiresIn: expiresIn\r\n      };\r\n    } catch (error: unknown) {\r\n      // Clear tokens on refresh failure\r\n      tokenUtils.clearAll();\r\n      throw createApiError(error as Error, 'Token refresh failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logout user\r\n   */\r\n  async logout(): Promise<void> {\r\n    try {\r\n      await this.client.post(API_ENDPOINTS.AUTH.LOGOUT);\r\n    } catch (error: unknown) {\r\n      // Continue with local logout even if server request fails\r\n      console.warn('Server logout failed, continuing with local logout');\r\n    } finally {\r\n      // Always clear local tokens\r\n      tokenUtils.clearAll();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current user from session\r\n   */\r\n  async getCurrentUser(): Promise<User> {\r\n    try {\r\n      const response = await this.client.get<{success: boolean; data: User}>(API_ENDPOINTS.AUTH.PROFILE);\r\n\r\n      if (!response.data.success || !response.data.data) {\r\n        throw new Error('Failed to get current user');\r\n      }\r\n\r\n      return response.data.data;\r\n    } catch (error: unknown) {\r\n      throw createApiError(error as Error, 'Failed to get current user');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Google OAuth login\r\n   */\r\n  async loginWithGoogle(): Promise<void> {\r\n    const baseUrl = API_CONFIG.BASE_URL.replace('/api', '');\r\n    window.location.href = `${baseUrl}${API_ENDPOINTS.AUTH.LOGIN}/google`;\r\n  }\r\n\r\n  /**\r\n   * Microsoft OAuth login\r\n   */\r\n  async loginWithMicrosoft(): Promise<void> {\r\n    const baseUrl = API_CONFIG.BASE_URL.replace('/api', '');\r\n    window.location.href = `${baseUrl}${API_ENDPOINTS.AUTH.LOGIN}/microsoft`;\r\n  }\r\n\r\n  /**\r\n   * Request password reset\r\n   */\r\n  async forgotPassword(email: string): Promise<{ message: string }> {\r\n    try {\r\n      const response = await this.client.post<{ message: string }>(\r\n        API_ENDPOINTS.AUTH.FORGOT_PASSWORD,\r\n        { email }\r\n      );\r\n\r\n      return response.data;\r\n    } catch (error: unknown) {\r\n      throw createApiError(error as Error, 'Password reset request failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Reset password with token\r\n   */\r\n  async resetPassword(token: string, password: string): Promise<{ message: string }> {\r\n    try {\r\n      const response = await this.client.post<{ message: string }>(\r\n        API_ENDPOINTS.AUTH.RESET_PASSWORD,\r\n        { token, password }\r\n      );\r\n\r\n      return response.data;\r\n    } catch (error: unknown) {\r\n      throw createApiError(error as Error, 'Password reset failed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user is authenticated\r\n   */\r\n  isAuthenticated(): boolean {\r\n    const token = tokenUtils.getToken();\r\n    return !!token;\r\n  }\r\n\r\n  /**\r\n   * Check if token is expired\r\n   */\r\n  isTokenExpired(): boolean {\r\n    try {\r\n      const token = tokenUtils.getToken();\r\n      if (!token) return true;\r\n\r\n      const payload = JSON.parse(atob(token.split('.')[1]));\r\n      const currentTime = Date.now() / 1000;\r\n\r\n      return payload.exp < currentTime;\r\n    } catch (error: unknown) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all users for development/testing (includes passwords)\r\n   * Only works in development environment\r\n   */\r\n  async getDevUsers(): Promise<Array<{\r\n    id: string;\r\n    email: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    role: string;\r\n    password: string;\r\n    displayName: string;\r\n  }>> {\r\n    try {\r\n      const response = await this.client.get<{\r\n        success: boolean;\r\n        data: {\r\n          users: Array<{\r\n            id: string;\r\n            email: string;\r\n            firstName: string;\r\n            lastName: string;\r\n            role: string;\r\n            password: string;\r\n            displayName: string;\r\n          }>;\r\n        };\r\n      }>(API_ENDPOINTS.USERS.BASE + '/dev');\r\n\r\n      if (!response.data.success || !response.data.data) {\r\n        throw new Error('Failed to fetch development users');\r\n      }\r\n\r\n      return response.data.data.users;\r\n    } catch (error: unknown) {\r\n      throw createApiError(error as Error, 'Failed to fetch development users');\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Factory function to create Auth API instance\r\n * @param client - ApiClient instance with authentication and resilience patterns\r\n * @returns Configured AuthApi instance\r\n */\r\nexport function createAuthApi(client: ApiClient): AuthApi {\r\n  return new AuthApi(client);\r\n}\r\n\r\n// Create and export a default instance for backward compatibility\r\nimport { apiClient } from '@/services/core/ApiClient';\r\nexport const authApi = createAuthApi(apiClient);\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAwGC;;;;;;;;AAGD;AAAA;AACA;AACA;AAEA;AAwfA,kEAAkE;AAClE;;;;;AAxdA,qBAAqB;AACrB,MAAM,cAAc,kLAAC,CAAC,MAAM,CAAC;IAC3B,OAAO,kLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,YAAY,kLAAC,CAAC,OAAO,GAAG,QAAQ;AAClC;AAEA,MAAM,iBAAiB,kLAAC,CAAC,MAAM,CAAC;IAC9B,OAAO,kLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,WAAW,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,UAAU,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,MAAM,kLAAC,CAAC,IAAI,CAAC;QAAC;QAAS;QAAS;QAAgB;QAAkB;QAAU;KAAY;IACxF,UAAU,kLAAC,CAAC,MAAM,GAAG,QAAQ;AAC/B;AAGO,MAAM;;IACX,YAAY,AAAiB,MAAiB,CAAE;aAAnB,SAAA;IAAoB;IAEjD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAsDC,GACD,MAAM,MAAM,WAA6B,EAAyB;QAChE,IAAI;YACF,YAAY,KAAK,CAAC;YAElB,QAAQ,GAAG,CAAC,uCAAuC,wIAAa,CAAC,IAAI,CAAC,KAAK;YAE3E,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAOrC,wIAAa,CAAC,IAAI,CAAC,KAAK,EACxB;YAGF,QAAQ,GAAG,CAAC,sCAAsC;gBAChD,UAAU;gBACV,SAAS,CAAC,CAAC,SAAS,IAAI;gBACxB,cAAc,OAAO,IAAI,CAAC,YAAY,CAAC;YACzC;YAEA,oFAAoF;YACpF,4EAA4E;YAC5E,MAAM,eAAe,SAAS,IAAI,IAAI;YACtC,QAAQ,GAAG,CAAC,4BAA4B;gBACtC,gBAAgB,CAAC,CAAC,aAAa,WAAW;gBAC1C,iBAAiB,CAAC,CAAC,aAAa,YAAY;gBAC5C,SAAS,CAAC,CAAC,aAAa,IAAI;gBAC5B,UAAU,OAAO,IAAI,CAAC,gBAAgB,CAAC;YACzC;YAEA,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG;YAEvD,IAAI,CAAC,aAAa;gBAChB,QAAQ,KAAK,CAAC;gBACd,MAAM,IAAI,MAAM;YAClB;YAEA,IAAI,CAAC,cAAc;gBACjB,QAAQ,KAAK,CAAC;gBACd,MAAM,IAAI,MAAM;YAClB;YAEA,QAAQ,GAAG,CAAC;YAEZ,eAAe;YACf,oKAAU,CAAC,QAAQ,CAAC;YACpB,oKAAU,CAAC,eAAe,CAAC;YAE3B,QAAQ,GAAG,CAAC;YAEZ,OAAO;gBACL;gBACA,OAAO;gBACP,cAAc;gBACd,WAAW;YACb;QACF,EAAE,OAAO,OAAgB;YACvB,QAAQ,KAAK,CAAC,0BAA0B;YAExC,IAAI,iBAAiB,kLAAC,CAAC,QAAQ,EAAE;gBAC/B,MAAM,IAAA,0JAAqB,EACzB,MAAM,MAAM,CAAC,EAAE,EAAE,WAAW,oBAC5B,MAAM,MAAM,CAAC,EAAE,EAAE,KAAK,KAAK,MAC3B,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,KAA+B;oBAClD,MAAM,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC;oBAC3B,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,KAAK,GAAG,EAAE;oBAC9B,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,OAAO;oBAC1B,OAAO;gBACT,GAAG,CAAC,IACJ;YAEJ;YACA,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA+DC,GACD,MAAM,SAAS,QAAsB,EAAyB;QAC5D,IAAI;YACF,eAAe,KAAK,CAAC;YAErB,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAOrC,wIAAa,CAAC,IAAI,CAAC,QAAQ,EAC3B;YAGF,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,SAAS,IAAI;YAEpE,eAAe;YACf,oKAAU,CAAC,QAAQ,CAAC;YACpB,oKAAU,CAAC,eAAe,CAAC;YAE3B,OAAO;gBACL;gBACA,OAAO;gBACP,cAAc;gBACd,WAAW;YACb;QACF,EAAE,OAAO,OAAgB;YACvB,IAAI,iBAAiB,kLAAC,CAAC,QAAQ,EAAE;gBAC/B,MAAM,IAAA,0JAAqB,EACzB,MAAM,MAAM,CAAC,EAAE,EAAE,WAAW,oBAC5B,MAAM,MAAM,CAAC,EAAE,EAAE,KAAK,KAAK,MAC3B,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,KAA+B;oBAClD,MAAM,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC;oBAC3B,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,KAAK,GAAG,EAAE;oBAC9B,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,OAAO;oBAC1B,OAAO;gBACT,GAAG,CAAC,IACJ;YAEJ;YACA,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,MAAM,cAA6B;QACjC,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CACrC,wIAAa,CAAC,IAAI,CAAC,MAAM;YAG3B,OAAO,SAAS,IAAI,CAAC,IAAI;QAC3B,EAAE,OAAO,OAAgB;YACvB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,MAAM,eAA8C;QAClD,IAAI;YACF,MAAM,eAAe,oKAAU,CAAC,eAAe;YAC/C,IAAI,CAAC,cAAc;gBACjB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAOrC,wIAAa,CAAC,IAAI,CAAC,OAAO,EAC1B;gBAAE;YAAa;YAGjB,MAAM,EAAE,WAAW,EAAE,cAAc,eAAe,EAAE,SAAS,EAAE,GAAG,SAAS,IAAI;YAE/E,uBAAuB;YACvB,oKAAU,CAAC,QAAQ,CAAC;YACpB,oKAAU,CAAC,eAAe,CAAC;YAE3B,OAAO;gBACL,OAAO;gBACP,cAAc;gBACd,WAAW;YACb;QACF,EAAE,OAAO,OAAgB;YACvB,kCAAkC;YAClC,oKAAU,CAAC,QAAQ;YACnB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,MAAM,SAAwB;QAC5B,IAAI;YACF,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,wIAAa,CAAC,IAAI,CAAC,MAAM;QAClD,EAAE,OAAO,OAAgB;YACvB,0DAA0D;YAC1D,QAAQ,IAAI,CAAC;QACf,SAAU;YACR,4BAA4B;YAC5B,oKAAU,CAAC,QAAQ;QACrB;IACF;IAEA;;GAEC,GACD,MAAM,iBAAgC;QACpC,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,GAAG,CAAiC,wIAAa,CAAC,IAAI,CAAC,OAAO;YAEjG,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;gBACjD,MAAM,IAAI,MAAM;YAClB;YAEA,OAAO,SAAS,IAAI,CAAC,IAAI;QAC3B,EAAE,OAAO,OAAgB;YACvB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,MAAM,kBAAiC;QACrC,MAAM,UAAU,wIAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ;QACpD,OAAO,QAAQ,CAAC,IAAI,GAAG,GAAG,UAAU,wIAAa,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;IACvE;IAEA;;GAEC,GACD,MAAM,qBAAoC;QACxC,MAAM,UAAU,wIAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ;QACpD,OAAO,QAAQ,CAAC,IAAI,GAAG,GAAG,UAAU,wIAAa,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;IAC1E;IAEA;;GAEC,GACD,MAAM,eAAe,KAAa,EAAgC;QAChE,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CACrC,wIAAa,CAAC,IAAI,CAAC,eAAe,EAClC;gBAAE;YAAM;YAGV,OAAO,SAAS,IAAI;QACtB,EAAE,OAAO,OAAgB;YACvB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,MAAM,cAAc,KAAa,EAAE,QAAgB,EAAgC;QACjF,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CACrC,wIAAa,CAAC,IAAI,CAAC,cAAc,EACjC;gBAAE;gBAAO;YAAS;YAGpB,OAAO,SAAS,IAAI;QACtB,EAAE,OAAO,OAAgB;YACvB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;IAEA;;GAEC,GACD,kBAA2B;QACzB,MAAM,QAAQ,oKAAU,CAAC,QAAQ;QACjC,OAAO,CAAC,CAAC;IACX;IAEA;;GAEC,GACD,iBAA0B;QACxB,IAAI;YACF,MAAM,QAAQ,oKAAU,CAAC,QAAQ;YACjC,IAAI,CAAC,OAAO,OAAO;YAEnB,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACnD,MAAM,cAAc,KAAK,GAAG,KAAK;YAEjC,OAAO,QAAQ,GAAG,GAAG;QACvB,EAAE,OAAO,OAAgB;YACvB,OAAO;QACT;IACF;IAEA;;;GAGC,GACD,MAAM,cAQF;QACF,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,MAAM,CAAC,GAAG,CAanC,wIAAa,CAAC,KAAK,CAAC,IAAI,GAAG;YAE9B,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;gBACjD,MAAM,IAAI,MAAM;YAClB;YAEA,OAAO,SAAS,IAAI,CAAC,IAAI,CAAC,KAAK;QACjC,EAAE,OAAO,OAAgB;YACvB,MAAM,IAAA,mJAAc,EAAC,OAAgB;QACvC;IACF;AACF;AAOO,SAAS,cAAc,MAAiB;IAC7C,OAAO,IAAI,QAAQ;AACrB;;AAIO,MAAM,UAAU,cAAc,iKAAS","debugId":null}},
    {"offset": {"line": 4445, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/stores/authSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Authentication Redux Slice for White Cross Healthcare Platform\r\n *\r\n * Manages global authentication state including user sessions, login/logout flows,\r\n * and JWT token lifecycle management. This slice is persisted to localStorage for\r\n * session recovery across browser tabs and page refreshes.\r\n *\r\n * **Key Features:**\r\n * - JWT-based authentication with automatic token refresh\r\n * - Secure credential handling with httpOnly cookies\r\n * - Cross-tab state synchronization via BroadcastChannel API\r\n * - Persistent session management with localStorage (non-PHI user data only)\r\n * - Integration with RBAC (Role-Based Access Control) system\r\n * - Automatic session cleanup on logout\r\n * - Toast notifications for user feedback\r\n *\r\n * **HIPAA Compliance:**\r\n * - User profile data (name, email, role) is NOT considered PHI\r\n * - Authentication state is persisted to localStorage (HIPAA compliant)\r\n * - JWT tokens stored in httpOnly cookies (not accessible via JavaScript)\r\n * - Session expiration enforced server-side and client-side\r\n * - All authentication operations are audit logged on the backend\r\n *\r\n * **State Management:**\r\n * - Global store location: `stores/slices/authSlice.ts`\r\n * - Persisted to localStorage via redux-persist\r\n * - Automatically cleared on logout via `clearPersistedState()`\r\n * - Synchronized across browser tabs\r\n *\r\n * **Integration:**\r\n * - Backend API: `services/modules/authApi.ts`\r\n * - Type definitions: `types/index.ts` (User interface)\r\n * - Redux store: `stores/reduxStore.ts`\r\n * - Used by: Authentication guards, protected routes, user profile components\r\n *\r\n * @module stores/slices/authSlice\r\n * @requires @reduxjs/toolkit\r\n * @requires services/modules/authApi\r\n * @requires types/User\r\n * @security Authentication state management, JWT token handling\r\n * @compliance HIPAA-compliant user session management\r\n *\r\n * @example Basic usage in component\r\n * ```typescript\r\n * import { useDispatch, useSelector } from 'react-redux';\r\n * import { loginUser, logoutUser } from '@/identity-access/stores/authSlice';\r\n *\r\n * function LoginForm() {\r\n *   const dispatch = useDispatch();\r\n *   const { isAuthenticated, isLoading, user, error } = useSelector((state) => state.auth);\r\n *\r\n *   const handleLogin = async (credentials) => {\r\n *     await dispatch(loginUser(credentials));\r\n *   };\r\n *\r\n *   return (\r\n *     <form onSubmit={handleLogin}>\r\n *       {error && <div>{error}</div>}\r\n *       {user && <div>Welcome, {user.firstName}!</div>}\r\n *     </form>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @example Protected route with auth check\r\n * ```typescript\r\n * import { Navigate } from 'react-router-dom';\r\n * import { useSelector } from 'react-redux';\r\n *\r\n * function ProtectedRoute({ children }) {\r\n *   const { isAuthenticated } = useSelector((state) => state.auth);\r\n *\r\n *   if (!isAuthenticated) {\r\n *     return <Navigate to=\"/login\" />;\r\n *   }\r\n *\r\n *   return children;\r\n * }\r\n * ```\r\n *\r\n * @see {@link ../../services/modules/authApi.ts} for API integration\r\n * @see {@link ../reduxStore.ts} for store configuration\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\r\nimport { authApi } from '../services/authApi';\r\nimport { \r\n  User, \r\n  LoginCredentials, \r\n  RegisterData, \r\n  AuthResponse,\r\n  AuthState \r\n} from './types/auth.types';\r\nimport toast from 'react-hot-toast';\r\nimport debug from 'debug';\r\n\r\nconst log = debug('whitecross:auth-slice');\r\n\r\n\r\n/**\r\n * Initial authentication state when no user is logged in.\r\n *\r\n * This state is used on first load and after logout operations.\r\n *\r\n * @type {AuthState}\r\n * @constant\r\n */\r\nconst initialState: AuthState = {\r\n  user: null,\r\n  isAuthenticated: false,\r\n  isLoading: false,\r\n  error: null,\r\n  sessionExpiresAt: null,\r\n};\r\n\r\n/**\r\n * Authenticates a user with email and password credentials.\r\n *\r\n * Performs login via the backend authentication API, which validates credentials,\r\n * generates a JWT token, and returns the user profile. The JWT token is stored\r\n * in an httpOnly cookie for security. User profile is stored in Redux state.\r\n *\r\n * **Authentication Flow:**\r\n * 1. Dispatch loginUser with credentials\r\n * 2. API validates credentials and generates JWT\r\n * 3. JWT stored in httpOnly cookie (automatic)\r\n * 4. User profile returned and stored in Redux state\r\n * 5. State persisted to localStorage for session recovery\r\n * 6. Success toast notification displayed\r\n *\r\n * **Security:**\r\n * - Credentials transmitted over HTTPS only\r\n * - JWT stored in httpOnly cookie (not accessible via JavaScript)\r\n * - Failed attempts are rate-limited on the backend\r\n * - All login attempts are audit logged\r\n *\r\n * @async\r\n * @function loginUser\r\n * @param {LoginCredentials} credentials - User login credentials\r\n * @param {string} credentials.email - User email address\r\n * @param {string} credentials.password - User password (plain text, encrypted in transit)\r\n * @returns {Promise<{user: User, token: string}>} Authenticated user and JWT token\r\n * @throws {string} Error message if login fails (invalid credentials, network error, etc.)\r\n *\r\n * @example Login with email and password\r\n * ```typescript\r\n * const dispatch = useDispatch();\r\n *\r\n * const handleLogin = async () => {\r\n *   try {\r\n *     const result = await dispatch(loginUser({\r\n *       email: 'nurse@school.edu',\r\n *       password: 'securePassword123'\r\n *     })).unwrap();\r\n *\r\n *     console.log('Login successful:', result.user);\r\n *     // Navigate to dashboard\r\n *   } catch (error) {\r\n *     console.error('Login failed:', error);\r\n *     // Error toast already shown automatically\r\n *   }\r\n * };\r\n * ```\r\n *\r\n * @example Using with loading state\r\n * ```typescript\r\n * const { isLoading } = useSelector((state) => state.auth);\r\n *\r\n * <button onClick={handleLogin} disabled={isLoading}>\r\n *   {isLoading ? 'Logging in...' : 'Login'}\r\n * </button>\r\n * ```\r\n *\r\n * @security JWT stored in httpOnly cookie, credentials encrypted in transit\r\n * @compliance Backend audit logging for all authentication attempts\r\n * @see {@link ../../services/modules/authApi.ts#login} for API implementation\r\n */\r\nexport const loginUser = createAsyncThunk(\r\n  'auth/loginUser',\r\n  async (credentials: LoginCredentials, { rejectWithValue }) => {\r\n    try {\r\n      const response = await authApi.login(credentials);\r\n      return response;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Login failed';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Registers a new user account in the White Cross platform.\r\n *\r\n * Creates a new user account with the provided registration data. After successful\r\n * registration, the user is automatically logged in and their profile is stored\r\n * in Redux state. Registration requires administrator approval in production.\r\n *\r\n * **Registration Flow:**\r\n * 1. Dispatch registerUser with user data\r\n * 2. API validates data and creates user account\r\n * 3. User account created with pending or active status\r\n * 4. JWT token generated and stored in httpOnly cookie\r\n * 5. User profile returned and stored in Redux state\r\n * 6. Success toast notification displayed\r\n *\r\n * **Validation:**\r\n * - Email must be unique and valid format\r\n * - Password must meet complexity requirements (8+ chars, mixed case, numbers)\r\n * - Role must be valid healthcare role (nurse, administrator, etc.)\r\n * - All required fields validated on backend\r\n *\r\n * @async\r\n * @function registerUser\r\n * @param {RegisterData} userData - New user registration data\r\n * @param {string} userData.email - Unique email address\r\n * @param {string} userData.password - Password meeting complexity requirements\r\n * @param {string} userData.firstName - User first name\r\n * @param {string} userData.lastName - User last name\r\n * @param {string} userData.role - Healthcare role (nurse, admin, etc.)\r\n * @returns {Promise<{user: User, token: string}>} Created user profile and JWT token\r\n * @throws {string} Error message if registration fails (duplicate email, validation error, etc.)\r\n *\r\n * @example Register new nurse account\r\n * ```typescript\r\n * const dispatch = useDispatch();\r\n *\r\n * const handleRegister = async () => {\r\n *   try {\r\n *     const result = await dispatch(registerUser({\r\n *       email: 'new.nurse@school.edu',\r\n *       password: 'SecurePass123!',\r\n *       firstName: 'Sarah',\r\n *       lastName: 'Johnson',\r\n *       role: 'nurse'\r\n *     })).unwrap();\r\n *\r\n *     console.log('Registration successful:', result.user);\r\n *     // Navigate to onboarding or dashboard\r\n *   } catch (error) {\r\n *     console.error('Registration failed:', error);\r\n *     // Error details shown in toast\r\n *   }\r\n * };\r\n * ```\r\n *\r\n * @security Password hashed before storage, email uniqueness enforced\r\n * @compliance Backend audit logging for account creation\r\n * @see {@link ../../services/modules/authApi.ts#register} for API implementation\r\n */\r\nexport const registerUser = createAsyncThunk(\r\n  'auth/registerUser',\r\n  async (userData: RegisterData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await authApi.register(userData);\r\n      return response;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Registration failed';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Logs out the current user and clears all session data.\r\n *\r\n * Performs a secure logout by invalidating the JWT token on the backend,\r\n * clearing all persisted Redux state from localStorage, and resetting\r\n * the authentication state. Even if the backend logout fails (network error),\r\n * local state is still cleared for security.\r\n *\r\n * **Logout Flow:**\r\n * 1. Dispatch logoutUser action\r\n * 2. Backend invalidates JWT token (adds to blacklist)\r\n * 3. httpOnly cookie cleared by browser\r\n * 4. All Redux persisted state cleared via `clearPersistedState()`\r\n * 5. Authentication state reset to initial state\r\n * 6. User redirected to login page (handled by component)\r\n *\r\n * **Security:**\r\n * - JWT token blacklisted on backend to prevent reuse\r\n * - All localStorage data cleared (auth, cached data)\r\n * - Session state synchronized across all browser tabs\r\n * - Automatic redirect to login page\r\n *\r\n * @async\r\n * @function logoutUser\r\n * @param {void} _ - No parameters required\r\n * @returns {Promise<void>} Resolves when logout is complete\r\n * @throws {string} Error message if backend logout fails (still clears local state)\r\n *\r\n * @example Logout current user\r\n * ```typescript\r\n * const dispatch = useDispatch();\r\n *\r\n * const handleLogout = async () => {\r\n *   await dispatch(logoutUser());\r\n *   // User state cleared, navigate to login\r\n *   navigate('/login');\r\n * };\r\n *\r\n * <button onClick={handleLogout}>Logout</button>\r\n * ```\r\n *\r\n * @example Logout with confirmation dialog\r\n * ```typescript\r\n * const handleLogout = async () => {\r\n *   if (confirm('Are you sure you want to logout?')) {\r\n *     await dispatch(logoutUser());\r\n *     navigate('/login');\r\n *   }\r\n * };\r\n * ```\r\n *\r\n * @security Clears all persisted state regardless of backend success\r\n * @compliance Audit logging on backend for session termination\r\n * @see {@link ../../services/modules/authApi.ts#logout} for API implementation\r\n * @see {@link ../reduxStore.ts#clearPersistedState} for state cleanup\r\n */\r\nexport const logoutUser = createAsyncThunk(\r\n  'auth/logoutUser',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      await authApi.logout();\r\n    } catch (error) {\r\n      // Even if server logout fails, we still want to clear local state\r\n      const message = error instanceof Error ? error.message : 'Logout failed';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Refreshes the current user session by verifying the JWT token.\r\n *\r\n * Called on app initialization and periodically to verify the JWT token is still\r\n * valid. If the token is valid, updates the user profile in Redux state with\r\n * the latest data from the backend. If the token is invalid or expired, logs\r\n * the user out automatically.\r\n *\r\n * **Refresh Flow:**\r\n * 1. Dispatch refreshUser on app initialization\r\n * 2. Backend verifies JWT token from httpOnly cookie\r\n * 3. If valid, returns updated user profile\r\n * 4. Redux state updated with fresh user data\r\n * 5. If invalid, user state cleared (silent logout)\r\n *\r\n * **Use Cases:**\r\n * - App initialization to restore session from localStorage\r\n * - Periodic token validation (every 15 minutes)\r\n * - After permissions change to refresh user roles\r\n * - Cross-tab session synchronization\r\n *\r\n * @async\r\n * @function refreshUser\r\n * @param {void} _ - No parameters required (uses token from cookie)\r\n * @returns {Promise<User>} Updated user profile from backend\r\n * @throws {string} Error message if token verification fails (triggers silent logout)\r\n *\r\n * @example Refresh user on app initialization\r\n * ```typescript\r\n * import { useEffect } from 'react';\r\n * import { useDispatch } from 'react-redux';\r\n * import { refreshUser } from '@/stores/slices/authSlice';\r\n *\r\n * function App() {\r\n *   const dispatch = useDispatch();\r\n *\r\n *   useEffect(() => {\r\n *     // Verify token and restore session on app load\r\n *     dispatch(refreshUser());\r\n *   }, [dispatch]);\r\n *\r\n *   return <Router>...</Router>;\r\n * }\r\n * ```\r\n *\r\n * @example Periodic token refresh\r\n * ```typescript\r\n * useEffect(() => {\r\n *   // Refresh token every 15 minutes\r\n *   const interval = setInterval(() => {\r\n *     dispatch(refreshUser());\r\n *   }, 15 * 60 * 1000);\r\n *\r\n *   return () => clearInterval(interval);\r\n * }, [dispatch]);\r\n * ```\r\n *\r\n * @security Silent logout on token expiration, no error toast shown\r\n * @compliance Validates JWT signature and expiration server-side\r\n * @see {@link ../../services/modules/authApi.ts#verifyToken} for API implementation\r\n */\r\nexport const refreshUser = createAsyncThunk(\r\n  'auth/refreshUser',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const user = await authApi.verifyToken();\r\n      return user;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Token verification failed';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Authentication Redux slice with reducers for login, logout, registration, and token refresh.\r\n *\r\n * Handles all authentication state transitions including loading states, error handling,\r\n * and user profile management. Integrates with react-hot-toast for user feedback.\r\n *\r\n * @constant authSlice\r\n * @type {Slice<AuthState>}\r\n */\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    /**\r\n     * Clears the current error message from authentication state.\r\n     *\r\n     * Used to dismiss error messages after user acknowledgment or before\r\n     * retrying a failed operation.\r\n     *\r\n     * @function clearError\r\n     * @param {AuthState} state - Current authentication state\r\n     * @returns {void}\r\n     *\r\n     * @example Clear error after user dismisses notification\r\n     * ```typescript\r\n     * const { error } = useSelector((state) => state.auth);\r\n     * const dispatch = useDispatch();\r\n     *\r\n     * if (error) {\r\n     *   return (\r\n     *     <Alert onClose={() => dispatch(clearError())}>\r\n     *       {error}\r\n     *     </Alert>\r\n     *   );\r\n     * }\r\n     * ```\r\n     */\r\n    clearError: (state) => {\r\n      state.error = null;\r\n    },\r\n\r\n    /**\r\n     * Directly sets the current user in authentication state.\r\n     *\r\n     * Used for manual user updates (e.g., profile edits, role changes) or\r\n     * for cross-tab synchronization via BroadcastChannel API. Setting user\r\n     * to null logs the user out.\r\n     *\r\n     * @function setUser\r\n     * @param {AuthState} state - Current authentication state\r\n     * @param {PayloadAction<User | null>} action - User profile or null to logout\r\n     * @returns {void}\r\n     *\r\n     * @example Update user profile after edit\r\n     * ```typescript\r\n     * const handleProfileUpdate = (updatedUser: User) => {\r\n     *   dispatch(setUser(updatedUser));\r\n     *   toast.success('Profile updated successfully');\r\n     * };\r\n     * ```\r\n     *\r\n     * @example Cross-tab session sync\r\n     * ```typescript\r\n     * const channel = new BroadcastChannel('auth');\r\n     * channel.onmessage = (event) => {\r\n     *   if (event.data.type === 'USER_UPDATED') {\r\n     *     dispatch(setUser(event.data.user));\r\n     *   }\r\n     * };\r\n     * ```\r\n     */\r\n    setUser: (state, action: PayloadAction<User | null>) => {\r\n      state.user = action.payload;\r\n      state.isAuthenticated = !!action.payload;\r\n      state.error = null;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      /**\r\n       * Login pending - Sets loading state while authentication request is in progress.\r\n       * Clears any previous error messages to provide clean UX for retry attempts.\r\n       */\r\n      .addCase(loginUser.pending, (state) => {\r\n        state.isLoading = true;\r\n        state.error = null;\r\n      })\r\n\r\n      /**\r\n       * Login fulfilled - User successfully authenticated.\r\n       * Stores user profile, sets authenticated flag, and shows welcome toast.\r\n       * User data is automatically persisted to localStorage by redux-persist.\r\n       */\r\n      .addCase(loginUser.fulfilled, (state, action) => {\r\n        state.user = action.payload.user;\r\n        state.isAuthenticated = true;\r\n        state.isLoading = false;\r\n        state.error = null;\r\n        toast.success(`Welcome back, ${action.payload.user.firstName}!`);\r\n      })\r\n\r\n      /**\r\n       * Login rejected - Authentication failed.\r\n       * Clears user state, stores error message, and shows error toast.\r\n       * Common causes: invalid credentials, account locked, network error.\r\n       */\r\n      .addCase(loginUser.rejected, (state, action) => {\r\n        state.user = null;\r\n        state.isAuthenticated = false;\r\n        state.isLoading = false;\r\n        state.error = action.payload as string;\r\n        toast.error(action.payload as string);\r\n      })\r\n\r\n      /**\r\n       * Register pending - Sets loading state while registration request is in progress.\r\n       * Clears any previous error messages.\r\n       */\r\n      .addCase(registerUser.pending, (state) => {\r\n        state.isLoading = true;\r\n        state.error = null;\r\n      })\r\n\r\n      /**\r\n       * Register fulfilled - User account successfully created.\r\n       * Stores user profile, sets authenticated flag, and shows welcome toast.\r\n       * User is automatically logged in after successful registration.\r\n       */\r\n      .addCase(registerUser.fulfilled, (state, action) => {\r\n        state.user = action.payload.user;\r\n        state.isAuthenticated = true;\r\n        state.isLoading = false;\r\n        state.error = null;\r\n        toast.success(`Welcome, ${action.payload.user.firstName}! Your account has been created.`);\r\n      })\r\n\r\n      /**\r\n       * Register rejected - Registration failed.\r\n       * Clears user state, stores error message, and shows error toast.\r\n       * Common causes: duplicate email, invalid data, validation error.\r\n       */\r\n      .addCase(registerUser.rejected, (state, action) => {\r\n        state.user = null;\r\n        state.isAuthenticated = false;\r\n        state.isLoading = false;\r\n        state.error = action.payload as string;\r\n        toast.error(action.payload as string);\r\n      })\r\n\r\n      /**\r\n       * Logout pending - Sets loading state during logout process.\r\n       * Brief loading state while backend invalidates token.\r\n       */\r\n      .addCase(logoutUser.pending, (state) => {\r\n        state.isLoading = true;\r\n      })\r\n\r\n      /**\r\n       * Logout fulfilled - User successfully logged out.\r\n       * Clears all authentication state and persisted data from localStorage.\r\n       * Called via clearPersistedState() to remove all Redux persisted state.\r\n       */\r\n      .addCase(logoutUser.fulfilled, (state) => {\r\n        state.user = null;\r\n        state.isAuthenticated = false;\r\n        state.isLoading = false;\r\n        state.error = null;\r\n        state.sessionExpiresAt = null;\r\n        toast.success('You have been logged out successfully');\r\n      })\r\n\r\n      /**\r\n       * Logout rejected - Backend logout failed but still clear local state.\r\n       * Security best practice: Always clear local state even if backend fails.\r\n       * User cannot continue authenticated session if backend logout failed.\r\n       */\r\n      .addCase(logoutUser.rejected, (state) => {\r\n        // Even if server logout fails, clear local state\r\n        state.user = null;\r\n        state.isAuthenticated = false;\r\n        state.isLoading = false;\r\n        state.error = null;\r\n        state.sessionExpiresAt = null;\r\n        toast.success('You have been logged out successfully');\r\n      })\r\n\r\n      /**\r\n       * Refresh user fulfilled - Token verified and user profile updated.\r\n       * Called on app initialization to restore session from persisted state.\r\n       * Updates user profile with latest data from backend.\r\n       */\r\n      .addCase(refreshUser.fulfilled, (state, action) => {\r\n        state.user = action.payload;\r\n        state.isAuthenticated = true;\r\n        state.error = null;\r\n      })\r\n\r\n      /**\r\n       * Refresh user rejected - Token verification failed (expired or invalid).\r\n       * Performs silent logout without showing error toast (expected during normal session expiry).\r\n       * User will be redirected to login page by authentication guard.\r\n       */\r\n      .addCase(refreshUser.rejected, (state) => {\r\n        // If token verification fails, logout user\r\n        state.user = null;\r\n        state.isAuthenticated = false;\r\n        state.error = null;\r\n        // Don't show toast for silent refresh failures\r\n        log('Token verification failed during refresh');\r\n      });\r\n  },\r\n});\r\n\r\n/**\r\n * Authentication action creators for manual state updates.\r\n *\r\n * @exports clearError - Clear authentication error message\r\n * @exports setUser - Manually set user profile (for updates, cross-tab sync)\r\n * @exports clearAuthError - Alias for clearError (backward compatibility)\r\n * @exports setUserFromSession - Alias for setUser (backward compatibility)\r\n */\r\nexport const { clearError, setUser } = authSlice.actions;\r\n\r\n// Backward compatibility aliases\r\nexport const clearAuthError = clearError;\r\nexport const setUserFromSession = setUser;\r\nexport const refreshAuthToken = refreshUser;\r\n\r\n/**\r\n * Authentication reducer for Redux store integration.\r\n *\r\n * Import this reducer in the root Redux store configuration:\r\n * ```typescript\r\n * import authReducer from './slices/authSlice';\r\n *\r\n * const store = configureStore({\r\n *   reducer: {\r\n *     auth: authReducer,\r\n *   },\r\n * });\r\n * ```\r\n *\r\n * @default authSlice.reducer\r\n */\r\nexport default authSlice.reducer;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4794, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/utils/apiUtils.ts"],"sourcesContent":["/**\r\n * WF-COMP-302 | apiUtils.ts - React component or utility module\r\n * Purpose: react component or utility module\r\n * Upstream: React, external libs | Dependencies: axios, moment, debug\r\n * Downstream: Components, pages, app routing | Called by: React component tree\r\n * Related: Other components, hooks, services, types\r\n * Exports: constants, interfaces, classes | Key Features: component\r\n * Last Updated: 2025-10-17 | File Type: .ts\r\n * Critical Path: Component mount â†’ Render â†’ User interaction â†’ State updates\r\n * LLM Context: react component or utility module, part of React frontend architecture\r\n */\r\n\r\nimport { AxiosResponse, AxiosError } from 'axios';\r\nimport {\r\n  formatISO,\r\n  parseISO,\r\n  isValid,\r\n  format,\r\n  isBefore,\r\n  differenceInMilliseconds,\r\n  addMilliseconds\r\n} from 'date-fns';\r\nimport debug from 'debug';\r\n\r\nconst log = debug('whitecross:api-utils');\r\n\r\n// Standard API response interface\r\nexport interface ApiResponse<T = unknown> {\r\n  success: boolean;\r\n  data: T;\r\n  message?: string;\r\n  errors?: Record<string, string[]>;\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrev: boolean;\r\n  };\r\n}\r\n\r\nexport interface ApiError {\r\n  message: string;\r\n  code?: string;\r\n  status?: number;\r\n  details?: unknown;\r\n}\r\n\r\n// Error handling utilities\r\nexport class ApiErrorHandler {\r\n  static handle(error: AxiosError | unknown): ApiError {\r\n    // Type guard to check if error is an AxiosError\r\n    const isAxiosError = (err: unknown): err is AxiosError => {\r\n      return err !== null && typeof err === 'object' && 'isAxiosError' in err;\r\n    };\r\n\r\n    if (isAxiosError(error) && error.response) {\r\n      // Server responded with error status\r\n      const { status, data } = error.response;\r\n\r\n      // Safely access data properties\r\n      const errorData = data as Record<string, unknown> | undefined;\r\n      const message = (errorData?.message as string) || `Request failed with status ${status}`;\r\n      const code = errorData?.code as string | undefined;\r\n      const errors = errorData?.errors as unknown;\r\n      const details = errors || errorData?.details as unknown;\r\n\r\n      return {\r\n        message,\r\n        code,\r\n        status,\r\n        details,\r\n      };\r\n    } else if (isAxiosError(error) && error.request) {\r\n      // Network error\r\n      return {\r\n        message: 'Network error - please check your connection',\r\n        code: 'NETWORK_ERROR',\r\n        details: error.request,\r\n      };\r\n    } else {\r\n      // Other error - safely access message if available\r\n      const message = (isAxiosError(error) && error.message) || 'An unexpected error occurred';\r\n      return {\r\n        message,\r\n        code: 'UNKNOWN_ERROR',\r\n        details: error,\r\n      };\r\n    }\r\n  }\r\n\r\n  static isNetworkError(error: ApiError): boolean {\r\n    return error.code === 'NETWORK_ERROR';\r\n  }\r\n\r\n  static isValidationError(error: ApiError): boolean {\r\n    return error.status === 400 && !!error.details;\r\n  }\r\n\r\n  static isUnauthorizedError(error: ApiError): boolean {\r\n    return error.status === 401;\r\n  }\r\n\r\n  static isForbiddenError(error: ApiError): boolean {\r\n    return error.status === 403;\r\n  }\r\n\r\n  static isNotFoundError(error: ApiError): boolean {\r\n    return error.status === 404;\r\n  }\r\n\r\n  static isServerError(error: ApiError): boolean {\r\n    return (error.status ?? 0) >= 500;\r\n  }\r\n}\r\n\r\n// Data extraction utilities\r\nexport const extractApiData = <T>(response: AxiosResponse<ApiResponse<T>>): T => {\r\n  if (response.data.success && response.data.data !== undefined) {\r\n    return response.data.data;\r\n  }\r\n  throw new Error('API request failed');\r\n};\r\n\r\nexport const extractApiDataOptional = <T>(\r\n  response: AxiosResponse<ApiResponse<T>>\r\n): T | null => {\r\n  try {\r\n    return extractApiData(response);\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\n// URL and query parameter utilities\r\nexport const buildUrlParams = (params: Record<string, unknown>): string => {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  Object.entries(params).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      urlParams.append(key, String(value));\r\n    }\r\n  });\r\n\r\n  const paramsString = urlParams.toString();\r\n  return paramsString ? `?${paramsString}` : '';\r\n};\r\n\r\nexport const buildPaginationParams = (\r\n  page: number = 1,\r\n  limit: number = 10,\r\n  sort?: string,\r\n  order?: 'asc' | 'desc'\r\n): string => {\r\n  const params: Record<string, unknown> = {\r\n    page,\r\n    limit,\r\n  };\r\n\r\n  if (sort) params.sort = sort;\r\n  if (order) params.order = order;\r\n\r\n  return buildUrlParams(params);\r\n};\r\n\r\n// Date formatting utilities with date-fns\r\nexport const formatDateForApi = (date: Date | string): string => {\r\n  try {\r\n    if (typeof date === 'string') {\r\n      // Try to parse as ISO string first\r\n      const parsed = parseISO(date);\r\n      if (isValid(parsed)) {\r\n        return formatISO(parsed);\r\n      }\r\n      // If not valid ISO, try as Date constructor\r\n      const fallback = new Date(date);\r\n      if (isValid(fallback)) {\r\n        return formatISO(fallback);\r\n      }\r\n      throw new Error('Invalid date format');\r\n    }\r\n\r\n    if (date instanceof Date) {\r\n      if (isValid(date)) {\r\n        return formatISO(date);\r\n      }\r\n      throw new Error('Invalid date');\r\n    }\r\n\r\n    throw new Error('Invalid date format');\r\n  } catch (error) {\r\n    log('Error formatting date for API:', error);\r\n    return formatISO(new Date()); // Fallback to current time\r\n  }\r\n};\r\n\r\nexport const parseDateFromApi = (dateString: string): Date => {\r\n  try {\r\n    const parsedDate = parseISO(dateString);\r\n    if (isValid(parsedDate)) {\r\n      return parsedDate;\r\n    }\r\n    // Fallback: try Date constructor\r\n    const fallback = new Date(dateString);\r\n    if (isValid(fallback)) {\r\n      return fallback;\r\n    }\r\n    throw new Error('Invalid date string');\r\n  } catch (error) {\r\n    log('Error parsing date from API:', error);\r\n    return new Date(); // Fallback to current date\r\n  }\r\n};\r\n\r\n// Enhanced date utilities\r\nexport const formatDateForDisplay = (date: Date | string): string => {\r\n  try {\r\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\r\n    if (isValid(dateObj)) {\r\n      return format(dateObj, 'MMM dd, yyyy');\r\n    }\r\n    return 'Invalid Date';\r\n  } catch (error) {\r\n    log('Error formatting date for display:', error);\r\n    return 'Invalid Date';\r\n  }\r\n};\r\n\r\nexport const formatDateTimeForDisplay = (date: Date | string): string => {\r\n  try {\r\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\r\n    if (isValid(dateObj)) {\r\n      return format(dateObj, 'MMM dd, yyyy HH:mm');\r\n    }\r\n    return 'Invalid Date';\r\n  } catch (error) {\r\n    log('Error formatting datetime for display:', error);\r\n    return 'Invalid Date';\r\n  }\r\n};\r\n\r\nexport const isDateExpired = (date: Date | string): boolean => {\r\n  try {\r\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\r\n    if (isValid(dateObj)) {\r\n      return isBefore(dateObj, new Date());\r\n    }\r\n    return false;\r\n  } catch (error) {\r\n    log('Error checking if date is expired:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const getTimeUntilExpiry = (date: Date | string): string => {\r\n  try {\r\n    const expiryDate = typeof date === 'string' ? parseISO(date) : date;\r\n    if (!isValid(expiryDate)) {\r\n      return 'Unknown';\r\n    }\r\n\r\n    const now = new Date();\r\n    const diff = differenceInMilliseconds(expiryDate, now);\r\n\r\n    if (diff <= 0) return 'Expired';\r\n\r\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\r\n    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\r\n\r\n    if (days > 0) return `${days}d ${hours}h`;\r\n    if (hours > 0) return `${hours}h ${minutes}m`;\r\n    return `${minutes}m`;\r\n  } catch (error) {\r\n    log('Error calculating time until expiry:', error);\r\n    return 'Unknown';\r\n  }\r\n};\r\n\r\n// Retry utility\r\nexport const withRetry = async <T>(\r\n  fn: () => Promise<T>,\r\n  maxRetries: number = 3,\r\n  delay: number = 1000\r\n): Promise<T> => {\r\n  let lastError: Error;\r\n\r\n  for (let i = 0; i <= maxRetries; i++) {\r\n    try {\r\n      return await fn();\r\n    } catch (error) {\r\n      lastError = error as Error;\r\n\r\n      if (i === maxRetries) {\r\n        throw lastError;\r\n      }\r\n\r\n      // Wait before retrying\r\n      await new Promise(resolve => setTimeout(resolve, delay * (i + 1)));\r\n    }\r\n  }\r\n\r\n  throw lastError!;\r\n};\r\n\r\n// Form data utility\r\nexport const createFormData = (data: Record<string, unknown>): FormData => {\r\n  const formData = new FormData();\r\n\r\n  Object.entries(data).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null) {\r\n      if (value instanceof File) {\r\n        formData.append(key, value);\r\n      } else if (Array.isArray(value)) {\r\n        value.forEach((item, index) => {\r\n          formData.append(`${key}[${index}]`, item);\r\n        });\r\n      } else {\r\n        formData.append(key, String(value));\r\n      }\r\n    }\r\n  });\r\n\r\n  return formData;\r\n};\r\n\r\n// Type guards\r\nexport const isApiResponse = (obj: unknown): obj is ApiResponse => {\r\n  return obj !== null && typeof obj === 'object' && 'success' in obj && 'data' in obj;\r\n};\r\n\r\nexport const isPaginatedResponse = <T>(obj: unknown): obj is PaginatedResponse<T> => {\r\n  return obj !== null && typeof obj === 'object' && 'data' in obj && 'pagination' in obj;\r\n};\r\n\r\n// Cache utilities (simple in-memory cache)\r\nclass ApiCache {\r\n  private cache = new Map<string, { data: unknown; timestamp: number; ttl: number }>();\r\n\r\n  set<T>(key: string, data: T, ttl: number = 5 * 60 * 1000): void {\r\n    this.cache.set(key, {\r\n      data,\r\n      timestamp: Date.now(),\r\n      ttl,\r\n    });\r\n  }\r\n\r\n  get<T>(key: string): T | null {\r\n    const item = this.cache.get(key);\r\n\r\n    if (!item) return null;\r\n\r\n    if (Date.now() - item.timestamp > item.ttl) {\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return item.data as T;\r\n  }\r\n\r\n  delete(key: string): void {\r\n    this.cache.delete(key);\r\n  }\r\n\r\n  clear(): void {\r\n    this.cache.clear();\r\n  }\r\n\r\n  // Generate cache key from URL and params\r\n  generateKey(url: string, params?: Record<string, unknown>): string {\r\n    const paramsString = params ? JSON.stringify(params) : '';\r\n    return `${url}:${paramsString}`;\r\n  }\r\n}\r\n\r\nexport const apiCache = new ApiCache();\r\n\r\n// Higher-order function to add caching to API calls\r\nexport const withCache = <T extends unknown[], R>(\r\n  fn: (...args: T) => Promise<R>\r\n) => {\r\n  return async (...args: T): Promise<R> => {\r\n    // For now, just call the function without caching\r\n    // In a real implementation, you'd want to generate a cache key from the args\r\n    return fn(...args);\r\n  };\r\n};\r\n\r\n// Debounce utility for search inputs\r\nexport const debounce = <T extends (...args: unknown[]) => unknown>(\r\n  func: T,\r\n  wait: number\r\n): ((...args: Parameters<T>) => void) => {\r\n  let timeout: NodeJS.Timeout;\r\n\r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func(...args), wait);\r\n  };\r\n};\r\n\r\n// Cancel token utility (deprecated in newer axios versions)\r\n// export const createCancelTokenSource = () => {\r\n//   return CancelToken.source();\r\n// };\r\n\r\n// Export error handler instance\r\nexport const handleApiError = ApiErrorHandler.handle;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5133, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/modules/accessControlApi.ts"],"sourcesContent":["/**\r\n * @fileoverview Access Control and RBAC Management API service\r\n * @module services/modules/accessControlApi\r\n * @category Services - Security & Access Control\r\n *\r\n * Provides comprehensive Role-Based Access Control (RBAC) management, security incident\r\n * tracking, session management, and IP restriction capabilities for the White Cross\r\n * healthcare platform. Implements enterprise-grade security controls with audit logging.\r\n *\r\n * Key Features:\r\n * - Role management (create, update, delete roles)\r\n * - Permission management (create and assign permissions)\r\n * - Role-Permission assignments (many-to-many relationship)\r\n * - User-Role assignments (dynamic role switching)\r\n * - Permission checking and validation\r\n * - Session management and tracking\r\n * - Security incident logging and monitoring\r\n * - IP restriction management (allowlist/blocklist)\r\n * - Security statistics and analytics\r\n * - Default role initialization\r\n *\r\n * RBAC Hierarchy:\r\n * - System Admin > District Admin > School Admin > Nurse > Counselor > Viewer\r\n * - Hierarchical role inheritance with permission aggregation\r\n * - Dynamic permission checking at runtime\r\n * - Resource-level and action-level permissions\r\n *\r\n * Security Features:\r\n * - Role-based permission enforcement on all endpoints\r\n * - Automatic audit logging for all access control changes\r\n * - Session tracking with IP and user agent logging\r\n * - Security incident classification (LOW, MEDIUM, HIGH, CRITICAL)\r\n * - IP restriction for enhanced security\r\n * - Multi-session management per user\r\n * - Automatic session expiration handling\r\n *\r\n * Permission Model:\r\n * - Resource-based permissions (e.g., 'students', 'medications', 'reports')\r\n * - Action-based permissions (e.g., 'read', 'create', 'update', 'delete')\r\n * - Combined permission format: 'resource:action' (e.g., 'students:read')\r\n * - Wildcard permissions supported ('*:*' for super admin)\r\n *\r\n * Security Incident Tracking:\r\n * - Failed login attempts monitoring\r\n * - Unauthorized access attempts logging\r\n * - Suspicious activity detection\r\n * - Incident severity classification\r\n * - Automatic alerting for critical incidents\r\n *\r\n * Session Management:\r\n * - Multi-device session support\r\n * - Session termination (single or all user sessions)\r\n * - Session activity tracking\r\n * - Automatic cleanup of expired sessions\r\n *\r\n * IP Restriction Management:\r\n * - IP allowlist for trusted networks\r\n * - IP blocklist for banned addresses\r\n * - CIDR notation support for network ranges\r\n * - Geographic IP filtering capabilities\r\n *\r\n * @example Setup RBAC for new user\r\n * ```typescript\r\n * import { accessControlApi } from '@/services/modules/accessControlApi';\r\n *\r\n * // Assign role to user\r\n * const assignment = await accessControlApi.assignRoleToUser(\r\n *   'user-uuid-123',\r\n *   'role-nurse-uuid'\r\n * );\r\n *\r\n * // Check user permissions\r\n * const hasAccess = await accessControlApi.checkPermission(\r\n *   'user-uuid-123',\r\n *   'students',\r\n *   'read'\r\n * );\r\n * console.log(`User can read students: ${hasAccess.hasPermission}`);\r\n * ```\r\n *\r\n * @example Manage user sessions\r\n * ```typescript\r\n * // Get all active sessions for user\r\n * const { sessions } = await accessControlApi.getUserSessions('user-uuid-123');\r\n * console.log(`Active sessions: ${sessions.length}`);\r\n *\r\n * // Terminate all sessions (force logout)\r\n * await accessControlApi.deleteAllUserSessions('user-uuid-123');\r\n * ```\r\n *\r\n * @example Track security incidents\r\n * ```typescript\r\n * const incidents = await accessControlApi.getSecurityIncidents({\r\n *   severity: 'HIGH',\r\n *   startDate: '2025-01-01',\r\n *   endDate: '2025-01-31'\r\n * });\r\n * console.log(`High severity incidents: ${incidents.total}`);\r\n * ```\r\n *\r\n * @see {@link usersApi} for user management operations\r\n * @see {@link authApi} for authentication operations\r\n * @see {@link Role} for role data type definition\r\n * @see {@link Permission} for permission data type definition\r\n */\r\n\r\nimport type {\r\n  Role,\r\n  Permission,\r\n  RolePermission,\r\n  Session,\r\n  SecurityIncident,\r\n  IpRestriction,\r\n  UserRoleAssignment,\r\n  CreateRoleData,\r\n  UpdateRoleData,\r\n  CreatePermissionData,\r\n  CreateSecurityIncidentData,\r\n  UpdateSecurityIncidentData,\r\n  AddIpRestrictionData,\r\n  SecurityIncidentFilters,\r\n  UserPermissionsResult,\r\n  SecurityStatistics,\r\n  SecurityIncidentsPaginatedResponse,\r\n  DeleteResponse,\r\n  DeleteSessionsResponse,\r\n  PermissionCheckResponse\r\n} from '@/types/accessControl'\r\nimport type { ApiClient } from '../core/ApiClient'\r\nimport { extractApiData, handleApiError } from '../utils/apiUtils'\r\n\r\n/**\r\n * Access Control API Interface\r\n * Defines all access control, RBAC, and security management operations\r\n */\r\nexport interface IAccessControlApi {\r\n  // Role Management\r\n  getRoles(): Promise<{ roles: Role[] }>;\r\n  getRoleById(id: string): Promise<{ role: Role }>;\r\n  createRole(data: CreateRoleData): Promise<{ role: Role }>;\r\n  updateRole(id: string, data: UpdateRoleData): Promise<{ role: Role }>;\r\n  deleteRole(id: string): Promise<DeleteResponse>;\r\n\r\n  // Permission Management\r\n  getPermissions(): Promise<{ permissions: Permission[] }>;\r\n  createPermission(data: CreatePermissionData): Promise<{ permission: Permission }>;\r\n\r\n  // Role-Permission Assignments\r\n  assignPermissionToRole(roleId: string, permissionId: string): Promise<{ rolePermission: RolePermission }>;\r\n  removePermissionFromRole(roleId: string, permissionId: string): Promise<DeleteResponse>;\r\n\r\n  // User-Role Assignments\r\n  assignRoleToUser(userId: string, roleId: string): Promise<{ userRole: UserRoleAssignment }>;\r\n  removeRoleFromUser(userId: string, roleId: string): Promise<DeleteResponse>;\r\n\r\n  // User Permissions\r\n  getUserPermissions(userId: string): Promise<UserPermissionsResult>;\r\n  checkPermission(userId: string, resource: string, action: string): Promise<PermissionCheckResponse>;\r\n\r\n  // Session Management\r\n  getUserSessions(userId: string): Promise<{ sessions: Session[] }>;\r\n  deleteSession(token: string): Promise<DeleteResponse>;\r\n  deleteAllUserSessions(userId: string): Promise<DeleteSessionsResponse>;\r\n\r\n  // Security Incidents\r\n  getSecurityIncidents(params?: SecurityIncidentFilters): Promise<SecurityIncidentsPaginatedResponse>;\r\n  createSecurityIncident(data: CreateSecurityIncidentData): Promise<{ incident: SecurityIncident }>;\r\n  updateSecurityIncident(id: string, data: UpdateSecurityIncidentData): Promise<{ incident: SecurityIncident }>;\r\n\r\n  // IP Restrictions\r\n  getIpRestrictions(): Promise<{ restrictions: IpRestriction[] }>;\r\n  addIpRestriction(data: AddIpRestrictionData): Promise<{ restriction: IpRestriction }>;\r\n  removeIpRestriction(id: string): Promise<DeleteResponse>;\r\n\r\n  // Statistics\r\n  getStatistics(): Promise<SecurityStatistics>;\r\n\r\n  // System Initialization\r\n  initializeDefaultRoles(): Promise<{ roles: Role[] }>;\r\n}\r\n\r\n/**\r\n * Access Control API implementation\r\n * Handles roles, permissions, sessions, and security management\r\n */\r\nclass AccessControlApiImpl implements IAccessControlApi {\r\n  constructor(private readonly client: ApiClient) {}\r\n\r\n  // Roles\r\n  /**\r\n   * Get all roles\r\n   */\r\n  async getRoles(): Promise<{ roles: Role[] }> {\r\n    try {\r\n      const response = await this.client.get('/access-control/roles')\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get role by ID\r\n   */\r\n  async getRoleById(id: string): Promise<{ role: Role }> {\r\n    try {\r\n      const response = await this.client.get(`/access-control/roles/${id}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a new role\r\n   */\r\n  async createRole(data: CreateRoleData): Promise<{ role: Role }> {\r\n    try {\r\n      const response = await this.client.post('/access-control/roles', data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update an existing role\r\n   */\r\n  async updateRole(id: string, data: UpdateRoleData): Promise<{ role: Role }> {\r\n    try {\r\n      const response = await this.client.put(`/access-control/roles/${id}`, data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete a role\r\n   */\r\n  async deleteRole(id: string): Promise<DeleteResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/roles/${id}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Permissions\r\n  /**\r\n   * Get all permissions\r\n   */\r\n  async getPermissions(): Promise<{ permissions: Permission[] }> {\r\n    try {\r\n      const response = await this.client.get('/access-control/permissions')\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a new permission\r\n   */\r\n  async createPermission(data: CreatePermissionData): Promise<{ permission: Permission }> {\r\n    try {\r\n      const response = await this.client.post('/access-control/permissions', data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Role-Permission Assignments\r\n  /**\r\n   * Assign permission to role\r\n   */\r\n  async assignPermissionToRole(roleId: string, permissionId: string): Promise<{ rolePermission: RolePermission }> {\r\n    try {\r\n      const response = await this.client.post(`/access-control/roles/${roleId}/permissions/${permissionId}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove permission from role\r\n   */\r\n  async removePermissionFromRole(roleId: string, permissionId: string): Promise<DeleteResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/roles/${roleId}/permissions/${permissionId}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // User-Role Assignments\r\n  /**\r\n   * Assign role to user\r\n   */\r\n  async assignRoleToUser(userId: string, roleId: string): Promise<{ userRole: UserRoleAssignment }> {\r\n    try {\r\n      const response = await this.client.post(`/access-control/users/${userId}/roles/${roleId}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove role from user\r\n   */\r\n  async removeRoleFromUser(userId: string, roleId: string): Promise<DeleteResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/users/${userId}/roles/${roleId}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // User Permissions\r\n  /**\r\n   * Get user permissions\r\n   */\r\n  async getUserPermissions(userId: string): Promise<UserPermissionsResult> {\r\n    try {\r\n      const response = await this.client.get(`/access-control/users/${userId}/permissions`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user has specific permission\r\n   */\r\n  async checkPermission(userId: string, resource: string, action: string): Promise<PermissionCheckResponse> {\r\n    try {\r\n      const response = await this.client.get(`/access-control/users/${userId}/check`, {\r\n        params: { resource, action }\r\n      })\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Sessions\r\n  /**\r\n   * Get user sessions\r\n   */\r\n  async getUserSessions(userId: string): Promise<{ sessions: Session[] }> {\r\n    try {\r\n      const response = await this.client.get(`/access-control/users/${userId}/sessions`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete a specific session\r\n   */\r\n  async deleteSession(token: string): Promise<DeleteResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/sessions/${token}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete all user sessions\r\n   */\r\n  async deleteAllUserSessions(userId: string): Promise<DeleteSessionsResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/users/${userId}/sessions`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Security Incidents\r\n  /**\r\n   * Get security incidents with optional filters\r\n   */\r\n  async getSecurityIncidents(params?: SecurityIncidentFilters): Promise<SecurityIncidentsPaginatedResponse> {\r\n    try {\r\n      const response = await this.client.get('/access-control/security-incidents', { params })\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create security incident\r\n   */\r\n  async createSecurityIncident(data: CreateSecurityIncidentData): Promise<{ incident: SecurityIncident }> {\r\n    try {\r\n      const response = await this.client.post('/access-control/security-incidents', data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update security incident\r\n   */\r\n  async updateSecurityIncident(id: string, data: UpdateSecurityIncidentData): Promise<{ incident: SecurityIncident }> {\r\n    try {\r\n      const response = await this.client.put(`/access-control/security-incidents/${id}`, data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // IP Restrictions\r\n  /**\r\n   * Get IP restrictions\r\n   */\r\n  async getIpRestrictions(): Promise<{ restrictions: IpRestriction[] }> {\r\n    try {\r\n      const response = await this.client.get('/access-control/ip-restrictions')\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add IP restriction\r\n   */\r\n  async addIpRestriction(data: AddIpRestrictionData): Promise<{ restriction: IpRestriction }> {\r\n    try {\r\n      const response = await this.client.post('/access-control/ip-restrictions', data)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove IP restriction\r\n   */\r\n  async removeIpRestriction(id: string): Promise<DeleteResponse> {\r\n    try {\r\n      const response = await this.client.delete(`/access-control/ip-restrictions/${id}`)\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Statistics\r\n  /**\r\n   * Get comprehensive security statistics\r\n   */\r\n  async getStatistics(): Promise<SecurityStatistics> {\r\n    try {\r\n      const response = await this.client.get('/access-control/statistics')\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n\r\n  // Initialize default roles\r\n  /**\r\n   * Initialize default system roles\r\n   */\r\n  async initializeDefaultRoles(): Promise<{ roles: Role[] }> {\r\n    try {\r\n      const response = await this.client.post('/access-control/initialize-roles')\r\n      return response.data\r\n    } catch (error) {\r\n      throw handleApiError(error as any)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Factory function to create Access Control API instance\r\n * @param client - ApiClient instance with authentication and resilience patterns\r\n * @returns Configured AccessControlApi instance\r\n */\r\nexport function createAccessControlApi(client: ApiClient): AccessControlApiImpl {\r\n  return new AccessControlApiImpl(client)\r\n}\r\n\r\n// Export class and interface for direct usage\r\nexport { AccessControlApiImpl }\r\nexport type { IAccessControlApi }\r\n\r\n// Export singleton instance\r\nimport { apiClient } from '../core/ApiClient'\r\nexport const accessControlApi = createAccessControlApi(apiClient)\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5525, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/stores/accessControlSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Optimized Access Control Management Redux Slice\r\n * @module identity-access/stores/accessControlSlice\r\n *\r\n * OPTIMIZATIONS APPLIED:\r\n * âœ… Replaced all 'any' types with proper TypeScript interfaces\r\n * âœ… Added memoized selectors with createSelector\r\n * âœ… Improved type safety throughout\r\n * âœ… Better error handling\r\n * âœ… Normalized state structure for performance\r\n *\r\n * This slice manages comprehensive access control functionality for the healthcare management system,\r\n * including role-based access control (RBAC), permissions management, security incident tracking,\r\n * session management, and audit logging.\r\n */\r\n\r\nimport { createSlice, createAsyncThunk, PayloadAction, createSelector } from '@reduxjs/toolkit';\r\nimport { RootState } from '@/stores/store';\r\nimport { accessControlApi } from '@/services/modules/accessControlApi';\r\nimport {\r\n  Role,\r\n  Permission,\r\n  SecurityIncident,\r\n  UserSession,\r\n  IpRestriction,\r\n  RolePermission,\r\n  UserRole,\r\n  AccessControlStatistics,\r\n  IncidentFilters,\r\n  SessionFilters,\r\n  PaginationInfo,\r\n  Notification,\r\n  CreateRolePayload,\r\n  UpdateRolePayload,\r\n  CreatePermissionPayload,\r\n  CreateSecurityIncidentPayload,\r\n  UpdateSecurityIncidentPayload,\r\n  CreateIpRestrictionPayload,\r\n  UpdateRoleArgs,\r\n  UpdateSecurityIncidentArgs,\r\n  AssignPermissionArgs,\r\n  RemovePermissionArgs,\r\n  AssignRoleArgs,\r\n  RemoveRoleArgs,\r\n  CheckPermissionArgs,\r\n  SecurityIncidentQueryParams,\r\n  PermissionCheckResult,\r\n  UserPermissionsResponse,\r\n} from './types/accessControl.types';\r\n\r\n// ==========================================\r\n// STATE INTERFACE\r\n// ==========================================\r\n\r\ninterface AccessControlState {\r\n  roles: Role[];\r\n  permissions: Permission[];\r\n  securityIncidents: SecurityIncident[];\r\n  sessions: UserSession[];\r\n  ipRestrictions: IpRestriction[];\r\n  statistics: AccessControlStatistics | null;\r\n  selectedRole: Role | null;\r\n  selectedPermission: Permission | null;\r\n  selectedIncident: SecurityIncident | null;\r\n  filters: {\r\n    incidents: IncidentFilters;\r\n    sessions: SessionFilters;\r\n  };\r\n  pagination: {\r\n    roles: PaginationInfo;\r\n    permissions: PaginationInfo;\r\n    incidents: PaginationInfo;\r\n    sessions: PaginationInfo;\r\n  };\r\n  loading: {\r\n    roles: boolean;\r\n    permissions: boolean;\r\n    incidents: boolean;\r\n    sessions: boolean;\r\n    statistics: boolean;\r\n    operations: boolean;\r\n  };\r\n  error: string | null;\r\n  notifications: Notification[];\r\n}\r\n\r\n// ==========================================\r\n// INITIAL STATE\r\n// ==========================================\r\n\r\nconst initialState: AccessControlState = {\r\n  roles: [],\r\n  permissions: [],\r\n  securityIncidents: [],\r\n  sessions: [],\r\n  ipRestrictions: [],\r\n  statistics: null,\r\n  selectedRole: null,\r\n  selectedPermission: null,\r\n  selectedIncident: null,\r\n  filters: {\r\n    incidents: {},\r\n    sessions: {},\r\n  },\r\n  pagination: {\r\n    roles: { page: 1, limit: 20, total: 0 },\r\n    permissions: { page: 1, limit: 20, total: 0 },\r\n    incidents: { page: 1, limit: 20, total: 0 },\r\n    sessions: { page: 1, limit: 20, total: 0 },\r\n  },\r\n  loading: {\r\n    roles: false,\r\n    permissions: false,\r\n    incidents: false,\r\n    sessions: false,\r\n    statistics: false,\r\n    operations: false,\r\n  },\r\n  error: null,\r\n  notifications: [],\r\n};\r\n\r\n// ==========================================\r\n// ASYNC THUNKS (properly typed)\r\n// ==========================================\r\n\r\n// Roles\r\nexport const fetchRoles = createAsyncThunk<Role[], void, { rejectValue: string }>(\r\n  'accessControl/fetchRoles',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getRoles();\r\n      return response.roles;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch roles';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const fetchRoleById = createAsyncThunk<Role, string, { rejectValue: string }>(\r\n  'accessControl/fetchRoleById',\r\n  async (id, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getRoleById(id);\r\n      return response.role;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createRole = createAsyncThunk<Role, CreateRolePayload, { rejectValue: string }>(\r\n  'accessControl/createRole',\r\n  async (roleData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.createRole(roleData);\r\n      return response.role;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to create role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const updateRole = createAsyncThunk<\r\n  Role,\r\n  UpdateRoleArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/updateRole',\r\n  async ({ id, updates }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.updateRole(id, updates);\r\n      return response.role;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to update role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const deleteRole = createAsyncThunk<string, string, { rejectValue: string }>(\r\n  'accessControl/deleteRole',\r\n  async (id, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.deleteRole(id);\r\n      return id;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to delete role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Permissions\r\nexport const fetchPermissions = createAsyncThunk<Permission[], void, { rejectValue: string }>(\r\n  'accessControl/fetchPermissions',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getPermissions();\r\n      return response.permissions;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch permissions';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createPermission = createAsyncThunk<\r\n  Permission,\r\n  CreatePermissionPayload,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/createPermission',\r\n  async (permissionData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.createPermission(permissionData);\r\n      return response.permission;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to create permission';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Role-Permission assignments\r\nexport const assignPermissionToRole = createAsyncThunk<\r\n  RolePermission,\r\n  AssignPermissionArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/assignPermissionToRole',\r\n  async ({ roleId, permissionId }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.assignPermissionToRole(roleId, permissionId);\r\n      return response.rolePermission;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to assign permission to role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const removePermissionFromRole = createAsyncThunk<\r\n  RemovePermissionArgs,\r\n  RemovePermissionArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/removePermissionFromRole',\r\n  async ({ roleId, permissionId }, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.removePermissionFromRole(roleId, permissionId);\r\n      return { roleId, permissionId };\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to remove permission from role';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// User-Role assignments\r\nexport const assignRoleToUser = createAsyncThunk<\r\n  UserRole,\r\n  AssignRoleArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/assignRoleToUser',\r\n  async ({ userId, roleId }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.assignRoleToUser(userId, roleId);\r\n      return response.userRole;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to assign role to user';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const removeRoleFromUser = createAsyncThunk<\r\n  RemoveRoleArgs,\r\n  RemoveRoleArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/removeRoleFromUser',\r\n  async ({ userId, roleId }, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.removeRoleFromUser(userId, roleId);\r\n      return { userId, roleId };\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to remove role from user';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// User permissions\r\nexport const fetchUserPermissions = createAsyncThunk<\r\n  UserPermissionsResponse,\r\n  string,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/fetchUserPermissions',\r\n  async (userId, { rejectWithValue }) => {\r\n    try {\r\n      return await accessControlApi.getUserPermissions(userId);\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch user permissions';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const checkUserPermission = createAsyncThunk<\r\n  PermissionCheckResult,\r\n  CheckPermissionArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/checkUserPermission',\r\n  async ({ userId, resource, action }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.checkPermission(userId, resource, action);\r\n      return { userId, resource, action, hasPermission: response.hasPermission };\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to check permission';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Sessions\r\nexport const fetchUserSessions = createAsyncThunk<UserSession[], string, { rejectValue: string }>(\r\n  'accessControl/fetchUserSessions',\r\n  async (userId, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getUserSessions(userId);\r\n      return response.sessions;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch sessions';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const deleteSession = createAsyncThunk<string, string, { rejectValue: string }>(\r\n  'accessControl/deleteSession',\r\n  async (token, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.deleteSession(token);\r\n      return token;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to delete session';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const deleteAllUserSessions = createAsyncThunk<void, string, { rejectValue: string }>(\r\n  'accessControl/deleteAllUserSessions',\r\n  async (userId, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.deleteAllUserSessions(userId);\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to delete all user sessions';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Security incidents\r\nexport const fetchSecurityIncidents = createAsyncThunk<\r\n  { incidents: SecurityIncident[]; pagination?: PaginationInfo },\r\n  SecurityIncidentQueryParams | undefined,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/fetchSecurityIncidents',\r\n  async (params, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getSecurityIncidents(params);\r\n      return response;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch security incidents';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const createSecurityIncident = createAsyncThunk<\r\n  SecurityIncident,\r\n  CreateSecurityIncidentPayload,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/createSecurityIncident',\r\n  async (incidentData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.createSecurityIncident(incidentData);\r\n      return response.incident;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to create security incident';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const updateSecurityIncident = createAsyncThunk<\r\n  SecurityIncident,\r\n  UpdateSecurityIncidentArgs,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/updateSecurityIncident',\r\n  async ({ id, updates }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.updateSecurityIncident(id, updates);\r\n      return response.incident;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to update security incident';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// IP restrictions\r\nexport const fetchIpRestrictions = createAsyncThunk<IpRestriction[], void, { rejectValue: string }>(\r\n  'accessControl/fetchIpRestrictions',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.getIpRestrictions();\r\n      return response.restrictions;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch IP restrictions';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const addIpRestriction = createAsyncThunk<\r\n  IpRestriction,\r\n  CreateIpRestrictionPayload,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/addIpRestriction',\r\n  async (restrictionData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.addIpRestriction(restrictionData);\r\n      return response.restriction;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to add IP restriction';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\nexport const removeIpRestriction = createAsyncThunk<string, string, { rejectValue: string }>(\r\n  'accessControl/removeIpRestriction',\r\n  async (id, { rejectWithValue }) => {\r\n    try {\r\n      await accessControlApi.removeIpRestriction(id);\r\n      return id;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to remove IP restriction';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Statistics\r\nexport const fetchAccessControlStatistics = createAsyncThunk<\r\n  AccessControlStatistics,\r\n  void,\r\n  { rejectValue: string }\r\n>(\r\n  'accessControl/fetchStatistics',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      return await accessControlApi.getStatistics();\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to fetch statistics';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// Default roles initialization\r\nexport const initializeDefaultRoles = createAsyncThunk<Role[], void, { rejectValue: string }>(\r\n  'accessControl/initializeDefaultRoles',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await accessControlApi.initializeDefaultRoles();\r\n      return response.roles;\r\n    } catch (error) {\r\n      const message = error instanceof Error ? error.message : 'Failed to initialize default roles';\r\n      return rejectWithValue(message);\r\n    }\r\n  }\r\n);\r\n\r\n// ==========================================\r\n// SLICE DEFINITION\r\n// ==========================================\r\n\r\nconst accessControlSlice = createSlice({\r\n  name: 'accessControl',\r\n  initialState,\r\n  reducers: {\r\n    setSelectedRole: (state, action: PayloadAction<Role | null>) => {\r\n      state.selectedRole = action.payload;\r\n    },\r\n    setSelectedPermission: (state, action: PayloadAction<Permission | null>) => {\r\n      state.selectedPermission = action.payload;\r\n    },\r\n    setSelectedIncident: (state, action: PayloadAction<SecurityIncident | null>) => {\r\n      state.selectedIncident = action.payload;\r\n    },\r\n    setIncidentFilters: (state, action: PayloadAction<Partial<IncidentFilters>>) => {\r\n      state.filters.incidents = { ...state.filters.incidents, ...action.payload };\r\n    },\r\n    setSessionFilters: (state, action: PayloadAction<Partial<SessionFilters>>) => {\r\n      state.filters.sessions = { ...state.filters.sessions, ...action.payload };\r\n    },\r\n    setRolesPagination: (state, action: PayloadAction<Partial<PaginationInfo>>) => {\r\n      state.pagination.roles = { ...state.pagination.roles, ...action.payload };\r\n    },\r\n    setPermissionsPagination: (state, action: PayloadAction<Partial<PaginationInfo>>) => {\r\n      state.pagination.permissions = { ...state.pagination.permissions, ...action.payload };\r\n    },\r\n    setIncidentsPagination: (state, action: PayloadAction<Partial<PaginationInfo>>) => {\r\n      state.pagination.incidents = { ...state.pagination.incidents, ...action.payload };\r\n    },\r\n    setSessionsPagination: (state, action: PayloadAction<Partial<PaginationInfo>>) => {\r\n      state.pagination.sessions = { ...state.pagination.sessions, ...action.payload };\r\n    },\r\n    clearError: (state) => {\r\n      state.error = null;\r\n    },\r\n    addNotification: (state, action: PayloadAction<Omit<Notification, 'id' | 'timestamp'>>) => {\r\n      const notification: Notification = {\r\n        ...action.payload,\r\n        id: `notification_${Date.now()}_${Math.random()}`,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n      state.notifications.push(notification);\r\n    },\r\n    removeNotification: (state, action: PayloadAction<string>) => {\r\n      state.notifications = state.notifications.filter((n: Notification) => n.id !== action.payload);\r\n    },\r\n    clearNotifications: (state) => {\r\n      state.notifications = [];\r\n    },\r\n    clearFilters: (state) => {\r\n      state.filters = {\r\n        incidents: {},\r\n        sessions: {},\r\n      };\r\n    },\r\n    resetState: () => initialState,\r\n  },\r\n  extraReducers: (builder) => {\r\n    // Roles\r\n    builder\r\n      .addCase(fetchRoles.pending, (state) => {\r\n        state.loading.roles = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchRoles.fulfilled, (state, action) => {\r\n        state.loading.roles = false;\r\n        state.roles = action.payload;\r\n      })\r\n      .addCase(fetchRoles.rejected, (state, action) => {\r\n        state.loading.roles = false;\r\n        state.error = action.payload || 'Failed to fetch roles';\r\n      })\r\n\r\n      // Role by ID\r\n      .addCase(fetchRoleById.pending, (state) => {\r\n        state.loading.operations = true;\r\n      })\r\n      .addCase(fetchRoleById.fulfilled, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.selectedRole = action.payload;\r\n      })\r\n      .addCase(fetchRoleById.rejected, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.error = action.payload || 'Failed to fetch role';\r\n      })\r\n\r\n      // Create role\r\n      .addCase(createRole.pending, (state) => {\r\n        state.loading.operations = true;\r\n      })\r\n      .addCase(createRole.fulfilled, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.roles.push(action.payload);\r\n      })\r\n      .addCase(createRole.rejected, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.error = action.payload || 'Failed to create role';\r\n      })\r\n\r\n      // Update role\r\n      .addCase(updateRole.pending, (state) => {\r\n        state.loading.operations = true;\r\n      })\r\n      .addCase(updateRole.fulfilled, (state, action) => {\r\n        state.loading.operations = false;\r\n        const index = state.roles.findIndex((r) => r.id === action.payload.id);\r\n        if (index !== -1) {\r\n          state.roles[index] = action.payload;\r\n        }\r\n        if (state.selectedRole?.id === action.payload.id) {\r\n          state.selectedRole = action.payload;\r\n        }\r\n      })\r\n      .addCase(updateRole.rejected, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.error = action.payload || 'Failed to update role';\r\n      })\r\n\r\n      // Delete role\r\n      .addCase(deleteRole.pending, (state) => {\r\n        state.loading.operations = true;\r\n      })\r\n      .addCase(deleteRole.fulfilled, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.roles = state.roles.filter((r) => r.id !== action.payload);\r\n        if (state.selectedRole?.id === action.payload) {\r\n          state.selectedRole = null;\r\n        }\r\n      })\r\n      .addCase(deleteRole.rejected, (state, action) => {\r\n        state.loading.operations = false;\r\n        state.error = action.payload || 'Failed to delete role';\r\n      })\r\n\r\n      // Permissions\r\n      .addCase(fetchPermissions.pending, (state) => {\r\n        state.loading.permissions = true;\r\n      })\r\n      .addCase(fetchPermissions.fulfilled, (state, action) => {\r\n        state.loading.permissions = false;\r\n        state.permissions = action.payload;\r\n      })\r\n      .addCase(fetchPermissions.rejected, (state, action) => {\r\n        state.loading.permissions = false;\r\n        state.error = action.payload || 'Failed to fetch permissions';\r\n      })\r\n\r\n      // Create permission\r\n      .addCase(createPermission.fulfilled, (state, action) => {\r\n        state.permissions.push(action.payload);\r\n      })\r\n\r\n      // Security incidents\r\n      .addCase(fetchSecurityIncidents.pending, (state) => {\r\n        state.loading.incidents = true;\r\n      })\r\n      .addCase(fetchSecurityIncidents.fulfilled, (state, action) => {\r\n        state.loading.incidents = false;\r\n        state.securityIncidents = action.payload.incidents;\r\n        if (action.payload.pagination) {\r\n          state.pagination.incidents = {\r\n            ...state.pagination.incidents,\r\n            ...action.payload.pagination,\r\n          };\r\n        }\r\n      })\r\n      .addCase(fetchSecurityIncidents.rejected, (state, action) => {\r\n        state.loading.incidents = false;\r\n        state.error = action.payload || 'Failed to fetch security incidents';\r\n      })\r\n\r\n      // Create security incident\r\n      .addCase(createSecurityIncident.fulfilled, (state, action) => {\r\n        state.securityIncidents.push(action.payload);\r\n      })\r\n\r\n      // Update security incident\r\n      .addCase(updateSecurityIncident.fulfilled, (state, action) => {\r\n        const index = state.securityIncidents.findIndex((i) => i.id === action.payload.id);\r\n        if (index !== -1) {\r\n          state.securityIncidents[index] = action.payload;\r\n        }\r\n        if (state.selectedIncident?.id === action.payload.id) {\r\n          state.selectedIncident = action.payload;\r\n        }\r\n      })\r\n\r\n      // Sessions\r\n      .addCase(fetchUserSessions.pending, (state) => {\r\n        state.loading.sessions = true;\r\n      })\r\n      .addCase(fetchUserSessions.fulfilled, (state, action) => {\r\n        state.loading.sessions = false;\r\n        state.sessions = action.payload;\r\n      })\r\n      .addCase(fetchUserSessions.rejected, (state, action) => {\r\n        state.loading.sessions = false;\r\n        state.error = action.payload || 'Failed to fetch sessions';\r\n      })\r\n\r\n      // Delete session\r\n      .addCase(deleteSession.fulfilled, (state, action) => {\r\n        state.sessions = state.sessions.filter((s) => s.token !== action.payload);\r\n      })\r\n\r\n      // IP restrictions\r\n      .addCase(fetchIpRestrictions.fulfilled, (state, action) => {\r\n        state.ipRestrictions = action.payload;\r\n      })\r\n\r\n      // Add IP restriction\r\n      .addCase(addIpRestriction.fulfilled, (state, action) => {\r\n        state.ipRestrictions.push(action.payload);\r\n      })\r\n\r\n      // Remove IP restriction\r\n      .addCase(removeIpRestriction.fulfilled, (state, action) => {\r\n        state.ipRestrictions = state.ipRestrictions.filter((r) => r.id !== action.payload);\r\n      })\r\n\r\n      // Statistics\r\n      .addCase(fetchAccessControlStatistics.pending, (state) => {\r\n        state.loading.statistics = true;\r\n      })\r\n      .addCase(fetchAccessControlStatistics.fulfilled, (state, action) => {\r\n        state.loading.statistics = false;\r\n        state.statistics = action.payload;\r\n      })\r\n      .addCase(fetchAccessControlStatistics.rejected, (state, action) => {\r\n        state.loading.statistics = false;\r\n        state.error = action.payload || 'Failed to fetch statistics';\r\n      })\r\n\r\n      // Initialize default roles\r\n      .addCase(initializeDefaultRoles.fulfilled, (state, action) => {\r\n        state.roles = [...state.roles, ...action.payload];\r\n      });\r\n  },\r\n});\r\n\r\n// ==========================================\r\n// ACTIONS EXPORT\r\n// ==========================================\r\n\r\nexport const {\r\n  setSelectedRole,\r\n  setSelectedPermission,\r\n  setSelectedIncident,\r\n  setIncidentFilters,\r\n  setSessionFilters,\r\n  setRolesPagination,\r\n  setPermissionsPagination,\r\n  setIncidentsPagination,\r\n  setSessionsPagination,\r\n  clearError,\r\n  addNotification,\r\n  removeNotification,\r\n  clearNotifications,\r\n  clearFilters,\r\n  resetState,\r\n} = accessControlSlice.actions;\r\n\r\n// ==========================================\r\n// BASIC SELECTORS\r\n// ==========================================\r\n\r\nexport const selectAccessControlState = (state: RootState): AccessControlState =>\r\n  state.accessControl;\r\n\r\nexport const selectRoles = (state: RootState): Role[] => state.accessControl.roles;\r\n\r\nexport const selectPermissions = (state: RootState): Permission[] =>\r\n  state.accessControl.permissions;\r\n\r\nexport const selectSecurityIncidents = (state: RootState): SecurityIncident[] =>\r\n  state.accessControl.securityIncidents;\r\n\r\nexport const selectSessions = (state: RootState): UserSession[] => state.accessControl.sessions;\r\n\r\nexport const selectIpRestrictions = (state: RootState): IpRestriction[] =>\r\n  state.accessControl.ipRestrictions;\r\n\r\nexport const selectStatistics = (state: RootState): AccessControlStatistics | null =>\r\n  state.accessControl.statistics;\r\n\r\nexport const selectSelectedRole = (state: RootState): Role | null =>\r\n  state.accessControl.selectedRole;\r\n\r\nexport const selectSelectedPermission = (state: RootState): Permission | null =>\r\n  state.accessControl.selectedPermission;\r\n\r\nexport const selectSelectedIncident = (state: RootState): SecurityIncident | null =>\r\n  state.accessControl.selectedIncident;\r\n\r\nexport const selectIncidentFilters = (state: RootState): IncidentFilters =>\r\n  state.accessControl.filters.incidents;\r\n\r\nexport const selectSessionFilters = (state: RootState): SessionFilters =>\r\n  state.accessControl.filters.sessions;\r\n\r\nexport const selectRolesPagination = (state: RootState): PaginationInfo =>\r\n  state.accessControl.pagination.roles;\r\n\r\nexport const selectPermissionsPagination = (state: RootState): PaginationInfo =>\r\n  state.accessControl.pagination.permissions;\r\n\r\nexport const selectIncidentsPagination = (state: RootState): PaginationInfo =>\r\n  state.accessControl.pagination.incidents;\r\n\r\nexport const selectSessionsPagination = (state: RootState): PaginationInfo =>\r\n  state.accessControl.pagination.sessions;\r\n\r\nexport const selectLoading = (state: RootState): AccessControlState['loading'] =>\r\n  state.accessControl.loading;\r\n\r\nexport const selectError = (state: RootState): string | null => state.accessControl.error;\r\n\r\nexport const selectNotifications = (state: RootState): Notification[] =>\r\n  state.accessControl.notifications;\r\n\r\n// ==========================================\r\n// MEMOIZED SELECTORS (using createSelector)\r\n// ==========================================\r\n\r\n/**\r\n * Select only active roles (performance optimized)\r\n */\r\nexport const selectActiveRoles = createSelector([selectRoles], (roles) =>\r\n  roles.filter((role) => role.isActive)\r\n);\r\n\r\n/**\r\n * Select critical and high severity incidents (performance optimized)\r\n */\r\nexport const selectCriticalIncidents = createSelector([selectSecurityIncidents], (incidents) =>\r\n  incidents.filter(\r\n    (incident) => incident.severity === 'CRITICAL' || incident.severity === 'HIGH'\r\n  )\r\n);\r\n\r\n/**\r\n * Select only active sessions (performance optimized)\r\n */\r\nexport const selectActiveSessions = createSelector([selectSessions], (sessions) =>\r\n  sessions.filter((session) => session.isActive)\r\n);\r\n\r\n/**\r\n * Select filtered incidents based on current filters (performance optimized)\r\n */\r\nexport const selectFilteredIncidents = createSelector(\r\n  [selectSecurityIncidents, selectIncidentFilters],\r\n  (incidents, filters) => {\r\n    let filtered = incidents;\r\n\r\n    if (filters.severity) {\r\n      filtered = filtered.filter((incident) => incident.severity === filters.severity);\r\n    }\r\n\r\n    if (filters.type) {\r\n      filtered = filtered.filter((incident) => incident.type === filters.type);\r\n    }\r\n\r\n    if (filters.userId) {\r\n      filtered = filtered.filter((incident) => incident.userId === filters.userId);\r\n    }\r\n\r\n    if (filters.startDate && filters.endDate) {\r\n      const startDate = new Date(filters.startDate);\r\n      const endDate = new Date(filters.endDate);\r\n      filtered = filtered.filter((incident) => {\r\n        const incidentDate = new Date(incident.createdAt);\r\n        return incidentDate >= startDate && incidentDate <= endDate;\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }\r\n);\r\n\r\n/**\r\n * Select filtered sessions based on current filters (performance optimized)\r\n */\r\nexport const selectFilteredSessions = createSelector(\r\n  [selectSessions, selectSessionFilters],\r\n  (sessions, filters) => {\r\n    let filtered = sessions;\r\n\r\n    if (filters.userId) {\r\n      filtered = filtered.filter((session) => session.userId === filters.userId);\r\n    }\r\n\r\n    if (filters.isActive !== undefined) {\r\n      filtered = filtered.filter((session) => session.isActive === filters.isActive);\r\n    }\r\n\r\n    return filtered;\r\n  }\r\n);\r\n\r\n/**\r\n * Select security metrics (performance optimized)\r\n */\r\nexport const selectSecurityMetrics = createSelector(\r\n  [selectRoles, selectPermissions, selectSecurityIncidents, selectSessions],\r\n  (roles, permissions, incidents, sessions) => {\r\n    const totalRoles = roles.length;\r\n    const activeRoles = roles.filter((r) => r.isActive).length;\r\n    const totalPermissions = permissions.length;\r\n\r\n    const recentIncidents = incidents.filter(\r\n      (incident) => new Date(incident.createdAt) > new Date(Date.now() - 24 * 60 * 60 * 1000)\r\n    ).length;\r\n\r\n    const criticalIncidents = incidents.filter((incident) => incident.severity === 'CRITICAL')\r\n      .length;\r\n\r\n    const activeSessions = sessions.filter((s) => s.isActive).length;\r\n\r\n    return {\r\n      totalRoles,\r\n      activeRoles,\r\n      totalPermissions,\r\n      recentIncidents,\r\n      criticalIncidents,\r\n      activeSessions,\r\n      securityScore: criticalIncidents > 0 ? Math.max(0, 100 - criticalIncidents * 10) : 100,\r\n    };\r\n  }\r\n);\r\n\r\n/**\r\n * Select role by ID (memoized)\r\n */\r\nexport const selectRoleById = (roleId: string) =>\r\n  createSelector([selectRoles], (roles) => roles.find((role) => role.id === roleId) || null);\r\n\r\n/**\r\n * Select permission by ID (memoized)\r\n */\r\nexport const selectPermissionById = (permissionId: string) =>\r\n  createSelector(\r\n    [selectPermissions],\r\n    (permissions) => permissions.find((perm) => perm.id === permissionId) || null\r\n  );\r\n\r\n// ==========================================\r\n// REDUCER EXPORT\r\n// ==========================================\r\n\r\nexport default accessControlSlice.reducer;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6264, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/stores/index.ts"],"sourcesContent":["/**\r\n * @fileoverview Identity Access - Stores Barrel Export\r\n * @module identity-access/stores\r\n * \r\n * Note: For specific actions and types, import directly from the slice files\r\n * to avoid naming conflicts and maintain explicit imports.\r\n */\r\n\r\n// Export reducers for Redux store configuration\r\nexport { default as authReducer } from './authSlice';\r\nexport { default as accessControlReducer } from './accessControlSlice';\r\n\r\n// Re-export slice modules for direct access to actions/types\r\nexport * as authSlice from './authSlice';\r\nexport * as accessControlSlice from './accessControlSlice';\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC,GAED,gDAAgD;;AAChD;AACA","debugId":null}},
    {"offset": {"line": 6300, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/sliceFactory.ts"],"sourcesContent":["/**\r\n * @fileoverview Redux Slice Factory for Standardized Entity Management\r\n * @module stores/sliceFactory\r\n * @category Store - Factories\r\n *\r\n * Comprehensive factory functions for creating Redux Toolkit slices with standardized\r\n * CRUD operations, normalized state management using EntityAdapter, and built-in\r\n * async thunk generation. Dramatically reduces boilerplate while ensuring consistency\r\n * across all entity slices in the application.\r\n *\r\n * Key Features:\r\n * - **Standardized CRUD Operations**: Auto-generated create, read, update, delete thunks\r\n * - **Normalized State**: RTK EntityAdapter for optimized lookups and updates\r\n * - **Bulk Operations**: Optional bulk delete and bulk update support\r\n * - **Loading States**: Granular loading tracking for each operation type\r\n * - **Pagination Support**: Built-in pagination state management\r\n * - **Filter & Sort**: Advanced filtering, searching, and sorting capabilities\r\n * - **Selection Management**: Multi-select with single/multiple modes\r\n * - **UI State**: View mode, column visibility, density settings\r\n * - **Cache Management**: Stale data tracking and cache invalidation\r\n * - **HIPAA Compliance**: Healthcare-specific factory with audit trail support\r\n *\r\n * Architecture:\r\n * - Uses Redux Toolkit's createSlice and createAsyncThunk\r\n * - EntityAdapter for normalized state (entities dictionary + ids array)\r\n * - Generic type support for any entity extending BaseEntity\r\n * - Extensible with custom reducers and extra actions\r\n * - Type-safe throughout with full TypeScript inference\r\n *\r\n * Usage Pattern:\r\n * ```typescript\r\n * // 1. Define API service\r\n * const apiService: EntityApiService<Student> = {\r\n *   getAll: async () => { ... },\r\n *   getById: async (id) => { ... },\r\n *   create: async (data) => { ... },\r\n *   update: async (id, data) => { ... },\r\n *   delete: async (id) => { ... },\r\n * };\r\n *\r\n * // 2. Create slice\r\n * const { slice, thunks, actions, adapter } = createEntitySlice(\r\n *   'students',\r\n *   apiService,\r\n *   { enableBulkOperations: true }\r\n * );\r\n *\r\n * // 3. Use in components\r\n * dispatch(thunks.fetchList());\r\n * const students = useAppSelector(state => state.students.entities);\r\n * ```\r\n *\r\n * @see {@link createEntitySlice} Main factory for standard entities\r\n * @see {@link createHealthcareEntitySlice} HIPAA-compliant factory for PHI entities\r\n * @see {@link createSimpleSlice} Minimal factory without bulk operations\r\n * @see {@link EntityApiService} Required API service interface\r\n *\r\n * WF-COMP-501: Redux Slice Factory\r\n * Purpose: Factory function for creating standardized Redux slices with CRUD operations\r\n * Critical Path: Slice creation â†’ Store configuration â†’ Component usage\r\n */\r\n\r\nimport {\r\n  createSlice,\r\n  createAsyncThunk,\r\n  createEntityAdapter,\r\n  PayloadAction,\r\n  AsyncThunk,\r\n  SerializedError,\r\n  EntityState,\r\n  Reducer,\r\n  Slice,\r\n  EntityAdapter,\r\n} from '@reduxjs/toolkit';\r\nimport type { WritableDraft } from '@reduxjs/toolkit';\r\nimport type {\r\n  BaseEntity,\r\n  HealthcareEntity,\r\n  LoadingState,\r\n  PaginationState,\r\n  SortState,\r\n  FilterState,\r\n  SelectionState,\r\n  UIState,\r\n  EntityQueryParams,\r\n  AuditRecord,\r\n} from './types/entityTypes';\r\n\r\n/**\r\n * Data classification type for healthcare entities\r\n * Matches the HealthcareEntity dataClassification field\r\n */\r\nexport type DataClassification = 'PUBLIC' | 'INTERNAL' | 'CONFIDENTIAL' | 'PHI';\r\n\r\n/**\r\n * API error structure with proper typing\r\n */\r\nexport interface ApiError {\r\n  message: string;\r\n  status?: number;\r\n  code?: string;\r\n  validationErrors?: Record<string, string[]>;\r\n}\r\n\r\n/**\r\n * Enhanced entity state that extends RTK's EntityState\r\n */\r\nexport interface EnhancedEntityState<T extends BaseEntity> extends EntityState<T, string> {\r\n  loading: {\r\n    list: LoadingState;\r\n    detail: LoadingState;\r\n    create: LoadingState;\r\n    update: LoadingState;\r\n    delete: LoadingState;\r\n    bulk: LoadingState;\r\n  };\r\n  pagination: PaginationState;\r\n  sort: SortState;\r\n  filters: FilterState;\r\n  selection: SelectionState;\r\n  ui: UIState;\r\n  cache: {\r\n    lastFetched: number;\r\n    isStale: boolean;\r\n  };\r\n}\r\n\r\n/**\r\n * Generic API service interface that entity services must implement.\r\n *\r\n * Defines the contract for CRUD operations that the slice factory expects.\r\n * Entity-specific API implementations must conform to this interface to be\r\n * compatible with createEntitySlice factory.\r\n *\r\n * @interface EntityApiService\r\n * @template T - Entity type extending BaseEntity\r\n * @template TCreate - Shape of data for entity creation (defaults to Partial<T>)\r\n * @template TUpdate - Shape of data for entity updates (defaults to Partial<T>)\r\n *\r\n * @example\r\n * ```typescript\r\n * // Implement for a Student entity\r\n * const studentApiService: EntityApiService<Student, CreateStudentData, UpdateStudentData> = {\r\n *   getAll: async (params) => {\r\n *     const response = await api.get('/students', { params });\r\n *     return { data: response.data, total: response.total };\r\n *   },\r\n *   getById: async (id) => {\r\n *     const response = await api.get(`/students/${id}`);\r\n *     return { data: response.data };\r\n *   },\r\n *   create: async (data) => {\r\n *     const response = await api.post('/students', data);\r\n *     return { data: response.data };\r\n *   },\r\n *   update: async (id, data) => {\r\n *     const response = await api.patch(`/students/${id}`, data);\r\n *     return { data: response.data };\r\n *   },\r\n *   delete: async (id) => {\r\n *     await api.delete(`/students/${id}`);\r\n *     return { success: true };\r\n *   },\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * - All methods should throw errors that can be caught by thunks\r\n * - Use consistent response shapes for proper state management\r\n * - Bulk operations are optional but recommended for performance\r\n */\r\nexport interface EntityApiService<T extends BaseEntity, TCreate = Partial<T>, TUpdate = Partial<T>> {\r\n  /**\r\n   * Fetch a list of entities with optional filtering, sorting, and pagination.\r\n   *\r\n   * @async\r\n   * @param {EntityQueryParams} [params] - Query parameters for filtering and pagination\r\n   * @returns {Promise<{data: T[], total?: number, pagination?: Partial<PaginationState>}>} List of entities with metadata\r\n   */\r\n  getAll(params?: EntityQueryParams): Promise<{ data: T[]; total?: number; pagination?: Partial<PaginationState> }>;\r\n\r\n  /**\r\n   * Fetch a single entity by its unique identifier.\r\n   *\r\n   * @async\r\n   * @param {string} id - Unique entity ID\r\n   * @returns {Promise<{data: T}>} The entity data\r\n   * @throws {NotFoundError} If entity doesn't exist\r\n   */\r\n  getById(id: string): Promise<{ data: T }>;\r\n\r\n  /**\r\n   * Create a new entity.\r\n   *\r\n   * @async\r\n   * @param {TCreate} data - Entity creation data\r\n   * @returns {Promise<{data: T}>} Created entity with generated ID and timestamps\r\n   * @throws {ValidationError} If data validation fails\r\n   */\r\n  create(data: TCreate): Promise<{ data: T }>;\r\n\r\n  /**\r\n   * Update an existing entity.\r\n   *\r\n   * @async\r\n   * @param {string} id - Entity ID to update\r\n   * @param {TUpdate} data - Partial entity data to update\r\n   * @returns {Promise<{data: T}>} Updated entity\r\n   * @throws {NotFoundError} If entity doesn't exist\r\n   * @throws {ValidationError} If update data is invalid\r\n   */\r\n  update(id: string, data: TUpdate): Promise<{ data: T }>;\r\n\r\n  /**\r\n   * Delete an entity.\r\n   *\r\n   * @async\r\n   * @param {string} id - Entity ID to delete\r\n   * @returns {Promise<{success: boolean}>} Deletion success status\r\n   * @throws {NotFoundError} If entity doesn't exist\r\n   * @throws {ForbiddenError} If user lacks permission\r\n   */\r\n  delete(id: string): Promise<{ success: boolean }>;\r\n\r\n  /**\r\n   * Bulk delete multiple entities (optional).\r\n   *\r\n   * @async\r\n   * @param {string[]} ids - Array of entity IDs to delete\r\n   * @returns {Promise<{success: boolean}>} Bulk deletion success status\r\n   * @throws {Error} If any deletion fails\r\n   */\r\n  bulkDelete?(ids: string[]): Promise<{ success: boolean }>;\r\n\r\n  /**\r\n   * Bulk update multiple entities (optional).\r\n   *\r\n   * @async\r\n   * @param {Array<{id: string, data: TUpdate}>} updates - Array of entity updates\r\n   * @returns {Promise<{data: T[]}>} Updated entities\r\n   * @throws {Error} If any update fails\r\n   */\r\n  bulkUpdate?(updates: Array<{ id: string; data: TUpdate }>): Promise<{ data: T[] }>;\r\n}\r\n\r\n/**\r\n * Configuration options for slice factory.\r\n *\r\n * Allows customization of generated slice behavior, including bulk operations,\r\n * custom reducers, and initial state overrides.\r\n *\r\n * @interface SliceFactoryOptions\r\n * @template T - Entity type extending BaseEntity\r\n *\r\n * @property {boolean} [enableBulkOperations=true] - Enable bulk delete and update operations\r\n * @property {Record<string, Function>} [extraReducers] - Additional custom reducers to include in slice\r\n * @property {Partial<EnhancedEntityState<T>>} [customInitialState] - Override default initial state values\r\n *\r\n * @example\r\n * ```typescript\r\n * const options: SliceFactoryOptions<Student> = {\r\n *   enableBulkOperations: true,\r\n *   extraReducers: {\r\n *     markAsActive: (state, action) => {\r\n *       const { id } = action.payload;\r\n *       state.entities[id].status = 'active';\r\n *     },\r\n *   },\r\n *   customInitialState: {\r\n *     pagination: { pageSize: 50 }, // Override default page size\r\n *   },\r\n * };\r\n * ```\r\n */\r\nexport interface SliceFactoryOptions<T extends BaseEntity> {\r\n  /** Whether to include bulk operations */\r\n  enableBulkOperations?: boolean;\r\n  /** Custom reducers to add to the slice */\r\n  extraReducers?: Record<string, (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<unknown>) => void>;\r\n  /** Custom initial state */\r\n  customInitialState?: Partial<EnhancedEntityState<T>>;\r\n}\r\n\r\n/**\r\n * Result object returned by slice factory containing all generated artifacts.\r\n *\r\n * Provides the complete set of Redux slice components including the slice itself,\r\n * entity adapter, async thunks, action creators, and reducer. Use these to integrate\r\n * the generated slice into your Redux store and components.\r\n *\r\n * @interface SliceFactoryResult\r\n * @template T - Entity type extending BaseEntity\r\n * @template TCreate - Entity creation data shape\r\n * @template TUpdate - Entity update data shape\r\n *\r\n * @property {Slice} slice - Complete Redux Toolkit slice with reducers and actions\r\n * @property {EntityAdapter<T, string>} adapter - Entity adapter for normalized state access\r\n * @property {Object} thunks - Auto-generated async thunks for CRUD operations\r\n * @property {Record<string, unknown>} actions - Synchronous action creators from slice.actions\r\n * @property {Reducer} reducer - Reducer function to add to store configuration\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create slice\r\n * const {\r\n *   slice,\r\n *   adapter,\r\n *   thunks,\r\n *   actions,\r\n *   reducer\r\n * } = createEntitySlice('students', studentApiService);\r\n *\r\n * // Export for use in store\r\n * export const studentsReducer = reducer;\r\n * export const studentsActions = actions;\r\n * export const studentsThunks = thunks;\r\n *\r\n * // Use adapter for selectors\r\n * export const studentsSelectors = adapter.getSelectors(\r\n *   (state: RootState) => state.students\r\n * );\r\n *\r\n * // Use in components\r\n * const dispatch = useAppDispatch();\r\n * dispatch(thunks.fetchList());\r\n * ```\r\n */\r\nexport interface SliceFactoryResult<T extends BaseEntity, TCreate = Partial<T>, TUpdate = Partial<T>> {\r\n  /** The generated slice */\r\n  slice: Slice;\r\n  /** Entity adapter for normalized state */\r\n  adapter: EntityAdapter<T, string>;\r\n  /** Async thunks for CRUD operations */\r\n  thunks: {\r\n    fetchList: AsyncThunk<{ data: T[]; total?: number; pagination?: Partial<PaginationState> }, EntityQueryParams | void, object>;\r\n    fetchById: AsyncThunk<{ data: T }, string, object>;\r\n    create: AsyncThunk<{ data: T }, TCreate, object>;\r\n    update: AsyncThunk<{ data: T }, { id: string; data: TUpdate }, object>;\r\n    delete: AsyncThunk<{ success: boolean; id: string }, string, object>;\r\n    bulkDelete?: AsyncThunk<{ success: boolean; ids: string[] }, string[], object>;\r\n    bulkUpdate?: AsyncThunk<{ data: T[] }, Array<{ id: string; data: TUpdate }>, object>;\r\n  };\r\n  /** Action creators */\r\n  actions: Record<string, unknown>;\r\n  /** Reducer */\r\n  reducer: Reducer<unknown>;\r\n}\r\n\r\n/**\r\n * Create initial state for enhanced entity state\r\n */\r\nfunction createInitialEnhancedState<T extends BaseEntity>(\r\n  adapter: ReturnType<typeof createEntityAdapter<T, string>>,\r\n  customState?: Partial<EnhancedEntityState<T>>\r\n): EnhancedEntityState<T> {\r\n  return {\r\n    ...adapter.getInitialState(),\r\n    loading: {\r\n      list: { status: 'idle', isLoading: false, error: null },\r\n      detail: { status: 'idle', isLoading: false, error: null },\r\n      create: { status: 'idle', isLoading: false, error: null },\r\n      update: { status: 'idle', isLoading: false, error: null },\r\n      delete: { status: 'idle', isLoading: false, error: null },\r\n      bulk: { status: 'idle', isLoading: false, error: null },\r\n    },\r\n    pagination: {\r\n      page: 1,\r\n      pageSize: 25,\r\n      total: 0,\r\n      totalPages: 0,\r\n      hasNextPage: false,\r\n      hasPreviousPage: false,\r\n    },\r\n    sort: {\r\n      field: 'createdAt',\r\n      direction: 'desc',\r\n    },\r\n    filters: {\r\n      active: {},\r\n      search: '',\r\n      presets: {},\r\n    },\r\n    selection: {\r\n      selectedIds: [],\r\n      focusedId: null,\r\n      isAllSelected: false,\r\n      mode: 'multiple',\r\n    },\r\n    ui: {\r\n      viewMode: 'list',\r\n      showFilters: false,\r\n      showSidebar: true,\r\n      density: 'normal',\r\n      visibleColumns: [],\r\n      columnWidths: {},\r\n    },\r\n    cache: {\r\n      lastFetched: 0,\r\n      isStale: true,\r\n    },\r\n    ...customState,\r\n  };\r\n}\r\n\r\n/**\r\n * Create a standardized Redux Toolkit slice with complete CRUD operations.\r\n *\r\n * This is the primary factory function for creating entity management slices.\r\n * Generates a fully-featured Redux slice with:\r\n * - EntityAdapter for normalized state management\r\n * - Async thunks for all CRUD operations\r\n * - Granular loading states (list, detail, create, update, delete, bulk)\r\n * - Pagination, sorting, filtering, and selection management\r\n * - Optional bulk operations\r\n * - UI state management\r\n * - Cache invalidation support\r\n *\r\n * The generated slice dramatically reduces boilerplate while ensuring consistency\r\n * across all entity management in the application.\r\n *\r\n * @template T - Entity type extending BaseEntity with id, createdAt, updatedAt\r\n * @template TCreate - Shape of data for entity creation (defaults to Partial<T>)\r\n * @template TUpdate - Shape of data for entity updates (defaults to Partial<T>)\r\n *\r\n * @param {string} name - Slice name (e.g., 'students', 'medications'). Used as Redux action prefix.\r\n * @param {EntityApiService<T, TCreate, TUpdate>} apiService - API service implementing EntityApiService interface\r\n * @param {SliceFactoryOptions<T>} [options={}] - Configuration options for slice customization\r\n * @param {boolean} [options.enableBulkOperations=true] - Enable bulk delete/update thunks\r\n * @param {Record<string, Function>} [options.extraReducers={}] - Custom reducers to add to slice\r\n * @param {Partial<EnhancedEntityState<T>>} [options.customInitialState={}] - Override default initial state\r\n *\r\n * @returns {SliceFactoryResult<T, TCreate, TUpdate>} Complete slice with thunks, actions, adapter, and reducer\r\n *\r\n * @example\r\n * ```typescript\r\n * // 1. Define your entity type\r\n * interface Student extends BaseEntity {\r\n *   firstName: string;\r\n *   lastName: string;\r\n *   grade: number;\r\n * }\r\n *\r\n * // 2. Implement API service\r\n * const studentApiService: EntityApiService<Student> = {\r\n *   getAll: async (params) => {\r\n *     const response = await api.get('/students', { params });\r\n *     return { data: response.data, total: response.total };\r\n *   },\r\n *   getById: async (id) => {\r\n *     const response = await api.get(`/students/${id}`);\r\n *     return { data: response.data };\r\n *   },\r\n *   create: async (data) => {\r\n *     const response = await api.post('/students', data);\r\n *     return { data: response.data };\r\n *   },\r\n *   update: async (id, data) => {\r\n *     const response = await api.patch(`/students/${id}`, data);\r\n *     return { data: response.data };\r\n *   },\r\n *   delete: async (id) => {\r\n *     await api.delete(`/students/${id}`);\r\n *     return { success: true };\r\n *   },\r\n * };\r\n *\r\n * // 3. Create the slice\r\n * const {\r\n *   slice: studentsSlice,\r\n *   thunks: studentsThunks,\r\n *   actions: studentsActions,\r\n *   adapter: studentsAdapter,\r\n *   reducer: studentsReducer,\r\n * } = createEntitySlice('students', studentApiService, {\r\n *   enableBulkOperations: true,\r\n * });\r\n *\r\n * // 4. Export for store configuration\r\n * export { studentsReducer, studentsThunks, studentsActions };\r\n *\r\n * // 5. Create selectors\r\n * export const studentsSelectors = studentsAdapter.getSelectors(\r\n *   (state: RootState) => state.students\r\n * );\r\n *\r\n * // 6. Use in components\r\n * function StudentList() {\r\n *   const dispatch = useAppDispatch();\r\n *   const students = useAppSelector(studentsSelectors.selectAll);\r\n *   const loading = useAppSelector(state => state.students.loading.list.isLoading);\r\n *\r\n *   useEffect(() => {\r\n *     dispatch(studentsThunks.fetchList());\r\n *   }, [dispatch]);\r\n *\r\n *   if (loading) return <Spinner />;\r\n *   return <div>{students.map(s => <StudentCard key={s.id} student={s} />)}</div>;\r\n * }\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Advanced usage with custom reducers\r\n * const { slice, thunks, actions, reducer } = createEntitySlice(\r\n *   'students',\r\n *   studentApiService,\r\n *   {\r\n *     enableBulkOperations: true,\r\n *     extraReducers: {\r\n *       // Custom action to mark student as graduated\r\n *       markAsGraduated: (state, action: PayloadAction<{ id: string }>) => {\r\n *         const { id } = action.payload;\r\n *         if (state.entities[id]) {\r\n *           state.entities[id].status = 'graduated';\r\n *           state.entities[id].updatedAt = new Date().toISOString();\r\n *         }\r\n *       },\r\n *     },\r\n *     customInitialState: {\r\n *       pagination: { pageSize: 50 }, // Override default 25\r\n *       sort: { field: 'lastName', direction: 'asc' },\r\n *     },\r\n *   }\r\n * );\r\n * ```\r\n *\r\n * @remarks\r\n * **Generated Thunks**:\r\n * - `fetchList`: Fetch paginated list with filters/sort\r\n * - `fetchById`: Fetch single entity\r\n * - `create`: Create new entity\r\n * - `update`: Update existing entity\r\n * - `delete`: Delete entity\r\n * - `bulkDelete`: Delete multiple entities (if enabled)\r\n * - `bulkUpdate`: Update multiple entities (if enabled)\r\n *\r\n * **Generated Actions**:\r\n * - `setEntities`: Replace all entities\r\n * - `addEntity`: Add single entity\r\n * - `updateEntity`: Update single entity\r\n * - `removeEntity`: Remove single entity\r\n * - `setPagination`: Update pagination state\r\n * - `setSort`: Update sort configuration\r\n * - `setFilters`: Update active filters\r\n * - `clearFilters`: Clear all filters\r\n * - `selectEntity`: Select entity (multi-select support)\r\n * - `deselectEntity`: Deselect entity\r\n * - `clearSelection`: Clear all selections\r\n * - `selectAll`: Select all entities\r\n * - `setUI`: Update UI state (view mode, columns, etc.)\r\n * - `invalidateCache`: Mark cache as stale\r\n * - `clearErrors`: Clear all error states\r\n *\r\n * **State Structure**:\r\n * ```typescript\r\n * {\r\n *   ids: string[],                    // Ordered entity IDs\r\n *   entities: { [id]: Entity },       // Normalized entities\r\n *   loading: {\r\n *     list: LoadingState,              // List operation loading\r\n *     detail: LoadingState,            // Detail operation loading\r\n *     create: LoadingState,            // Create operation loading\r\n *     update: LoadingState,            // Update operation loading\r\n *     delete: LoadingState,            // Delete operation loading\r\n *     bulk: LoadingState,              // Bulk operation loading\r\n *   },\r\n *   pagination: PaginationState,       // Page, pageSize, total, etc.\r\n *   sort: SortState,                   // Sort field and direction\r\n *   filters: FilterState,              // Active filters and search\r\n *   selection: SelectionState,         // Selected IDs and focus\r\n *   ui: UIState,                       // View mode, columns, density\r\n *   cache: { lastFetched, isStale },   // Cache metadata\r\n * }\r\n * ```\r\n *\r\n * **Performance Considerations**:\r\n * - EntityAdapter provides O(1) lookups and optimized updates\r\n * - Normalized state prevents duplication\r\n * - Granular loading states prevent unnecessary re-renders\r\n * - Cache metadata supports intelligent refetching\r\n *\r\n * **Error Handling**:\r\n * - All thunks catch errors and store in loading[operation].error\r\n * - Use `.unwrap()` on dispatch to handle errors in components\r\n * - Errors include message, status code, and validation errors\r\n *\r\n * @see {@link EntityApiService} for API service requirements\r\n * @see {@link SliceFactoryOptions} for configuration options\r\n * @see {@link SliceFactoryResult} for return value details\r\n * @see {@link createHealthcareEntitySlice} for HIPAA-compliant variant\r\n */\r\nexport function createEntitySlice<\r\n  T extends BaseEntity,\r\n  TCreate = Partial<T>,\r\n  TUpdate = Partial<T>\r\n>(\r\n  name: string,\r\n  apiService: EntityApiService<T, TCreate, TUpdate>,\r\n  options: SliceFactoryOptions<T> = {}\r\n): SliceFactoryResult<T, TCreate, TUpdate> {\r\n  \r\n  const {\r\n    enableBulkOperations = true,\r\n    extraReducers = {},\r\n    customInitialState = {},\r\n  } = options;\r\n\r\n  // Create entity adapter for normalized state management\r\n  const adapter = createEntityAdapter<T, string>({\r\n    selectId: (entity: T) => entity.id,\r\n    sortComparer: (a: T, b: T) => {\r\n      // Default sort by updatedAt descending\r\n      if (!a.updatedAt || !b.updatedAt) return 0;\r\n      return new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime();\r\n    },\r\n  });\r\n\r\n  // Create initial state\r\n  const initialState = createInitialEnhancedState<T>(adapter, customInitialState);\r\n\r\n  // Helper function to safely extract error information\r\n  const extractErrorInfo = (error: unknown): ApiError => {\r\n    if (error instanceof Error) {\r\n      return {\r\n        message: error.message,\r\n        status: (error as { status?: number }).status,\r\n        code: (error as { code?: string }).code,\r\n        validationErrors: (error as { validationErrors?: Record<string, string[]> }).validationErrors,\r\n      };\r\n    }\r\n\r\n    if (typeof error === 'object' && error !== null) {\r\n      const err = error as Record<string, unknown>;\r\n      return {\r\n        message: (err.message as string) || 'An error occurred',\r\n        status: err.status as number,\r\n        code: err.code as string,\r\n        validationErrors: err.validationErrors as Record<string, string[]>,\r\n      };\r\n    }\r\n\r\n    return {\r\n      message: String(error) || 'An unknown error occurred',\r\n    };\r\n  };\r\n\r\n  // Helper function to update loading state\r\n  const updateLoadingState = (\r\n    state: WritableDraft<EnhancedEntityState<T>>,\r\n    operation: keyof EnhancedEntityState<T>['loading'],\r\n    loading: Partial<LoadingState>\r\n  ): void => {\r\n    state.loading[operation] = { ...state.loading[operation], ...loading };\r\n  };\r\n\r\n  // Create async thunks\r\n  const fetchList = createAsyncThunk(\r\n    `${name}/fetchList`,\r\n    async (params: EntityQueryParams | void, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.getAll(params || {});\r\n        return result;\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || 'Failed to fetch list',\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n        });\r\n      }\r\n    }\r\n  );\r\n\r\n  const fetchById = createAsyncThunk(\r\n    `${name}/fetchById`,\r\n    async (id: string, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.getById(id);\r\n        return result;\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to fetch ${name}`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n        });\r\n      }\r\n    }\r\n  );\r\n\r\n  const create = createAsyncThunk(\r\n    `${name}/create`,\r\n    async (data: TCreate, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.create(data);\r\n        return result;\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to create ${name}`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n          validationErrors: errorInfo.validationErrors,\r\n        });\r\n      }\r\n    }\r\n  );\r\n\r\n  const update = createAsyncThunk(\r\n    `${name}/update`,\r\n    async ({ id, data }: { id: string; data: TUpdate }, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.update(id, data);\r\n        return result;\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to update ${name}`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n          validationErrors: errorInfo.validationErrors,\r\n        });\r\n      }\r\n    }\r\n  );\r\n\r\n  const deleteEntity = createAsyncThunk(\r\n    `${name}/delete`,\r\n    async (id: string, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.delete(id);\r\n        return { ...result, id };\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to delete ${name}`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n        });\r\n      }\r\n    }\r\n  );\r\n\r\n  // Bulk operations (if enabled and API service supports them)\r\n  const bulkDelete = enableBulkOperations && apiService.bulkDelete ? createAsyncThunk(\r\n    `${name}/bulkDelete`,\r\n    async (ids: string[], { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.bulkDelete!(ids);\r\n        return { ...result, ids };\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to bulk delete ${name}s`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n        });\r\n      }\r\n    }\r\n  ) : undefined;\r\n\r\n  const bulkUpdate = enableBulkOperations && apiService.bulkUpdate ? createAsyncThunk(\r\n    `${name}/bulkUpdate`,\r\n    async (updates: Array<{ id: string; data: TUpdate }>, { rejectWithValue }) => {\r\n      try {\r\n        const result = await apiService.bulkUpdate!(updates);\r\n        return result;\r\n      } catch (error: unknown) {\r\n        const errorInfo = extractErrorInfo(error);\r\n        return rejectWithValue({\r\n          message: errorInfo.message || `Failed to bulk update ${name}s`,\r\n          status: errorInfo.status,\r\n          code: errorInfo.code,\r\n        });\r\n      }\r\n    }\r\n  ) : undefined;\r\n\r\n  // Create the slice\r\n  const slice = createSlice({\r\n    name,\r\n    initialState,\r\n    reducers: {\r\n      // Entity management\r\n      setEntities: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<T[]>) => {\r\n        adapter.setAll(state, action.payload);\r\n        state.cache.lastFetched = Date.now();\r\n        state.cache.isStale = false;\r\n      },\r\n\r\n      addEntity: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<T>) => {\r\n        adapter.addOne(state, action.payload);\r\n      },\r\n\r\n      updateEntity: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<{ id: string; changes: Partial<T> }>) => {\r\n        adapter.updateOne(state, action.payload);\r\n      },\r\n\r\n      removeEntity: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<string>) => {\r\n        adapter.removeOne(state, action.payload);\r\n        // Remove from selection if selected\r\n        state.selection.selectedIds = state.selection.selectedIds.filter((id: string) => id !== action.payload);\r\n        if (state.selection.focusedId === action.payload) {\r\n          state.selection.focusedId = null;\r\n        }\r\n      },\r\n\r\n      // Pagination\r\n      setPagination: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<Partial<PaginationState>>) => {\r\n        state.pagination = { ...state.pagination, ...action.payload };\r\n      },\r\n\r\n      // Sorting\r\n      setSort: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<SortState>) => {\r\n        state.sort = action.payload;\r\n      },\r\n\r\n      // Filtering\r\n      setFilters: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<Partial<FilterState>>) => {\r\n        state.filters = { ...state.filters, ...action.payload };\r\n      },\r\n\r\n      clearFilters: (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n        state.filters = {\r\n          active: {},\r\n          search: '',\r\n          presets: state.filters.presets,\r\n        };\r\n      },\r\n\r\n      // Selection\r\n      setSelection: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<Partial<SelectionState>>) => {\r\n        state.selection = { ...state.selection, ...action.payload };\r\n      },\r\n\r\n      selectEntity: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<string>) => {\r\n        const id = action.payload;\r\n        if (state.selection.mode === 'single') {\r\n          state.selection.selectedIds = [id];\r\n        } else if (state.selection.mode === 'multiple') {\r\n          if (!state.selection.selectedIds.includes(id)) {\r\n            state.selection.selectedIds.push(id);\r\n          }\r\n        }\r\n        state.selection.focusedId = id;\r\n      },\r\n\r\n      deselectEntity: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<string>) => {\r\n        const id = action.payload;\r\n        state.selection.selectedIds = state.selection.selectedIds.filter((selectedId: string) => selectedId !== id);\r\n        if (state.selection.focusedId === id) {\r\n          state.selection.focusedId = null;\r\n        }\r\n      },\r\n\r\n      clearSelection: (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n        state.selection.selectedIds = [];\r\n        state.selection.focusedId = null;\r\n        state.selection.isAllSelected = false;\r\n      },\r\n\r\n      selectAll: (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n        state.selection.selectedIds = [...state.ids] as string[];\r\n        state.selection.isAllSelected = true;\r\n      },\r\n\r\n      // UI state\r\n      setUI: (state: WritableDraft<EnhancedEntityState<T>>, action: PayloadAction<Partial<UIState>>) => {\r\n        state.ui = { ...state.ui, ...action.payload };\r\n      },\r\n\r\n      // Cache management\r\n      invalidateCache: (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n        state.cache.isStale = true;\r\n        state.cache.lastFetched = 0;\r\n      },\r\n\r\n      // Error handling\r\n      clearErrors: (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n        Object.keys(state.loading).forEach((key: string) => {\r\n          state.loading[key as keyof typeof state.loading].error = null;\r\n        });\r\n      },\r\n\r\n      // Custom reducers\r\n      ...extraReducers,\r\n    },\r\n\r\n    extraReducers: (builder: any) => {\r\n      // Fetch list\r\n      builder\r\n        .addCase(fetchList.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n          updateLoadingState(state, 'list', {\r\n            status: 'pending',\r\n            isLoading: true,\r\n            error: null,\r\n            startedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(fetchList.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          adapter.setAll(state, action.payload.data);\r\n          updateLoadingState(state, 'list', {\r\n            status: 'fulfilled',\r\n            isLoading: false,\r\n            error: null,\r\n            completedAt: Date.now(),\r\n          });\r\n\r\n          // Update pagination if provided\r\n          if (action.payload.pagination) {\r\n            state.pagination = { ...state.pagination, ...action.payload.pagination };\r\n          }\r\n          if (action.payload.total !== undefined) {\r\n            state.pagination.total = action.payload.total;\r\n          }\r\n\r\n          state.cache.lastFetched = Date.now();\r\n          state.cache.isStale = false;\r\n        })\r\n        .addCase(fetchList.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          updateLoadingState(state, 'list', {\r\n            status: 'rejected',\r\n            isLoading: false,\r\n            error: action.error,\r\n            completedAt: Date.now(),\r\n          });\r\n        });\r\n\r\n      // Fetch by ID\r\n      builder\r\n        .addCase(fetchById.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n          updateLoadingState(state, 'detail', {\r\n            status: 'pending',\r\n            isLoading: true,\r\n            error: null,\r\n            startedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(fetchById.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          adapter.upsertOne(state, action.payload.data);\r\n          updateLoadingState(state, 'detail', {\r\n            status: 'fulfilled',\r\n            isLoading: false,\r\n            error: null,\r\n            completedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(fetchById.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          updateLoadingState(state, 'detail', {\r\n            status: 'rejected',\r\n            isLoading: false,\r\n            error: action.error,\r\n            completedAt: Date.now(),\r\n          });\r\n        });\r\n\r\n      // Create\r\n      builder\r\n        .addCase(create.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n          updateLoadingState(state, 'create', {\r\n            status: 'pending',\r\n            isLoading: true,\r\n            error: null,\r\n            startedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(create.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          adapter.addOne(state, action.payload.data);\r\n          updateLoadingState(state, 'create', {\r\n            status: 'fulfilled',\r\n            isLoading: false,\r\n            error: null,\r\n            completedAt: Date.now(),\r\n          });\r\n\r\n          // Update pagination\r\n          state.pagination.total += 1;\r\n        })\r\n        .addCase(create.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          updateLoadingState(state, 'create', {\r\n            status: 'rejected',\r\n            isLoading: false,\r\n            error: action.error,\r\n            completedAt: Date.now(),\r\n          });\r\n        });\r\n\r\n      // Update\r\n      builder\r\n        .addCase(update.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n          updateLoadingState(state, 'update', {\r\n            status: 'pending',\r\n            isLoading: true,\r\n            error: null,\r\n            startedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(update.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          adapter.upsertOne(state, action.payload.data);\r\n          updateLoadingState(state, 'update', {\r\n            status: 'fulfilled',\r\n            isLoading: false,\r\n            error: null,\r\n            completedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(update.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          updateLoadingState(state, 'update', {\r\n            status: 'rejected',\r\n            isLoading: false,\r\n            error: action.error,\r\n            completedAt: Date.now(),\r\n          });\r\n        });\r\n\r\n      // Delete\r\n      builder\r\n        .addCase(deleteEntity.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n          updateLoadingState(state, 'delete', {\r\n            status: 'pending',\r\n            isLoading: true,\r\n            error: null,\r\n            startedAt: Date.now(),\r\n          });\r\n        })\r\n        .addCase(deleteEntity.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          adapter.removeOne(state, action.payload.id);\r\n          updateLoadingState(state, 'delete', {\r\n            status: 'fulfilled',\r\n            isLoading: false,\r\n            error: null,\r\n            completedAt: Date.now(),\r\n          });\r\n\r\n          // Update pagination\r\n          state.pagination.total = Math.max(0, state.pagination.total - 1);\r\n        })\r\n        .addCase(deleteEntity.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n          updateLoadingState(state, 'delete', {\r\n            status: 'rejected',\r\n            isLoading: false,\r\n            error: action.error,\r\n            completedAt: Date.now(),\r\n          });\r\n        });\r\n\r\n      // Bulk operations\r\n      if (bulkDelete) {\r\n        builder\r\n          .addCase(bulkDelete.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'pending',\r\n              isLoading: true,\r\n              error: null,\r\n              startedAt: Date.now(),\r\n            });\r\n          })\r\n          .addCase(bulkDelete.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n            adapter.removeMany(state, action.payload.ids);\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'fulfilled',\r\n              isLoading: false,\r\n              error: null,\r\n              completedAt: Date.now(),\r\n            });\r\n\r\n            // Update pagination\r\n            state.pagination.total = Math.max(0, state.pagination.total - action.payload.ids.length);\r\n\r\n            // Clear selection\r\n            state.selection.selectedIds = [];\r\n            state.selection.isAllSelected = false;\r\n          })\r\n          .addCase(bulkDelete.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'rejected',\r\n              isLoading: false,\r\n              error: action.error,\r\n              completedAt: Date.now(),\r\n            });\r\n          });\r\n      }\r\n\r\n      if (bulkUpdate) {\r\n        builder\r\n          .addCase(bulkUpdate.pending, (state: WritableDraft<EnhancedEntityState<T>>) => {\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'pending',\r\n              isLoading: true,\r\n              error: null,\r\n              startedAt: Date.now(),\r\n            });\r\n          })\r\n          .addCase(bulkUpdate.fulfilled, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n            adapter.upsertMany(state, action.payload.data);\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'fulfilled',\r\n              isLoading: false,\r\n              error: null,\r\n              completedAt: Date.now(),\r\n            });\r\n          })\r\n          .addCase(bulkUpdate.rejected, (state: WritableDraft<EnhancedEntityState<T>>, action: any) => {\r\n            updateLoadingState(state, 'bulk', {\r\n              status: 'rejected',\r\n              isLoading: false,\r\n              error: action.error,\r\n              completedAt: Date.now(),\r\n            });\r\n          });\r\n      }\r\n    },\r\n  });\r\n\r\n  // Return complete slice factory result\r\n  return {\r\n    slice,\r\n    adapter,\r\n    thunks: {\r\n      fetchList,\r\n      fetchById,\r\n      create,\r\n      update,\r\n      delete: deleteEntity,\r\n      ...(bulkDelete && { bulkDelete }),\r\n      ...(bulkUpdate && { bulkUpdate }),\r\n    },\r\n    actions: slice.actions,\r\n    reducer: slice.reducer as Reducer<unknown>,\r\n  };\r\n}\r\n\r\n/**\r\n * Healthcare-specific slice factory with HIPAA compliance features.\r\n *\r\n * Extends the standard entity slice factory with healthcare-specific functionality\r\n * including audit trail management and data classification tracking. Use this for\r\n * entities that contain Protected Health Information (PHI) or require HIPAA compliance.\r\n *\r\n * Additional Features Beyond Standard Slice:\r\n * - **Audit Trail Management**: addAuditRecord action for tracking PHI access\r\n * - **Data Classification**: updateDataClassification action for sensitivity updates\r\n * - **Compliance Fields**: Automatic handling of createdBy, modifiedBy, auditTrail\r\n * - **PHI Protection**: Inherits all entity management with compliance awareness\r\n *\r\n * @template T - Entity type extending HealthcareEntity (includes audit fields)\r\n * @template TCreate - Shape of data for entity creation\r\n * @template TUpdate - Shape of data for entity updates\r\n *\r\n * @param {string} name - Slice name (e.g., 'healthRecords', 'medications')\r\n * @param {EntityApiService<T, TCreate, TUpdate>} apiService - API service implementing EntityApiService\r\n * @param {SliceFactoryOptions<T>} [options={}] - Configuration options\r\n *\r\n * @returns {SliceFactoryResult<T, TCreate, TUpdate>} Complete slice with HIPAA compliance actions\r\n *\r\n * @example\r\n * ```typescript\r\n * interface HealthRecord extends HealthcareEntity {\r\n *   studentId: string;\r\n *   diagnosis: string;\r\n *   treatment: string;\r\n *   notes: string;\r\n * }\r\n *\r\n * const healthRecordsApiService: EntityApiService<HealthRecord> = {\r\n *   getAll: async (params) => {\r\n *     const response = await api.get('/health-records', { params });\r\n *     // API automatically logs PHI access\r\n *     return { data: response.data, total: response.total };\r\n *   },\r\n *   // ... other CRUD operations with audit logging\r\n * };\r\n *\r\n * const {\r\n *   slice,\r\n *   thunks,\r\n *   actions,\r\n *   reducer\r\n * } = createHealthcareEntitySlice('healthRecords', healthRecordsApiService);\r\n *\r\n * // Export for use in store\r\n * export { reducer as healthRecordsReducer, thunks as healthRecordsThunks };\r\n *\r\n * // Use in components (same as standard slice)\r\n * function HealthRecordsList() {\r\n *   const dispatch = useAppDispatch();\r\n *   const records = useAppSelector(state => state.healthRecords.entities);\r\n *\r\n *   useEffect(() => {\r\n *     dispatch(thunks.fetchList());\r\n *   }, [dispatch]);\r\n *\r\n *   return <div>{Object.values(records).map(r => <RecordCard key={r.id} record={r} />)}</div>;\r\n * }\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Adding audit records programmatically\r\n * import { actions } from './healthRecordsSlice';\r\n *\r\n * // After viewing a health record\r\n * dispatch(actions.addAuditRecord({\r\n *   entityId: recordId,\r\n *   auditRecord: {\r\n *     timestamp: new Date().toISOString(),\r\n *     userId: currentUser.id,\r\n *     action: 'VIEW',\r\n *     ipAddress: userIpAddress,\r\n *     context: 'Viewed from student detail page',\r\n *   },\r\n * }));\r\n *\r\n * // Updating data classification\r\n * dispatch(actions.updateDataClassification({\r\n *   entityId: recordId,\r\n *   classification: 'PHI', // PHI, CONFIDENTIAL, INTERNAL, PUBLIC\r\n * }));\r\n * ```\r\n *\r\n * @remarks\r\n * **HIPAA Compliance Requirements**:\r\n * - All API operations must log PHI access to audit trail\r\n * - Audit records include timestamp, user, action, IP address\r\n * - Data classification must be set appropriately (PHI for patient data)\r\n * - No PHI should be persisted to browser storage\r\n * - Access logs must be maintained for 6 years minimum\r\n *\r\n * **Additional Actions Beyond Standard Slice**:\r\n * - `addAuditRecord`: Add audit trail entry to entity\r\n * - `updateDataClassification`: Update sensitivity classification\r\n *\r\n * **Healthcare Entity Fields**:\r\n * ```typescript\r\n * {\r\n *   id: string;\r\n *   createdAt: string;\r\n *   updatedAt: string;\r\n *   createdBy: string;           // User who created\r\n *   modifiedBy: string;          // User who last modified\r\n *   auditTrail: AuditRecord[];   // Complete access history\r\n *   dataClassification: 'PHI' | 'CONFIDENTIAL' | 'INTERNAL' | 'PUBLIC';\r\n * }\r\n * ```\r\n *\r\n * **Audit Record Structure**:\r\n * ```typescript\r\n * {\r\n *   timestamp: string;\r\n *   userId: string;\r\n *   action: 'CREATE' | 'READ' | 'UPDATE' | 'DELETE' | 'VIEW' | 'EXPORT' | 'PRINT';\r\n *   ipAddress?: string;\r\n *   context?: string;\r\n * }\r\n * ```\r\n *\r\n * @see {@link createEntitySlice} for standard entity slice factory\r\n * @see {@link HealthcareEntity} for healthcare entity interface\r\n * @see {@link AuditRecord} for audit record structure\r\n */\r\nexport function createHealthcareEntitySlice<\r\n  T extends HealthcareEntity,\r\n  TCreate = Partial<T>,\r\n  TUpdate = Partial<T>\r\n>(\r\n  name: string,\r\n  apiService: EntityApiService<T, TCreate, TUpdate>,\r\n  options: SliceFactoryOptions<T> = {}\r\n): SliceFactoryResult<T, TCreate, TUpdate> {\r\n  \r\n  // Add healthcare-specific options\r\n  const healthcareOptions: SliceFactoryOptions<T> = {\r\n    ...options,\r\n    extraReducers: {\r\n      ...options.extraReducers,\r\n\r\n      // Audit trail management\r\n      addAuditRecord: (state: any, action: PayloadAction<unknown>) => {\r\n        const payload = action.payload as { entityId: string; auditRecord: AuditRecord };\r\n        const { entityId, auditRecord } = payload;\r\n        const entity = state.entities[entityId];\r\n        if (entity && 'auditTrail' in entity) {\r\n          const healthcareEntity = entity as HealthcareEntity;\r\n          if (healthcareEntity.auditTrail) {\r\n            healthcareEntity.auditTrail = [...healthcareEntity.auditTrail, auditRecord];\r\n          } else {\r\n            healthcareEntity.auditTrail = [auditRecord];\r\n          }\r\n        }\r\n      },\r\n\r\n      // Data classification updates\r\n      updateDataClassification: (state: any, action: PayloadAction<unknown>) => {\r\n        const payload = action.payload as { entityId: string; classification: DataClassification };\r\n        const { entityId, classification } = payload;\r\n        const entity = state.entities[entityId];\r\n        if (entity && 'dataClassification' in entity) {\r\n          const healthcareEntity = entity as HealthcareEntity;\r\n          healthcareEntity.dataClassification = classification;\r\n        }\r\n      },\r\n    },\r\n  };\r\n\r\n  return createEntitySlice(name, apiService, healthcareOptions);\r\n}\r\n\r\n/**\r\n * Utility function to create a simple entity slice with minimal configuration.\r\n *\r\n * Convenience wrapper around createEntitySlice with bulk operations disabled.\r\n * Use this for entities that don't require bulk delete/update operations,\r\n * reducing the number of generated thunks and keeping the slice lightweight.\r\n *\r\n * @template T - Entity type extending BaseEntity\r\n *\r\n * @param {string} name - Slice name (e.g., 'settings', 'profile')\r\n * @param {EntityApiService<T>} apiService - API service implementing EntityApiService interface\r\n *\r\n * @returns {SliceFactoryResult<T>} Complete slice without bulk operations\r\n *\r\n * @example\r\n * ```typescript\r\n * interface UserProfile extends BaseEntity {\r\n *   firstName: string;\r\n *   lastName: string;\r\n *   email: string;\r\n * }\r\n *\r\n * const profileApiService: EntityApiService<UserProfile> = {\r\n *   getAll: async () => ({ data: [] }),       // Not used for profiles\r\n *   getById: async (id) => ({ data: await api.get(`/profile/${id}`) }),\r\n *   create: async (data) => ({ data: await api.post('/profile', data) }),\r\n *   update: async (id, data) => ({ data: await api.patch(`/profile/${id}`, data) }),\r\n *   delete: async (id) => ({ success: await api.delete(`/profile/${id}`) }),\r\n * };\r\n *\r\n * // Create simple slice without bulk operations\r\n * const {\r\n *   slice,\r\n *   thunks,\r\n *   actions,\r\n *   reducer\r\n * } = createSimpleSlice('profile', profileApiService);\r\n *\r\n * export { reducer as profileReducer, thunks as profileThunks };\r\n * ```\r\n *\r\n * @remarks\r\n * - Bulk operations (bulkDelete, bulkUpdate) are disabled\r\n * - All other features of createEntitySlice are included\r\n * - Use for singleton or low-volume entities\r\n * - Equivalent to: `createEntitySlice(name, apiService, { enableBulkOperations: false })`\r\n *\r\n * @see {@link createEntitySlice} for full-featured slice factory\r\n */\r\nexport function createSimpleSlice<T extends BaseEntity>(\r\n  name: string,\r\n  apiService: EntityApiService<T>\r\n): SliceFactoryResult<T> {\r\n  return createEntitySlice(\r\n    name,\r\n    apiService,\r\n    { enableBulkOperations: false }\r\n  );\r\n}\r\n\r\nexport default createEntitySlice;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6965, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/lib/api/client.ts"],"sourcesContent":["/**\r\n * @fileoverview Client-Side API Client\r\n * @module lib/api/client\r\n * @category API Client\r\n *\r\n * Client-side HTTP client for browser environments. This client is designed\r\n * for use in Client Components and browser-only contexts where Next.js\r\n * server APIs (like next/headers) are not available.\r\n *\r\n * Key Features:\r\n * - Browser-compatible fetch API\r\n * - Client-side authentication via cookies\r\n * - CSRF protection\r\n * - Error handling and retry logic\r\n * - Type-safe HTTP methods\r\n * - Request ID generation for tracing\r\n *\r\n * @example\r\n * ```typescript\r\n * // In a Client Component\r\n * 'use client';\r\n * import { clientGet, clientPost } from '@/lib/api/client';\r\n * \r\n * const students = await clientGet<Student[]>('/api/students');\r\n * const newStudent = await clientPost<Student>('/api/students', data);\r\n * ```\r\n *\r\n * @version 1.0.0\r\n * @since 2025-11-01\r\n */\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS\r\n// ==========================================\r\n\r\n/**\r\n * Client-side fetch options\r\n */\r\nexport interface ClientFetchOptions extends RequestInit {\r\n  /**\r\n   * Whether to include authentication token\r\n   * @default true\r\n   */\r\n  requiresAuth?: boolean;\r\n\r\n  /**\r\n   * Retry configuration\r\n   */\r\n  retry?: {\r\n    attempts: number;\r\n    delay: number;\r\n  };\r\n\r\n  /**\r\n   * Custom error handler\r\n   */\r\n  onError?: (error: Error) => void;\r\n\r\n  /**\r\n   * Request timeout in milliseconds\r\n   */\r\n  timeout?: number;\r\n}\r\n\r\n/**\r\n * API error response structure\r\n */\r\nexport interface ApiErrorResponse {\r\n  message: string;\r\n  code?: string;\r\n  status?: number;\r\n  details?: unknown;\r\n  field?: string;\r\n  traceId?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n/**\r\n * Custom error class for client API errors\r\n */\r\nexport class ClientApiError extends Error {\r\n  public readonly code?: string;\r\n  public readonly status?: number;\r\n  public readonly details?: unknown;\r\n  public readonly traceId?: string;\r\n  public readonly isNetworkError: boolean;\r\n  public readonly isServerError: boolean;\r\n  public readonly isValidationError: boolean;\r\n\r\n  constructor(error: ApiErrorResponse) {\r\n    super(error.message);\r\n    this.name = 'ClientApiError';\r\n    this.code = error.code;\r\n    this.status = error.status;\r\n    this.details = error.details;\r\n    this.traceId = error.traceId;\r\n\r\n    // Classify error types\r\n    this.isNetworkError = error.code === 'NETWORK_ERROR';\r\n    this.isServerError = (error.status ?? 0) >= 500;\r\n    this.isValidationError = error.status === 400;\r\n\r\n    // Maintain proper stack trace\r\n    if (typeof Error.captureStackTrace === 'function') {\r\n      Error.captureStackTrace(this, ClientApiError);\r\n    }\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Get API base URL from environment\r\n */\r\nfunction getApiBaseUrl(): string {\r\n  return process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\r\n}\r\n\r\n/**\r\n * Get authentication token from cookies (client-side)\r\n */\r\nfunction getAuthToken(): string | null {\r\n  if (typeof document === 'undefined') return null;\r\n  \r\n  try {\r\n    const cookies = document.cookie.split(';');\r\n    const authCookie = cookies.find(cookie => \r\n      cookie.trim().startsWith('auth_token=')\r\n    );\r\n    \r\n    if (authCookie) {\r\n      return authCookie.split('=')[1];\r\n    }\r\n    \r\n    return null;\r\n  } catch (error) {\r\n    console.error('[Client API] Failed to get auth token:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Generate unique request ID for tracing\r\n */\r\nfunction generateRequestId(): string {\r\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n}\r\n\r\n/**\r\n * Get CSRF token from cookies (client-side)\r\n */\r\nfunction getCsrfToken(): string | null {\r\n  if (typeof document === 'undefined') return null;\r\n  \r\n  try {\r\n    const cookies = document.cookie.split(';');\r\n    const csrfCookie = cookies.find(cookie => \r\n      cookie.trim().startsWith('csrf-token=')\r\n    );\r\n    \r\n    if (csrfCookie) {\r\n      return csrfCookie.split('=')[1];\r\n    }\r\n    \r\n    return null;\r\n  } catch (error) {\r\n    console.error('[Client API] Failed to get CSRF token:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// CORE FETCH FUNCTION\r\n// ==========================================\r\n\r\n/**\r\n * Core client-side fetch function\r\n *\r\n * @template T - The expected response data type\r\n * @param endpoint - API endpoint (relative or absolute URL)\r\n * @param options - Fetch options\r\n * @returns Promise resolving to typed API response\r\n *\r\n * @throws {ClientApiError} On request failure\r\n */\r\nexport async function clientFetch<T>(\r\n  endpoint: string,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  const {\r\n    requiresAuth = true,\r\n    onError,\r\n    retry = { attempts: 3, delay: 1000 },\r\n    timeout = 30000,\r\n    ...fetchOptions\r\n  } = options;\r\n\r\n  // Build full URL\r\n  const url = endpoint.startsWith('http')\r\n    ? endpoint\r\n    : `${getApiBaseUrl()}${endpoint}`;\r\n\r\n  // Prepare headers\r\n  const headers: Record<string, string> = {\r\n    'Content-Type': 'application/json',\r\n  };\r\n\r\n  // Merge additional headers\r\n  if (fetchOptions.headers) {\r\n    Object.entries(fetchOptions.headers).forEach(([key, value]) => {\r\n      if (typeof value === 'string') {\r\n        headers[key] = value;\r\n      }\r\n    });\r\n  }\r\n\r\n  // Add authentication if required\r\n  if (requiresAuth) {\r\n    const token = getAuthToken();\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n    }\r\n  }\r\n\r\n  // Add CSRF token for mutations\r\n  if (fetchOptions.method && ['POST', 'PUT', 'PATCH', 'DELETE'].includes(fetchOptions.method)) {\r\n    const csrfToken = getCsrfToken();\r\n    if (csrfToken) {\r\n      headers['X-CSRF-Token'] = csrfToken;\r\n    }\r\n  }\r\n\r\n  // Add request ID for tracing\r\n  headers['X-Request-ID'] = generateRequestId();\r\n\r\n  // Add security headers\r\n  headers['X-Content-Type-Options'] = 'nosniff';\r\n  headers['X-Frame-Options'] = 'DENY';\r\n  headers['X-XSS-Protection'] = '1; mode=block';\r\n\r\n  // Execute fetch with retry logic\r\n  let lastError: Error | null = null;\r\n\r\n  for (let attempt = 0; attempt < retry.attempts; attempt++) {\r\n    try {\r\n      // Create abort controller for timeout\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n      const response = await fetch(url, {\r\n        ...fetchOptions,\r\n        headers,\r\n        signal: controller.signal,\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      // Handle different response status codes\r\n      if (!response.ok) {\r\n        const error = await handleErrorResponse(response);\r\n\r\n        // Handle specific errors with redirects (client-side)\r\n        if (response.status === 401 && typeof window !== 'undefined') {\r\n          window.location.href = '/login';\r\n          return Promise.reject(error);\r\n        } else if (response.status === 403 && typeof window !== 'undefined') {\r\n          window.location.href = '/access-denied';\r\n          return Promise.reject(error);\r\n        }\r\n\r\n        throw error;\r\n      }\r\n\r\n      // Parse response\r\n      const contentType = response.headers.get('content-type');\r\n      if (contentType?.includes('application/json')) {\r\n        return await response.json() as T;\r\n      }\r\n\r\n      return await response.text() as unknown as T;\r\n\r\n    } catch (error) {\r\n      lastError = error as Error;\r\n\r\n      // Don't retry on client errors (except 408, 429)\r\n      if (error instanceof ClientApiError) {\r\n        const status = error.status;\r\n        if (status && status >= 400 && status < 500 && status !== 408 && status !== 429) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      // Wait before retry (exponential backoff)\r\n      if (attempt < retry.attempts - 1) {\r\n        await new Promise(resolve =>\r\n          setTimeout(resolve, retry.delay * Math.pow(2, attempt))\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  // All retries failed\r\n  const finalError = lastError || new Error('Unknown error');\r\n\r\n  if (onError) {\r\n    onError(finalError);\r\n  }\r\n\r\n  throw finalError;\r\n}\r\n\r\n/**\r\n * Handle error responses and create normalized error objects\r\n */\r\nasync function handleErrorResponse(response: Response): Promise<ClientApiError> {\r\n  let details: unknown;\r\n\r\n  try {\r\n    const contentType = response.headers.get('content-type');\r\n    if (contentType?.includes('application/json')) {\r\n      details = await response.json();\r\n    } else {\r\n      details = await response.text();\r\n    }\r\n  } catch {\r\n    details = null;\r\n  }\r\n\r\n  const error: ApiErrorResponse = {\r\n    message: typeof details === 'object' && details !== null && 'message' in details\r\n      ? (details as { message: string }).message\r\n      : response.statusText || 'Request failed',\r\n    status: response.status,\r\n    code: typeof details === 'object' && details !== null && 'code' in details\r\n      ? (details as { code: string }).code\r\n      : undefined,\r\n    details,\r\n    traceId: response.headers.get('x-trace-id') || undefined,\r\n  };\r\n\r\n  return new ClientApiError(error);\r\n}\r\n\r\n// ==========================================\r\n// CONVENIENCE METHODS\r\n// ==========================================\r\n\r\n/**\r\n * Client-side GET request\r\n */\r\nexport async function clientGet<T>(\r\n  endpoint: string,\r\n  params?: Record<string, string | number | boolean>,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  const queryString = params\r\n    ? '?' + new URLSearchParams(\r\n        Object.entries(params).map(([k, v]) => [k, String(v)])\r\n      ).toString()\r\n    : '';\r\n\r\n  return clientFetch<T>(`${endpoint}${queryString}`, {\r\n    ...options,\r\n    method: 'GET',\r\n  });\r\n}\r\n\r\n/**\r\n * Client-side POST request\r\n */\r\nexport async function clientPost<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  return clientFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'POST',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n  });\r\n}\r\n\r\n/**\r\n * Client-side PUT request\r\n */\r\nexport async function clientPut<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  return clientFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'PUT',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n  });\r\n}\r\n\r\n/**\r\n * Client-side PATCH request\r\n */\r\nexport async function clientPatch<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  return clientFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'PATCH',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n  });\r\n}\r\n\r\n/**\r\n * Client-side DELETE request\r\n */\r\nexport async function clientDelete<T>(\r\n  endpoint: string,\r\n  options: ClientFetchOptions = {}\r\n): Promise<T> {\r\n  return clientFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'DELETE',\r\n  });\r\n}\r\n\r\n// ==========================================\r\n// LEGACY CLIENT SUPPORT\r\n// ==========================================\r\n\r\n/**\r\n * Simple API client options for basic HTTP requests\r\n */\r\nexport interface ApiClientOptions {\r\n  method?: string\r\n  body?: unknown\r\n  headers?: Record<string, string>\r\n}\r\n\r\n/**\r\n * Simple API client for basic HTTP requests (legacy support)\r\n */\r\nexport async function apiClient(endpoint: string, options: ApiClientOptions = {}) {\r\n  const { method = 'GET', body, headers = {} } = options\r\n\r\n  const config: RequestInit = {\r\n    method,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...headers\r\n    }\r\n  }\r\n\r\n  if (body) {\r\n    config.body = JSON.stringify(body)\r\n  }\r\n\r\n  const url = endpoint.startsWith('http') ? endpoint : `${getApiBaseUrl()}${endpoint}`\r\n  const response = await fetch(url, config)\r\n\r\n  if (!response.ok) {\r\n    throw new Error(`API Error: ${response.statusText}`)\r\n  }\r\n\r\n  return response.json()\r\n}\r\n\r\n/**\r\n * Alias for apiClient (legacy support)\r\n */\r\nexport const fetchApi = apiClient\r\n\r\n// ==========================================\r\n// EXPORTS\r\n// ==========================================\r\n\r\nexport default {\r\n  clientFetch,\r\n  clientGet,\r\n  clientPost,\r\n  clientPut,\r\n  clientPatch,\r\n  clientDelete,\r\n  // Legacy exports\r\n  apiClient,\r\n  fetchApi,\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7281, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/lib/api/index.ts"],"sourcesContent":["/**\r\n * @fileoverview Centralized API Actions Hub\r\n * @module lib/api\r\n * @category API Client\r\n * \r\n * This is the single entry point for ALL API actions in the frontend.\r\n * All API calls should go through this centralized hub to ensure:\r\n * - Consistent error handling\r\n * - Unified caching strategy\r\n * - Centralized authentication\r\n * - Request/response logging\r\n * - Type safety\r\n * \r\n * @example\r\n * ```typescript\r\n * import { apiActions } from '@/lib/api';\r\n * \r\n * // All API calls go through centralized actions\r\n * const students = await apiActions.students.getAll({ grade: '5' });\r\n * const user = await apiActions.auth.getCurrentUser();\r\n * const appointments = await apiActions.appointments.getUpcoming();\r\n * ```\r\n * \r\n * @version 1.0.0\r\n * @since 2025-10-31\r\n */\r\n\r\n// ==========================================\r\n// CLIENT-SIDE API EXPORTS\r\n// ==========================================\r\n\r\n// Export client-side API functions (safe for Client Components)\r\nexport {\r\n  clientFetch,\r\n  clientGet,\r\n  clientPost,\r\n  clientPut,\r\n  clientPatch,\r\n  clientDelete,\r\n  apiClient,\r\n  fetchApi,\r\n  ClientApiError\r\n} from './client';\r\n\r\n// Export client types\r\nexport type {\r\n  ClientFetchOptions,\r\n  ApiClientOptions,\r\n  ApiErrorResponse\r\n} from './client';\r\n\r\n// ==========================================\r\n// SERVER-SIDE API EXPORTS\r\n// ==========================================\r\n\r\n// NOTE: Server-side API exports have been moved to './server' to prevent\r\n// client components from importing 'next/headers' which causes build errors.\r\n// Use: import { serverGet, serverPost, ... } from '@/lib/api/server'\r\n\r\n\r\n/**\r\n * Centralized API Actions Hub\r\n *\r\n * This object provides a single point of access to all API operations\r\n * organized by domain. Each domain uses the centralized client for\r\n * consistent behavior across the application.\r\n *\r\n * @note Service API integrations should be imported directly from their\r\n * respective modules when available. This is a placeholder for future\r\n * service integrations.\r\n */\r\nexport const apiActions = {\r\n  // Placeholder for future service API integrations\r\n  // Services should be imported from their respective modules as needed\r\n} as const;\r\n\r\n/**\r\n * Centralized API Error Handler\r\n * \r\n * Provides consistent error handling across all API calls\r\n */\r\nexport class CentralizedApiError extends Error {\r\n  public readonly code: string;\r\n  public readonly status?: number;\r\n  public readonly details?: unknown;\r\n  \r\n  constructor(\r\n    message: string, \r\n    code: string = 'API_ERROR', \r\n    status?: number, \r\n    details?: unknown\r\n  ) {\r\n    super(message);\r\n    this.name = 'CentralizedApiError';\r\n    this.code = code;\r\n    this.status = status;\r\n    this.details = details;\r\n  }\r\n}\r\n\r\n/**\r\n * Centralized API Request Wrapper\r\n * \r\n * Wraps all API calls with consistent error handling, logging, and caching\r\n */\r\nexport async function centralizedApiRequest<T>(\r\n  apiCall: () => Promise<T>,\r\n  context: {\r\n    operation: string;\r\n    domain: string;\r\n    cacheTags?: string[];\r\n    requiresAuth?: boolean;\r\n  }\r\n): Promise<T> {\r\n  const { operation, domain, cacheTags = [], requiresAuth = true } = context;\r\n  \r\n  try {\r\n    console.log(`[API] ${domain}.${operation} - Starting request`);\r\n    \r\n    const startTime = Date.now();\r\n    const result = await apiCall();\r\n    const endTime = Date.now();\r\n    \r\n    console.log(`[API] ${domain}.${operation} - Completed in ${endTime - startTime}ms`);\r\n    \r\n    return result;\r\n  } catch (error) {\r\n    console.error(`[API] ${domain}.${operation} - Error:`, error);\r\n    \r\n    if (error instanceof Error) {\r\n      throw new CentralizedApiError(\r\n        error.message,\r\n        `${domain.toUpperCase()}_${operation.toUpperCase()}_ERROR`,\r\n        undefined,\r\n        error\r\n      );\r\n    }\r\n    \r\n    throw new CentralizedApiError(\r\n      'Unknown API error occurred',\r\n      `${domain.toUpperCase()}_${operation.toUpperCase()}_UNKNOWN_ERROR`\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Centralized Cache Management\r\n * \r\n * Provides unified cache invalidation and management\r\n */\r\nexport const apiCache = {\r\n  /**\r\n   * Invalidate cache tags\r\n   */\r\n  invalidate: async (tags: string[]) => {\r\n    // This would integrate with Next.js cache invalidation\r\n    // For now, log the operation\r\n    console.log('[API Cache] Invalidating tags:', tags);\r\n  },\r\n  \r\n  /**\r\n   * Clear all cache\r\n   */\r\n  clearAll: async () => {\r\n    console.log('[API Cache] Clearing all cache');\r\n  },\r\n  \r\n  /**\r\n   * Build cache key for operation\r\n   */\r\n  buildKey: (domain: string, operation: string, params?: Record<string, unknown>) => {\r\n    const paramsKey = params ? JSON.stringify(params) : '';\r\n    return `${domain}:${operation}:${paramsKey}`;\r\n  }\r\n} as const;\r\n\r\n/**\r\n * API Actions Type Definitions\r\n */\r\nexport type ApiActionsType = typeof apiActions;\r\nexport type ApiDomain = keyof ApiActionsType;\r\n\r\n/**\r\n * Default export for convenient access\r\n */\r\nexport default apiActions;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;CAyBC,GAED,6CAA6C;AAC7C,0BAA0B;AAC1B,6CAA6C;AAE7C,gEAAgE;;;;;;;;;;;;;AAChE;;AAuCO,MAAM,aAAa;AAG1B;AAOO,MAAM,4BAA4B;IACvB,KAAa;IACb,OAAgB;IAChB,QAAkB;IAElC,YACE,OAAe,EACf,OAAe,WAAW,EAC1B,MAAe,EACf,OAAiB,CACjB;QACA,KAAK,CAAC;QACN,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,OAAO,GAAG;IACjB;AACF;AAOO,eAAe,sBACpB,OAAyB,EACzB,OAKC;IAED,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,eAAe,IAAI,EAAE,GAAG;IAEnE,IAAI;QACF,QAAQ,GAAG,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,UAAU,mBAAmB,CAAC;QAE7D,MAAM,YAAY,KAAK,GAAG;QAC1B,MAAM,SAAS,MAAM;QACrB,MAAM,UAAU,KAAK,GAAG;QAExB,QAAQ,GAAG,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,UAAU,gBAAgB,EAAE,UAAU,UAAU,EAAE,CAAC;QAElF,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,UAAU,SAAS,CAAC,EAAE;QAEvD,IAAI,iBAAiB,OAAO;YAC1B,MAAM,IAAI,oBACR,MAAM,OAAO,EACb,GAAG,OAAO,WAAW,GAAG,CAAC,EAAE,UAAU,WAAW,GAAG,MAAM,CAAC,EAC1D,WACA;QAEJ;QAEA,MAAM,IAAI,oBACR,8BACA,GAAG,OAAO,WAAW,GAAG,CAAC,EAAE,UAAU,WAAW,GAAG,cAAc,CAAC;IAEtE;AACF;AAOO,MAAM,WAAW;IACtB;;GAEC,GACD,YAAY,OAAO;QACjB,uDAAuD;QACvD,6BAA6B;QAC7B,QAAQ,GAAG,CAAC,kCAAkC;IAChD;IAEA;;GAEC,GACD,UAAU;QACR,QAAQ,GAAG,CAAC;IACd;IAEA;;GAEC,GACD,UAAU,CAAC,QAAgB,WAAmB;QAC5C,MAAM,YAAY,SAAS,KAAK,SAAS,CAAC,UAAU;QACpD,OAAO,GAAG,OAAO,CAAC,EAAE,UAAU,CAAC,EAAE,WAAW;IAC9C;AACF;uCAWe","debugId":null}},
    {"offset": {"line": 7380, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/usersSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview User Management Redux Slice\r\n * \r\n * This slice manages comprehensive user administration functionality for the healthcare management\r\n * system, including user accounts, roles, permissions, authentication status, and organizational\r\n * hierarchies. Designed specifically for healthcare environments with strict access control,\r\n * HIPAA compliance requirements, and multi-organizational support.\r\n * \r\n * Key Features:\r\n * - Role-based user management (Nurses, Administrators, Support Staff, etc.)\r\n * - Multi-organizational hierarchy support (District â†’ School â†’ Department)\r\n * - Healthcare-specific role assignments and permissions\r\n * - User authentication status and session management\r\n * - Account activation and deactivation workflows\r\n * - Audit logging for user account changes\r\n * - HIPAA-compliant user access tracking\r\n * - Bulk user operations for administrative efficiency\r\n * - User profile management with healthcare credentials\r\n * - Integration with access control and permission systems\r\n * \r\n * Healthcare User Roles:\r\n * - System Administrator: Full system access and configuration\r\n * - District Administrator: Multi-school oversight and reporting\r\n * - School Administrator: School-level management and supervision\r\n * - Head Nurse: Senior nursing staff with administrative duties\r\n * - School Nurse: Direct patient care and health services\r\n * - Substitute Nurse: Temporary coverage and limited access\r\n * - Support Staff: Administrative support with restricted access\r\n * - IT Support: Technical support with system maintenance access\r\n * \r\n * HIPAA Compliance Features:\r\n * - User access logging for audit trails\r\n * - Role-based PHI access controls\r\n * - Account security monitoring and alerts\r\n * - User authentication and authorization tracking\r\n * - Minimum necessary access principle enforcement\r\n * - User account change audit trails\r\n * - Session timeout and security controls\r\n * - Multi-factor authentication integration\r\n * \r\n * Organizational Hierarchy:\r\n * - District Level: Multi-school administration and oversight\r\n * - School Level: Individual school management\r\n * - Department Level: Specialized units (Health Office, Administration)\r\n * - User Level: Individual staff members and their assignments\r\n * - Cross-organizational visibility based on role permissions\r\n * \r\n * User Account Lifecycle:\r\n * - Account Creation: New user onboarding with role assignment\r\n * - Profile Setup: Healthcare credentials and certifications\r\n * - Role Assignment: Permission levels and access scope\r\n * - Account Activation: Initial setup and security configuration\r\n * - Ongoing Management: Profile updates and role changes\r\n * - Account Deactivation: Secure offboarding with data retention\r\n * - Account Archival: Long-term storage for compliance\r\n * \r\n * Performance Optimizations:\r\n * - User data caching with intelligent invalidation\r\n * - Lazy loading of user profiles and extended information\r\n * - Optimistic updates for non-critical user operations\r\n * - Background synchronization of user directory changes\r\n * - Efficient filtering and search capabilities\r\n * - Bulk operations for administrative efficiency\r\n * \r\n * @example\r\n * // Basic user management\r\n * const dispatch = useAppDispatch();\r\n * \r\n * // Fetch all users with filtering\r\n * dispatch(usersThunks.fetchAll({\r\n *   schoolId: 'school-123',\r\n *   role: 'nurse',\r\n *   isActive: true\r\n * }));\r\n * \r\n * // Create a new nurse user\r\n * dispatch(usersThunks.create({\r\n *   firstName: 'Jane',\r\n *   lastName: 'Smith',\r\n *   email: 'jane.smith@school.edu',\r\n *   role: 'nurse',\r\n *   schoolId: 'school-123',\r\n *   departmentId: 'health-office',\r\n *   credentials: ['RN', 'BSN'],\r\n *   licenseNumber: 'RN123456789'\r\n * }));\r\n * \r\n * @example\r\n * // Role-based user filtering\r\n * // Get all nurses in a district\r\n * const nurses = useAppSelector(state => \r\n *   selectUsersByRole(state, 'nurse')\r\n * );\r\n * \r\n * // Get active users in a school\r\n * const activeStaff = useAppSelector(state =>\r\n *   selectActiveUsers(state).filter(user => user.schoolId === schoolId)\r\n * );\r\n * \r\n * @example\r\n * // User account management\r\n * // Update user profile\r\n * dispatch(usersThunks.update('user-456', {\r\n *   credentials: ['RN', 'BSN', 'CPN'],\r\n *   licenseExpiration: '2025-12-31',\r\n *   department: 'pediatric_care'\r\n * }));\r\n * \r\n * // Deactivate user account\r\n * dispatch(usersThunks.update('user-789', {\r\n *   isActive: false,\r\n *   deactivationReason: 'Employment ended',\r\n *   deactivationDate: new Date().toISOString()\r\n * }));\r\n * \r\n * @example\r\n * // Organizational filtering\r\n * // Get all users in a school\r\n * const schoolStaff = useAppSelector(state =>\r\n *   selectUsersBySchool(state, 'school-123')\r\n * );\r\n * \r\n * // Get all users in a district\r\n * const districtStaff = useAppSelector(state =>\r\n *   selectUsersByDistrict(state, 'district-456')\r\n * );\r\n * \r\n * @example\r\n * // Advanced user queries\r\n * // Get users with expiring licenses\r\n * const expiringLicenses = useAppSelector(state => {\r\n *   const allUsers = usersSelectors.selectAll(state);\r\n *   const thirtyDaysFromNow = new Date();\r\n *   thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);\r\n *   \r\n *   return allUsers.filter(user => \r\n *     user.licenseExpiration && \r\n *     new Date(user.licenseExpiration) <= thirtyDaysFromNow\r\n *   );\r\n * });\r\n * \r\n * Integration Points:\r\n * - Authentication Service: User login and session management\r\n * - Access Control System: Role-based permissions and restrictions\r\n * - Audit Logging Service: User action tracking and compliance\r\n * - Directory Services: Integration with organizational directories\r\n * - Notification Service: User account alerts and communications\r\n * - Compliance Dashboard: User access reporting and analytics\r\n * - HR Systems: Employee lifecycle integration\r\n * \r\n * Security Considerations:\r\n * - User account data contains PII and must be protected\r\n * - Role assignments control access to PHI and sensitive data\r\n * - Account changes require proper authorization and approval\r\n * - User session management with timeout controls\r\n * - Password policy enforcement and security requirements\r\n * - Multi-factor authentication integration\r\n * - Account lockout and security monitoring\r\n * \r\n * Healthcare-Specific Features:\r\n * - Healthcare professional credentials tracking\r\n * - License expiration monitoring and alerts\r\n * - Continuing education requirements tracking\r\n * - Clinical competency validation\r\n * - Coverage and scheduling integration\r\n * - Emergency contact information management\r\n * - Professional liability and insurance tracking\r\n * \r\n * Compliance and Audit:\r\n * - HIPAA-compliant user access management\r\n * - Audit trail for all user account changes\r\n * - User access reporting for compliance reviews\r\n * - Role assignment documentation and approval\r\n * - Account security monitoring and reporting\r\n * - Data retention policies for user records\r\n * - Regulatory compliance reporting\r\n * \r\n * @author [Your Organization] - Healthcare IT Administration Team\r\n * @version 2.1.0\r\n * @since 2024-01-15\r\n * @see {@link https://your-docs.com/user-management} User Management Documentation\r\n * @see {@link https://your-docs.com/role-based-access} Role-Based Access Control Guide\r\n * @see {@link https://your-docs.com/healthcare-credentials} Healthcare Credentials Management\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { User, CreateUserData, UpdateUserData, UserFilters } from '@/types/administration';\r\nimport { apiActions } from '@/lib/api';\r\nimport type { RootState } from '@/stores/store';\r\n\r\n// Create API service adapter for users\r\nconst usersApiService: EntityApiService<User, CreateUserData, UpdateUserData> = {\r\n  async getAll(params?: UserFilters) {\r\n    const response = await apiActions.administration.getUsers(params);\r\n    return {\r\n      data: response.data || [],\r\n      total: response.pagination?.total,\r\n      pagination: response.pagination,\r\n    };\r\n  },\r\n\r\n  async getById(id: string) {\r\n    // For now, fetch all and filter - can be optimized with a dedicated endpoint\r\n    const response = await apiActions.administration.getUsers();\r\n    const user = response.data?.find((u: User) => u.id === id);\r\n    if (!user) {\r\n      throw new Error(`User with id ${id} not found`);\r\n    }\r\n    return { data: user };\r\n  },\r\n\r\n  async create(data: CreateUserData) {\r\n    const response = await apiActions.administration.createUser(data);\r\n    return { data: response };\r\n  },\r\n\r\n  async update(id: string, data: UpdateUserData) {\r\n    const response = await apiActions.administration.updateUser(id, data);\r\n    return { data: response };\r\n  },\r\n\r\n  async delete(id: string) {\r\n    await apiActions.administration.deleteUser(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n// Create the users slice using the factory\r\nconst usersSliceFactory = createEntitySlice<User, CreateUserData, UpdateUserData>(\r\n  'users',\r\n  usersApiService,\r\n  {\r\n    enableBulkOperations: true,\r\n  }\r\n);\r\n\r\n// Export the slice and its components\r\nexport const usersSlice = usersSliceFactory.slice;\r\nexport const usersReducer = usersSlice.reducer;\r\nexport const usersActions = usersSliceFactory.actions;\r\nexport const usersSelectors = usersSliceFactory.adapter.getSelectors((state: RootState) => state.users);\r\nexport const usersThunks = usersSliceFactory.thunks;\r\n\r\n// Export custom selectors\r\nexport const selectUsersByRole = (state: RootState, role: string): User[] => {\r\n  const allUsers = usersSelectors.selectAll(state) as User[];\r\n  return allUsers.filter(user => user.role === role);\r\n};\r\n\r\nexport const selectActiveUsers = (state: RootState): User[] => {\r\n  const allUsers = usersSelectors.selectAll(state) as User[];\r\n  return allUsers.filter(user => user.isActive);\r\n};\r\n\r\nexport const selectUsersBySchool = (state: RootState, schoolId: string): User[] => {\r\n  const allUsers = usersSelectors.selectAll(state) as User[];\r\n  return allUsers.filter(user => user.schoolId === schoolId);\r\n};\r\n\r\nexport const selectUsersByDistrict = (state: RootState, districtId: string): User[] => {\r\n  const allUsers = usersSelectors.selectAll(state) as User[];\r\n  return allUsers.filter(user => user.districtId === districtId);\r\n};\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAuLC;;;;;;;;;;;;;;;;;;;;AAED;AAEA;;;AAGA,uCAAuC;AACvC,MAAM,kBAA0E;IAC9E,MAAM,QAAO,MAAoB;QAC/B,MAAM,WAAW,MAAM,wJAAU,CAAC,cAAc,CAAC,QAAQ,CAAC;QAC1D,OAAO;YACL,MAAM,SAAS,IAAI,IAAI,EAAE;YACzB,OAAO,SAAS,UAAU,EAAE;YAC5B,YAAY,SAAS,UAAU;QACjC;IACF;IAEA,MAAM,SAAQ,EAAU;QACtB,6EAA6E;QAC7E,MAAM,WAAW,MAAM,wJAAU,CAAC,cAAc,CAAC,QAAQ;QACzD,MAAM,OAAO,SAAS,IAAI,EAAE,KAAK,CAAC,IAAY,EAAE,EAAE,KAAK;QACvD,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,GAAG,UAAU,CAAC;QAChD;QACA,OAAO;YAAE,MAAM;QAAK;IACtB;IAEA,MAAM,QAAO,IAAoB;QAC/B,MAAM,WAAW,MAAM,wJAAU,CAAC,cAAc,CAAC,UAAU,CAAC;QAC5D,OAAO;YAAE,MAAM;QAAS;IAC1B;IAEA,MAAM,QAAO,EAAU,EAAE,IAAoB;QAC3C,MAAM,WAAW,MAAM,wJAAU,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI;QAChE,OAAO;YAAE,MAAM;QAAS;IAC1B;IAEA,MAAM,QAAO,EAAU;QACrB,MAAM,wJAAU,CAAC,cAAc,CAAC,UAAU,CAAC;QAC3C,OAAO;YAAE,SAAS;QAAK;IACzB;AACF;AAEA,2CAA2C;AAC3C,MAAM,oBAAoB,IAAA,kJAAiB,EACzC,SACA,iBACA;IACE,sBAAsB;AACxB;AAIK,MAAM,aAAa,kBAAkB,KAAK;AAC1C,MAAM,eAAe,WAAW,OAAO;AACvC,MAAM,eAAe,kBAAkB,OAAO;AAC9C,MAAM,iBAAiB,kBAAkB,OAAO,CAAC,YAAY,CAAC,CAAC,QAAqB,MAAM,KAAK;AAC/F,MAAM,cAAc,kBAAkB,MAAM;AAG5C,MAAM,oBAAoB,CAAC,OAAkB;IAClD,MAAM,WAAW,eAAe,SAAS,CAAC;IAC1C,OAAO,SAAS,MAAM,CAAC,CAAA,OAAQ,KAAK,IAAI,KAAK;AAC/C;AAEO,MAAM,oBAAoB,CAAC;IAChC,MAAM,WAAW,eAAe,SAAS,CAAC;IAC1C,OAAO,SAAS,MAAM,CAAC,CAAA,OAAQ,KAAK,QAAQ;AAC9C;AAEO,MAAM,sBAAsB,CAAC,OAAkB;IACpD,MAAM,WAAW,eAAe,SAAS,CAAC;IAC1C,OAAO,SAAS,MAAM,CAAC,CAAA,OAAQ,KAAK,QAAQ,KAAK;AACnD;AAEO,MAAM,wBAAwB,CAAC,OAAkB;IACtD,MAAM,WAAW,eAAe,SAAS,CAAC;IAC1C,OAAO,SAAS,MAAM,CAAC,CAAA,OAAQ,KAAK,UAAU,KAAK;AACrD","debugId":null}},
    {"offset": {"line": 7656, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/dashboardSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Dashboard Redux Slice\r\n *\r\n * Comprehensive state management for nurse dashboard with real-time statistics, recent activities,\r\n * upcoming appointments, health alerts, and chart data. Provides aggregated view of daily operations\r\n * including student health status, appointment schedules, and critical alerts requiring immediate attention.\r\n *\r\n * **Key Features:**\r\n * - Real-time dashboard statistics (total students, appointments today, pending medications)\r\n * - Recent activity feed with filtering and pagination\r\n * - Upcoming appointments view with priority indicators\r\n * - Health alerts with severity levels (critical, high, medium, low)\r\n * - Chart data for visualizations (medication trends, appointment patterns, health metrics)\r\n * - Quick actions for common nurse workflows\r\n * - Date range filtering for historical data\r\n * - School/district scope selection for multi-location support\r\n * - Automatic cache refresh with configurable intervals\r\n *\r\n * **State Management Architecture:**\r\n * - Redux Toolkit with manual slice creation (not using EntityAdapter)\r\n * - Separate loading/error states for each dashboard section\r\n * - No localStorage persistence (dashboard data is transient)\r\n * - Real-time polling via TanStack Query (30-second intervals)\r\n * - Optimistic health alert management\r\n *\r\n * **HIPAA Compliance:**\r\n * - All dashboard operations trigger PHI access audit logs\r\n * - Dashboard displays student counts but not identifiable information in summaries\r\n * - Activity feed contains PHI (student names, actions) - requires audit logging\r\n * - Health alerts may contain student identifiers - logged access\r\n * - No caching of dashboard data in localStorage\r\n * - Role-based data filtering (nurses see only assigned students)\r\n *\r\n * **Dashboard Data Types:**\r\n * - **Statistics**: Aggregate counts, trends, and metrics\r\n * - **Recent Activities**: Last 10-50 nurse actions with timestamps\r\n * - **Upcoming Appointments**: Next 24 hours with conflict indicators\r\n * - **Health Alerts**: Critical issues requiring immediate attention\r\n * - **Chart Data**: Time-series data for visualizations\r\n * - **Quick Actions**: Contextual shortcuts for common tasks\r\n *\r\n * **Real-Time Update Strategy:**\r\n * - Auto-refresh every 30 seconds for critical dashboard sections\r\n * - Manual refresh via refreshDashboardCache action\r\n * - Optimistic updates for alert acknowledgment\r\n * - Server-sent events for critical health alerts (future enhancement)\r\n * - Background polling without blocking UI\r\n *\r\n * **TanStack Query Integration:**\r\n * - Dashboard stats: 30-second cache with auto-refresh\r\n * - Recent activities: 1-minute cache, invalidate on new actions\r\n * - Upcoming appointments: 30-second cache with polling\r\n * - Health alerts: 15-second cache, real-time critical alerts\r\n * - Chart data: 5-minute cache, invalidate on data changes\r\n *\r\n * **Performance Optimizations:**\r\n * - Bulk data loading via fetchCompleteDashboardData (reduces API calls)\r\n * - Selective re-rendering with memoized selectors\r\n * - Lazy loading for chart data (load only when chart tab active)\r\n * - Debounced date range updates\r\n * - Cached scope selections\r\n *\r\n * @module pages/dashboard/store/dashboardSlice\r\n * @see {@link services/modules/dashboardApi} for API implementation\r\n * @see {@link types/dashboard} for type definitions\r\n * @see {@link hooks/useDashboard} for React hooks integration\r\n */\r\n\r\nimport { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\r\nimport { apiActions } from '@/lib/api';\r\nimport type {\r\n  DashboardStats,\r\n  DashboardRecentActivity,\r\n  DashboardUpcomingAppointment,\r\n  DashboardChartData,\r\n  RecentActivitiesParams,\r\n  UpcomingAppointmentsParams,\r\n  ChartDataParams,\r\n  CompleteDashboardData,\r\n  HealthAlert,\r\n  QuickAction\r\n} from '../../types/dashboard';\r\n\r\n/**\r\n * Dashboard API Service Adapter\r\n *\r\n * Provides a clean interface to dashboard API methods with consistent error handling,\r\n * response formatting, and support for multiple data aggregation patterns. Handles both\r\n * individual section fetching and bulk dashboard data loading.\r\n *\r\n * @class DashboardApiService\r\n *\r\n * @remarks\r\n * **Authentication**: All methods require valid JWT token with nurse/admin role\r\n * **Authorization**: Data filtered by user's assigned students/schools\r\n * **Rate Limiting**: 200 requests per minute (dashboard has high refresh rate)\r\n * **Audit Logging**: Dashboard views trigger PHI access audit logs\r\n * **Caching**: Server-side caching for 15-30 seconds depending on data type\r\n * **Performance**: Use getCompleteDashboardData() for initial load to reduce round trips\r\n *\r\n * @example\r\n * ```typescript\r\n * const apiService = new DashboardApiService();\r\n * const stats = await apiService.getDashboardStats();\r\n * console.log(`Total students: ${stats.totalStudents}`);\r\n * ```\r\n */\r\nclass DashboardApiService {\r\n  /**\r\n   * Get comprehensive dashboard statistics\r\n   */\r\n  async getDashboardStats(): Promise<DashboardStats> {\r\n    try {\r\n      return await apiActions.dashboard.getDashboardStats();\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch dashboard statistics');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get recent activities with optional limit\r\n   */\r\n  async getRecentActivities(params?: RecentActivitiesParams): Promise<DashboardRecentActivity[]> {\r\n    try {\r\n      return await apiActions.dashboard.getRecentActivities(params);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch recent activities');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get upcoming appointments with optional limit\r\n   */\r\n  async getUpcomingAppointments(params?: UpcomingAppointmentsParams): Promise<DashboardUpcomingAppointment[]> {\r\n    try {\r\n      return await apiActions.dashboard.getUpcomingAppointments(params);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch upcoming appointments');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get chart data for visualizations\r\n   */\r\n  async getChartData(params?: ChartDataParams): Promise<DashboardChartData> {\r\n    try {\r\n      return await apiActions.dashboard.getChartData(params);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch chart data');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get complete dashboard data in single request\r\n   */\r\n  async getCompleteDashboardData(options?: {\r\n    activityLimit?: number;\r\n    appointmentLimit?: number;\r\n  }): Promise<Partial<CompleteDashboardData>> {\r\n    try {\r\n      return await apiActions.dashboard.getCompleteDashboardData(options);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch complete dashboard data');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh dashboard cache\r\n   */\r\n  async refreshCache(): Promise<boolean> {\r\n    try {\r\n      return await apiActions.dashboard.refreshCache();\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to refresh dashboard cache');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get dashboard stats by date range\r\n   */\r\n  async getDashboardStatsByDateRange(startDate: string, endDate: string): Promise<DashboardStats> {\r\n    try {\r\n      return await apiActions.dashboard.getDashboardStatsByDateRange(startDate, endDate);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch dashboard stats by date range');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get dashboard stats by scope (school/district)\r\n   */\r\n  async getDashboardStatsByScope(scope: {\r\n    schoolId?: string;\r\n    districtId?: string;\r\n  }): Promise<DashboardStats> {\r\n    try {\r\n      return await apiActions.dashboard.getDashboardStatsByScope(scope);\r\n    } catch (error: any) {\r\n      throw new Error(error.message || 'Failed to fetch scoped dashboard stats');\r\n    }\r\n  }\r\n}\r\n\r\n// Create service instance\r\nconst dashboardApiService = new DashboardApiService();\r\n\r\n/**\r\n * Dashboard State Interface\r\n */\r\ninterface DashboardState {\r\n  // Dashboard statistics\r\n  stats: DashboardStats | null;\r\n  statsLoading: boolean;\r\n  statsError: string | null;\r\n\r\n  // Recent activities\r\n  recentActivities: DashboardRecentActivity[];\r\n  activitiesLoading: boolean;\r\n  activitiesError: string | null;\r\n\r\n  // Upcoming appointments\r\n  upcomingAppointments: DashboardUpcomingAppointment[];\r\n  appointmentsLoading: boolean;\r\n  appointmentsError: string | null;\r\n\r\n  // Chart data\r\n  chartData: DashboardChartData | null;\r\n  chartLoading: boolean;\r\n  chartError: string | null;\r\n\r\n  // Health alerts\r\n  healthAlerts: HealthAlert[];\r\n  alertsLoading: boolean;\r\n  alertsError: string | null;\r\n\r\n  // Quick actions\r\n  quickActions: QuickAction[];\r\n\r\n  // General dashboard state\r\n  isRefreshing: boolean;\r\n  lastUpdated: string | null;\r\n  selectedDateRange: {\r\n    startDate: string | null;\r\n    endDate: string | null;\r\n  };\r\n  selectedScope: {\r\n    schoolId?: string;\r\n    districtId?: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Initial state\r\n */\r\nconst initialState: DashboardState = {\r\n  // Dashboard statistics\r\n  stats: null,\r\n  statsLoading: false,\r\n  statsError: null,\r\n\r\n  // Recent activities\r\n  recentActivities: [],\r\n  activitiesLoading: false,\r\n  activitiesError: null,\r\n\r\n  // Upcoming appointments\r\n  upcomingAppointments: [],\r\n  appointmentsLoading: false,\r\n  appointmentsError: null,\r\n\r\n  // Chart data\r\n  chartData: null,\r\n  chartLoading: false,\r\n  chartError: null,\r\n\r\n  // Health alerts\r\n  healthAlerts: [],\r\n  alertsLoading: false,\r\n  alertsError: null,\r\n\r\n  // Quick actions\r\n  quickActions: [],\r\n\r\n  // General dashboard state\r\n  isRefreshing: false,\r\n  lastUpdated: null,\r\n  selectedDateRange: {\r\n    startDate: null,\r\n    endDate: null,\r\n  },\r\n  selectedScope: {},\r\n};\r\n\r\n/**\r\n * Async Thunks\r\n */\r\n\r\n// Fetch dashboard statistics\r\nexport const fetchDashboardStats = createAsyncThunk(\r\n  'dashboard/fetchStats',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const stats = await dashboardApiService.getDashboardStats();\r\n      return stats;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch recent activities\r\nexport const fetchRecentActivities = createAsyncThunk(\r\n  'dashboard/fetchRecentActivities',\r\n  async (params: RecentActivitiesParams = {}, { rejectWithValue }) => {\r\n    try {\r\n      const activities = await dashboardApiService.getRecentActivities(params);\r\n      return activities;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch upcoming appointments\r\nexport const fetchUpcomingAppointments = createAsyncThunk(\r\n  'dashboard/fetchUpcomingAppointments',\r\n  async (params: UpcomingAppointmentsParams = {}, { rejectWithValue }) => {\r\n    try {\r\n      const appointments = await dashboardApiService.getUpcomingAppointments(params);\r\n      return appointments;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch chart data\r\nexport const fetchChartData = createAsyncThunk(\r\n  'dashboard/fetchChartData',\r\n  async (params: ChartDataParams = {}, { rejectWithValue }) => {\r\n    try {\r\n      const chartData = await dashboardApiService.getChartData(params);\r\n      return chartData;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch complete dashboard data\r\nexport const fetchCompleteDashboardData = createAsyncThunk(\r\n  'dashboard/fetchCompleteDashboardData',\r\n  async (options: {\r\n    activityLimit?: number;\r\n    appointmentLimit?: number;\r\n  } = {}, { rejectWithValue }) => {\r\n    try {\r\n      const data = await dashboardApiService.getCompleteDashboardData(options);\r\n      return data;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Refresh dashboard cache\r\nexport const refreshDashboardCache = createAsyncThunk(\r\n  'dashboard/refreshCache',\r\n  async (_, { rejectWithValue, dispatch }) => {\r\n    try {\r\n      const success = await dashboardApiService.refreshCache();\r\n      if (success) {\r\n        // Refetch all dashboard data after cache refresh\r\n        await dispatch(fetchCompleteDashboardData({}));\r\n      }\r\n      return success;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch dashboard stats by date range\r\nexport const fetchDashboardStatsByDateRange = createAsyncThunk(\r\n  'dashboard/fetchStatsByDateRange',\r\n  async (params: { startDate: string; endDate: string }, { rejectWithValue }) => {\r\n    try {\r\n      const stats = await dashboardApiService.getDashboardStatsByDateRange(params.startDate, params.endDate);\r\n      return stats;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n// Fetch dashboard stats by scope\r\nexport const fetchDashboardStatsByScope = createAsyncThunk(\r\n  'dashboard/fetchStatsByScope',\r\n  async (scope: {\r\n    schoolId?: string;\r\n    districtId?: string;\r\n  }, { rejectWithValue }) => {\r\n    try {\r\n      const stats = await dashboardApiService.getDashboardStatsByScope(scope);\r\n      return stats;\r\n    } catch (error: any) {\r\n      return rejectWithValue(error.message);\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Dashboard Slice\r\n */\r\nconst dashboardSlice = createSlice({\r\n  name: 'dashboard',\r\n  initialState,\r\n  reducers: {\r\n    // Set selected date range\r\n    setSelectedDateRange: (state, action: PayloadAction<{\r\n      startDate: string | null;\r\n      endDate: string | null;\r\n    }>) => {\r\n      state.selectedDateRange = action.payload;\r\n    },\r\n\r\n    // Set selected scope\r\n    setSelectedScope: (state, action: PayloadAction<{\r\n      schoolId?: string;\r\n      districtId?: string;\r\n    }>) => {\r\n      state.selectedScope = action.payload;\r\n    },\r\n\r\n    // Clear dashboard data\r\n    clearDashboardData: (state) => {\r\n      state.stats = null;\r\n      state.recentActivities = [];\r\n      state.upcomingAppointments = [];\r\n      state.chartData = null;\r\n      state.healthAlerts = [];\r\n      state.lastUpdated = null;\r\n    },\r\n\r\n    // Clear errors\r\n    clearErrors: (state) => {\r\n      state.statsError = null;\r\n      state.activitiesError = null;\r\n      state.appointmentsError = null;\r\n      state.chartError = null;\r\n      state.alertsError = null;\r\n    },\r\n\r\n    // Set quick actions\r\n    setQuickActions: (state, action: PayloadAction<QuickAction[]>) => {\r\n      state.quickActions = action.payload;\r\n    },\r\n\r\n    // Add health alert\r\n    addHealthAlert: (state, action: PayloadAction<HealthAlert>) => {\r\n      state.healthAlerts.unshift(action.payload);\r\n    },\r\n\r\n    // Remove health alert\r\n    removeHealthAlert: (state, action: PayloadAction<string>) => {\r\n      state.healthAlerts = state.healthAlerts.filter(alert => alert.id !== action.payload);\r\n    },\r\n\r\n    // Mark health alert as acknowledged\r\n    markAlertAsAcknowledged: (state, action: PayloadAction<string>) => {\r\n      const alert = state.healthAlerts.find(alert => alert.id === action.payload);\r\n      if (alert) {\r\n        alert.acknowledged = true;\r\n      }\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    // Fetch dashboard statistics\r\n    builder\r\n      .addCase(fetchDashboardStats.pending, (state) => {\r\n        state.statsLoading = true;\r\n        state.statsError = null;\r\n      })\r\n      .addCase(fetchDashboardStats.fulfilled, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.stats = action.payload;\r\n        state.lastUpdated = new Date().toISOString();\r\n      })\r\n      .addCase(fetchDashboardStats.rejected, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.statsError = action.payload as string;\r\n      });\r\n\r\n    // Fetch recent activities\r\n    builder\r\n      .addCase(fetchRecentActivities.pending, (state) => {\r\n        state.activitiesLoading = true;\r\n        state.activitiesError = null;\r\n      })\r\n      .addCase(fetchRecentActivities.fulfilled, (state, action) => {\r\n        state.activitiesLoading = false;\r\n        state.recentActivities = action.payload;\r\n      })\r\n      .addCase(fetchRecentActivities.rejected, (state, action) => {\r\n        state.activitiesLoading = false;\r\n        state.activitiesError = action.payload as string;\r\n      });\r\n\r\n    // Fetch upcoming appointments\r\n    builder\r\n      .addCase(fetchUpcomingAppointments.pending, (state) => {\r\n        state.appointmentsLoading = true;\r\n        state.appointmentsError = null;\r\n      })\r\n      .addCase(fetchUpcomingAppointments.fulfilled, (state, action) => {\r\n        state.appointmentsLoading = false;\r\n        state.upcomingAppointments = action.payload;\r\n      })\r\n      .addCase(fetchUpcomingAppointments.rejected, (state, action) => {\r\n        state.appointmentsLoading = false;\r\n        state.appointmentsError = action.payload as string;\r\n      });\r\n\r\n    // Fetch chart data\r\n    builder\r\n      .addCase(fetchChartData.pending, (state) => {\r\n        state.chartLoading = true;\r\n        state.chartError = null;\r\n      })\r\n      .addCase(fetchChartData.fulfilled, (state, action) => {\r\n        state.chartLoading = false;\r\n        state.chartData = action.payload;\r\n      })\r\n      .addCase(fetchChartData.rejected, (state, action) => {\r\n        state.chartLoading = false;\r\n        state.chartError = action.payload as string;\r\n      });\r\n\r\n    // Fetch complete dashboard data\r\n    builder\r\n      .addCase(fetchCompleteDashboardData.pending, (state) => {\r\n        state.isRefreshing = true;\r\n        state.statsLoading = true;\r\n        state.activitiesLoading = true;\r\n        state.appointmentsLoading = true;\r\n        // Clear errors\r\n        state.statsError = null;\r\n        state.activitiesError = null;\r\n        state.appointmentsError = null;\r\n        state.chartError = null;\r\n        state.alertsError = null;\r\n      })\r\n      .addCase(fetchCompleteDashboardData.fulfilled, (state, action) => {\r\n        state.isRefreshing = false;\r\n        state.statsLoading = false;\r\n        state.activitiesLoading = false;\r\n        state.appointmentsLoading = false;\r\n        \r\n        const data = action.payload;\r\n        \r\n        if (data.stats) {\r\n          state.stats = data.stats;\r\n        }\r\n        if (data.recentActivities) {\r\n          state.recentActivities = data.recentActivities;\r\n        }\r\n        if (data.upcomingAppointments) {\r\n          state.upcomingAppointments = data.upcomingAppointments;\r\n        }\r\n        if (data.healthAlerts) {\r\n          state.healthAlerts = data.healthAlerts;\r\n        }\r\n        if (data.quickActions) {\r\n          state.quickActions = data.quickActions;\r\n        }\r\n        \r\n        state.lastUpdated = new Date().toISOString();\r\n      })\r\n      .addCase(fetchCompleteDashboardData.rejected, (state, action) => {\r\n        state.isRefreshing = false;\r\n        state.statsLoading = false;\r\n        state.activitiesLoading = false;\r\n        state.appointmentsLoading = false;\r\n        state.statsError = action.payload as string;\r\n      });\r\n\r\n    // Refresh dashboard cache\r\n    builder\r\n      .addCase(refreshDashboardCache.pending, (state) => {\r\n        state.isRefreshing = true;\r\n      })\r\n      .addCase(refreshDashboardCache.fulfilled, (state) => {\r\n        state.isRefreshing = false;\r\n      })\r\n      .addCase(refreshDashboardCache.rejected, (state) => {\r\n        state.isRefreshing = false;\r\n      });\r\n\r\n    // Fetch stats by date range\r\n    builder\r\n      .addCase(fetchDashboardStatsByDateRange.pending, (state) => {\r\n        state.statsLoading = true;\r\n        state.statsError = null;\r\n      })\r\n      .addCase(fetchDashboardStatsByDateRange.fulfilled, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.stats = action.payload;\r\n        state.lastUpdated = new Date().toISOString();\r\n      })\r\n      .addCase(fetchDashboardStatsByDateRange.rejected, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.statsError = action.payload as string;\r\n      });\r\n\r\n    // Fetch stats by scope\r\n    builder\r\n      .addCase(fetchDashboardStatsByScope.pending, (state) => {\r\n        state.statsLoading = true;\r\n        state.statsError = null;\r\n      })\r\n      .addCase(fetchDashboardStatsByScope.fulfilled, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.stats = action.payload;\r\n        state.lastUpdated = new Date().toISOString();\r\n      })\r\n      .addCase(fetchDashboardStatsByScope.rejected, (state, action) => {\r\n        state.statsLoading = false;\r\n        state.statsError = action.payload as string;\r\n      });\r\n  },\r\n});\r\n\r\n// Export actions\r\nexport const {\r\n  setSelectedDateRange,\r\n  setSelectedScope,\r\n  clearDashboardData,\r\n  clearErrors,\r\n  setQuickActions,\r\n  addHealthAlert,\r\n  removeHealthAlert,\r\n  markAlertAsAcknowledged,\r\n} = dashboardSlice.actions;\r\n\r\n// Selectors\r\nexport const selectDashboardStats = (state: { dashboard: DashboardState }) => state.dashboard.stats;\r\nexport const selectDashboardStatsLoading = (state: { dashboard: DashboardState }) => state.dashboard.statsLoading;\r\nexport const selectDashboardStatsError = (state: { dashboard: DashboardState }) => state.dashboard.statsError;\r\n\r\nexport const selectRecentActivities = (state: { dashboard: DashboardState }) => state.dashboard.recentActivities;\r\nexport const selectActivitiesLoading = (state: { dashboard: DashboardState }) => state.dashboard.activitiesLoading;\r\nexport const selectActivitiesError = (state: { dashboard: DashboardState }) => state.dashboard.activitiesError;\r\n\r\nexport const selectUpcomingAppointments = (state: { dashboard: DashboardState }) => state.dashboard.upcomingAppointments;\r\nexport const selectAppointmentsLoading = (state: { dashboard: DashboardState }) => state.dashboard.appointmentsLoading;\r\nexport const selectAppointmentsError = (state: { dashboard: DashboardState }) => state.dashboard.appointmentsError;\r\n\r\nexport const selectChartData = (state: { dashboard: DashboardState }) => state.dashboard.chartData;\r\nexport const selectChartLoading = (state: { dashboard: DashboardState }) => state.dashboard.chartLoading;\r\nexport const selectChartError = (state: { dashboard: DashboardState }) => state.dashboard.chartError;\r\n\r\nexport const selectHealthAlerts = (state: { dashboard: DashboardState }) => state.dashboard.healthAlerts;\r\nexport const selectUnreadHealthAlerts = (state: { dashboard: DashboardState }) => \r\n  state.dashboard.healthAlerts.filter(alert => !alert.acknowledged);\r\n\r\nexport const selectQuickActions = (state: { dashboard: DashboardState }) => state.dashboard.quickActions;\r\nexport const selectIsRefreshing = (state: { dashboard: DashboardState }) => state.dashboard.isRefreshing;\r\nexport const selectLastUpdated = (state: { dashboard: DashboardState }) => state.dashboard.lastUpdated;\r\nexport const selectSelectedDateRange = (state: { dashboard: DashboardState }) => state.dashboard.selectedDateRange;\r\nexport const selectSelectedScope = (state: { dashboard: DashboardState }) => state.dashboard.selectedScope;\r\n\r\n// Derived selectors\r\nexport const selectHighPriorityAppointments = (state: { dashboard: DashboardState }) =>\r\n  state.dashboard.upcomingAppointments.filter(appointment => appointment.priority === 'high');\r\n\r\nexport const selectCriticalHealthAlerts = (state: { dashboard: DashboardState }) =>\r\n  state.dashboard.healthAlerts.filter(alert => alert.severity === 'critical' || alert.severity === 'high');\r\n\r\nexport const selectDashboardOverview = (state: { dashboard: DashboardState }) => ({\r\n  stats: state.dashboard.stats,\r\n  recentActivities: state.dashboard.recentActivities.slice(0, 5),\r\n  upcomingAppointments: state.dashboard.upcomingAppointments.slice(0, 5),\r\n  unreadAlerts: state.dashboard.healthAlerts.filter(alert => !alert.acknowledged).length,\r\n  isLoading: state.dashboard.statsLoading || state.dashboard.activitiesLoading || state.dashboard.appointmentsLoading,\r\n  hasError: !!(state.dashboard.statsError || state.dashboard.activitiesError || state.dashboard.appointmentsError),\r\n  lastUpdated: state.dashboard.lastUpdated,\r\n});\r\n\r\nexport default dashboardSlice.reducer;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAkEC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAED;AACA;;;AAcA;;;;;;;;;;;;;;;;;;;;;;;CAuBC,GACD,MAAM;IACJ;;GAEC,GACD,MAAM,oBAA6C;QACjD,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,iBAAiB;QACrD,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,oBAAoB,MAA+B,EAAsC;QAC7F,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,mBAAmB,CAAC;QACxD,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,wBAAwB,MAAmC,EAA2C;QAC1G,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,uBAAuB,CAAC;QAC5D,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,aAAa,MAAwB,EAA+B;QACxE,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,YAAY,CAAC;QACjD,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,yBAAyB,OAG9B,EAA2C;QAC1C,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,wBAAwB,CAAC;QAC7D,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,eAAiC;QACrC,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,YAAY;QAChD,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,6BAA6B,SAAiB,EAAE,OAAe,EAA2B;QAC9F,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,4BAA4B,CAAC,WAAW;QAC5E,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;IAEA;;GAEC,GACD,MAAM,yBAAyB,KAG9B,EAA2B;QAC1B,IAAI;YACF,OAAO,MAAM,wJAAU,CAAC,SAAS,CAAC,wBAAwB,CAAC;QAC7D,EAAE,OAAO,OAAY;YACnB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;IACF;AACF;AAEA,0BAA0B;AAC1B,MAAM,sBAAsB,IAAI;AA+ChC;;CAEC,GACD,MAAM,eAA+B;IACnC,uBAAuB;IACvB,OAAO;IACP,cAAc;IACd,YAAY;IAEZ,oBAAoB;IACpB,kBAAkB,EAAE;IACpB,mBAAmB;IACnB,iBAAiB;IAEjB,wBAAwB;IACxB,sBAAsB,EAAE;IACxB,qBAAqB;IACrB,mBAAmB;IAEnB,aAAa;IACb,WAAW;IACX,cAAc;IACd,YAAY;IAEZ,gBAAgB;IAChB,cAAc,EAAE;IAChB,eAAe;IACf,aAAa;IAEb,gBAAgB;IAChB,cAAc,EAAE;IAEhB,0BAA0B;IAC1B,cAAc;IACd,aAAa;IACb,mBAAmB;QACjB,WAAW;QACX,SAAS;IACX;IACA,eAAe,CAAC;AAClB;AAOO,MAAM,sBAAsB,IAAA,+MAAgB,EACjD,wBACA,OAAO,GAAG,EAAE,eAAe,EAAE;IAC3B,IAAI;QACF,MAAM,QAAQ,MAAM,oBAAoB,iBAAiB;QACzD,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,wBAAwB,IAAA,+MAAgB,EACnD,mCACA,OAAO,SAAiC,CAAC,CAAC,EAAE,EAAE,eAAe,EAAE;IAC7D,IAAI;QACF,MAAM,aAAa,MAAM,oBAAoB,mBAAmB,CAAC;QACjE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,4BAA4B,IAAA,+MAAgB,EACvD,uCACA,OAAO,SAAqC,CAAC,CAAC,EAAE,EAAE,eAAe,EAAE;IACjE,IAAI;QACF,MAAM,eAAe,MAAM,oBAAoB,uBAAuB,CAAC;QACvE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,iBAAiB,IAAA,+MAAgB,EAC5C,4BACA,OAAO,SAA0B,CAAC,CAAC,EAAE,EAAE,eAAe,EAAE;IACtD,IAAI;QACF,MAAM,YAAY,MAAM,oBAAoB,YAAY,CAAC;QACzD,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,6BAA6B,IAAA,+MAAgB,EACxD,wCACA,OAAO,UAGH,CAAC,CAAC,EAAE,EAAE,eAAe,EAAE;IACzB,IAAI;QACF,MAAM,OAAO,MAAM,oBAAoB,wBAAwB,CAAC;QAChE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,wBAAwB,IAAA,+MAAgB,EACnD,0BACA,OAAO,GAAG,EAAE,eAAe,EAAE,QAAQ,EAAE;IACrC,IAAI;QACF,MAAM,UAAU,MAAM,oBAAoB,YAAY;QACtD,IAAI,SAAS;YACX,iDAAiD;YACjD,MAAM,SAAS,2BAA2B,CAAC;QAC7C;QACA,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,iCAAiC,IAAA,+MAAgB,EAC5D,mCACA,OAAO,QAAgD,EAAE,eAAe,EAAE;IACxE,IAAI;QACF,MAAM,QAAQ,MAAM,oBAAoB,4BAA4B,CAAC,OAAO,SAAS,EAAE,OAAO,OAAO;QACrG,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAIK,MAAM,6BAA6B,IAAA,+MAAgB,EACxD,+BACA,OAAO,OAGJ,EAAE,eAAe,EAAE;IACpB,IAAI;QACF,MAAM,QAAQ,MAAM,oBAAoB,wBAAwB,CAAC;QACjE,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,OAAO,gBAAgB,MAAM,OAAO;IACtC;AACF;AAGF;;CAEC,GACD,MAAM,iBAAiB,IAAA,0MAAW,EAAC;IACjC,MAAM;IACN;IACA,UAAU;QACR,0BAA0B;QAC1B,sBAAsB,CAAC,OAAO;YAI5B,MAAM,iBAAiB,GAAG,OAAO,OAAO;QAC1C;QAEA,qBAAqB;QACrB,kBAAkB,CAAC,OAAO;YAIxB,MAAM,aAAa,GAAG,OAAO,OAAO;QACtC;QAEA,uBAAuB;QACvB,oBAAoB,CAAC;YACnB,MAAM,KAAK,GAAG;YACd,MAAM,gBAAgB,GAAG,EAAE;YAC3B,MAAM,oBAAoB,GAAG,EAAE;YAC/B,MAAM,SAAS,GAAG;YAClB,MAAM,YAAY,GAAG,EAAE;YACvB,MAAM,WAAW,GAAG;QACtB;QAEA,eAAe;QACf,aAAa,CAAC;YACZ,MAAM,UAAU,GAAG;YACnB,MAAM,eAAe,GAAG;YACxB,MAAM,iBAAiB,GAAG;YAC1B,MAAM,UAAU,GAAG;YACnB,MAAM,WAAW,GAAG;QACtB;QAEA,oBAAoB;QACpB,iBAAiB,CAAC,OAAO;YACvB,MAAM,YAAY,GAAG,OAAO,OAAO;QACrC;QAEA,mBAAmB;QACnB,gBAAgB,CAAC,OAAO;YACtB,MAAM,YAAY,CAAC,OAAO,CAAC,OAAO,OAAO;QAC3C;QAEA,sBAAsB;QACtB,mBAAmB,CAAC,OAAO;YACzB,MAAM,YAAY,GAAG,MAAM,YAAY,CAAC,MAAM,CAAC,CAAA,QAAS,MAAM,EAAE,KAAK,OAAO,OAAO;QACrF;QAEA,oCAAoC;QACpC,yBAAyB,CAAC,OAAO;YAC/B,MAAM,QAAQ,MAAM,YAAY,CAAC,IAAI,CAAC,CAAA,QAAS,MAAM,EAAE,KAAK,OAAO,OAAO;YAC1E,IAAI,OAAO;gBACT,MAAM,YAAY,GAAG;YACvB;QACF;IACF;IACA,eAAe,CAAC;QACd,6BAA6B;QAC7B,QACG,OAAO,CAAC,oBAAoB,OAAO,EAAE,CAAC;YACrC,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG;QACrB,GACC,OAAO,CAAC,oBAAoB,SAAS,EAAE,CAAC,OAAO;YAC9C,MAAM,YAAY,GAAG;YACrB,MAAM,KAAK,GAAG,OAAO,OAAO;YAC5B,MAAM,WAAW,GAAG,IAAI,OAAO,WAAW;QAC5C,GACC,OAAO,CAAC,oBAAoB,QAAQ,EAAE,CAAC,OAAO;YAC7C,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;QAEF,0BAA0B;QAC1B,QACG,OAAO,CAAC,sBAAsB,OAAO,EAAE,CAAC;YACvC,MAAM,iBAAiB,GAAG;YAC1B,MAAM,eAAe,GAAG;QAC1B,GACC,OAAO,CAAC,sBAAsB,SAAS,EAAE,CAAC,OAAO;YAChD,MAAM,iBAAiB,GAAG;YAC1B,MAAM,gBAAgB,GAAG,OAAO,OAAO;QACzC,GACC,OAAO,CAAC,sBAAsB,QAAQ,EAAE,CAAC,OAAO;YAC/C,MAAM,iBAAiB,GAAG;YAC1B,MAAM,eAAe,GAAG,OAAO,OAAO;QACxC;QAEF,8BAA8B;QAC9B,QACG,OAAO,CAAC,0BAA0B,OAAO,EAAE,CAAC;YAC3C,MAAM,mBAAmB,GAAG;YAC5B,MAAM,iBAAiB,GAAG;QAC5B,GACC,OAAO,CAAC,0BAA0B,SAAS,EAAE,CAAC,OAAO;YACpD,MAAM,mBAAmB,GAAG;YAC5B,MAAM,oBAAoB,GAAG,OAAO,OAAO;QAC7C,GACC,OAAO,CAAC,0BAA0B,QAAQ,EAAE,CAAC,OAAO;YACnD,MAAM,mBAAmB,GAAG;YAC5B,MAAM,iBAAiB,GAAG,OAAO,OAAO;QAC1C;QAEF,mBAAmB;QACnB,QACG,OAAO,CAAC,eAAe,OAAO,EAAE,CAAC;YAChC,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG;QACrB,GACC,OAAO,CAAC,eAAe,SAAS,EAAE,CAAC,OAAO;YACzC,MAAM,YAAY,GAAG;YACrB,MAAM,SAAS,GAAG,OAAO,OAAO;QAClC,GACC,OAAO,CAAC,eAAe,QAAQ,EAAE,CAAC,OAAO;YACxC,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;QAEF,gCAAgC;QAChC,QACG,OAAO,CAAC,2BAA2B,OAAO,EAAE,CAAC;YAC5C,MAAM,YAAY,GAAG;YACrB,MAAM,YAAY,GAAG;YACrB,MAAM,iBAAiB,GAAG;YAC1B,MAAM,mBAAmB,GAAG;YAC5B,eAAe;YACf,MAAM,UAAU,GAAG;YACnB,MAAM,eAAe,GAAG;YACxB,MAAM,iBAAiB,GAAG;YAC1B,MAAM,UAAU,GAAG;YACnB,MAAM,WAAW,GAAG;QACtB,GACC,OAAO,CAAC,2BAA2B,SAAS,EAAE,CAAC,OAAO;YACrD,MAAM,YAAY,GAAG;YACrB,MAAM,YAAY,GAAG;YACrB,MAAM,iBAAiB,GAAG;YAC1B,MAAM,mBAAmB,GAAG;YAE5B,MAAM,OAAO,OAAO,OAAO;YAE3B,IAAI,KAAK,KAAK,EAAE;gBACd,MAAM,KAAK,GAAG,KAAK,KAAK;YAC1B;YACA,IAAI,KAAK,gBAAgB,EAAE;gBACzB,MAAM,gBAAgB,GAAG,KAAK,gBAAgB;YAChD;YACA,IAAI,KAAK,oBAAoB,EAAE;gBAC7B,MAAM,oBAAoB,GAAG,KAAK,oBAAoB;YACxD;YACA,IAAI,KAAK,YAAY,EAAE;gBACrB,MAAM,YAAY,GAAG,KAAK,YAAY;YACxC;YACA,IAAI,KAAK,YAAY,EAAE;gBACrB,MAAM,YAAY,GAAG,KAAK,YAAY;YACxC;YAEA,MAAM,WAAW,GAAG,IAAI,OAAO,WAAW;QAC5C,GACC,OAAO,CAAC,2BAA2B,QAAQ,EAAE,CAAC,OAAO;YACpD,MAAM,YAAY,GAAG;YACrB,MAAM,YAAY,GAAG;YACrB,MAAM,iBAAiB,GAAG;YAC1B,MAAM,mBAAmB,GAAG;YAC5B,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;QAEF,0BAA0B;QAC1B,QACG,OAAO,CAAC,sBAAsB,OAAO,EAAE,CAAC;YACvC,MAAM,YAAY,GAAG;QACvB,GACC,OAAO,CAAC,sBAAsB,SAAS,EAAE,CAAC;YACzC,MAAM,YAAY,GAAG;QACvB,GACC,OAAO,CAAC,sBAAsB,QAAQ,EAAE,CAAC;YACxC,MAAM,YAAY,GAAG;QACvB;QAEF,4BAA4B;QAC5B,QACG,OAAO,CAAC,+BAA+B,OAAO,EAAE,CAAC;YAChD,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG;QACrB,GACC,OAAO,CAAC,+BAA+B,SAAS,EAAE,CAAC,OAAO;YACzD,MAAM,YAAY,GAAG;YACrB,MAAM,KAAK,GAAG,OAAO,OAAO;YAC5B,MAAM,WAAW,GAAG,IAAI,OAAO,WAAW;QAC5C,GACC,OAAO,CAAC,+BAA+B,QAAQ,EAAE,CAAC,OAAO;YACxD,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;QAEF,uBAAuB;QACvB,QACG,OAAO,CAAC,2BAA2B,OAAO,EAAE,CAAC;YAC5C,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG;QACrB,GACC,OAAO,CAAC,2BAA2B,SAAS,EAAE,CAAC,OAAO;YACrD,MAAM,YAAY,GAAG;YACrB,MAAM,KAAK,GAAG,OAAO,OAAO;YAC5B,MAAM,WAAW,GAAG,IAAI,OAAO,WAAW;QAC5C,GACC,OAAO,CAAC,2BAA2B,QAAQ,EAAE,CAAC,OAAO;YACpD,MAAM,YAAY,GAAG;YACrB,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC;IACJ;AACF;AAGO,MAAM,EACX,oBAAoB,EACpB,gBAAgB,EAChB,kBAAkB,EAClB,WAAW,EACX,eAAe,EACf,cAAc,EACd,iBAAiB,EACjB,uBAAuB,EACxB,GAAG,eAAe,OAAO;AAGnB,MAAM,uBAAuB,CAAC,QAAyC,MAAM,SAAS,CAAC,KAAK;AAC5F,MAAM,8BAA8B,CAAC,QAAyC,MAAM,SAAS,CAAC,YAAY;AAC1G,MAAM,4BAA4B,CAAC,QAAyC,MAAM,SAAS,CAAC,UAAU;AAEtG,MAAM,yBAAyB,CAAC,QAAyC,MAAM,SAAS,CAAC,gBAAgB;AACzG,MAAM,0BAA0B,CAAC,QAAyC,MAAM,SAAS,CAAC,iBAAiB;AAC3G,MAAM,wBAAwB,CAAC,QAAyC,MAAM,SAAS,CAAC,eAAe;AAEvG,MAAM,6BAA6B,CAAC,QAAyC,MAAM,SAAS,CAAC,oBAAoB;AACjH,MAAM,4BAA4B,CAAC,QAAyC,MAAM,SAAS,CAAC,mBAAmB;AAC/G,MAAM,0BAA0B,CAAC,QAAyC,MAAM,SAAS,CAAC,iBAAiB;AAE3G,MAAM,kBAAkB,CAAC,QAAyC,MAAM,SAAS,CAAC,SAAS;AAC3F,MAAM,qBAAqB,CAAC,QAAyC,MAAM,SAAS,CAAC,YAAY;AACjG,MAAM,mBAAmB,CAAC,QAAyC,MAAM,SAAS,CAAC,UAAU;AAE7F,MAAM,qBAAqB,CAAC,QAAyC,MAAM,SAAS,CAAC,YAAY;AACjG,MAAM,2BAA2B,CAAC,QACvC,MAAM,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA,QAAS,CAAC,MAAM,YAAY;AAE3D,MAAM,qBAAqB,CAAC,QAAyC,MAAM,SAAS,CAAC,YAAY;AACjG,MAAM,qBAAqB,CAAC,QAAyC,MAAM,SAAS,CAAC,YAAY;AACjG,MAAM,oBAAoB,CAAC,QAAyC,MAAM,SAAS,CAAC,WAAW;AAC/F,MAAM,0BAA0B,CAAC,QAAyC,MAAM,SAAS,CAAC,iBAAiB;AAC3G,MAAM,sBAAsB,CAAC,QAAyC,MAAM,SAAS,CAAC,aAAa;AAGnG,MAAM,iCAAiC,CAAC,QAC7C,MAAM,SAAS,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAA,cAAe,YAAY,QAAQ,KAAK;AAE/E,MAAM,6BAA6B,CAAC,QACzC,MAAM,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA,QAAS,MAAM,QAAQ,KAAK,cAAc,MAAM,QAAQ,KAAK;AAE5F,MAAM,0BAA0B,CAAC,QAAyC,CAAC;QAChF,OAAO,MAAM,SAAS,CAAC,KAAK;QAC5B,kBAAkB,MAAM,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG;QAC5D,sBAAsB,MAAM,SAAS,CAAC,oBAAoB,CAAC,KAAK,CAAC,GAAG;QACpE,cAAc,MAAM,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA,QAAS,CAAC,MAAM,YAAY,EAAE,MAAM;QACtF,WAAW,MAAM,SAAS,CAAC,YAAY,IAAI,MAAM,SAAS,CAAC,iBAAiB,IAAI,MAAM,SAAS,CAAC,mBAAmB;QACnH,UAAU,CAAC,CAAC,CAAC,MAAM,SAAS,CAAC,UAAU,IAAI,MAAM,SAAS,CAAC,eAAe,IAAI,MAAM,SAAS,CAAC,iBAAiB;QAC/G,aAAa,MAAM,SAAS,CAAC,WAAW;IAC1C,CAAC;uCAEc,eAAe,OAAO","debugId":null}},
    {"offset": {"line": 8215, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/healthRecordsSlice.ts"],"sourcesContent":["/**\r\n * @module pages/students/store/healthRecordsSlice\r\n *\r\n * Health Records Redux Slice - HIPAA-Compliant PHI Management\r\n *\r\n * Manages student health records with strict HIPAA compliance requirements.\r\n * Provides standardized CRUD operations for health record management using the\r\n * entity slice factory pattern with enhanced security and audit logging.\r\n *\r\n * @remarks\r\n * **CRITICAL - HIPAA Compliance:** This slice manages Protected Health Information (PHI)\r\n * and is subject to strict HIPAA regulations. All operations trigger comprehensive audit\r\n * logging in the backend for compliance tracking.\r\n *\r\n * **PHI Data Handling:**\r\n * - Health records contain highly sensitive PHI (diagnoses, treatments, medical history)\r\n * - PHI data is NEVER persisted to localStorage\r\n * - All PHI data stored in sessionStorage or memory only\r\n * - Automatic data clearing on session end or logout\r\n * - Encryption at rest and in transit (handled by backend API)\r\n *\r\n * **Audit Logging Integration:**\r\n * - Every CRUD operation logs: user ID, timestamp, operation type, record ID\r\n * - Read operations log PHI access for compliance audits\r\n * - All audit logs are immutable and stored in backend database\r\n * - Audit logs include IP address, device info for security tracking\r\n *\r\n * **Cross-Tab Synchronization:**\r\n * - Uses BroadcastChannel API (NOT localStorage) for cross-tab sync\r\n * - Prevents PHI exposure through persistent storage\r\n * - Real-time updates across browser tabs for multi-nurse workflows\r\n *\r\n * **Bulk Operations Disabled:**\r\n * - Bulk operations intentionally disabled for safety\r\n * - Each health record change requires individual review and validation\r\n * - Prevents accidental mass updates to sensitive medical data\r\n *\r\n * **Data Minimization:**\r\n * - Only loads health records for currently active student\r\n * - Automatic cache clearing when navigating away from student\r\n * - Reduces PHI exposure per HIPAA data minimization principle\r\n *\r\n * @see {@link healthRecordsApi} for backend API integration with audit logging\r\n * @see {@link HealthRecord} for health record entity type definition\r\n * @see {@link createEntitySlice} for factory implementation details\r\n *\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { HealthRecord } from '@/types/student.types';\r\nimport { apiActions } from '@/lib/api';\r\nimport type { RootState } from '@/stores/store';\r\n\r\n// Transform API response (with 'type'/'date') to store format (with 'recordType'/'recordDate')\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nconst transformApiToStore = (apiRecord: any): HealthRecord => ({\r\n  id: apiRecord.id as string,\r\n  studentId: apiRecord.studentId as string,\r\n  recordType: apiRecord.type as string,\r\n  recordDate: apiRecord.date as string,\r\n  provider: apiRecord.provider as string | undefined,\r\n  notes: apiRecord.notes as string | undefined,\r\n  attachments: (apiRecord.attachments as string[]) || [],\r\n  createdAt: apiRecord.createdAt as string,\r\n  updatedAt: apiRecord.updatedAt as string,\r\n});\r\n\r\n// Transform store create data to API format\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nconst transformCreateToApi = (storeData: CreateHealthRecordData): any => ({\r\n  studentId: storeData.studentId,\r\n  type: storeData.recordType,\r\n  date: storeData.recordDate,\r\n  provider: storeData.provider,\r\n  notes: storeData.notes,\r\n  attachments: storeData.attachments,\r\n});\r\n\r\n// Transform store update data to API format\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nconst transformUpdateToApi = (storeData: UpdateHealthRecordData): any => ({\r\n  type: storeData.recordType,\r\n  date: storeData.recordDate,\r\n  provider: storeData.provider,\r\n  notes: storeData.notes,\r\n  attachments: storeData.attachments,\r\n});\r\n\r\n/**\r\n * Data required to create a new health record.\r\n *\r\n * @interface CreateHealthRecordData\r\n *\r\n * @property {string} studentId - Student ID (PHI - links to student identity)\r\n * @property {string} recordType - Type of health record (e.g., 'IMMUNIZATION', 'PHYSICAL_EXAM', 'VISIT', 'CONDITION')\r\n * @property {string} recordDate - ISO date when record was created or event occurred\r\n * @property {string} [provider] - Healthcare provider name or ID (optional)\r\n * @property {string} [notes] - Clinical notes or observations (PHI - medical information)\r\n * @property {string[]} [attachments] - Document IDs for attached files (e.g., lab results, forms)\r\n *\r\n * @remarks\r\n * **PHI Content:** All fields except recordType and recordDate may contain PHI.\r\n * Notes field commonly contains diagnoses, treatments, and medical observations.\r\n *\r\n * **Validation:** Backend validates recordType against allowed values, ensures\r\n * recordDate is not in future, and verifies studentId exists.\r\n *\r\n * @example\r\n * ```typescript\r\n * const newRecord: CreateHealthRecordData = {\r\n *   studentId: 'student-123',\r\n *   recordType: 'PHYSICAL_EXAM',\r\n *   recordDate: '2024-08-15',\r\n *   provider: 'Dr. Smith',\r\n *   notes: 'Annual physical examination. All vitals normal.',\r\n *   attachments: ['doc-456', 'doc-789']\r\n * };\r\n * ```\r\n */\r\ninterface CreateHealthRecordData {\r\n  studentId: string;\r\n  recordType: string;\r\n  recordDate: string;\r\n  provider?: string;\r\n  notes?: string;\r\n  attachments?: string[];\r\n}\r\n\r\n/**\r\n * Data allowed for updating an existing health record.\r\n *\r\n * All fields are optional to support partial updates. StudentId cannot be changed\r\n * after creation (immutable for audit trail integrity).\r\n *\r\n * @interface UpdateHealthRecordData\r\n *\r\n * @property {string} [recordType] - Updated record type\r\n * @property {string} [recordDate] - Updated record date\r\n * @property {string} [provider] - Updated provider information\r\n * @property {string} [notes] - Updated or appended clinical notes\r\n * @property {string[]} [attachments] - Updated attachment list\r\n *\r\n * @remarks\r\n * **Audit Trail:** Updates create new audit log entries recording which fields changed.\r\n * Original values are preserved in audit history for compliance.\r\n *\r\n * **Notes Appending:** Common pattern is to append to existing notes rather than\r\n * replace, maintaining full medical history timeline.\r\n */\r\ninterface UpdateHealthRecordData {\r\n  recordType?: string;\r\n  recordDate?: string;\r\n  provider?: string;\r\n  notes?: string;\r\n  attachments?: string[];\r\n}\r\n\r\n/**\r\n * Filter parameters for querying health records.\r\n *\r\n * Supports filtering by student, record type, date range, and provider with\r\n * pagination support for large record sets.\r\n *\r\n * @interface HealthRecordFilters\r\n *\r\n * @property {string} [studentId] - Filter by specific student (required for getAll)\r\n * @property {string} [recordType] - Filter by record type (e.g., 'IMMUNIZATION')\r\n * @property {string} [startDate] - Filter by date range start (ISO format)\r\n * @property {string} [endDate] - Filter by date range end (ISO format)\r\n * @property {string} [provider] - Filter by healthcare provider\r\n * @property {number} [page] - Page number for pagination (1-indexed)\r\n * @property {number} [limit] - Number of records per page (default: 20)\r\n *\r\n * @remarks\r\n * **Required studentId:** For HIPAA data minimization, health records queries\r\n * must specify studentId to prevent broad PHI access.\r\n *\r\n * **Date Range Filtering:** Useful for generating compliance reports or\r\n * reviewing records for specific time periods.\r\n */\r\ninterface HealthRecordFilters {\r\n  studentId?: string;\r\n  recordType?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  provider?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n/**\r\n * API service adapter for health records.\r\n *\r\n * Wraps the healthRecordsApi service to conform to the EntityApiService interface\r\n * required by the entity slice factory. Handles response transformation, error\r\n * handling, and enforces studentId requirement for all operations.\r\n *\r\n * @const {EntityApiService<HealthRecord, CreateHealthRecordData, UpdateHealthRecordData>}\r\n *\r\n * @remarks\r\n * **HIPAA Audit Logging:** All methods trigger comprehensive audit logging in the\r\n * backend API layer, recording user, timestamp, operation, and record ID.\r\n *\r\n * **Required studentId:** The getAll method requires studentId parameter to enforce\r\n * data minimization - prevents broad PHI queries that could expose multiple students'\r\n * health information.\r\n *\r\n * **Error Handling:** API errors are caught and transformed to user-friendly messages\r\n * without exposing PHI details in error messages.\r\n *\r\n * @see {@link healthRecordsApi} for underlying API implementation with audit logging\r\n * @see {@link EntityApiService} for interface definition\r\n */\r\nconst healthRecordsApiService: EntityApiService<HealthRecord, CreateHealthRecordData, UpdateHealthRecordData> = {\r\n  /**\r\n   * Fetches all health records for a specific student with optional filtering.\r\n   *\r\n   * @param {HealthRecordFilters} [params] - Filter parameters (studentId required)\r\n   * @returns {Promise<{data: HealthRecord[], total?: number, pagination?: any}>} Health records and pagination\r\n   * @throws {Error} If studentId is missing or student not found\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation logs PHI access for compliance audits.\r\n   *\r\n   * **Required Parameter:** studentId is required to enforce data minimization.\r\n   * Backend rejects queries without studentId to prevent broad PHI access.\r\n   *\r\n   * **Performance:** Returns paginated results for students with many records.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Fetch all immunization records for a student\r\n   * const response = await healthRecordsApiService.getAll({\r\n   *   studentId: 'student-123',\r\n   *   recordType: 'IMMUNIZATION'\r\n   * });\r\n   * ```\r\n   */\r\n  async getAll(params?: HealthRecordFilters) {\r\n    // HealthRecordsApi requires studentId as first parameter\r\n    const studentId = params?.studentId || '';\r\n    if (!studentId) {\r\n      throw new Error('studentId is required for fetching health records');\r\n    }\r\n    const response = await apiActions.healthRecords.getRecords(studentId, params);\r\n    return {\r\n      data: (response.data || []).map(transformApiToStore),\r\n      total: response.pagination?.total || 0,\r\n      pagination: response.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetches a single health record by ID.\r\n   *\r\n   * @param {string} id - Health record ID to fetch\r\n   * @returns {Promise<{data: HealthRecord}>} Single health record\r\n   * @throws {Error} If record not found or access denied\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation logs PHI access for compliance audits.\r\n   *\r\n   * **Access Control:** Backend verifies user has permission to access this\r\n   * record based on role and student assignment.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const record = await healthRecordsApiService.getById('record-456');\r\n   * ```\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.healthRecords.getRecordById(id);\r\n    return { data: transformApiToStore(response) };\r\n  },\r\n\r\n  /**\r\n   * Creates a new health record.\r\n   *\r\n   * @param {CreateHealthRecordData} data - Health record creation data\r\n   * @returns {Promise<{data: HealthRecord}>} Created health record\r\n   * @throws {Error} If validation fails or studentId not found\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Creation triggers audit log for new PHI record creation,\r\n   * recording who created the record, when, and for which student.\r\n   *\r\n   * **Validation:** Backend validates recordType, ensures recordDate is valid,\r\n   * and verifies studentId exists before creation.\r\n   *\r\n   * **Medical Record Integrity:** Creates immutable baseline record that can only\r\n   * be updated via audit-logged operations.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const newRecord = await healthRecordsApiService.create({\r\n   *   studentId: 'student-123',\r\n   *   recordType: 'IMMUNIZATION',\r\n   *   recordDate: '2024-09-01',\r\n   *   provider: 'School Nurse',\r\n   *   notes: 'Flu vaccine administered. No adverse reactions.'\r\n   * });\r\n   * ```\r\n   */\r\n  async create(data: CreateHealthRecordData) {\r\n    const apiData = transformCreateToApi(data);\r\n    const response = await apiActions.healthRecords.createRecord(apiData);\r\n    return { data: transformApiToStore(response) };\r\n  },\r\n\r\n  /**\r\n   * Updates an existing health record.\r\n   *\r\n   * @param {string} id - Health record ID to update\r\n   * @param {UpdateHealthRecordData} data - Updated health record data (partial)\r\n   * @returns {Promise<{data: HealthRecord}>} Updated health record\r\n   * @throws {Error} If record not found, access denied, or validation fails\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Update triggers audit log recording which fields changed,\r\n   * preserving original values for compliance and legal requirements.\r\n   *\r\n   * **Partial Updates:** Supports updating only specific fields without affecting\r\n   * others, maintaining data integrity.\r\n   *\r\n   * **Medical Record Integrity:** Updates are appended to audit trail, original\r\n   * data is never physically deleted or overwritten.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Append follow-up note to existing record\r\n   * const updated = await healthRecordsApiService.update('record-456', {\r\n   *   notes: record.notes + '\\n\\nFollow-up 9/15: No complications reported.'\r\n   * });\r\n   * ```\r\n   */\r\n  async update(id: string, data: UpdateHealthRecordData) {\r\n    const apiData = transformUpdateToApi(data);\r\n    const response = await apiActions.healthRecords.updateRecord(id, apiData);\r\n    return { data: transformApiToStore(response) };\r\n  },\r\n\r\n  /**\r\n   * Deletes (soft-deletes) a health record.\r\n   *\r\n   * @param {string} id - Health record ID to delete\r\n   * @returns {Promise<{success: boolean}>} Deletion success status\r\n   * @throws {Error} If record not found or access denied\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Deletion triggers audit log for data retention compliance.\r\n   *\r\n   * **Soft Delete:** Health records are soft-deleted (marked inactive) rather than\r\n   * physically deleted to maintain medical history and legal compliance. Physical\r\n   * deletion requires elevated permissions and separate retention policy procedures.\r\n   *\r\n   * **Medical-Legal Requirements:** Health records typically must be retained for\r\n   * minimum period (7 years for minors in most jurisdictions) per legal requirements.\r\n   *\r\n   * **Access After Deletion:** Soft-deleted records remain accessible to authorized\r\n   * users for compliance audits and legal discovery.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * await healthRecordsApiService.delete('record-456');\r\n   * // Record is marked inactive, not physically deleted\r\n   * ```\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.healthRecords.deleteRecord(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Health records slice factory instance.\r\n *\r\n * Creates the Redux slice with standardized CRUD operations, loading states,\r\n * and error handling using the entity slice factory pattern.\r\n *\r\n * @const\r\n *\r\n * @remarks\r\n * **Bulk Operations Disabled:** Intentionally disabled for health records to ensure\r\n * each medical record change receives individual validation and review. This prevents\r\n * accidental mass updates to sensitive medical data that could compromise patient safety\r\n * or data integrity.\r\n *\r\n * **Normalized State:** Uses EntityAdapter for normalized state management with\r\n * efficient O(1) lookups by record ID.\r\n *\r\n * **Medical Record Safety:** Individual operations ensure proper validation,\r\n * access control, and audit logging for each health record change.\r\n *\r\n * @see {@link createEntitySlice} for factory implementation details\r\n */\r\nconst healthRecordsSliceFactory = createEntitySlice<HealthRecord, CreateHealthRecordData, UpdateHealthRecordData>(\r\n  'healthRecords',\r\n  healthRecordsApiService,\r\n  {\r\n    enableBulkOperations: false, // Disable bulk operations for sensitive health data\r\n  }\r\n);\r\n\r\n/**\r\n * Health records Redux slice.\r\n *\r\n * @exports healthRecordsSlice\r\n */\r\nexport const healthRecordsSlice = healthRecordsSliceFactory.slice;\r\n\r\n/**\r\n * Health records reducer for Redux store.\r\n *\r\n * @exports healthRecordsReducer\r\n */\r\nexport const healthRecordsReducer = healthRecordsSlice.reducer;\r\n\r\n/**\r\n * Action creators for health record state updates.\r\n *\r\n * Includes synchronous actions (setFilters, clearCache, etc.) and\r\n * auto-generated actions from async thunks (pending, fulfilled, rejected).\r\n *\r\n * @exports healthRecordsActions\r\n */\r\nexport const healthRecordsActions = healthRecordsSliceFactory.actions;\r\n\r\n/**\r\n * Entity adapter selectors for normalized health record state.\r\n *\r\n * Provides efficient selectors for accessing health records:\r\n * - selectAll: Get all health records as array\r\n * - selectById: Get health record by ID\r\n * - selectIds: Get all health record IDs\r\n * - selectEntities: Get health records as normalized object\r\n * - selectTotal: Get total count\r\n *\r\n * @exports healthRecordsSelectors\r\n *\r\n * @example\r\n * ```typescript\r\n * const allRecords = useSelector(healthRecordsSelectors.selectAll);\r\n * const record = useSelector(state => healthRecordsSelectors.selectById(state, 'record-123'));\r\n * ```\r\n */\r\nexport const healthRecordsSelectors = healthRecordsSliceFactory.adapter.getSelectors((state: RootState) => state.healthRecords);\r\n\r\n/**\r\n * Async thunks for health record API operations.\r\n *\r\n * Provides thunks for all CRUD operations:\r\n * - fetchAll: Fetch health records with filters (requires studentId)\r\n * - fetchById: Fetch single health record\r\n * - create: Create new health record\r\n * - update: Update existing health record\r\n * - delete: Delete (soft-delete) health record\r\n *\r\n * @exports healthRecordsThunks\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch all immunization records for a student\r\n * dispatch(healthRecordsThunks.fetchAll({\r\n *   studentId: 'student-123',\r\n *   recordType: 'IMMUNIZATION'\r\n * }));\r\n *\r\n * // Create new health record\r\n * dispatch(healthRecordsThunks.create(recordData));\r\n * ```\r\n */\r\nexport const healthRecordsThunks = healthRecordsSliceFactory.thunks;\r\n\r\n/**\r\n * Selector for health records by student.\r\n *\r\n * Returns all health records for a specific student, useful for displaying\r\n * student's complete medical history.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student ID to filter by\r\n * @returns {HealthRecord[]} Health records for specified student\r\n *\r\n * @remarks\r\n * **HIPAA Data Minimization:** Only returns records for specified student,\r\n * preventing broad PHI exposure.\r\n *\r\n * @example\r\n * ```typescript\r\n * const studentRecords = useSelector(state =>\r\n *   selectHealthRecordsByStudent(state, 'student-123')\r\n * );\r\n * ```\r\n */\r\nexport const selectHealthRecordsByStudent = (state: RootState, studentId: string): HealthRecord[] => {\r\n  const allRecords = healthRecordsSelectors.selectAll(state) as HealthRecord[];\r\n  return allRecords.filter(record => record.studentId === studentId);\r\n};\r\n\r\n/**\r\n * Selector for health records by type.\r\n *\r\n * Returns health records of a specific type (e.g., 'IMMUNIZATION', 'PHYSICAL_EXAM',\r\n * 'VISIT', 'CONDITION'), useful for generating type-specific reports.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} recordType - Record type to filter by\r\n * @returns {HealthRecord[]} Health records of specified type\r\n *\r\n * @remarks\r\n * **Use Cases:**\r\n * - Immunization compliance reports\r\n * - Physical exam tracking\r\n * - Chronic condition monitoring\r\n * - Visit history analysis\r\n *\r\n * @example\r\n * ```typescript\r\n * const immunizations = useSelector(state =>\r\n *   selectHealthRecordsByType(state, 'IMMUNIZATION')\r\n * );\r\n * ```\r\n */\r\nexport const selectHealthRecordsByType = (state: RootState, recordType: string): HealthRecord[] => {\r\n  const allRecords = healthRecordsSelectors.selectAll(state) as HealthRecord[];\r\n  return allRecords.filter(record => record.recordType === recordType);\r\n};\r\n\r\n/**\r\n * Selector for health records by provider.\r\n *\r\n * Returns health records documented by a specific healthcare provider,\r\n * useful for provider-specific reporting and quality assurance.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} provider - Provider name or ID to filter by\r\n * @returns {HealthRecord[]} Health records by specified provider\r\n *\r\n * @example\r\n * ```typescript\r\n * const nurseRecords = useSelector(state =>\r\n *   selectHealthRecordsByProvider(state, 'Nurse Smith')\r\n * );\r\n * ```\r\n */\r\nexport const selectHealthRecordsByProvider = (state: RootState, provider: string): HealthRecord[] => {\r\n  const allRecords = healthRecordsSelectors.selectAll(state) as HealthRecord[];\r\n  return allRecords.filter(record => record.provider === provider);\r\n};\r\n\r\n/**\r\n * Selector for recent health records.\r\n *\r\n * Returns health records created or updated within the specified number of days,\r\n * sorted by date (most recent first). Useful for displaying recent medical activity.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {number} [days=30] - Number of days to look back (default: 30)\r\n * @returns {HealthRecord[]} Recent health records sorted by date descending\r\n *\r\n * @remarks\r\n * **Performance:** Consider using with pagination for students with extensive\r\n * medical histories (100+ records).\r\n *\r\n * **Clinical Relevance:** Recent records (30 days) are typically most relevant\r\n * for current treatment decisions and follow-ups.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Get records from last 7 days\r\n * const recentRecords = useSelector(state =>\r\n *   selectRecentHealthRecords(state, 7)\r\n * );\r\n * ```\r\n */\r\nexport const selectRecentHealthRecords = (state: RootState, days: number = 30): HealthRecord[] => {\r\n  const allRecords = healthRecordsSelectors.selectAll(state) as HealthRecord[];\r\n  const cutoffDate = new Date();\r\n  cutoffDate.setDate(cutoffDate.getDate() - days);\r\n\r\n  return allRecords.filter(record => {\r\n    const recordDate = new Date(record.recordDate);\r\n    return recordDate >= cutoffDate;\r\n  }).sort((a, b) => new Date(b.recordDate).getTime() - new Date(a.recordDate).getTime());\r\n};\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA+CC;;;;;;;;;;;;;;;;;;;;AAED;AAEA;;;AAGA,+FAA+F;AAC/F,8DAA8D;AAC9D,MAAM,sBAAsB,CAAC,YAAiC,CAAC;QAC7D,IAAI,UAAU,EAAE;QAChB,WAAW,UAAU,SAAS;QAC9B,YAAY,UAAU,IAAI;QAC1B,YAAY,UAAU,IAAI;QAC1B,UAAU,UAAU,QAAQ;QAC5B,OAAO,UAAU,KAAK;QACtB,aAAa,AAAC,UAAU,WAAW,IAAiB,EAAE;QACtD,WAAW,UAAU,SAAS;QAC9B,WAAW,UAAU,SAAS;IAChC,CAAC;AAED,4CAA4C;AAC5C,8DAA8D;AAC9D,MAAM,uBAAuB,CAAC,YAA2C,CAAC;QACxE,WAAW,UAAU,SAAS;QAC9B,MAAM,UAAU,UAAU;QAC1B,MAAM,UAAU,UAAU;QAC1B,UAAU,UAAU,QAAQ;QAC5B,OAAO,UAAU,KAAK;QACtB,aAAa,UAAU,WAAW;IACpC,CAAC;AAED,4CAA4C;AAC5C,8DAA8D;AAC9D,MAAM,uBAAuB,CAAC,YAA2C,CAAC;QACxE,MAAM,UAAU,UAAU;QAC1B,MAAM,UAAU,UAAU;QAC1B,UAAU,UAAU,QAAQ;QAC5B,OAAO,UAAU,KAAK;QACtB,aAAa,UAAU,WAAW;IACpC,CAAC;AAwGD;;;;;;;;;;;;;;;;;;;;;;CAsBC,GACD,MAAM,0BAA0G;IAC9G;;;;;;;;;;;;;;;;;;;;;;;GAuBC,GACD,MAAM,QAAO,MAA4B;QACvC,yDAAyD;QACzD,MAAM,YAAY,QAAQ,aAAa;QACvC,IAAI,CAAC,WAAW;YACd,MAAM,IAAI,MAAM;QAClB;QACA,MAAM,WAAW,MAAM,wJAAU,CAAC,aAAa,CAAC,UAAU,CAAC,WAAW;QACtE,OAAO;YACL,MAAM,CAAC,SAAS,IAAI,IAAI,EAAE,EAAE,GAAG,CAAC;YAChC,OAAO,SAAS,UAAU,EAAE,SAAS;YACrC,YAAY,SAAS,UAAU;QACjC;IACF;IAEA;;;;;;;;;;;;;;;;;GAiBC,GACD,MAAM,SAAQ,EAAU;QACtB,MAAM,WAAW,MAAM,wJAAU,CAAC,aAAa,CAAC,aAAa,CAAC;QAC9D,OAAO;YAAE,MAAM,oBAAoB;QAAU;IAC/C;IAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BC,GACD,MAAM,QAAO,IAA4B;QACvC,MAAM,UAAU,qBAAqB;QACrC,MAAM,WAAW,MAAM,wJAAU,CAAC,aAAa,CAAC,YAAY,CAAC;QAC7D,OAAO;YAAE,MAAM,oBAAoB;QAAU;IAC/C;IAEA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBC,GACD,MAAM,QAAO,EAAU,EAAE,IAA4B;QACnD,MAAM,UAAU,qBAAqB;QACrC,MAAM,WAAW,MAAM,wJAAU,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI;QACjE,OAAO;YAAE,MAAM,oBAAoB;QAAU;IAC/C;IAEA;;;;;;;;;;;;;;;;;;;;;;;;;GAyBC,GACD,MAAM,QAAO,EAAU;QACrB,MAAM,wJAAU,CAAC,aAAa,CAAC,YAAY,CAAC;QAC5C,OAAO;YAAE,SAAS;QAAK;IACzB;AACF;AAEA;;;;;;;;;;;;;;;;;;;;;CAqBC,GACD,MAAM,4BAA4B,IAAA,kJAAiB,EACjD,iBACA,yBACA;IACE,sBAAsB;AACxB;AAQK,MAAM,qBAAqB,0BAA0B,KAAK;AAO1D,MAAM,uBAAuB,mBAAmB,OAAO;AAUvD,MAAM,uBAAuB,0BAA0B,OAAO;AAoB9D,MAAM,yBAAyB,0BAA0B,OAAO,CAAC,YAAY,CAAC,CAAC,QAAqB,MAAM,aAAa;AA0BvH,MAAM,sBAAsB,0BAA0B,MAAM;AAuB5D,MAAM,+BAA+B,CAAC,OAAkB;IAC7D,MAAM,aAAa,uBAAuB,SAAS,CAAC;IACpD,OAAO,WAAW,MAAM,CAAC,CAAA,SAAU,OAAO,SAAS,KAAK;AAC1D;AA0BO,MAAM,4BAA4B,CAAC,OAAkB;IAC1D,MAAM,aAAa,uBAAuB,SAAS,CAAC;IACpD,OAAO,WAAW,MAAM,CAAC,CAAA,SAAU,OAAO,UAAU,KAAK;AAC3D;AAmBO,MAAM,gCAAgC,CAAC,OAAkB;IAC9D,MAAM,aAAa,uBAAuB,SAAS,CAAC;IACpD,OAAO,WAAW,MAAM,CAAC,CAAA,SAAU,OAAO,QAAQ,KAAK;AACzD;AA2BO,MAAM,4BAA4B,CAAC,OAAkB,OAAe,EAAE;IAC3E,MAAM,aAAa,uBAAuB,SAAS,CAAC;IACpD,MAAM,aAAa,IAAI;IACvB,WAAW,OAAO,CAAC,WAAW,OAAO,KAAK;IAE1C,OAAO,WAAW,MAAM,CAAC,CAAA;QACvB,MAAM,aAAa,IAAI,KAAK,OAAO,UAAU;QAC7C,OAAO,cAAc;IACvB,GAAG,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,UAAU,EAAE,OAAO;AACrF","debugId":null}},
    {"offset": {"line": 8552, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/medicationsSlice.ts"],"sourcesContent":["/**\r\n * Medications Redux Slice\r\n *\r\n * Redux Toolkit slice for managing student medication prescriptions and administration\r\n * data. Provides standardized CRUD operations, selectors, and thunks for medication\r\n * management throughout the application.\r\n *\r\n * Uses the entity slice factory pattern for consistent state management across all\r\n * medication-related operations with built-in loading states, error handling, and\r\n * optimistic updates.\r\n *\r\n * @module pages/medications/store/medicationsSlice\r\n *\r\n * @remarks\r\n * HIPAA Compliance: All medication operations automatically generate audit logs for\r\n * PHI access tracking. State updates trigger cross-tab synchronization via BroadcastChannel.\r\n *\r\n * Medication Safety: Bulk operations are intentionally disabled for medication management\r\n * to ensure each medication change receives individual validation and review.\r\n *\r\n * State Structure: Uses Redux Toolkit's EntityAdapter for normalized state management,\r\n * enabling efficient lookups and updates by medication ID.\r\n *\r\n * @see {@link medicationsApi} for API integration\r\n * @see {@link useMedicationsData} for hook-based data access\r\n * @see {@link MedicationTypes} for type definitions\r\n *\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { Medication } from '@/types/api';\r\nimport { apiActions } from '@/lib/api';\r\nimport type { RootState } from '@/stores/store';\r\n\r\n/**\r\n * Data required to create a new student medication prescription.\r\n *\r\n * @interface CreateMedicationData\r\n *\r\n * @property {string} studentId - Student receiving the medication (PHI)\r\n * @property {string} medicationId - Reference to medication catalog entry\r\n * @property {string} dosage - Prescribed dosage (e.g., \"10mg\", \"2 tablets\")\r\n * @property {string} frequency - Administration frequency (e.g., \"TWICE_DAILY\", \"AS_NEEDED\")\r\n * @property {string} route - Route of administration (e.g., \"ORAL\", \"INJECTION_SC\")\r\n * @property {string} startDate - ISO date when medication should begin\r\n * @property {string} [endDate] - ISO date when medication should end (optional for ongoing)\r\n * @property {string} [prescribedBy] - Prescribing physician name or ID\r\n * @property {string} [instructions] - Special administration instructions\r\n * @property {string} [sideEffects] - Known or potential side effects to monitor\r\n * @property {boolean} [requiresParentConsent] - True if parent consent required before administration\r\n */\r\ninterface CreateMedicationData {\r\n  studentId: string;\r\n  medicationId: string;\r\n  dosage: string;\r\n  frequency: string;\r\n  route: string;\r\n  startDate: string;\r\n  endDate?: string;\r\n  prescribedBy?: string;\r\n  instructions?: string;\r\n  sideEffects?: string;\r\n  requiresParentConsent?: boolean;\r\n}\r\n\r\n/**\r\n * Data allowed for updating an existing student medication prescription.\r\n *\r\n * All fields are optional to support partial updates. Changes to dosage, frequency,\r\n * or route typically require new physician orders.\r\n *\r\n * @interface UpdateMedicationData\r\n *\r\n * @property {string} [dosage] - Updated dosage amount\r\n * @property {string} [frequency] - Updated administration frequency\r\n * @property {string} [route] - Updated administration route\r\n * @property {string} [startDate] - Updated start date\r\n * @property {string} [endDate] - Updated end date\r\n * @property {string} [prescribedBy] - Updated prescriber information\r\n * @property {string} [instructions] - Updated administration instructions\r\n * @property {string} [sideEffects] - Updated side effects information\r\n * @property {boolean} [isActive] - Updated active status\r\n * @property {boolean} [requiresParentConsent] - Updated consent requirement\r\n * @property {string} [parentConsentDate] - Date parent consent was obtained\r\n */\r\ninterface UpdateMedicationData {\r\n  dosage?: string;\r\n  frequency?: string;\r\n  route?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  prescribedBy?: string;\r\n  instructions?: string;\r\n  sideEffects?: string;\r\n  isActive?: boolean;\r\n  requiresParentConsent?: boolean;\r\n  parentConsentDate?: string;\r\n}\r\n\r\n/**\r\n * Filter parameters for querying medications.\r\n *\r\n * Supports filtering by student, medication type, active status, consent requirements,\r\n * and date ranges with pagination support.\r\n *\r\n * @interface MedicationFilters\r\n *\r\n * @property {string} [studentId] - Filter by specific student\r\n * @property {string} [medicationId] - Filter by specific medication from catalog\r\n * @property {boolean} [isActive] - Filter by active status\r\n * @property {boolean} [requiresParentConsent] - Filter by consent requirement\r\n * @property {string} [startDate] - Filter by start date (ISO format)\r\n * @property {string} [endDate] - Filter by end date (ISO format)\r\n * @property {number} [page] - Page number for pagination (1-indexed)\r\n * @property {number} [limit] - Number of results per page\r\n */\r\ninterface MedicationFilters {\r\n  studentId?: string;\r\n  medicationId?: string;\r\n  isActive?: boolean;\r\n  requiresParentConsent?: boolean;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n/**\r\n * API service adapter for medications.\r\n *\r\n * Wraps the medicationsApi service to conform to the EntityApiService interface\r\n * required by the slice factory. Handles response transformation and error handling\r\n * for all medication CRUD operations.\r\n *\r\n * @const {EntityApiService<Medication, CreateMedicationData, UpdateMedicationData>}\r\n *\r\n * @remarks\r\n * API Integration: All methods call medicationsApi which handles authentication,\r\n * error handling, retry logic, and audit logging.\r\n *\r\n * Response Transformation: Normalizes API responses to match slice factory expectations,\r\n * ensuring consistent data structure across all entity types.\r\n *\r\n * @see {@link medicationsApi} for underlying API implementation\r\n */\r\nconst medicationsApiService: EntityApiService<Medication, CreateMedicationData, UpdateMedicationData> = {\r\n  /**\r\n   * Fetches all medications with optional filtering and pagination.\r\n   *\r\n   * @param {MedicationFilters} [params] - Optional filter parameters\r\n   * @returns {Promise<{data: Medication[], total?: number, pagination?: any}>} Medications and pagination info\r\n   */\r\n  async getAll(params?: MedicationFilters) {\r\n    const response = await apiActions.medications.getAll(params);\r\n    return {\r\n      data: response.medications || [],\r\n      total: response.pagination?.total,\r\n      pagination: response.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetches a single medication by ID.\r\n   *\r\n   * @param {string} id - Medication ID\r\n   * @returns {Promise<{data: Medication}>} Single medication record\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.medications.getById(id);\r\n    return { data: response };\r\n  },\r\n\r\n  /**\r\n   * Creates a new student medication prescription.\r\n   *\r\n   * @param {CreateMedicationData} data - Medication creation data\r\n   * @returns {Promise<{data: Medication}>} Created medication record\r\n   *\r\n   * @remarks\r\n   * Medication Safety: Creation triggers validation of drug interactions,\r\n   * contraindications, and allergy checks before saving.\r\n   */\r\n  async create(data: CreateMedicationData) {\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const response = await apiActions.medications.create(data as any);\r\n    return { data: response.medication };\r\n  },\r\n\r\n  /**\r\n   * Updates an existing student medication prescription.\r\n   *\r\n   * @param {string} id - Medication ID to update\r\n   * @param {UpdateMedicationData} data - Updated medication data\r\n   * @returns {Promise<{data: Medication}>} Updated medication record\r\n   *\r\n   * @remarks\r\n   * Medication Safety: Updates to dosage, frequency, or route may require\r\n   * new physician orders depending on school policy.\r\n   */\r\n  async update(id: string, data: UpdateMedicationData) {\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const response = await apiActions.medications.update(id, data as any);\r\n    return { data: response };\r\n  },\r\n\r\n  /**\r\n   * Deletes (soft-deletes) a student medication prescription.\r\n   *\r\n   * @param {string} id - Medication ID to delete\r\n   * @returns {Promise<{success: boolean}>} Deletion success status\r\n   *\r\n   * @remarks\r\n   * Medication Safety: Deletion typically performs soft-delete to preserve\r\n   * audit trail. Physical deletion requires elevated permissions.\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.medications.delete(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Medications slice factory instance.\r\n *\r\n * Creates the Redux slice with standardized CRUD operations, loading states,\r\n * and error handling using the entity slice factory pattern.\r\n *\r\n * @const\r\n *\r\n * @remarks\r\n * Medication Safety: Bulk operations are intentionally disabled to ensure each\r\n * medication change receives individual validation and review. This prevents\r\n * accidental mass updates that could compromise patient safety.\r\n *\r\n * @see {@link createEntitySlice} for factory implementation details\r\n */\r\nconst medicationsSliceFactory = createEntitySlice<Medication, CreateMedicationData, UpdateMedicationData>(\r\n  'medications',\r\n  medicationsApiService,\r\n  {\r\n    enableBulkOperations: false, // Disable bulk operations for medication safety\r\n  }\r\n);\r\n\r\n/**\r\n * Medications Redux slice.\r\n *\r\n * @const {Slice}\r\n * @exports medicationsSlice\r\n */\r\nexport const medicationsSlice = medicationsSliceFactory.slice;\r\n\r\n/**\r\n * Medications reducer function for Redux store.\r\n *\r\n * @const {Reducer}\r\n * @exports medicationsReducer\r\n */\r\nexport const medicationsReducer = medicationsSlice.reducer;\r\n\r\n/**\r\n * Action creators for medication state updates.\r\n *\r\n * Includes both synchronous actions (setFilters, clearCache, etc.) and\r\n * auto-generated actions from async thunks (pending, fulfilled, rejected).\r\n *\r\n * @const {ActionCreators}\r\n * @exports medicationsActions\r\n */\r\nexport const medicationsActions = medicationsSliceFactory.actions;\r\n\r\n/**\r\n * Entity adapter selectors for normalized medication state.\r\n *\r\n * Provides efficient selectors for accessing medications:\r\n * - selectAll: Get all medications as array\r\n * - selectById: Get medication by ID\r\n * - selectIds: Get all medication IDs\r\n * - selectEntities: Get medications as normalized object\r\n * - selectTotal: Get total count\r\n *\r\n * @const {EntitySelectors}\r\n * @exports medicationsSelectors\r\n *\r\n * @example\r\n * ```typescript\r\n * const allMedications = useSelector(medicationsSelectors.selectAll);\r\n * const medication = useSelector(state => medicationsSelectors.selectById(state, 'med-123'));\r\n * ```\r\n */\r\nexport const medicationsSelectors = medicationsSliceFactory.adapter.getSelectors((state: RootState) => state.medications);\r\n\r\n/**\r\n * Async thunks for medication API operations.\r\n *\r\n * Provides thunks for all CRUD operations:\r\n * - fetchAll: Fetch medications with filters\r\n * - fetchById: Fetch single medication\r\n * - create: Create new medication\r\n * - update: Update existing medication\r\n * - delete: Delete medication\r\n *\r\n * @const {AsyncThunks}\r\n * @exports medicationsThunks\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch all active medications for a student\r\n * dispatch(medicationsThunks.fetchAll({ studentId: '123', isActive: true }));\r\n *\r\n * // Create new medication\r\n * dispatch(medicationsThunks.create(medicationData));\r\n * ```\r\n */\r\nexport const medicationsThunks = medicationsSliceFactory.thunks;\r\n\r\n/**\r\n * Selector for active medications from catalog.\r\n *\r\n * Returns all medications from the medication catalog. In the catalog context,\r\n * all medications are assumed available for prescription.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Medication[]} Array of all catalog medications\r\n *\r\n * @example\r\n * ```typescript\r\n * const activeMeds = useSelector(selectActiveMedications);\r\n * ```\r\n *\r\n * @remarks\r\n * Note: This selector is for the medication catalog, not student prescriptions.\r\n * For student-specific active medications, use selectActiveMedicationsByStudent.\r\n */\r\nexport const selectActiveMedications = (state: RootState): Medication[] => {\r\n  const allMedications = medicationsSelectors.selectAll(state) as Medication[];\r\n  // Medication catalog doesn't have isActive - all medications in catalog are assumed available\r\n  return allMedications;\r\n};\r\n\r\n/**\r\n * Selector for controlled substance medications.\r\n *\r\n * Filters medications to return only those classified as controlled substances\r\n * requiring DEA tracking and witness documentation.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Medication[]} Array of controlled substance medications\r\n *\r\n * @example\r\n * ```typescript\r\n * const controlledMeds = useSelector(selectControlledMedications);\r\n * ```\r\n *\r\n * @remarks\r\n * Medication Safety: Controlled substances require special handling including:\r\n * - Secure storage in locked cabinet\r\n * - Witness documentation for administration\r\n * - Enhanced audit logging\r\n * - Periodic inventory reconciliation\r\n */\r\nexport const selectControlledMedications = (state: RootState): Medication[] => {\r\n  const allMedications = medicationsSelectors.selectAll(state) as Medication[];\r\n  return allMedications.filter(medication => medication.isControlled);\r\n};\r\n\r\n/**\r\n * Selector for medications filtered by category.\r\n *\r\n * Returns medications matching a specific category (e.g., \"Antibiotic\", \"Analgesic\",\r\n * \"Antihistamine\", \"Antiseizure\").\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} category - Medication category to filter by\r\n * @returns {Medication[]} Array of medications in the specified category\r\n *\r\n * @example\r\n * ```typescript\r\n * const antibiotics = useSelector(state => selectMedicationsByCategory(state, 'Antibiotic'));\r\n * ```\r\n */\r\nexport const selectMedicationsByCategory = (state: RootState, category: string): Medication[] => {\r\n  const allMedications = medicationsSelectors.selectAll(state) as Medication[];\r\n  return allMedications.filter(medication => medication.category === category);\r\n};\r\n\r\n/**\r\n * Selector for medications filtered by dosage form.\r\n *\r\n * Returns medications available in a specific dosage form (e.g., \"Tablet\", \"Liquid\",\r\n * \"Injection\", \"Inhaler\").\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} dosageForm - Dosage form to filter by\r\n * @returns {Medication[]} Array of medications in the specified form\r\n *\r\n * @example\r\n * ```typescript\r\n * const tablets = useSelector(state => selectMedicationsByForm(state, 'Tablet'));\r\n * const liquids = useSelector(state => selectMedicationsByForm(state, 'Liquid'));\r\n * ```\r\n */\r\nexport const selectMedicationsByForm = (state: RootState, dosageForm: string): Medication[] => {\r\n  const allMedications = medicationsSelectors.selectAll(state) as Medication[];\r\n  return allMedications.filter(medication => medication.dosageForm === dosageForm);\r\n};\r\n\r\n/**\r\n * Selector for medications requiring witness documentation.\r\n *\r\n * Returns medications that require a second healthcare provider to witness\r\n * administration, typically controlled substances and high-risk medications.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Medication[]} Array of medications requiring witness\r\n *\r\n * @example\r\n * ```typescript\r\n * const witnessRequired = useSelector(selectMedicationsRequiringWitness);\r\n * ```\r\n *\r\n * @remarks\r\n * Medication Safety: Medications requiring witness include:\r\n * - All controlled substances (DEA Schedule II-V)\r\n * - Injectable medications (depending on school policy)\r\n * - High-alert medications (e.g., insulin)\r\n *\r\n * Workflow: Administration interface should prompt for witness selection when\r\n * administering these medications.\r\n */\r\nexport const selectMedicationsRequiringWitness = (state: RootState): Medication[] => {\r\n  const allMedications = medicationsSelectors.selectAll(state) as Medication[];\r\n  return allMedications.filter(medication => medication.requiresWitness);\r\n};\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA4BC;;;;;;;;;;;;;;;;;;;;;;AAED;AAEA;;;AAgGA;;;;;;;;;;;;;;;;;CAiBC,GACD,MAAM,wBAAkG;IACtG;;;;;GAKC,GACD,MAAM,QAAO,MAA0B;QACrC,MAAM,WAAW,MAAM,wJAAU,CAAC,WAAW,CAAC,MAAM,CAAC;QACrD,OAAO;YACL,MAAM,SAAS,WAAW,IAAI,EAAE;YAChC,OAAO,SAAS,UAAU,EAAE;YAC5B,YAAY,SAAS,UAAU;QACjC;IACF;IAEA;;;;;GAKC,GACD,MAAM,SAAQ,EAAU;QACtB,MAAM,WAAW,MAAM,wJAAU,CAAC,WAAW,CAAC,OAAO,CAAC;QACtD,OAAO;YAAE,MAAM;QAAS;IAC1B;IAEA;;;;;;;;;GASC,GACD,MAAM,QAAO,IAA0B;QACrC,8DAA8D;QAC9D,MAAM,WAAW,MAAM,wJAAU,CAAC,WAAW,CAAC,MAAM,CAAC;QACrD,OAAO;YAAE,MAAM,SAAS,UAAU;QAAC;IACrC;IAEA;;;;;;;;;;GAUC,GACD,MAAM,QAAO,EAAU,EAAE,IAA0B;QACjD,8DAA8D;QAC9D,MAAM,WAAW,MAAM,wJAAU,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI;QACzD,OAAO;YAAE,MAAM;QAAS;IAC1B;IAEA;;;;;;;;;GASC,GACD,MAAM,QAAO,EAAU;QACrB,MAAM,wJAAU,CAAC,WAAW,CAAC,MAAM,CAAC;QACpC,OAAO;YAAE,SAAS;QAAK;IACzB;AACF;AAEA;;;;;;;;;;;;;;CAcC,GACD,MAAM,0BAA0B,IAAA,kJAAiB,EAC/C,eACA,uBACA;IACE,sBAAsB;AACxB;AASK,MAAM,mBAAmB,wBAAwB,KAAK;AAQtD,MAAM,qBAAqB,iBAAiB,OAAO;AAWnD,MAAM,qBAAqB,wBAAwB,OAAO;AAqB1D,MAAM,uBAAuB,wBAAwB,OAAO,CAAC,YAAY,CAAC,CAAC,QAAqB,MAAM,WAAW;AAwBjH,MAAM,oBAAoB,wBAAwB,MAAM;AAoBxD,MAAM,0BAA0B,CAAC;IACtC,MAAM,iBAAiB,qBAAqB,SAAS,CAAC;IACtD,8FAA8F;IAC9F,OAAO;AACT;AAuBO,MAAM,8BAA8B,CAAC;IAC1C,MAAM,iBAAiB,qBAAqB,SAAS,CAAC;IACtD,OAAO,eAAe,MAAM,CAAC,CAAA,aAAc,WAAW,YAAY;AACpE;AAiBO,MAAM,8BAA8B,CAAC,OAAkB;IAC5D,MAAM,iBAAiB,qBAAqB,SAAS,CAAC;IACtD,OAAO,eAAe,MAAM,CAAC,CAAA,aAAc,WAAW,QAAQ,KAAK;AACrE;AAkBO,MAAM,0BAA0B,CAAC,OAAkB;IACxD,MAAM,iBAAiB,qBAAqB,SAAS,CAAC;IACtD,OAAO,eAAe,MAAM,CAAC,CAAA,aAAc,WAAW,UAAU,KAAK;AACvE;AAyBO,MAAM,oCAAoC,CAAC;IAChD,MAAM,iBAAiB,qBAAqB,SAAS,CAAC;IACtD,OAAO,eAAe,MAAM,CAAC,CAAA,aAAc,WAAW,eAAe;AACvE","debugId":null}},
    {"offset": {"line": 8744, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/appointmentsSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Appointments Redux Slice\r\n *\r\n * Comprehensive state management for student appointment scheduling with Redux Toolkit's\r\n * EntityAdapter pattern. Manages appointment CRUD operations, nurse scheduling, student\r\n * appointment tracking, and multi-view filtering (by date, status, type, nurse, student).\r\n * All operations include HIPAA-compliant audit logging for PHI access.\r\n *\r\n * **Key Features:**\r\n * - Appointment CRUD operations with validation\r\n * - Student appointment scheduling and management\r\n * - Nurse schedule management and conflict detection\r\n * - Multi-dimensional filtering (by student, nurse, status, type, date range)\r\n * - Today's appointments view with real-time updates\r\n * - Upcoming appointments with configurable lookahead\r\n * - Appointment status tracking (scheduled, completed, cancelled, no-show)\r\n * - Reminder integration for notifications\r\n *\r\n * **State Management Architecture:**\r\n * - Redux Toolkit with createEntitySlice factory pattern\r\n * - EntityAdapter for normalized state with optimized lookups\r\n * - No localStorage persistence (appointments are transient data)\r\n * - Real-time synchronization via TanStack Query cache invalidation\r\n * - Optimistic updates for improved UX\r\n *\r\n * **HIPAA Compliance:**\r\n * - All appointment operations trigger PHI access audit logs\r\n * - Appointment data contains student PHI (reason, notes)\r\n * - Audit logging includes appointment type, reason visibility\r\n * - No caching of appointment details in localStorage\r\n * - Nurse access to student appointments is role-based\r\n * - Cancellation reasons are logged for compliance\r\n *\r\n * **Appointment Scheduling Workflows:**\r\n * - **New Appointment**: Student selection â†’ date/time â†’ type â†’ reason â†’ nurse assignment\r\n * - **Rescheduling**: Load appointment â†’ modify date/time â†’ conflict check â†’ update\r\n * - **Cancellation**: Select appointment â†’ reason â†’ notify student/parent â†’ audit log\r\n * - **Completion**: Mark complete â†’ add notes â†’ record outcomes â†’ update student record\r\n * - **No-Show**: Mark no-show â†’ follow-up required â†’ parent notification\r\n *\r\n * **TanStack Query Integration:**\r\n * - Appointments list: 2-minute cache, invalidate on create/update/cancel\r\n * - Student appointments: 1-minute cache, invalidate on student-specific changes\r\n * - Today's appointments: 30-second cache, real-time polling\r\n * - Upcoming appointments: 2-minute cache\r\n * - Appointment details: 1-minute cache, invalidate on update\r\n *\r\n * **Nurse Scheduling Features:**\r\n * - View all appointments by nurse\r\n * - Conflict detection for double-booking prevention\r\n * - Daily schedule view with time blocks\r\n * - Workload balancing across nurses\r\n * - Appointment type tracking (routine, urgent, follow-up)\r\n *\r\n * @module pages/appointments/store/appointmentsSlice\r\n * @see {@link services/modules/appointmentsApi} for API implementation\r\n * @see {@link types/appointments} for type definitions\r\n * @see {@link stores/sliceFactory} for EntityAdapter factory pattern\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { apiActions } from '@/lib/api';\r\nimport type {\r\n  Appointment,\r\n  AppointmentFilters,\r\n  CreateAppointmentData,\r\n  UpdateAppointmentData\r\n} from '../../types/appointments';\r\n\r\n/**\r\n * Appointments API Service Adapter\r\n *\r\n * Provides a standardized interface to the appointments API following the EntityApiService\r\n * pattern. All methods include error handling, response transformation, and HIPAA-compliant\r\n * audit logging for PHI access. Integrates with Redux Toolkit's EntityAdapter for normalized\r\n * state management.\r\n *\r\n * @constant {EntityApiService<Appointment, CreateAppointmentData, UpdateAppointmentData>}\r\n *\r\n * @remarks\r\n * **Authentication**: All methods require valid JWT token with nurse/admin role\r\n * **Authorization**: Nurses can only access appointments for their assigned students\r\n * **Rate Limiting**: 100 requests per minute per user\r\n * **Audit Logging**: All operations trigger PHI access audit logs\r\n * **Conflict Detection**: Create/update operations check for scheduling conflicts\r\n *\r\n * @example\r\n * ```typescript\r\n * // Used internally by createEntitySlice factory\r\n * const slice = createEntitySlice('appointments', appointmentsApiService, options);\r\n * ```\r\n */\r\nconst appointmentsApiService: EntityApiService<Appointment, CreateAppointmentData, UpdateAppointmentData> = {\r\n  /**\r\n   * Get all appointments with optional filtering\r\n   *\r\n   * Retrieves paginated list of appointments with support for filtering by student,\r\n   * nurse, status, type, and date range. Results are sorted by scheduledAt by default.\r\n   *\r\n   * @async\r\n   * @param {AppointmentFilters} [params] - Optional filters for appointments\r\n   * @param {string} [params.studentId] - Filter by student ID\r\n   * @param {string} [params.nurseId] - Filter by nurse ID\r\n   * @param {string} [params.status] - Filter by status (scheduled, completed, cancelled)\r\n   * @param {string} [params.type] - Filter by appointment type\r\n   * @param {string} [params.startDate] - Filter by start date (ISO 8601)\r\n   * @param {string} [params.endDate] - Filter by end date (ISO 8601)\r\n   * @param {number} [params.page] - Page number for pagination\r\n   * @param {number} [params.limit] - Items per page\r\n   *\r\n   * @returns {Promise<{data: Appointment[], total: number, pagination: object}>} Paginated appointments\r\n   *\r\n   * @throws {ApiError} If request fails or user lacks permission\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Get today's appointments for a specific nurse\r\n   * const result = await appointmentsApiService.getAll({\r\n   *   nurseId: 'nurse-uuid',\r\n   *   startDate: '2025-10-26T00:00:00Z',\r\n   *   endDate: '2025-10-26T23:59:59Z'\r\n   * });\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * **Cache Strategy**: TanStack Query caches for 2 minutes\r\n   * **HIPAA**: Triggers audit log for PHI access (appointment details)\r\n   */\r\n  async getAll(params?: AppointmentFilters) {\r\n    const response = await apiActions.appointments.getAll(params as AppointmentFilters);\r\n    return {\r\n      data: response.data || [],\r\n      total: response.pagination?.total || 0,\r\n      pagination: response.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Get appointment by ID\r\n   *\r\n   * Retrieves detailed appointment information including student data, appointment reason,\r\n   * notes, and history. Used for appointment detail view and edit forms.\r\n   *\r\n   * @async\r\n   * @param {string} id - Appointment UUID\r\n   *\r\n   * @returns {Promise<{data: Appointment}>} Appointment details\r\n   *\r\n   * @throws {NotFoundError} If appointment doesn't exist\r\n   * @throws {ForbiddenError} If user lacks permission to view appointment\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Load appointment for editing\r\n   * const result = await appointmentsApiService.getById('appt-uuid');\r\n   * console.log(result.data.reason); // 'Annual health screening'\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * **Cache Strategy**: 1-minute cache, invalidated on update\r\n   * **HIPAA**: Audit log includes appointment reason (PHI)\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.appointments.getById(id);\r\n    return { data: response.appointment };\r\n  },\r\n\r\n  /**\r\n   * Create new appointment\r\n   *\r\n   * Creates appointment with student assignment, scheduling, type, and reason.\r\n   * Performs conflict detection to prevent double-booking. Sends notification\r\n   * to student and parent if configured.\r\n   *\r\n   * @async\r\n   * @param {CreateAppointmentData} data - Appointment creation data\r\n   * @param {string} data.studentId - Student UUID (required)\r\n   * @param {string} data.nurseId - Nurse UUID (required)\r\n   * @param {string} data.scheduledAt - ISO 8601 datetime (required)\r\n   * @param {string} data.type - Appointment type (required)\r\n   * @param {string} data.reason - Appointment reason (required)\r\n   * @param {string} [data.notes] - Additional notes\r\n   * @param {number} [data.duration] - Duration in minutes (default: 30)\r\n   *\r\n   * @returns {Promise<{data: Appointment}>} Created appointment\r\n   *\r\n   * @throws {ValidationError} If data validation fails\r\n   * @throws {ConflictError} If scheduling conflict detected\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Schedule routine health screening\r\n   * const result = await appointmentsApiService.create({\r\n   *   studentId: 'student-uuid',\r\n   *   nurseId: 'nurse-uuid',\r\n   *   scheduledAt: '2025-10-27T10:00:00Z',\r\n   *   type: 'Health Screening',\r\n   *   reason: 'Annual health screening',\r\n   *   duration: 30\r\n   * });\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * **Conflict Detection**: Checks for overlapping appointments\r\n   * **Notifications**: Sends reminder to student/parent\r\n   * **Optimistic Update**: UI updated before server confirmation\r\n   * **HIPAA**: Audit log includes student ID and reason\r\n   */\r\n  async create(data: CreateAppointmentData) {\r\n    const response = await apiActions.appointments.create(data);\r\n    return { data: response.appointment };\r\n  },\r\n\r\n  /**\r\n   * Update existing appointment\r\n   *\r\n   * Updates appointment details including rescheduling, status changes, and note updates.\r\n   * Performs conflict detection for date/time changes. Notifies affected parties of changes.\r\n   *\r\n   * @async\r\n   * @param {string} id - Appointment UUID\r\n   * @param {UpdateAppointmentData} data - Fields to update\r\n   * @param {string} [data.scheduledAt] - New datetime (triggers conflict check)\r\n   * @param {string} [data.status] - New status\r\n   * @param {string} [data.notes] - Updated notes\r\n   * @param {string} [data.reason] - Updated reason\r\n   *\r\n   * @returns {Promise<{data: Appointment}>} Updated appointment\r\n   *\r\n   * @throws {NotFoundError} If appointment doesn't exist\r\n   * @throws {ConflictError} If rescheduling creates conflict\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Reschedule appointment\r\n   * const result = await appointmentsApiService.update('appt-uuid', {\r\n   *   scheduledAt: '2025-10-28T14:00:00Z',\r\n   *   notes: 'Rescheduled due to student absence'\r\n   * });\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * **Conflict Detection**: Applied for date/time changes\r\n   * **Status Transitions**: Validates valid status transitions\r\n   * **Notifications**: Sends update notification if date/time changed\r\n   * **HIPAA**: Audit log tracks all changes\r\n   */\r\n  async update(id: string, data: UpdateAppointmentData) {\r\n    const response = await apiActions.appointments.update(id, data);\r\n    return { data: response.appointment };\r\n  },\r\n\r\n  /**\r\n   * Delete appointment (via cancellation)\r\n   *\r\n   * Cancels appointment with reason. Does not hard-delete to maintain audit trail.\r\n   * Sends cancellation notification to student and parent.\r\n   *\r\n   * @async\r\n   * @param {string} id - Appointment UUID\r\n   *\r\n   * @returns {Promise<{success: boolean}>} Success status\r\n   *\r\n   * @throws {NotFoundError} If appointment doesn't exist\r\n   * @throws {ForbiddenError} If user lacks permission\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Cancel appointment\r\n   * await appointmentsApiService.delete('appt-uuid');\r\n   * ```\r\n   *\r\n   * @remarks\r\n   * **Soft Delete**: Marks appointment as cancelled, doesn't delete\r\n   * **Reason**: Always logs 'Deleted' as cancellation reason\r\n   * **Notifications**: Sends cancellation notification\r\n   * **Audit Trail**: Maintains record for compliance\r\n   * **HIPAA**: Audit log tracks cancellation\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.appointments.cancel(id, 'Deleted');\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Create the appointments slice using the entity factory\r\n *\r\n * Uses createEntitySlice factory to generate a Redux slice with EntityAdapter\r\n * for normalized state management. Automatically creates standard CRUD thunks,\r\n * actions, and selectors.\r\n *\r\n * @constant {Object} appointmentsSliceFactory\r\n *\r\n * @remarks\r\n * **Factory Configuration**:\r\n * - Name: 'appointments'\r\n * - EntityAdapter: Normalized appointments by ID\r\n * - Bulk Operations: Disabled (appointments managed individually)\r\n * - Optimistic Updates: Enabled for create/update/delete\r\n *\r\n * **Generated Thunks**:\r\n * - fetchAll: Load all appointments with filters\r\n * - fetchById: Load single appointment\r\n * - createEntity: Create new appointment\r\n * - updateEntity: Update appointment\r\n * - deleteEntity: Delete (cancel) appointment\r\n *\r\n * **Generated Actions**:\r\n * - setAll, setOne, addOne, updateOne, removeOne\r\n * - Standard EntityAdapter actions\r\n *\r\n * **Generated Selectors**:\r\n * - selectAll, selectById, selectIds, selectEntities\r\n * - selectTotal (entity count)\r\n */\r\nconst appointmentsSliceFactory = createEntitySlice<Appointment, CreateAppointmentData, UpdateAppointmentData>(\r\n  'appointments',\r\n  appointmentsApiService,\r\n  {\r\n    enableBulkOperations: false,\r\n  }\r\n);\r\n\r\n/**\r\n * Appointments Redux slice\r\n *\r\n * @constant {Slice} appointmentsSlice\r\n * @see {@link createEntitySlice} for factory implementation\r\n */\r\nexport const appointmentsSlice = appointmentsSliceFactory.slice;\r\n\r\n/**\r\n * Appointments reducer for Redux store\r\n *\r\n * @constant {Reducer} appointmentsReducer\r\n * @example\r\n * ```typescript\r\n * // In store configuration\r\n * import { appointmentsReducer } from './pages/appointments/store/appointmentsSlice';\r\n *\r\n * const store = configureStore({\r\n *   reducer: {\r\n *     appointments: appointmentsReducer,\r\n *   },\r\n * });\r\n * ```\r\n */\r\nexport const appointmentsReducer = appointmentsSlice.reducer;\r\n\r\n/**\r\n * Appointments actions (standard EntityAdapter actions)\r\n *\r\n * @constant {Object} appointmentsActions\r\n * @property {Action} setAll - Replace all appointments\r\n * @property {Action} setOne - Set single appointment\r\n * @property {Action} addOne - Add single appointment\r\n * @property {Action} updateOne - Update single appointment\r\n * @property {Action} removeOne - Remove single appointment\r\n */\r\nexport const appointmentsActions = appointmentsSliceFactory.actions;\r\n\r\n/**\r\n * Standard EntityAdapter selectors\r\n *\r\n * @constant {Object} appointmentsSelectors\r\n * @property {Function} selectAll - Select all appointments\r\n * @property {Function} selectById - Select appointment by ID\r\n * @property {Function} selectIds - Select all appointment IDs\r\n * @property {Function} selectEntities - Select appointments dictionary\r\n * @property {Function} selectTotal - Select total count\r\n */\r\nexport const appointmentsSelectors = appointmentsSliceFactory.adapter.getSelectors((state: any) => state.appointments);\r\n\r\n/**\r\n * Appointments async thunks for API operations\r\n *\r\n * @constant {Object} appointmentsThunks\r\n * @property {AsyncThunk} fetchAll - Fetch all appointments with filters\r\n * @property {AsyncThunk} fetchById - Fetch single appointment\r\n * @property {AsyncThunk} createEntity - Create new appointment\r\n * @property {AsyncThunk} updateEntity - Update appointment\r\n * @property {AsyncThunk} deleteEntity - Delete (cancel) appointment\r\n */\r\nexport const appointmentsThunks = appointmentsSliceFactory.thunks;\r\n\r\n// ============================================================================\r\n// Custom Selectors\r\n// ============================================================================\r\n\r\n/**\r\n * Select all appointments for a specific student\r\n *\r\n * Filters appointments by student ID. Used in student detail view to show\r\n * appointment history and upcoming appointments for a single student.\r\n *\r\n * @function selectAppointmentsByStudent\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student UUID to filter by\r\n *\r\n * @returns {Appointment[]} Filtered appointments for the student\r\n *\r\n * @example\r\n * ```typescript\r\n * // In a component\r\n * import { useSelector } from 'react-redux';\r\n * import { selectAppointmentsByStudent } from '@/pages/appointments/store/appointmentsSlice';\r\n *\r\n * const StudentAppointments = ({ studentId }) => {\r\n *   const appointments = useSelector(state =>\r\n *     selectAppointmentsByStudent(state, studentId)\r\n *   );\r\n *\r\n *   return <AppointmentList appointments={appointments} />;\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * **Performance**: O(n) filter operation on all appointments\r\n * **Memoization**: Consider using reselect for frequently accessed data\r\n * **HIPAA**: Ensure user has permission to view student's appointments\r\n */\r\nexport const selectAppointmentsByStudent = (state: any, studentId: string): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  return allAppointments.filter(appointment => appointment.studentId === studentId);\r\n};\r\n\r\n/**\r\n * Select all appointments for a specific nurse\r\n *\r\n * Filters appointments by nurse ID. Used in nurse schedule view to show\r\n * daily/weekly schedule and workload for a single nurse.\r\n *\r\n * @function selectAppointmentsByNurse\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} nurseId - Nurse UUID to filter by\r\n *\r\n * @returns {Appointment[]} Filtered appointments for the nurse\r\n *\r\n * @example\r\n * ```typescript\r\n * // Nurse schedule component\r\n * const NurseSchedule = ({ nurseId }) => {\r\n *   const appointments = useSelector(state =>\r\n *     selectAppointmentsByNurse(state, nurseId)\r\n *   );\r\n *\r\n *   return (\r\n *     <ScheduleCalendar\r\n *       appointments={appointments}\r\n *       nurseId={nurseId}\r\n *     />\r\n *   );\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * **Use Case**: Daily nurse schedule, workload balancing\r\n * **Sorting**: Appointments not sorted by this selector (sort in component)\r\n * **Conflict Detection**: Use with date filters to check for overlaps\r\n */\r\nexport const selectAppointmentsByNurse = (state: any, nurseId: string): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  return allAppointments.filter(appointment => appointment.nurseId === nurseId);\r\n};\r\n\r\n/**\r\n * Select all appointments with a specific status\r\n *\r\n * Filters appointments by status (scheduled, completed, cancelled, no-show).\r\n * Used for status-based views and reporting.\r\n *\r\n * @function selectAppointmentsByStatus\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} status - Status to filter by (scheduled, completed, cancelled, no-show)\r\n *\r\n * @returns {Appointment[]} Filtered appointments with the specified status\r\n *\r\n * @example\r\n * ```typescript\r\n * // Completed appointments view\r\n * const CompletedAppointments = () => {\r\n *   const completed = useSelector(state =>\r\n *     selectAppointmentsByStatus(state, 'completed')\r\n *   );\r\n *\r\n *   return <AppointmentHistory appointments={completed} />;\r\n * };\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // No-show follow-up list\r\n * const NoShowFollowUp = () => {\r\n *   const noShows = useSelector(state =>\r\n *     selectAppointmentsByStatus(state, 'no-show')\r\n *   );\r\n *\r\n *   return <FollowUpList appointments={noShows} requiresAction />;\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * **Status Values**: 'scheduled', 'completed', 'cancelled', 'no-show'\r\n * **Reporting**: Used for appointment completion rates\r\n * **Follow-Up**: No-shows require parent notification\r\n */\r\nexport const selectAppointmentsByStatus = (state: any, status: string): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  return allAppointments.filter(appointment => appointment.status === status);\r\n};\r\n\r\n/**\r\n * Select today's appointments sorted by time\r\n *\r\n * Filters appointments scheduled for today (midnight to midnight) and sorts\r\n * them chronologically. Used for daily nurse schedule and dashboard.\r\n *\r\n * @function selectTodaysAppointments\r\n *\r\n * @param {any} state - Redux root state\r\n *\r\n * @returns {Appointment[]} Today's appointments sorted by scheduledAt time\r\n *\r\n * @example\r\n * ```typescript\r\n * // Dashboard today's schedule\r\n * const DashboardSchedule = () => {\r\n *   const todaysAppointments = useSelector(selectTodaysAppointments);\r\n *\r\n *   return (\r\n *     <DailySchedule\r\n *       appointments={todaysAppointments}\r\n *       date={new Date()}\r\n *     />\r\n *   );\r\n * };\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Check for upcoming appointments in next hour\r\n * const todaysAppointments = selectTodaysAppointments(state);\r\n * const now = new Date();\r\n * const nextHour = new Date(now.getTime() + 60 * 60 * 1000);\r\n * const upcoming = todaysAppointments.filter(appt =>\r\n *   new Date(appt.scheduledAt) >= now &&\r\n *   new Date(appt.scheduledAt) <= nextHour\r\n * );\r\n * ```\r\n *\r\n * @remarks\r\n * **Time Range**: Midnight to midnight in local timezone\r\n * **Sorting**: Chronologically sorted by scheduledAt\r\n * **Real-Time**: Consider polling every 30 seconds for accurate dashboard\r\n * **Performance**: Recalculates on every state change (consider memoization)\r\n */\r\nexport const selectTodaysAppointments = (state: any): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  const today = new Date();\r\n  const todayStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());\r\n  const todayEnd = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 1);\r\n\r\n  return allAppointments.filter(appointment => {\r\n    const appointmentDate = new Date(appointment.scheduledAt);\r\n    return appointmentDate >= todayStart && appointmentDate < todayEnd;\r\n  }).sort((a, b) => new Date(a.scheduledAt).getTime() - new Date(b.scheduledAt).getTime());\r\n};\r\n\r\n/**\r\n * Select upcoming appointments within specified days\r\n *\r\n * Filters appointments from now until N days in the future, sorted chronologically.\r\n * Used for appointment reminders, nurse planning, and upcoming schedule views.\r\n *\r\n * @function selectUpcomingAppointments\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {number} [days=7] - Number of days to look ahead (default: 7)\r\n *\r\n * @returns {Appointment[]} Upcoming appointments sorted by scheduledAt time\r\n *\r\n * @example\r\n * ```typescript\r\n * // Next 7 days appointments (default)\r\n * const UpcomingWeek = () => {\r\n *   const upcoming = useSelector(state =>\r\n *     selectUpcomingAppointments(state)\r\n *   );\r\n *\r\n *   return <AppointmentList appointments={upcoming} showCountdown />;\r\n * };\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Next 24 hours appointments\r\n * const NextDayAppointments = () => {\r\n *   const tomorrow = useSelector(state =>\r\n *     selectUpcomingAppointments(state, 1)\r\n *   );\r\n *\r\n *   return <ReminderList appointments={tomorrow} urgent />;\r\n * };\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Next 30 days for monthly view\r\n * const MonthlySchedule = () => {\r\n *   const monthAhead = useSelector(state =>\r\n *     selectUpcomingAppointments(state, 30)\r\n *   );\r\n *\r\n *   return <MonthCalendar appointments={monthAhead} />;\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * **Time Range**: From current moment to N days ahead\r\n * **Sorting**: Chronologically sorted by scheduledAt\r\n * **Reminders**: Send reminders 24 hours before appointment\r\n * **Planning**: Used for nurse schedule planning and workload projection\r\n * **Default**: 7-day lookahead is standard for weekly views\r\n */\r\nexport const selectUpcomingAppointments = (state: any, days: number = 7): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  const now = new Date();\r\n  const futureDate = new Date();\r\n  futureDate.setDate(futureDate.getDate() + days);\r\n\r\n  return allAppointments.filter(appointment => {\r\n    const appointmentDate = new Date(appointment.scheduledAt);\r\n    return appointmentDate >= now && appointmentDate <= futureDate;\r\n  }).sort((a, b) => new Date(a.scheduledAt).getTime() - new Date(b.scheduledAt).getTime());\r\n};\r\n\r\n/**\r\n * Select all appointments of a specific type\r\n *\r\n * Filters appointments by type (routine checkup, health screening, medication review, etc.).\r\n * Used for type-specific reporting and analysis.\r\n *\r\n * @function selectAppointmentsByType\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} type - Appointment type to filter by\r\n *\r\n * @returns {Appointment[]} Filtered appointments of the specified type\r\n *\r\n * @example\r\n * ```typescript\r\n * // Health screening appointments\r\n * const HealthScreenings = () => {\r\n *   const screenings = useSelector(state =>\r\n *     selectAppointmentsByType(state, 'Health Screening')\r\n *   );\r\n *\r\n *   return <ScreeningReport appointments={screenings} />;\r\n * };\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Medication review appointments\r\n * const MedicationReviews = () => {\r\n *   const reviews = useSelector(state =>\r\n *     selectAppointmentsByType(state, 'Medication Review')\r\n *   );\r\n *\r\n *   return <ReviewList appointments={reviews} />;\r\n * };\r\n * ```\r\n *\r\n * @remarks\r\n * **Common Types**:\r\n * - 'Health Screening': Annual health screenings\r\n * - 'Medication Review': Medication check-ins\r\n * - 'Illness Visit': Acute illness visits\r\n * - 'Injury Assessment': Injury evaluations\r\n * - 'Follow-Up': Follow-up appointments\r\n * - 'Routine Checkup': General wellness checks\r\n *\r\n * **Reporting**: Used for appointment type analytics\r\n * **Scheduling**: Helps balance different appointment types\r\n */\r\nexport const selectAppointmentsByType = (state: any, type: string): Appointment[] => {\r\n  const allAppointments = appointmentsSelectors.selectAll(state) as Appointment[];\r\n  return allAppointments.filter(appointment => appointment.type === type);\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9121, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/studentsSlice.ts"],"sourcesContent":["/**\r\n * @module pages/students/store/studentsSlice\r\n *\r\n * Students Redux Slice - Entity and UI State Management\r\n *\r\n * Manages student entities and comprehensive UI state using a hybrid approach combining\r\n * the entity slice factory pattern with custom UI state management. Provides standardized\r\n * CRUD operations for student records alongside sophisticated UI controls for selection,\r\n * filtering, sorting, and pagination.\r\n *\r\n * @remarks\r\n * **Architecture Pattern:** Combines entity slice factory (normalized CRUD state) with\r\n * custom UI slice (view preferences, filters, selection). This hybrid enables both\r\n * standardized backend integration and rich UI state management in a single slice.\r\n *\r\n * **HIPAA Compliance:** Student records contain PHI (names, dates of birth, health info).\r\n * All operations trigger audit logging in the backend API layer. PHI is excluded from\r\n * localStorage persistence - only non-sensitive UI preferences are persisted.\r\n *\r\n * **Cross-Tab Synchronization:** Uses BroadcastChannel API to sync student data changes\r\n * across browser tabs. When a nurse updates a student in one tab, all other tabs receive\r\n * the update notification and can refresh their data accordingly.\r\n *\r\n * **Entity Slice Factory:** Leverages createEntitySlice factory for standardized CRUD\r\n * operations with built-in loading states, error handling, and optimistic updates.\r\n * EntityAdapter provides efficient normalized state management with O(1) lookups.\r\n *\r\n * **Performance Optimization:** Complex selectors use memoization to prevent unnecessary\r\n * recalculations. Pagination limits rendered items to improve performance with large\r\n * student populations (100+ students).\r\n *\r\n * @see {@link createEntitySlice} for factory implementation details\r\n * @see {@link studentsApi} for backend API integration\r\n * @see {@link Student} for student entity type definition\r\n * @see {@link useStudentsData} for hook-based data access\r\n *\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { Student, CreateStudentData, UpdateStudentData, StudentFilters as StudentFiltersType } from '@/types/student.types';\r\nimport { apiActions } from '@/lib/api';\r\n\r\n// Re-export StudentFilters type for external use\r\nexport type { StudentFiltersType as StudentFilters };\r\n\r\n/**\r\n * Combined state interface for students slice (entity + UI state).\r\n *\r\n * @interface StudentsState\r\n */\r\nexport interface StudentsState {\r\n  // Entity state properties from EntityAdapter\r\n  ids: string[];\r\n  entities: Record<string, Student>;\r\n  // UI state\r\n  ui: StudentUIState;\r\n}\r\n\r\n/**\r\n * Root state interface for Redux store.\r\n *\r\n * @interface RootState\r\n */\r\nexport interface RootState {\r\n  students: StudentsState;\r\n  // Other slices would be added here\r\n}\r\n\r\n/**\r\n * UI state interface for student management views.\r\n *\r\n * Manages view preferences, selection state, filters, sorting, and pagination\r\n * for student list/grid/table views. This state is separate from entity data\r\n * to enable flexible UI state management without polluting entity state.\r\n *\r\n * @interface StudentUIState\r\n *\r\n * @property {string[]} selectedIds - IDs of currently selected students (for bulk operations)\r\n * @property {'grid' | 'list' | 'table'} viewMode - Current view mode for student display\r\n * @property {StudentFiltersType} filters - Active filter criteria (grade, nurse, allergies, etc.)\r\n * @property {'name' | 'grade' | 'enrollmentDate' | 'lastVisit'} sortBy - Field to sort students by\r\n * @property {'asc' | 'desc'} sortOrder - Sort direction (ascending/descending)\r\n * @property {string} searchQuery - Text search query for filtering students\r\n * @property {boolean} showInactive - Whether to show inactive students in lists\r\n * @property {boolean} bulkSelectMode - Whether bulk selection mode is active\r\n * @property {string[]} expandedCards - IDs of expanded student cards (in card view)\r\n * @property {number} pageSize - Number of students per page (default: 20)\r\n * @property {number} currentPage - Current page number (1-indexed)\r\n *\r\n * @remarks\r\n * **Persistence:** This UI state is persisted to localStorage (non-PHI data only)\r\n * to preserve user preferences across sessions. Entity data is NOT persisted due\r\n * to HIPAA requirements.\r\n *\r\n * **Selection Management:** Supports individual selection, multi-select with Ctrl/Cmd,\r\n * and bulk select mode for mass operations like printing reports or generating letters.\r\n *\r\n * **Performance:** Pagination reduces DOM size and rendering time for large student\r\n * populations. Filters are applied client-side for instant feedback, with server-side\r\n * filtering available for very large datasets.\r\n */\r\nexport interface StudentUIState {\r\n  selectedIds: string[];\r\n  viewMode: 'grid' | 'list' | 'table';\r\n  filters: StudentFiltersType;\r\n  sortBy: 'name' | 'grade' | 'enrollmentDate' | 'lastVisit';\r\n  sortOrder: 'asc' | 'desc';\r\n  searchQuery: string;\r\n  showInactive: boolean;\r\n  bulkSelectMode: boolean;\r\n  expandedCards: string[];\r\n  pageSize: number;\r\n  currentPage: number;\r\n}\r\n\r\n/**\r\n * API service adapter for students.\r\n *\r\n * Wraps the studentsApi service to conform to the EntityApiService interface required\r\n * by the entity slice factory. Handles response transformation and error handling for\r\n * all student CRUD operations.\r\n *\r\n * @const {EntityApiService<Student, CreateStudentData, UpdateStudentData>}\r\n *\r\n * @remarks\r\n * **API Integration:** All methods call studentsApi which handles authentication,\r\n * error handling, retry logic, and audit logging for HIPAA compliance.\r\n *\r\n * **Response Transformation:** Normalizes API responses to match slice factory\r\n * expectations, ensuring consistent data structure across all entity types.\r\n *\r\n * **Audit Logging:** Student CRUD operations trigger audit logs in backend for\r\n * HIPAA compliance tracking of PHI access.\r\n *\r\n * @see {@link studentsApi} for underlying API implementation\r\n * @see {@link EntityApiService} for interface definition\r\n */\r\nconst studentsApiService: EntityApiService<Student, CreateStudentData, UpdateStudentData> = {\r\n  /**\r\n   * Fetches all students with optional filtering and pagination.\r\n   *\r\n   * @param {StudentFiltersType} [params] - Optional filter parameters\r\n   * @returns {Promise<{data: Student[], total?: number, pagination?: any}>} Students and pagination info\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation triggers audit logging for PHI access in the backend.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Fetch all active students in grade 5\r\n   * const response = await studentsApiService.getAll({\r\n   *   grade: '5',\r\n   *   isActive: true\r\n   * });\r\n   * ```\r\n   */\r\n  async getAll(params?: StudentFiltersType) {\r\n    const response = await apiActions.students.getAll(params);\r\n    return {\r\n      data: response?.students || [],\r\n      total: response?.pagination?.total,\r\n      pagination: response?.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetches a single student by ID.\r\n   *\r\n   * @param {string} id - Student ID to fetch\r\n   * @returns {Promise<{data: Student}>} Single student record\r\n   * @throws {Error} If student not found or access denied\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation triggers audit logging for PHI access.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const student = await studentsApiService.getById('student-123');\r\n   * ```\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.students.getById(id);\r\n    return { data: response };\r\n  },\r\n\r\n  /**\r\n   * Creates a new student record.\r\n   *\r\n   * @param {CreateStudentData} data - Student creation data\r\n   * @returns {Promise<{data: Student}>} Created student record\r\n   * @throws {Error} If validation fails or duplicate student number detected\r\n   *\r\n   * @remarks\r\n   * **Validation:** Backend validates required fields, student number uniqueness,\r\n   * and grade format before creation.\r\n   *\r\n   * **HIPAA Audit:** Creation triggers audit log for new PHI record creation.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const newStudent = await studentsApiService.create({\r\n   *   firstName: 'John',\r\n   *   lastName: 'Doe',\r\n   *   studentNumber: 'STU-2024-001',\r\n   *   grade: '5',\r\n   *   dateOfBirth: '2014-05-15',\r\n   *   // ... other required fields\r\n   * });\r\n   * ```\r\n   */\r\n  async create(data: CreateStudentData) {\r\n    const response = await apiActions.students.create(data);\r\n    return { data: response };\r\n  },\r\n\r\n  /**\r\n   * Updates an existing student record.\r\n   *\r\n   * @param {string} id - Student ID to update\r\n   * @param {UpdateStudentData} data - Updated student data (partial)\r\n   * @returns {Promise<{data: Student}>} Updated student record\r\n   * @throws {Error} If student not found, access denied, or validation fails\r\n   *\r\n   * @remarks\r\n   * **Partial Updates:** Supports partial updates - only provided fields are updated.\r\n   *\r\n   * **HIPAA Audit:** Update triggers audit log recording changed fields.\r\n   *\r\n   * **Validation:** Backend validates updated fields (e.g., grade format, email format).\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Update only grade and active status\r\n   * const updated = await studentsApiService.update('student-123', {\r\n   *   grade: '6',\r\n   *   isActive: true\r\n   * });\r\n   * ```\r\n   */\r\n  async update(id: string, data: UpdateStudentData) {\r\n    const response = await apiActions.students.update(id, data);\r\n    return { data: response };\r\n  },\r\n\r\n  /**\r\n   * Deletes (soft-deletes) a student record.\r\n   *\r\n   * @param {string} id - Student ID to delete\r\n   * @returns {Promise<{success: boolean}>} Deletion success status\r\n   * @throws {Error} If student not found or access denied\r\n   *\r\n   * @remarks\r\n   * **Soft Delete:** Student records are soft-deleted (marked inactive) rather than\r\n   * physically deleted to preserve audit trail and historical data.\r\n   *\r\n   * **HIPAA Audit:** Deletion triggers audit log for data retention compliance.\r\n   *\r\n   * **Cascade Behavior:** Related health records, medications, and appointments are\r\n   * retained but marked as inactive.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * await studentsApiService.delete('student-123');\r\n   * // Student is marked isActive: false, not physically deleted\r\n   * ```\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.students.delete(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Students slice factory instance.\r\n *\r\n * Creates the Redux slice with standardized CRUD operations, loading states,\r\n * and error handling using the entity slice factory pattern.\r\n *\r\n * @const\r\n *\r\n * @remarks\r\n * **Bulk Operations:** Enabled for students to support bulk printing, reporting,\r\n * and administrative tasks. Each operation still triggers individual audit logs.\r\n *\r\n * **Normalized State:** Uses EntityAdapter for normalized state management with\r\n * efficient lookups by ID.\r\n *\r\n * @see {@link createEntitySlice} for factory implementation details\r\n */\r\nconst studentsSliceFactory = createEntitySlice<Student, CreateStudentData, UpdateStudentData>(\r\n  'students',\r\n  studentsApiService,\r\n  {\r\n    enableBulkOperations: true,\r\n  }\r\n);\r\n\r\n/**\r\n * Initial UI state for student management views.\r\n *\r\n * Provides sensible defaults for student list display: table view with 20 items\r\n * per page, sorted alphabetically by name, showing only active students.\r\n *\r\n * @const {StudentUIState}\r\n */\r\nconst initialUIState: StudentUIState = {\r\n  selectedIds: [],\r\n  viewMode: 'table',\r\n  filters: {},\r\n  sortBy: 'name',\r\n  sortOrder: 'asc',\r\n  searchQuery: '',\r\n  showInactive: false,\r\n  bulkSelectMode: false,\r\n  expandedCards: [],\r\n  pageSize: 20,\r\n  currentPage: 1,\r\n};\r\n\r\n/**\r\n * UI state slice for student management.\r\n *\r\n * Manages view preferences, selection state, filters, sorting, and pagination\r\n * separately from entity data to enable flexible UI state management.\r\n *\r\n * @const\r\n */\r\nconst studentUISlice = createSlice({\r\n  name: 'studentUI',\r\n  initialState: initialUIState,\r\n  reducers: {\r\n    /**\r\n     * Selects a single student (adds to selection if not already selected).\r\n     *\r\n     * @param {string} action.payload - Student ID to select\r\n     *\r\n     * @remarks\r\n     * **Multi-Select:** Adds to existing selection without clearing previous selections.\r\n     * Use clearSelection first for single-select behavior.\r\n     */\r\n    selectStudent: (state, action: PayloadAction<string>) => {\r\n      if (!state.selectedIds.includes(action.payload)) {\r\n        state.selectedIds.push(action.payload);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Deselects a single student (removes from selection).\r\n     *\r\n     * @param {string} action.payload - Student ID to deselect\r\n     */\r\n    deselectStudent: (state, action: PayloadAction<string>) => {\r\n      state.selectedIds = state.selectedIds.filter(id => id !== action.payload);\r\n    },\r\n\r\n    /**\r\n     * Selects multiple students (adds to existing selection).\r\n     *\r\n     * @param {string[]} action.payload - Array of student IDs to select\r\n     *\r\n     * @remarks\r\n     * **Deduplication:** Only adds IDs not already in selection to prevent duplicates.\r\n     */\r\n    selectMultipleStudents: (state, action: PayloadAction<string[]>) => {\r\n      const newIds = action.payload.filter(id => !state.selectedIds.includes(id));\r\n      state.selectedIds.push(...newIds);\r\n    },\r\n\r\n    /**\r\n     * Selects all students (replaces current selection).\r\n     *\r\n     * @param {string[]} action.payload - Array of all student IDs to select\r\n     *\r\n     * @remarks\r\n     * **Replace:** Clears existing selection and selects all provided IDs.\r\n     */\r\n    selectAllStudents: (state, action: PayloadAction<string[]>) => {\r\n      state.selectedIds = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Clears all student selections.\r\n     *\r\n     * @remarks\r\n     * Used when exiting bulk select mode or after completing bulk operations.\r\n     */\r\n    clearSelection: (state) => {\r\n      state.selectedIds = [];\r\n    },\r\n\r\n    /**\r\n     * Toggles bulk select mode on/off.\r\n     *\r\n     * @remarks\r\n     * **Auto-Clear:** When disabling bulk select mode, automatically clears selection.\r\n     */\r\n    toggleBulkSelectMode: (state) => {\r\n      state.bulkSelectMode = !state.bulkSelectMode;\r\n      if (!state.bulkSelectMode) {\r\n        state.selectedIds = [];\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets the view mode for student display.\r\n     *\r\n     * @param {'grid' | 'list' | 'table'} action.payload - View mode to set\r\n     *\r\n     * @remarks\r\n     * **Persistence:** View mode preference is persisted to localStorage.\r\n     */\r\n    setViewMode: (state, action: PayloadAction<'grid' | 'list' | 'table'>) => {\r\n      state.viewMode = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggles card expansion for a student in card view.\r\n     *\r\n     * @param {string} action.payload - Student ID to toggle expansion\r\n     *\r\n     * @remarks\r\n     * **Performance:** Collapsing cards improves performance by reducing rendered content.\r\n     */\r\n    toggleCardExpansion: (state, action: PayloadAction<string>) => {\r\n      const studentId = action.payload;\r\n      if (state.expandedCards.includes(studentId)) {\r\n        state.expandedCards = state.expandedCards.filter(id => id !== studentId);\r\n      } else {\r\n        state.expandedCards.push(studentId);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Collapses all student cards.\r\n     *\r\n     * @remarks\r\n     * **Performance:** Used when switching views or scrolling to improve performance.\r\n     */\r\n    collapseAllCards: (state) => {\r\n      state.expandedCards = [];\r\n    },\r\n\r\n    /**\r\n     * Sets filter criteria for students.\r\n     *\r\n     * @param {Partial<StudentFiltersType>} action.payload - Filter criteria to apply\r\n     *\r\n     * @remarks\r\n     * **Pagination Reset:** Automatically resets to page 1 when filters change.\r\n     * **Merge Behavior:** Merges with existing filters, allowing partial filter updates.\r\n     */\r\n    setFilters: (state, action: PayloadAction<Partial<StudentFiltersType>>) => {\r\n      state.filters = { ...state.filters, ...action.payload };\r\n      state.currentPage = 1; // Reset to first page when filters change\r\n    },\r\n\r\n    /**\r\n     * Clears all active filters.\r\n     *\r\n     * @remarks\r\n     * **Pagination Reset:** Automatically resets to page 1 when clearing filters.\r\n     */\r\n    clearFilters: (state) => {\r\n      state.filters = {};\r\n      state.currentPage = 1;\r\n    },\r\n\r\n    /**\r\n     * Sets search query for text-based filtering.\r\n     *\r\n     * @param {string} action.payload - Search query string\r\n     *\r\n     * @remarks\r\n     * **Client-Side Search:** Search is performed client-side on loaded students.\r\n     * Searches firstName, lastName, studentNumber, and grade fields.\r\n     * **Pagination Reset:** Automatically resets to page 1 when search query changes.\r\n     */\r\n    setSearchQuery: (state, action: PayloadAction<string>) => {\r\n      state.searchQuery = action.payload;\r\n      state.currentPage = 1; // Reset to first page when searching\r\n    },\r\n\r\n    /**\r\n     * Toggles visibility of inactive students.\r\n     *\r\n     * @remarks\r\n     * **Default:** Inactive students are hidden by default per HIPAA data minimization.\r\n     * **Pagination Reset:** Automatically resets to page 1 when toggling.\r\n     */\r\n    toggleShowInactive: (state) => {\r\n      state.showInactive = !state.showInactive;\r\n      state.currentPage = 1;\r\n    },\r\n\r\n    /**\r\n     * Sets sorting criteria for students.\r\n     *\r\n     * @param {Object} action.payload - Sort configuration\r\n     * @param {StudentUIState['sortBy']} action.payload.sortBy - Field to sort by\r\n     * @param {StudentUIState['sortOrder']} action.payload.sortOrder - Sort direction\r\n     */\r\n    setSorting: (state, action: PayloadAction<{ sortBy: StudentUIState['sortBy']; sortOrder: StudentUIState['sortOrder'] }>) => {\r\n      state.sortBy = action.payload.sortBy;\r\n      state.sortOrder = action.payload.sortOrder;\r\n    },\r\n\r\n    /**\r\n     * Toggles sort order between ascending and descending.\r\n     *\r\n     * @remarks\r\n     * **Toggle Behavior:** Switches asc â†” desc without changing sort field.\r\n     */\r\n    toggleSortOrder: (state) => {\r\n      state.sortOrder = state.sortOrder === 'asc' ? 'desc' : 'asc';\r\n    },\r\n\r\n    /**\r\n     * Sets the current page number.\r\n     *\r\n     * @param {number} action.payload - Page number to navigate to (1-indexed)\r\n     */\r\n    setPage: (state, action: PayloadAction<number>) => {\r\n      state.currentPage = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Sets the number of items per page.\r\n     *\r\n     * @param {number} action.payload - Page size (typically 10, 20, 50, 100)\r\n     *\r\n     * @remarks\r\n     * **Pagination Reset:** Automatically resets to page 1 when page size changes.\r\n     * **Performance:** Smaller page sizes improve rendering performance for large lists.\r\n     */\r\n    setPageSize: (state, action: PayloadAction<number>) => {\r\n      state.pageSize = action.payload;\r\n      state.currentPage = 1; // Reset to first page when page size changes\r\n    },\r\n\r\n    /**\r\n     * Navigates to the next page.\r\n     *\r\n     * @remarks\r\n     * **Bounds Checking:** UI should disable next button on last page.\r\n     */\r\n    nextPage: (state) => {\r\n      state.currentPage += 1;\r\n    },\r\n\r\n    /**\r\n     * Navigates to the previous page.\r\n     *\r\n     * @remarks\r\n     * **Bounds Checking:** Does not go below page 1. UI should disable previous button on first page.\r\n     */\r\n    previousPage: (state) => {\r\n      if (state.currentPage > 1) {\r\n        state.currentPage -= 1;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Resets all UI state to initial values.\r\n     *\r\n     * @remarks\r\n     * **Use Cases:** Logout, switching schools, or resetting view preferences.\r\n     */\r\n    resetUIState: () => initialUIState,\r\n  },\r\n});\r\n\r\n/**\r\n * Combined students slice (entity + UI state).\r\n *\r\n * Merges entity slice from factory with custom UI slice to provide unified state.\r\n *\r\n * @const\r\n */\r\nconst combinedStudentsSlice = createSlice({\r\n  name: 'students',\r\n  initialState: {\r\n    ...(studentsSliceFactory.slice.getInitialState() || {}),\r\n    ui: initialUIState,\r\n  },\r\n  reducers: {\r\n    // UI reducers from studentUISlice\r\n    selectStudent: (state, action: PayloadAction<string>) => {\r\n      if (!state.ui.selectedIds.includes(action.payload)) {\r\n        state.ui.selectedIds.push(action.payload);\r\n      }\r\n    },\r\n    deselectStudent: (state, action: PayloadAction<string>) => {\r\n      state.ui.selectedIds = state.ui.selectedIds.filter((id: string) => id !== action.payload);\r\n    },\r\n    selectMultipleStudents: (state, action: PayloadAction<string[]>) => {\r\n      const newIds = action.payload.filter(id => !state.ui.selectedIds.includes(id));\r\n      state.ui.selectedIds.push(...newIds);\r\n    },\r\n    selectAllStudents: (state, action: PayloadAction<string[]>) => {\r\n      state.ui.selectedIds = action.payload;\r\n    },\r\n    clearSelection: (state) => {\r\n      state.ui.selectedIds = [];\r\n    },\r\n    toggleBulkSelectMode: (state) => {\r\n      state.ui.bulkSelectMode = !state.ui.bulkSelectMode;\r\n      if (!state.ui.bulkSelectMode) {\r\n        state.ui.selectedIds = [];\r\n      }\r\n    },\r\n    setViewMode: (state, action: PayloadAction<'grid' | 'list' | 'table'>) => {\r\n      state.ui.viewMode = action.payload;\r\n    },\r\n    toggleCardExpansion: (state, action: PayloadAction<string>) => {\r\n      const studentId = action.payload;\r\n      if (state.ui.expandedCards.includes(studentId)) {\r\n        state.ui.expandedCards = state.ui.expandedCards.filter((id: string) => id !== studentId);\r\n      } else {\r\n        state.ui.expandedCards.push(studentId);\r\n      }\r\n    },\r\n    collapseAllCards: (state) => {\r\n      state.ui.expandedCards = [];\r\n    },\r\n    setFilters: (state, action: PayloadAction<Partial<StudentFiltersType>>) => {\r\n      state.ui.filters = { ...state.ui.filters, ...action.payload };\r\n      state.ui.currentPage = 1;\r\n    },\r\n    clearFilters: (state) => {\r\n      state.ui.filters = {};\r\n      state.ui.currentPage = 1;\r\n    },\r\n    setSearchQuery: (state, action: PayloadAction<string>) => {\r\n      state.ui.searchQuery = action.payload;\r\n      state.ui.currentPage = 1;\r\n    },\r\n    toggleShowInactive: (state) => {\r\n      state.ui.showInactive = !state.ui.showInactive;\r\n      state.ui.currentPage = 1;\r\n    },\r\n    setSorting: (state, action: PayloadAction<{ sortBy: StudentUIState['sortBy']; sortOrder: StudentUIState['sortOrder'] }>) => {\r\n      state.ui.sortBy = action.payload.sortBy;\r\n      state.ui.sortOrder = action.payload.sortOrder;\r\n    },\r\n    toggleSortOrder: (state) => {\r\n      state.ui.sortOrder = state.ui.sortOrder === 'asc' ? 'desc' : 'asc';\r\n    },\r\n    setPage: (state, action: PayloadAction<number>) => {\r\n      state.ui.currentPage = action.payload;\r\n    },\r\n    setPageSize: (state, action: PayloadAction<number>) => {\r\n      state.ui.pageSize = action.payload;\r\n      state.ui.currentPage = 1;\r\n    },\r\n    nextPage: (state) => {\r\n      state.ui.currentPage += 1;\r\n    },\r\n    previousPage: (state) => {\r\n      if (state.ui.currentPage > 1) {\r\n        state.ui.currentPage -= 1;\r\n      }\r\n    },\r\n    resetUIState: (state) => {\r\n      state.ui = initialUIState;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    // Copy all extra reducers from the entity slice\r\n    const entitySliceReducers = studentsSliceFactory.slice.reducer;\r\n    builder.addMatcher(\r\n      (action) => action.type.startsWith('students/'),\r\n      (state, action) => {\r\n        const entityState = entitySliceReducers(\r\n          { ...state, ui: undefined },\r\n          action\r\n        );\r\n        return {\r\n          ...(entityState || {}),\r\n          ui: state.ui,\r\n        };\r\n      }\r\n    );\r\n  },\r\n});\r\n\r\n/**\r\n * Students Redux slice.\r\n *\r\n * @exports studentsSlice\r\n */\r\nexport const studentsSlice = combinedStudentsSlice;\r\n\r\n/**\r\n * Students reducer for Redux store.\r\n *\r\n * @exports studentsReducer\r\n */\r\nexport const studentsReducer = combinedStudentsSlice.reducer;\r\n\r\n/**\r\n * Action creators for student state updates.\r\n *\r\n * Includes both entity actions (CRUD) and UI actions (selection, filtering, etc.).\r\n *\r\n * @exports studentsActions\r\n */\r\nexport const studentsActions = {\r\n  ...studentsSliceFactory.actions,\r\n  ...studentUISlice.actions,\r\n};\r\n\r\n/**\r\n * Entity adapter selectors for normalized student state.\r\n *\r\n * Provides efficient selectors for accessing students:\r\n * - selectAll: Get all students as array\r\n * - selectById: Get student by ID\r\n * - selectIds: Get all student IDs\r\n * - selectEntities: Get students as normalized object\r\n * - selectTotal: Get total count\r\n *\r\n * @exports studentsSelectors\r\n *\r\n * @example\r\n * ```typescript\r\n * const allStudents = useSelector(studentsSelectors.selectAll);\r\n * const student = useSelector(state => studentsSelectors.selectById(state, 'student-123'));\r\n * ```\r\n */\r\nexport const studentsSelectors = studentsSliceFactory.adapter.getSelectors((state: RootState) => state.students);\r\n\r\n/**\r\n * Async thunks for student API operations.\r\n *\r\n * Provides thunks for all CRUD operations from entity slice factory.\r\n *\r\n * @exports studentsThunks\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch all active students in grade 5\r\n * dispatch(studentsThunks.fetchAll({ grade: '5', isActive: true }));\r\n *\r\n * // Create new student\r\n * dispatch(studentsThunks.create(studentData));\r\n * ```\r\n */\r\nexport const studentsThunks = studentsSliceFactory.thunks;\r\n\r\n/**\r\n * Selector for student UI state.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {StudentUIState} Complete UI state object\r\n *\r\n * @example\r\n * ```typescript\r\n * const uiState = useSelector(selectStudentUIState);\r\n * console.log(uiState.viewMode, uiState.filters, uiState.selectedIds);\r\n * ```\r\n */\r\nexport const selectStudentUIState = (state: RootState): StudentUIState => state.students.ui;\r\n\r\n/**\r\n * Selector for selected student IDs.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {string[]} Array of selected student IDs\r\n *\r\n * @example\r\n * ```typescript\r\n * const selectedIds = useSelector(selectSelectedStudentIds);\r\n * const selectedCount = selectedIds.length;\r\n * ```\r\n */\r\nexport const selectSelectedStudentIds = (state: RootState): string[] => state.students.ui.selectedIds;\r\n\r\n/**\r\n * Selector for current view mode.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {StudentUIState['viewMode']} Current view mode ('grid' | 'list' | 'table')\r\n *\r\n * @example\r\n * ```typescript\r\n * const viewMode = useSelector(selectStudentViewMode);\r\n * ```\r\n */\r\nexport const selectStudentViewMode = (state: RootState): StudentUIState['viewMode'] => state.students.ui.viewMode;\r\n\r\n/**\r\n * Selector for active filters.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {StudentFiltersType} Current filter criteria\r\n *\r\n * @example\r\n * ```typescript\r\n * const filters = useSelector(selectStudentFilters);\r\n * if (filters.grade) {\r\n *   console.log(`Filtering by grade: ${filters.grade}`);\r\n * }\r\n * ```\r\n */\r\nexport const selectStudentFilters = (state: RootState): StudentFiltersType => state.students.ui.filters;\r\n\r\n/**\r\n * Selector for current sort configuration.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {{sortBy: string, sortOrder: string}} Sort configuration object\r\n *\r\n * @example\r\n * ```typescript\r\n * const { sortBy, sortOrder } = useSelector(selectStudentSort);\r\n * console.log(`Sorted by ${sortBy} ${sortOrder}`);\r\n * ```\r\n */\r\nexport const selectStudentSort = (state: RootState) => ({\r\n  sortBy: state.students.ui.sortBy,\r\n  sortOrder: state.students.ui.sortOrder,\r\n});\r\n\r\n/**\r\n * Selector for pagination state.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {{currentPage: number, pageSize: number}} Pagination configuration\r\n *\r\n * @example\r\n * ```typescript\r\n * const { currentPage, pageSize } = useSelector(selectStudentPagination);\r\n * ```\r\n */\r\nexport const selectStudentPagination = (state: RootState) => ({\r\n  currentPage: state.students.ui.currentPage,\r\n  pageSize: state.students.ui.pageSize,\r\n});\r\n\r\n/**\r\n * Selector for search query.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {string} Current search query\r\n *\r\n * @example\r\n * ```typescript\r\n * const searchQuery = useSelector(selectStudentSearchQuery);\r\n * ```\r\n */\r\nexport const selectStudentSearchQuery = (state: RootState): string => state.students.ui.searchQuery;\r\n\r\n/**\r\n * Selector for inactive students visibility.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {boolean} Whether inactive students are shown\r\n *\r\n * @example\r\n * ```typescript\r\n * const showInactive = useSelector(selectShowInactiveStudents);\r\n * ```\r\n */\r\nexport const selectShowInactiveStudents = (state: RootState): boolean => state.students.ui.showInactive;\r\n\r\n/**\r\n * Selector for bulk select mode status.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {boolean} Whether bulk select mode is active\r\n *\r\n * @example\r\n * ```typescript\r\n * const isBulkMode = useSelector(selectIsBulkSelectMode);\r\n * ```\r\n */\r\nexport const selectIsBulkSelectMode = (state: RootState): boolean => state.students.ui.bulkSelectMode;\r\n\r\n/**\r\n * Selector for expanded student card IDs.\r\n *\r\n * @param {RootState} state - Redux root state\r\n * @returns {string[]} Array of expanded student IDs\r\n *\r\n * @example\r\n * ```typescript\r\n * const expandedCards = useSelector(selectExpandedStudentCards);\r\n * const isExpanded = expandedCards.includes(studentId);\r\n * ```\r\n */\r\nexport const selectExpandedStudentCards = (state: RootState): string[] => state.students.ui.expandedCards;\r\n\r\n/**\r\n * Selector for filtered and sorted students.\r\n *\r\n * Applies filters, search query, and sorting to all students. This is a complex\r\n * selector that performs client-side filtering and sorting.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Filtered and sorted student array\r\n *\r\n * @remarks\r\n * **Performance:** Should be memoized with reselect for production use with large datasets.\r\n * **Filtering Logic:**\r\n * - Activity filter (active/inactive)\r\n * - Text search (firstName, lastName, studentNumber, grade)\r\n * - Grade filter\r\n * - Nurse assignment filter\r\n * - Allergy presence filter\r\n * - Medication presence filter\r\n * **Sorting Logic:** Supports sorting by name, grade, enrollment date, or last visit.\r\n *\r\n * @example\r\n * ```typescript\r\n * const filteredStudents = useSelector(selectFilteredAndSortedStudents);\r\n * console.log(`Showing ${filteredStudents.length} students`);\r\n * ```\r\n */\r\nexport const selectFilteredAndSortedStudents = (state: RootState): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  const { filters, searchQuery, showInactive, sortBy, sortOrder } = state.students.ui;\r\n\r\n  let filteredStudents = allStudents;\r\n\r\n  // Apply activity filter\r\n  if (!showInactive) {\r\n    filteredStudents = filteredStudents.filter(student => student.isActive);\r\n  }\r\n\r\n  // Apply search query\r\n  if (searchQuery.trim()) {\r\n    const query = searchQuery.toLowerCase();\r\n    filteredStudents = filteredStudents.filter(student =>\r\n      student.firstName.toLowerCase().includes(query) ||\r\n      student.lastName.toLowerCase().includes(query) ||\r\n      student.studentNumber.toLowerCase().includes(query) ||\r\n      student.grade.toLowerCase().includes(query)\r\n    );\r\n  }\r\n\r\n  // Apply filters\r\n  if (filters.grade) {\r\n    filteredStudents = filteredStudents.filter(student => student.grade === filters.grade);\r\n  }\r\n  if (filters.nurseId) {\r\n    filteredStudents = filteredStudents.filter(student => student.nurseId === filters.nurseId);\r\n  }\r\n  if (filters.hasAllergies !== undefined) {\r\n    filteredStudents = filteredStudents.filter(student =>\r\n      filters.hasAllergies ? (student.allergies && student.allergies.length > 0) :\r\n                            !(student.allergies && student.allergies.length > 0)\r\n    );\r\n  }\r\n  if (filters.hasMedications !== undefined) {\r\n    filteredStudents = filteredStudents.filter(student =>\r\n      filters.hasMedications ? (student.medications && student.medications.length > 0) :\r\n                              !(student.medications && student.medications.length > 0)\r\n    );\r\n  }\r\n\r\n  // Apply sorting\r\n  filteredStudents.sort((a, b) => {\r\n    let aValue: string | number | Date, bValue: string | number | Date;\r\n\r\n    switch (sortBy) {\r\n      case 'name':\r\n        aValue = `${a.lastName}, ${a.firstName}`;\r\n        bValue = `${b.lastName}, ${b.firstName}`;\r\n        break;\r\n      case 'grade':\r\n        aValue = a.grade;\r\n        bValue = b.grade;\r\n        break;\r\n      case 'enrollmentDate':\r\n        aValue = new Date(a.enrollmentDate);\r\n        bValue = new Date(b.enrollmentDate);\r\n        break;\r\n      case 'lastVisit':\r\n        // Get most recent appointment date as last visit\r\n        aValue = a.appointments && a.appointments.length > 0\r\n          ? new Date(Math.max(...a.appointments.map(apt => new Date(apt.scheduledAt).getTime())))\r\n          : new Date(0);\r\n        bValue = b.appointments && b.appointments.length > 0\r\n          ? new Date(Math.max(...b.appointments.map(apt => new Date(apt.scheduledAt).getTime())))\r\n          : new Date(0);\r\n        break;\r\n      default:\r\n        aValue = a.lastName;\r\n        bValue = b.lastName;\r\n    }\r\n\r\n    if ((aValue as any) < (bValue as any)) return sortOrder === 'asc' ? -1 : 1;\r\n    if ((aValue as any) > (bValue as any)) return sortOrder === 'asc' ? 1 : -1;\r\n    return 0;\r\n  });\r\n\r\n  return filteredStudents;\r\n};\r\n\r\n/**\r\n * Selector for paginated students.\r\n *\r\n * Returns the current page of students based on filtered/sorted results and\r\n * pagination settings.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Students for current page\r\n *\r\n * @remarks\r\n * **Performance:** Pagination reduces DOM rendering load for large student lists.\r\n * **Dependencies:** Relies on selectFilteredAndSortedStudents for input data.\r\n *\r\n * @example\r\n * ```typescript\r\n * const currentPageStudents = useSelector(selectPaginatedStudents);\r\n * // Returns 20 students for current page (default page size)\r\n * ```\r\n */\r\nexport const selectPaginatedStudents = (state: RootState): Student[] => {\r\n  const filteredStudents = selectFilteredAndSortedStudents(state);\r\n  const { currentPage, pageSize } = state.students.ui;\r\n\r\n  const startIndex = (currentPage - 1) * pageSize;\r\n  const endIndex = startIndex + pageSize;\r\n\r\n  return filteredStudents.slice(startIndex, endIndex);\r\n};\r\n\r\n/**\r\n * Selector for pagination metadata.\r\n *\r\n * Provides comprehensive pagination information including total count, page numbers,\r\n * and navigation availability.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Object} Pagination metadata\r\n * @returns {number} return.totalStudents - Total filtered student count\r\n * @returns {number} return.currentPage - Current page number\r\n * @returns {number} return.pageSize - Students per page\r\n * @returns {number} return.totalPages - Total number of pages\r\n * @returns {boolean} return.hasNextPage - Whether next page exists\r\n * @returns {boolean} return.hasPreviousPage - Whether previous page exists\r\n * @returns {number} return.startIndex - Starting student index (1-based)\r\n * @returns {number} return.endIndex - Ending student index (inclusive)\r\n *\r\n * @example\r\n * ```typescript\r\n * const paginationInfo = useSelector(selectStudentPaginationInfo);\r\n * console.log(`Showing ${paginationInfo.startIndex}-${paginationInfo.endIndex} of ${paginationInfo.totalStudents}`);\r\n * ```\r\n */\r\nexport const selectStudentPaginationInfo = (state: RootState) => {\r\n  const totalStudents = selectFilteredAndSortedStudents(state).length;\r\n  const { currentPage, pageSize } = state.students.ui;\r\n\r\n  return {\r\n    totalStudents,\r\n    currentPage,\r\n    pageSize,\r\n    totalPages: Math.ceil(totalStudents / pageSize),\r\n    hasNextPage: currentPage * pageSize < totalStudents,\r\n    hasPreviousPage: currentPage > 1,\r\n    startIndex: (currentPage - 1) * pageSize + 1,\r\n    endIndex: Math.min(currentPage * pageSize, totalStudents),\r\n  };\r\n};\r\n\r\n/**\r\n * Selector for selected student entities.\r\n *\r\n * Returns full student objects for all selected IDs.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Array of selected student entities\r\n *\r\n * @example\r\n * ```typescript\r\n * const selectedStudents = useSelector(selectSelectedStudents);\r\n * const selectedNames = selectedStudents.map(s => `${s.firstName} ${s.lastName}`);\r\n * ```\r\n */\r\nexport const selectSelectedStudents = (state: RootState): Student[] => {\r\n  const selectedIds = state.students.ui.selectedIds;\r\n  return selectedIds.map((id: string) => studentsSelectors.selectById(state, id)).filter(Boolean) as Student[];\r\n};\r\n\r\n/**\r\n * Selector for active students only.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Array of active students\r\n *\r\n * @remarks\r\n * **HIPAA Data Minimization:** By default, only active students are shown to limit\r\n * exposure of potentially outdated PHI.\r\n *\r\n * @example\r\n * ```typescript\r\n * const activeStudents = useSelector(selectActiveStudents);\r\n * ```\r\n */\r\nexport const selectActiveStudents = (state: RootState): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.filter(student => student.isActive);\r\n};\r\n\r\n/**\r\n * Selector for students by grade.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} grade - Grade to filter by (e.g., 'K', '1', '2', ..., '12')\r\n * @returns {Student[]} Students in specified grade\r\n *\r\n * @example\r\n * ```typescript\r\n * const fifthGraders = useSelector(state => selectStudentsByGrade(state, '5'));\r\n * ```\r\n */\r\nexport const selectStudentsByGrade = (state: RootState, grade: string): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.filter(student => student.grade === grade);\r\n};\r\n\r\n/**\r\n * Selector for students assigned to a specific nurse.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} nurseId - Nurse ID to filter by\r\n * @returns {Student[]} Students assigned to specified nurse\r\n *\r\n * @example\r\n * ```typescript\r\n * const myStudents = useSelector(state => selectStudentsByNurse(state, currentNurseId));\r\n * ```\r\n */\r\nexport const selectStudentsByNurse = (state: RootState, nurseId: string): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.filter(student => student.nurseId === nurseId);\r\n};\r\n\r\n/**\r\n * Selector for students with allergies.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Students with one or more documented allergies\r\n *\r\n * @remarks\r\n * **Healthcare Alert:** These students require special attention for medication\r\n * administration and should have allergy information prominently displayed.\r\n *\r\n * @example\r\n * ```typescript\r\n * const studentsWithAllergies = useSelector(selectStudentsWithAllergies);\r\n * const allergyCount = studentsWithAllergies.length;\r\n * ```\r\n */\r\nexport const selectStudentsWithAllergies = (state: RootState): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.filter(student => student.allergies && student.allergies.length > 0);\r\n};\r\n\r\n/**\r\n * Selector for students with active medications.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {Student[]} Students with one or more active medications\r\n *\r\n * @remarks\r\n * **Healthcare Alert:** These students require medication administration tracking\r\n * and should be monitored for side effects and compliance.\r\n *\r\n * @example\r\n * ```typescript\r\n * const studentsWithMeds = useSelector(selectStudentsWithMedications);\r\n * ```\r\n */\r\nexport const selectStudentsWithMedications = (state: RootState): Student[] => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.filter(student => student.medications && student.medications.length > 0);\r\n};\r\n\r\n/**\r\n * Selector for student by student number.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentNumber - Student number to search for (e.g., 'STU-2024-001')\r\n * @returns {Student | undefined} Student with matching student number, or undefined if not found\r\n *\r\n * @remarks\r\n * **Unique Identifier:** Student number is a unique identifier enforced by backend validation.\r\n *\r\n * @example\r\n * ```typescript\r\n * const student = useSelector(state => selectStudentByNumber(state, 'STU-2024-001'));\r\n * if (student) {\r\n *   console.log(`Found: ${student.firstName} ${student.lastName}`);\r\n * }\r\n * ```\r\n */\r\nexport const selectStudentByNumber = (state: RootState, studentNumber: string): Student | undefined => {\r\n  const allStudents = studentsSelectors.selectAll(state) as Student[];\r\n  return allStudents.find(student => student.studentNumber === studentNumber);\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9869, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/emergencyContactsSlice.ts"],"sourcesContent":["/**\r\n * @module pages/students/store/emergencyContactsSlice\r\n *\r\n * Emergency Contacts Redux Slice - Priority-Based Contact Management\r\n *\r\n * Manages student emergency contacts with support for contact verification,\r\n * priority-based notification workflows, and parent consent tracking. Provides\r\n * standardized CRUD operations using the entity slice factory pattern.\r\n *\r\n * @remarks\r\n * **Emergency Workflow Integration:** This slice supports critical emergency\r\n * notification workflows, enabling school nurses to quickly identify and contact\r\n * appropriate guardians during medical emergencies.\r\n *\r\n * **Contact Verification Process:**\r\n * 1. Initial creation with verificationStatus: 'UNVERIFIED'\r\n * 2. Automated verification attempt (phone/email validation)\r\n * 3. Manual verification by school nurse required\r\n * 4. Status progression: UNVERIFIED â†’ PENDING â†’ VERIFIED / FAILED\r\n * 5. Only VERIFIED contacts used in automated emergency notifications\r\n *\r\n * **Priority-Based Notification:**\r\n * - PRIMARY: First line contact for all notifications (typically parent/guardian)\r\n * - SECONDARY: Backup contact if primary unreachable\r\n * - EMERGENCY_ONLY: Reserved for critical situations only\r\n * - Priority-based escalation with configurable timeout per school policy\r\n *\r\n * **Parent Consent Tracking:**\r\n * - Tracks consent for medical treatment authorization\r\n * - Digital consent form integration with document management\r\n * - Consent date tracking and expiration monitoring\r\n * - Audit trail of all consent history changes\r\n *\r\n * **HIPAA Compliance:**\r\n * - Emergency contact information contains PHI (relationship, medical authorization)\r\n * - All operations trigger audit logging in backend\r\n * - PHI excluded from localStorage persistence\r\n * - Cross-tab sync via BroadcastChannel (not localStorage)\r\n *\r\n * **Bulk Operations Disabled:**\r\n * - Intentionally disabled to ensure individual validation\r\n * - Each contact change requires verification of current information\r\n * - Prevents mass updates that could compromise emergency response\r\n *\r\n * @see {@link emergencyContactsApi} for backend API integration\r\n * @see {@link EmergencyContact} for contact entity type definition\r\n * @see {@link createEntitySlice} for factory implementation details\r\n *\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { EmergencyContact, CreateEmergencyContactData, UpdateEmergencyContactData } from '@/types/student.types';\r\nimport { apiActions } from '@/lib/api';\r\n\r\n/**\r\n * Filter parameters for querying emergency contacts.\r\n *\r\n * Supports filtering by student, priority level, active status, and verification\r\n * status with pagination support.\r\n *\r\n * @interface EmergencyContactFilters\r\n *\r\n * @property {string} [studentId] - Filter by specific student\r\n * @property {string} [priority] - Filter by priority level ('PRIMARY', 'SECONDARY', 'EMERGENCY_ONLY')\r\n * @property {boolean} [isActive] - Filter by active status\r\n * @property {string} [verificationStatus] - Filter by verification status ('UNVERIFIED', 'PENDING', 'VERIFIED', 'FAILED')\r\n * @property {number} [page] - Page number for pagination (1-indexed)\r\n * @property {number} [limit] - Number of contacts per page (default: 20)\r\n *\r\n * @remarks\r\n * **Common Use Cases:**\r\n * - List all verified primary contacts for a student\r\n * - Find unverified contacts needing manual verification\r\n * - Identify contacts requiring consent re-verification\r\n * - Generate emergency contact reports by priority\r\n *\r\n * @example\r\n * ```typescript\r\n * // Get all verified primary contacts for a student\r\n * const filters: EmergencyContactFilters = {\r\n *   studentId: 'student-123',\r\n *   priority: 'PRIMARY',\r\n *   verificationStatus: 'VERIFIED',\r\n *   isActive: true\r\n * };\r\n * ```\r\n */\r\ninterface EmergencyContactFilters {\r\n  studentId?: string;\r\n  priority?: string;\r\n  isActive?: boolean;\r\n  verificationStatus?: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n/**\r\n * API service adapter for emergency contacts.\r\n *\r\n * Wraps the emergencyContactsApi service to conform to the EntityApiService\r\n * interface required by the entity slice factory. Handles response transformation\r\n * and error handling for all emergency contact CRUD operations.\r\n *\r\n * @const {EntityApiService<EmergencyContact, CreateEmergencyContactData, UpdateEmergencyContactData>}\r\n *\r\n * @remarks\r\n * **API Integration:** All methods call emergencyContactsApi which handles\r\n * authentication, error handling, retry logic, and audit logging.\r\n *\r\n * **Response Transformation:** Normalizes API responses to match slice factory\r\n * expectations, ensuring consistent data structure across all entity types.\r\n *\r\n * **Verification Workflow:** API automatically initiates verification process\r\n * upon contact creation, setting initial status to 'UNVERIFIED'.\r\n *\r\n * @see {@link emergencyContactsApi} for underlying API implementation\r\n * @see {@link EntityApiService} for interface definition\r\n */\r\nconst emergencyContactsApiService: EntityApiService<EmergencyContact, CreateEmergencyContactData, UpdateEmergencyContactData> = {\r\n  /**\r\n   * Fetches all emergency contacts with optional filtering and pagination.\r\n   *\r\n   * @param {EmergencyContactFilters} [params] - Optional filter parameters\r\n   * @returns {Promise<{data: EmergencyContact[], total?: number, pagination?: any}>} Emergency contacts and pagination\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation triggers audit logging for PHI access.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Fetch all verified contacts for a student\r\n   * const response = await emergencyContactsApiService.getAll({\r\n   *   studentId: 'student-123',\r\n   *   verificationStatus: 'VERIFIED'\r\n   * });\r\n   * ```\r\n   */\r\n  async getAll(params?: EmergencyContactFilters) {\r\n    const response = await apiActions.emergencyContacts.getAll(params);\r\n    return {\r\n      data: response.data?.contacts || [],\r\n      total: response.data?.pagination?.total,\r\n      pagination: response.data?.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetches a single emergency contact by ID.\r\n   *\r\n   * @param {string} id - Emergency contact ID to fetch\r\n   * @returns {Promise<{data: EmergencyContact}>} Single emergency contact\r\n   * @throws {Error} If contact not found or access denied\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** This operation triggers audit logging for PHI access.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const contact = await emergencyContactsApiService.getById('contact-456');\r\n   * ```\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.emergencyContacts.getById(id);\r\n    return { data: response.data };\r\n  },\r\n\r\n  /**\r\n   * Creates a new emergency contact.\r\n   *\r\n   * @param {CreateEmergencyContactData} data - Emergency contact creation data\r\n   * @returns {Promise<{data: EmergencyContact}>} Created emergency contact\r\n   * @throws {Error} If validation fails or studentId not found\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Creation triggers audit log for new contact record.\r\n   *\r\n   * **Verification Workflow:** Automatically initiates verification process:\r\n   * - Sets verificationStatus to 'UNVERIFIED'\r\n   * - Triggers automated phone/email validation if available\r\n   * - Creates task for manual verification by school nurse\r\n   *\r\n   * **Validation:** Backend validates phone number format, email format,\r\n   * relationship type, and ensures studentId exists.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const newContact = await emergencyContactsApiService.create({\r\n   *   studentId: 'student-123',\r\n   *   firstName: 'Jane',\r\n   *   lastName: 'Doe',\r\n   *   relationship: 'MOTHER',\r\n   *   phoneNumber: '555-123-4567',\r\n   *   email: 'jane.doe@example.com',\r\n   *   priority: 'PRIMARY',\r\n   *   canAuthorizeMeâ€‹dicalTreatment: true\r\n   * });\r\n   * ```\r\n   */\r\n  async create(data: CreateEmergencyContactData) {\r\n    const response = await apiActions.emergencyContacts.create(data);\r\n    return { data: response.data };\r\n  },\r\n\r\n  /**\r\n   * Updates an existing emergency contact.\r\n   *\r\n   * @param {string} id - Emergency contact ID to update\r\n   * @param {UpdateEmergencyContactData} data - Updated emergency contact data (partial)\r\n   * @returns {Promise<{data: EmergencyContact}>} Updated emergency contact\r\n   * @throws {Error} If contact not found, access denied, or validation fails\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Update triggers audit log recording changed fields.\r\n   *\r\n   * **Re-verification:** Changes to phone number or email automatically trigger\r\n   * re-verification process, resetting verificationStatus to 'PENDING'.\r\n   *\r\n   * **Consent Updates:** Changes to medical treatment authorization require\r\n   * new consent documentation and parent signature.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Update phone number (triggers re-verification)\r\n   * const updated = await emergencyContactsApiService.update('contact-456', {\r\n   *   phoneNumber: '555-987-6543'\r\n   * });\r\n   * ```\r\n   */\r\n  async update(id: string, data: UpdateEmergencyContactData) {\r\n    const response = await apiActions.emergencyContacts.update(id, data);\r\n    return { data: response.data };\r\n  },\r\n\r\n  /**\r\n   * Deletes (soft-deletes) an emergency contact.\r\n   *\r\n   * @param {string} id - Emergency contact ID to delete\r\n   * @returns {Promise<{success: boolean}>} Deletion success status\r\n   * @throws {Error} If contact not found or access denied\r\n   *\r\n   * @remarks\r\n   * **HIPAA Audit:** Deletion triggers audit log for data retention compliance.\r\n   *\r\n   * **Soft Delete:** Emergency contacts are soft-deleted (marked inactive) to\r\n   * preserve historical emergency response data and audit trail.\r\n   *\r\n   * **Emergency Impact:** Deleting PRIMARY contact triggers alert if no other\r\n   * verified PRIMARY contact exists for student.\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * await emergencyContactsApiService.delete('contact-456');\r\n   * // Contact is marked isActive: false, not physically deleted\r\n   * ```\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.emergencyContacts.delete(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Emergency contacts slice factory instance.\r\n *\r\n * Creates the Redux slice with standardized CRUD operations, loading states,\r\n * and error handling using the entity slice factory pattern.\r\n *\r\n * @const\r\n *\r\n * @remarks\r\n * **Bulk Operations Disabled:** Intentionally disabled for emergency contacts to\r\n * ensure each contact change receives individual verification. This prevents\r\n * accidental mass updates that could compromise emergency notification reliability.\r\n *\r\n * **Normalized State:** Uses EntityAdapter for normalized state management with\r\n * efficient O(1) lookups by contact ID.\r\n *\r\n * @see {@link createEntitySlice} for factory implementation details\r\n */\r\nconst emergencyContactsSliceFactory = createEntitySlice<EmergencyContact, CreateEmergencyContactData, UpdateEmergencyContactData>(\r\n  'emergencyContacts',\r\n  emergencyContactsApiService,\r\n  {\r\n    enableBulkOperations: false,\r\n  }\r\n);\r\n\r\n/**\r\n * Emergency contacts Redux slice.\r\n *\r\n * @exports emergencyContactsSlice\r\n */\r\nexport const emergencyContactsSlice = emergencyContactsSliceFactory.slice;\r\n\r\n/**\r\n * Emergency contacts reducer for Redux store.\r\n *\r\n * @exports emergencyContactsReducer\r\n */\r\nexport const emergencyContactsReducer = emergencyContactsSlice.reducer;\r\n\r\n/**\r\n * Action creators for emergency contact state updates.\r\n *\r\n * @exports emergencyContactsActions\r\n */\r\nexport const emergencyContactsActions = emergencyContactsSliceFactory.actions;\r\n\r\n/**\r\n * Entity adapter selectors for normalized emergency contact state.\r\n *\r\n * @exports emergencyContactsSelectors\r\n *\r\n * @example\r\n * ```typescript\r\n * const allContacts = useSelector(emergencyContactsSelectors.selectAll);\r\n * const contact = useSelector(state => emergencyContactsSelectors.selectById(state, 'contact-123'));\r\n * ```\r\n */\r\nexport const emergencyContactsSelectors = emergencyContactsSliceFactory.adapter.getSelectors((state: any) => state.emergencyContacts);\r\n\r\n/**\r\n * Async thunks for emergency contact API operations.\r\n *\r\n * @exports emergencyContactsThunks\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch all contacts for a student\r\n * dispatch(emergencyContactsThunks.fetchAll({ studentId: 'student-123' }));\r\n *\r\n * // Create new contact\r\n * dispatch(emergencyContactsThunks.create(contactData));\r\n * ```\r\n */\r\nexport const emergencyContactsThunks = emergencyContactsSliceFactory.thunks;\r\n\r\n/**\r\n * Selector for emergency contacts by student.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student ID to filter by\r\n * @returns {EmergencyContact[]} Emergency contacts for specified student\r\n *\r\n * @remarks\r\n * **Emergency Response:** Used to display all contacts when viewing student profile\r\n * or initiating emergency notification workflow.\r\n *\r\n * @example\r\n * ```typescript\r\n * const studentContacts = useSelector(state =>\r\n *   selectContactsByStudent(state, 'student-123')\r\n * );\r\n * ```\r\n */\r\nexport const selectContactsByStudent = (state: any, studentId: string): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact => contact.studentId === studentId);\r\n};\r\n\r\n/**\r\n * Selector for active emergency contacts.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {EmergencyContact[]} All active emergency contacts\r\n *\r\n * @remarks\r\n * **Data Filtering:** Excludes soft-deleted contacts to show only current,\r\n * usable emergency contacts.\r\n *\r\n * @example\r\n * ```typescript\r\n * const activeContacts = useSelector(selectActiveContacts);\r\n * ```\r\n */\r\nexport const selectActiveContacts = (state: any): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact => contact.isActive);\r\n};\r\n\r\n/**\r\n * Selector for active emergency contacts by student.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student ID to filter by\r\n * @returns {EmergencyContact[]} Active emergency contacts for specified student\r\n *\r\n * @remarks\r\n * **Emergency Workflow:** Primary selector for emergency notification workflows,\r\n * ensuring only active, current contacts are used.\r\n *\r\n * @example\r\n * ```typescript\r\n * const activeStudentContacts = useSelector(state =>\r\n *   selectActiveContactsByStudent(state, 'student-123')\r\n * );\r\n * ```\r\n */\r\nexport const selectActiveContactsByStudent = (state: any, studentId: string): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact =>\r\n    contact.studentId === studentId && contact.isActive\r\n  );\r\n};\r\n\r\n/**\r\n * Selector for primary emergency contacts.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {EmergencyContact[]} All active primary emergency contacts\r\n *\r\n * @remarks\r\n * **Emergency Response:** Primary contacts are first line for all notifications.\r\n * Students should have at least one verified primary contact.\r\n *\r\n * **Priority Level:** PRIMARY contacts are contacted first in emergency workflows\r\n * with fastest response expectations.\r\n *\r\n * @example\r\n * ```typescript\r\n * const primaryContacts = useSelector(selectPrimaryContacts);\r\n * ```\r\n */\r\nexport const selectPrimaryContacts = (state: any): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact =>\r\n    contact.priority === 'PRIMARY' && contact.isActive\r\n  );\r\n};\r\n\r\n/**\r\n * Selector for primary emergency contact by student.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student ID to filter by\r\n * @returns {EmergencyContact | undefined} Primary contact for student, or undefined if none exists\r\n *\r\n * @remarks\r\n * **Critical Selector:** Used to identify first contact point during emergencies.\r\n * If undefined, indicates student lacks verified primary contact (alert condition).\r\n *\r\n * **Emergency Workflow:** This contact receives first notification attempt with\r\n * shortest timeout before escalating to secondary contacts.\r\n *\r\n * @example\r\n * ```typescript\r\n * const primaryContact = useSelector(state =>\r\n *   selectPrimaryContactByStudent(state, 'student-123')\r\n * );\r\n * if (!primaryContact) {\r\n *   console.warn('No primary contact found for student - emergency response compromised');\r\n * }\r\n * ```\r\n */\r\nexport const selectPrimaryContactByStudent = (state: any, studentId: string): EmergencyContact | undefined => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.find(contact =>\r\n    contact.studentId === studentId &&\r\n    contact.priority === 'PRIMARY' &&\r\n    contact.isActive\r\n  );\r\n};\r\n\r\n/**\r\n * Selector for unverified emergency contacts.\r\n *\r\n * @param {any} state - Redux root state\r\n * @returns {EmergencyContact[]} Contacts requiring verification\r\n *\r\n * @remarks\r\n * **Compliance Alert:** Unverified contacts indicate incomplete emergency preparedness.\r\n * School nurses should prioritize verification of these contacts.\r\n *\r\n * **Verification Workflow:** Returns contacts with status 'UNVERIFIED' or 'FAILED'\r\n * that need manual verification or correction.\r\n *\r\n * **Quality Assurance:** Used to generate reports of contacts needing attention\r\n * before emergency situations arise.\r\n *\r\n * @example\r\n * ```typescript\r\n * const unverifiedContacts = useSelector(selectUnverifiedContacts);\r\n * if (unverifiedContacts.length > 0) {\r\n *   // Display alert: \"X contacts require verification\"\r\n * }\r\n * ```\r\n */\r\nexport const selectUnverifiedContacts = (state: any): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact =>\r\n    contact.verificationStatus === 'UNVERIFIED' ||\r\n    contact.verificationStatus === 'FAILED'\r\n  );\r\n};\r\n\r\n/**\r\n * Selector for emergency contacts by relationship.\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} relationship - Relationship type to filter by (e.g., 'MOTHER', 'FATHER', 'GUARDIAN')\r\n * @returns {EmergencyContact[]} Contacts with specified relationship\r\n *\r\n * @remarks\r\n * **Use Cases:**\r\n * - Generate parent contact lists\r\n * - Identify guardian contacts for consent forms\r\n * - Create relationship-specific reports\r\n *\r\n * @example\r\n * ```typescript\r\n * const mothers = useSelector(state =>\r\n *   selectContactsByRelationship(state, 'MOTHER')\r\n * );\r\n * ```\r\n */\r\nexport const selectContactsByRelationship = (state: any, relationship: string): EmergencyContact[] => {\r\n  const allContacts = emergencyContactsSelectors.selectAll(state) as EmergencyContact[];\r\n  return allContacts.filter(contact => contact.relationship === relationship);\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10167, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/types/domain/incidents.ts"],"sourcesContent":["/**\r\n * WF-COMP-325 | incidents.ts - React component or utility module\r\n * Purpose: react component or utility module\r\n * Upstream: React, external libs | Dependencies: React ecosystem\r\n * Downstream: Components, pages, app routing | Called by: React component tree\r\n * Related: Other components, hooks, services, types\r\n * Exports: functions, interfaces | Key Features: Standard module\r\n * Last Updated: 2025-10-17 | File Type: .ts\r\n * Critical Path: Component mount â†’ Render â†’ User interaction â†’ State updates\r\n * LLM Context: react component or utility module, part of React frontend architecture\r\n */\r\n\r\n/**\r\n * Incident Reports Module Types\r\n * Comprehensive type definitions for incident reporting system\r\n * Includes incidents, witness statements, follow-up actions, and compliance tracking\r\n */\r\n\r\nimport type { BaseEntity, User, Priority } from '../core/common';\r\n\r\n// To avoid circular dependencies, define minimal reference types\r\ntype StudentReference = {\r\n  id: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  studentNumber: string;\r\n};\r\n\r\n// =====================\r\n// ENUMS AND CONSTANTS\r\n// =====================\r\n\r\n/**\r\n * Incident type classification\r\n * @aligned_with backend/src/database/types/enums.ts:IncidentType\r\n */\r\nexport enum IncidentType {\r\n  INJURY = 'INJURY',\r\n  ILLNESS = 'ILLNESS',\r\n  BEHAVIORAL = 'BEHAVIORAL',\r\n  MEDICATION_ERROR = 'MEDICATION_ERROR',\r\n  ALLERGIC_REACTION = 'ALLERGIC_REACTION',\r\n  EMERGENCY = 'EMERGENCY',\r\n  OTHER = 'OTHER',\r\n}\r\n\r\n/**\r\n * Incident severity levels\r\n * @aligned_with backend/src/database/types/enums.ts:IncidentSeverity\r\n */\r\nexport enum IncidentSeverity {\r\n  LOW = 'LOW',\r\n  MEDIUM = 'MEDIUM',\r\n  HIGH = 'HIGH',\r\n  CRITICAL = 'CRITICAL',\r\n}\r\n\r\n/**\r\n * Incident status tracking (UI-specific)\r\n * Note: Used for frontend workflow states. Backend tracks status via other fields.\r\n */\r\nexport enum IncidentStatus {\r\n  OPEN = 'OPEN',\r\n  INVESTIGATING = 'INVESTIGATING',\r\n  RESOLVED = 'RESOLVED',\r\n  CLOSED = 'CLOSED',\r\n}\r\n\r\n/**\r\n * Witness type classification\r\n * @aligned_with backend/src/database/types/enums.ts:WitnessType\r\n */\r\nexport enum WitnessType {\r\n  STUDENT = 'STUDENT',\r\n  STAFF = 'STAFF',\r\n  PARENT = 'PARENT',\r\n  OTHER = 'OTHER',\r\n}\r\n\r\n/**\r\n * Follow-up action priority levels\r\n * @aligned_with backend/src/database/types/enums.ts:ActionPriority\r\n */\r\nexport enum ActionPriority {\r\n  LOW = 'LOW',\r\n  MEDIUM = 'MEDIUM',\r\n  HIGH = 'HIGH',\r\n  URGENT = 'URGENT',\r\n}\r\n\r\n/**\r\n * Follow-up action status\r\n * @aligned_with backend/src/database/types/enums.ts:ActionStatus\r\n */\r\nexport enum ActionStatus {\r\n  PENDING = 'PENDING',\r\n  IN_PROGRESS = 'IN_PROGRESS',\r\n  COMPLETED = 'COMPLETED',\r\n  CANCELLED = 'CANCELLED',\r\n}\r\n\r\n/**\r\n * Insurance claim status tracking\r\n * @aligned_with backend/src/database/types/enums.ts:InsuranceClaimStatus\r\n */\r\nexport enum InsuranceClaimStatus {\r\n  NOT_FILED = 'NOT_FILED',\r\n  FILED = 'FILED',\r\n  PENDING = 'PENDING',\r\n  APPROVED = 'APPROVED',\r\n  DENIED = 'DENIED',\r\n  CLOSED = 'CLOSED',\r\n}\r\n\r\n/**\r\n * Legal compliance status\r\n * @aligned_with backend/src/database/types/enums.ts:ComplianceStatus\r\n */\r\nexport enum ComplianceStatus {\r\n  PENDING = 'PENDING',\r\n  COMPLIANT = 'COMPLIANT',\r\n  NON_COMPLIANT = 'NON_COMPLIANT',\r\n  UNDER_REVIEW = 'UNDER_REVIEW',\r\n}\r\n\r\n/**\r\n * Parent notification methods (UI-specific)\r\n * Note: Used for tracking notification methods in UI. Not a backend enum.\r\n */\r\nexport enum ParentNotificationMethod {\r\n  EMAIL = 'email',\r\n  SMS = 'sms',\r\n  VOICE = 'voice',\r\n  IN_PERSON = 'in-person',\r\n  AUTO_NOTIFICATION = 'auto-notification',\r\n}\r\n\r\n/**\r\n * Evidence file types (UI-specific)\r\n * Note: Used for UI file type classification. Not a backend enum.\r\n */\r\nexport enum EvidenceType {\r\n  PHOTO = 'photo',\r\n  VIDEO = 'video',\r\n  DOCUMENT = 'document',\r\n  AUDIO = 'audio',\r\n}\r\n\r\n// =====================\r\n// CORE ENTITIES\r\n// =====================\r\n\r\n/**\r\n * Main Incident Report entity\r\n * Contains all information about a safety or health incident\r\n *\r\n * @aligned_with backend/src/database/models/incidents/IncidentReport.ts\r\n *\r\n * PHI/PII Fields:\r\n * - studentId: Student identifier involved in incident (PII)\r\n * - reportedById: User identifier who reported the incident (PII)\r\n * - description: Detailed incident description may contain health information (PHI)\r\n * - actionsTaken: Medical actions and interventions (PHI)\r\n * - witnesses: Array of witness identifiers (PII)\r\n * - parentNotifiedBy: User identifier who notified parent (PII)\r\n * - followUpNotes: May contain medical follow-up information (PHI)\r\n * - evidencePhotos/evidenceVideos: May contain images/videos of injuries (PHI)\r\n *\r\n * Note: status, discoveredAt, and reportedAt are UI-specific fields not in backend model\r\n */\r\nexport interface IncidentReport extends BaseEntity {\r\n  // Student and Reporter Information\r\n  studentId: string; // PII - Student identifier\r\n  student?: StudentReference;\r\n  reportedById: string; // PII - Reporter identifier\r\n  reportedBy?: User;\r\n\r\n  // Incident Classification\r\n  type: IncidentType;\r\n  severity: IncidentSeverity;\r\n  status?: IncidentStatus; // UI-specific field (not in backend)\r\n\r\n  // Incident Details\r\n  description: string; // PHI - May contain health information\r\n  location: string;\r\n  occurredAt: string;\r\n  discoveredAt?: string; // UI-specific field (not in backend)\r\n  reportedAt?: string; // UI-specific field (not in backend)\r\n\r\n  // Witness Information\r\n  witnesses?: string[]; // PII - Witness identifiers\r\n  witnessStatements?: WitnessStatement[];\r\n\r\n  // Actions and Response\r\n  actionsTaken: string; // PHI - Medical actions and interventions\r\n\r\n  // Follow-up Tracking\r\n  followUpRequired?: boolean;\r\n  followUpNotes?: string; // PHI - Medical follow-up information\r\n  followUpActions?: FollowUpAction[];\r\n\r\n  // Parent/Guardian Notification\r\n  parentNotified?: boolean;\r\n  parentNotificationMethod?: string;\r\n  parentNotifiedAt?: string;\r\n  parentNotifiedBy?: string; // PII - User identifier\r\n\r\n  // Evidence and Documentation\r\n  attachments?: string[]; // May contain PHI\r\n  evidencePhotos?: string[]; // PHI - Images of injuries\r\n  evidenceVideos?: string[]; // PHI - Videos of incidents\r\n\r\n  // Insurance and Compliance\r\n  insuranceClaimNumber?: string;\r\n  insuranceClaimStatus?: InsuranceClaimStatus;\r\n  legalComplianceStatus?: ComplianceStatus;\r\n}\r\n\r\n/**\r\n * Witness Statement entity\r\n * Records statements from witnesses of an incident\r\n *\r\n * @aligned_with backend/src/database/models/incidents/WitnessStatement.ts\r\n *\r\n * PHI/PII Fields:\r\n * - witnessName: Full name of the witness (PII)\r\n * - witnessContact: Contact information (email/phone) (PII)\r\n * - statement: Witness testimony may contain health information (PHI)\r\n * - verifiedBy: User identifier who verified the statement (PII)\r\n */\r\nexport interface WitnessStatement extends BaseEntity {\r\n  // Reference\r\n  incidentReportId: string;\r\n  incidentReport?: IncidentReport;\r\n\r\n  // Witness Information\r\n  witnessName: string; // PII - Witness full name\r\n  witnessType: WitnessType;\r\n  witnessContact?: string; // PII - Contact information\r\n\r\n  // Statement Details\r\n  statement: string; // May contain PHI\r\n\r\n  // Verification\r\n  verified: boolean;\r\n  verifiedBy?: string; // PII - User identifier\r\n  verifiedAt?: string;\r\n}\r\n\r\n/**\r\n * Follow-up Action entity\r\n * Tracks required actions and follow-up tasks for incidents\r\n *\r\n * @aligned_with backend/src/database/models/incidents/FollowUpAction.ts\r\n *\r\n * PHI/PII Fields:\r\n * - action: Description of follow-up action may reference medical care (PHI)\r\n * - assignedTo: User identifier assigned to the action (PII)\r\n * - completedBy: User identifier who completed the action (PII)\r\n * - notes: Completion notes may contain health information (PHI)\r\n */\r\nexport interface FollowUpAction extends BaseEntity {\r\n  // Reference\r\n  incidentReportId: string;\r\n  incidentReport?: IncidentReport;\r\n\r\n  // Action Details\r\n  action: string; // May contain PHI\r\n  priority: ActionPriority;\r\n  status: ActionStatus;\r\n\r\n  // Assignment\r\n  assignedTo?: string; // PII - User identifier\r\n  assignedToUser?: User;\r\n\r\n  // Scheduling\r\n  dueDate: string;\r\n\r\n  // Completion\r\n  completedAt?: string;\r\n  completedBy?: string; // PII - User identifier\r\n  notes?: string; // PHI - May contain health information\r\n}\r\n\r\n/**\r\n * Incident Comment entity\r\n * User comments on incident reports for collaboration and discussion\r\n *\r\n * PHI/PII Fields:\r\n * - userId: User identifier who created the comment (PII)\r\n * - text: Comment content may contain health information (PHI)\r\n * - editedBy: User identifier who edited the comment (PII)\r\n */\r\nexport interface IncidentComment extends BaseEntity {\r\n  // Reference\r\n  incidentReportId: string;\r\n  incidentReport?: IncidentReport;\r\n\r\n  // User Information\r\n  userId: string; // PII - User identifier\r\n  user?: User;\r\n\r\n  // Comment Details\r\n  text: string; // May contain PHI\r\n\r\n  // Edit tracking\r\n  isEdited: boolean;\r\n  editedAt?: string;\r\n  editedBy?: string; // PII - User identifier\r\n\r\n  // Metadata\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n// =====================\r\n// API REQUEST/RESPONSE TYPES\r\n// =====================\r\n\r\n/**\r\n * Request payload for creating a new incident report\r\n */\r\nexport interface CreateIncidentReportRequest {\r\n  studentId: string;\r\n  reportedById: string;\r\n  type: IncidentType;\r\n  severity: IncidentSeverity;\r\n  description: string;\r\n  location: string;\r\n  witnesses?: string[];\r\n  actionsTaken: string;\r\n  occurredAt: string;\r\n  parentNotified?: boolean;\r\n  followUpRequired?: boolean;\r\n  followUpNotes?: string;\r\n  attachments?: string[];\r\n  evidencePhotos?: string[];\r\n  evidenceVideos?: string[];\r\n  insuranceClaimNumber?: string;\r\n}\r\n\r\n/**\r\n * Request payload for updating an existing incident report\r\n */\r\nexport interface UpdateIncidentReportRequest {\r\n  type?: IncidentType;\r\n  severity?: IncidentSeverity;\r\n  description?: string;\r\n  location?: string;\r\n  witnesses?: string[];\r\n  actionsTaken?: string;\r\n  occurredAt?: string;\r\n  parentNotified?: boolean;\r\n  followUpRequired?: boolean;\r\n  followUpNotes?: string;\r\n  attachments?: string[];\r\n  evidencePhotos?: string[];\r\n  evidenceVideos?: string[];\r\n  insuranceClaimNumber?: string;\r\n  insuranceClaimStatus?: InsuranceClaimStatus;\r\n  legalComplianceStatus?: ComplianceStatus;\r\n}\r\n\r\n/**\r\n * Filter parameters for incident report queries\r\n */\r\nexport interface IncidentReportFilters {\r\n  page?: number;\r\n  limit?: number;\r\n  studentId?: string;\r\n  reportedById?: string;\r\n  type?: IncidentType;\r\n  severity?: IncidentSeverity;\r\n  status?: IncidentStatus;\r\n  dateFrom?: string;\r\n  dateTo?: string;\r\n  parentNotified?: boolean;\r\n  followUpRequired?: boolean;\r\n  location?: string;\r\n}\r\n\r\n/**\r\n * Request payload for creating a witness statement\r\n */\r\nexport interface CreateWitnessStatementRequest {\r\n  incidentReportId: string;\r\n  witnessName: string;\r\n  witnessType: WitnessType;\r\n  witnessContact?: string;\r\n  statement: string;\r\n}\r\n\r\n/**\r\n * Request payload for updating a witness statement\r\n */\r\nexport interface UpdateWitnessStatementRequest {\r\n  witnessName?: string;\r\n  witnessType?: WitnessType;\r\n  witnessContact?: string;\r\n  statement?: string;\r\n  verified?: boolean;\r\n}\r\n\r\n/**\r\n * Request payload for creating a follow-up action\r\n */\r\nexport interface CreateFollowUpActionRequest {\r\n  incidentReportId: string;\r\n  action: string;\r\n  dueDate: string;\r\n  priority: ActionPriority;\r\n  assignedTo?: string;\r\n}\r\n\r\n/**\r\n * Request payload for updating a follow-up action\r\n */\r\nexport interface UpdateFollowUpActionRequest {\r\n  action?: string;\r\n  dueDate?: string;\r\n  priority?: ActionPriority;\r\n  status?: ActionStatus;\r\n  assignedTo?: string;\r\n  notes?: string;\r\n}\r\n\r\n/**\r\n * Request payload for marking parent as notified\r\n */\r\nexport interface MarkParentNotifiedRequest {\r\n  notificationMethod?: string;\r\n  notifiedBy?: string;\r\n}\r\n\r\n/**\r\n * Request payload for adding follow-up notes\r\n */\r\nexport interface AddFollowUpNotesRequest {\r\n  notes: string;\r\n}\r\n\r\n/**\r\n * Request payload for parent notification\r\n */\r\nexport interface NotifyParentRequest {\r\n  method: ParentNotificationMethod;\r\n}\r\n\r\n/**\r\n * Request payload for adding evidence\r\n */\r\nexport interface AddEvidenceRequest {\r\n  evidenceType: 'photo' | 'video';\r\n  evidenceUrls: string[];\r\n}\r\n\r\n/**\r\n * Request payload for updating insurance claim\r\n */\r\nexport interface UpdateInsuranceClaimRequest {\r\n  claimNumber: string;\r\n  status: InsuranceClaimStatus;\r\n}\r\n\r\n/**\r\n * Request payload for updating compliance status\r\n */\r\nexport interface UpdateComplianceStatusRequest {\r\n  status: ComplianceStatus;\r\n}\r\n\r\n// =====================\r\n// STATISTICS AND ANALYTICS\r\n// =====================\r\n\r\n/**\r\n * Incident statistics response\r\n * Provides analytics and metrics about incidents\r\n */\r\nexport interface IncidentStatistics {\r\n  total: number;\r\n  byType: Record<string, number>;\r\n  bySeverity: Record<string, number>;\r\n  byLocation: Record<string, number>;\r\n  parentNotificationRate: number;\r\n  followUpRate: number;\r\n  averageResponseTime: number; // in minutes\r\n}\r\n\r\n/**\r\n * Filter parameters for statistics queries\r\n */\r\nexport interface IncidentStatisticsFilters {\r\n  dateFrom?: string;\r\n  dateTo?: string;\r\n  studentId?: string;\r\n}\r\n\r\n/**\r\n * Search parameters for incident reports\r\n */\r\nexport interface IncidentSearchParams {\r\n  query: string;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n// =====================\r\n// DOCUMENT GENERATION\r\n// =====================\r\n\r\n/**\r\n * Generated incident report document structure\r\n */\r\nexport interface IncidentReportDocument {\r\n  reportNumber: string;\r\n  generatedAt: string;\r\n  student: {\r\n    name: string;\r\n    studentNumber: string;\r\n    grade: string;\r\n    dateOfBirth: string;\r\n  };\r\n  incident: {\r\n    type: IncidentType;\r\n    severity: IncidentSeverity;\r\n    occurredAt: string;\r\n    location: string;\r\n    description: string;\r\n    actionsTaken: string;\r\n    witnesses?: string[];\r\n  };\r\n  reporter: {\r\n    name: string;\r\n    role: string;\r\n    reportedAt: string;\r\n  };\r\n  followUp: {\r\n    required: boolean;\r\n    notes?: string;\r\n    parentNotified: boolean;\r\n    parentNotificationMethod?: string;\r\n    parentNotifiedAt?: string;\r\n    actions?: FollowUpAction[];\r\n  };\r\n  evidence: {\r\n    attachments?: string[];\r\n    photos?: string[];\r\n    videos?: string[];\r\n  };\r\n  witnessStatements?: WitnessStatement[];\r\n  insurance: {\r\n    claimNumber?: string;\r\n    claimStatus?: InsuranceClaimStatus;\r\n  };\r\n  compliance: {\r\n    status?: ComplianceStatus;\r\n  };\r\n}\r\n\r\n// =====================\r\n// API RESPONSE TYPES\r\n// =====================\r\n\r\n/**\r\n * Response containing a single incident report\r\n */\r\nexport interface IncidentReportResponse {\r\n  report: IncidentReport;\r\n}\r\n\r\n/**\r\n * Response containing paginated list of incident reports\r\n */\r\nexport interface IncidentReportListResponse {\r\n  reports: IncidentReport[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n}\r\n\r\n/**\r\n * Response containing a single witness statement\r\n */\r\nexport interface WitnessStatementResponse {\r\n  statement: WitnessStatement;\r\n}\r\n\r\n/**\r\n * Response containing list of witness statements\r\n */\r\nexport interface WitnessStatementListResponse {\r\n  statements: WitnessStatement[];\r\n}\r\n\r\n/**\r\n * Response containing a single follow-up action\r\n */\r\nexport interface FollowUpActionResponse {\r\n  action: FollowUpAction;\r\n}\r\n\r\n/**\r\n * Response containing list of follow-up actions\r\n */\r\nexport interface FollowUpActionListResponse {\r\n  actions: FollowUpAction[];\r\n}\r\n\r\n/**\r\n * Response containing incident statistics\r\n */\r\nexport interface IncidentStatisticsResponse {\r\n  statistics: IncidentStatistics;\r\n}\r\n\r\n/**\r\n * Response containing generated document\r\n */\r\nexport interface IncidentDocumentResponse {\r\n  document: IncidentReportDocument;\r\n}\r\n\r\n/**\r\n * Response for evidence upload\r\n */\r\nexport interface EvidenceUploadResponse {\r\n  attachments: string[];\r\n}\r\n\r\n/**\r\n * Response for insurance submission\r\n */\r\nexport interface InsuranceSubmissionResponse {\r\n  submission: {\r\n    id: string;\r\n    claimNumber: string;\r\n    status: InsuranceClaimStatus;\r\n    submittedAt: string;\r\n    submittedBy: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Response containing list of insurance submissions\r\n */\r\nexport interface InsuranceSubmissionsResponse {\r\n  submissions: Array<{\r\n    id: string;\r\n    claimNumber: string;\r\n    status: InsuranceClaimStatus;\r\n    submittedAt: string;\r\n    submittedBy: string;\r\n  }>;\r\n}\r\n\r\n// =====================\r\n// FORM DATA TYPES\r\n// =====================\r\n\r\n/**\r\n * Form data for incident report creation/editing\r\n */\r\nexport interface IncidentReportFormData {\r\n  studentId: string;\r\n  type: IncidentType;\r\n  severity: IncidentSeverity;\r\n  description: string;\r\n  location: string;\r\n  occurredAt: string;\r\n  actionsTaken: string;\r\n  witnesses?: string[];\r\n  parentNotified?: boolean;\r\n  followUpRequired?: boolean;\r\n  followUpNotes?: string;\r\n}\r\n\r\n/**\r\n * Form data for witness statement\r\n */\r\nexport interface WitnessStatementFormData {\r\n  witnessName: string;\r\n  witnessType: WitnessType;\r\n  witnessContact?: string;\r\n  statement: string;\r\n}\r\n\r\n/**\r\n * Form data for follow-up action\r\n */\r\nexport interface FollowUpActionFormData {\r\n  action: string;\r\n  dueDate: string;\r\n  priority: ActionPriority;\r\n  assignedTo?: string;\r\n}\r\n\r\n/**\r\n * Request payload for creating a comment\r\n */\r\nexport interface CreateCommentRequest {\r\n  incidentReportId: string;\r\n  text: string;\r\n}\r\n\r\n/**\r\n * Request payload for updating a comment\r\n */\r\nexport interface UpdateCommentRequest {\r\n  text: string;\r\n}\r\n\r\n/**\r\n * Response containing a single comment\r\n */\r\nexport interface CommentResponse {\r\n  comment: IncidentComment;\r\n}\r\n\r\n/**\r\n * Response containing list of comments\r\n */\r\nexport interface CommentListResponse {\r\n  comments: IncidentComment[];\r\n  pagination?: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n}\r\n\r\n// =====================\r\n// UTILITY TYPES\r\n// =====================\r\n\r\n/**\r\n * Type guard for checking if value is valid IncidentType\r\n */\r\nexport function isIncidentType(value: string): value is IncidentType {\r\n  return Object.values(IncidentType).includes(value as IncidentType);\r\n}\r\n\r\n/**\r\n * Type guard for checking if value is valid IncidentSeverity\r\n */\r\nexport function isIncidentSeverity(value: string): value is IncidentSeverity {\r\n  return Object.values(IncidentSeverity).includes(value as IncidentSeverity);\r\n}\r\n\r\n/**\r\n * Type guard for checking if value is valid WitnessType\r\n */\r\nexport function isWitnessType(value: string): value is WitnessType {\r\n  return Object.values(WitnessType).includes(value as WitnessType);\r\n}\r\n\r\n/**\r\n * Type guard for checking if value is valid ActionStatus\r\n */\r\nexport function isActionStatus(value: string): value is ActionStatus {\r\n  return Object.values(ActionStatus).includes(value as ActionStatus);\r\n}\r\n\r\n/**\r\n * Helper function to get human-readable incident type label\r\n */\r\nexport function getIncidentTypeLabel(type: IncidentType): string {\r\n  const labels: Record<IncidentType, string> = {\r\n    [IncidentType.INJURY]: 'Injury',\r\n    [IncidentType.ILLNESS]: 'Illness',\r\n    [IncidentType.BEHAVIORAL]: 'Behavioral',\r\n    [IncidentType.MEDICATION_ERROR]: 'Medication Error',\r\n    [IncidentType.ALLERGIC_REACTION]: 'Allergic Reaction',\r\n    [IncidentType.EMERGENCY]: 'Emergency',\r\n    [IncidentType.OTHER]: 'Other',\r\n  };\r\n  return labels[type] || type;\r\n}\r\n\r\n/**\r\n * Helper function to get human-readable severity label\r\n */\r\nexport function getIncidentSeverityLabel(severity: IncidentSeverity): string {\r\n  const labels: Record<IncidentSeverity, string> = {\r\n    [IncidentSeverity.LOW]: 'Low',\r\n    [IncidentSeverity.MEDIUM]: 'Medium',\r\n    [IncidentSeverity.HIGH]: 'High',\r\n    [IncidentSeverity.CRITICAL]: 'Critical',\r\n  };\r\n  return labels[severity] || severity;\r\n}\r\n\r\n/**\r\n * Helper function to get severity color class for UI\r\n */\r\nexport function getIncidentSeverityColor(severity: IncidentSeverity): string {\r\n  const colors: Record<IncidentSeverity, string> = {\r\n    [IncidentSeverity.LOW]: 'text-green-600 bg-green-100',\r\n    [IncidentSeverity.MEDIUM]: 'text-yellow-600 bg-yellow-100',\r\n    [IncidentSeverity.HIGH]: 'text-orange-600 bg-orange-100',\r\n    [IncidentSeverity.CRITICAL]: 'text-red-600 bg-red-100',\r\n  };\r\n  return colors[severity] || 'text-gray-600 bg-gray-100';\r\n}\r\n\r\n/**\r\n * Helper function to get action priority color class for UI\r\n */\r\nexport function getActionPriorityColor(priority: ActionPriority): string {\r\n  const colors: Record<ActionPriority, string> = {\r\n    [ActionPriority.LOW]: 'text-blue-600 bg-blue-100',\r\n    [ActionPriority.MEDIUM]: 'text-yellow-600 bg-yellow-100',\r\n    [ActionPriority.HIGH]: 'text-orange-600 bg-orange-100',\r\n    [ActionPriority.URGENT]: 'text-red-600 bg-red-100',\r\n  };\r\n  return colors[priority] || 'text-gray-600 bg-gray-100';\r\n}\r\n\r\n/**\r\n * Helper function to get action status color class for UI\r\n */\r\nexport function getActionStatusColor(status: ActionStatus): string {\r\n  const colors: Record<ActionStatus, string> = {\r\n    [ActionStatus.PENDING]: 'text-gray-600 bg-gray-100',\r\n    [ActionStatus.IN_PROGRESS]: 'text-blue-600 bg-blue-100',\r\n    [ActionStatus.COMPLETED]: 'text-green-600 bg-green-100',\r\n    [ActionStatus.CANCELLED]: 'text-red-600 bg-red-100',\r\n  };\r\n  return colors[status] || 'text-gray-600 bg-gray-100';\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;CAUC,GAED;;;;CAIC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBM,IAAA,AAAK,sCAAA;;;;;;;;WAAA;;AAcL,IAAA,AAAK,0CAAA;;;;;WAAA;;AAWL,IAAA,AAAK,wCAAA;;;;;WAAA;;AAWL,IAAA,AAAK,qCAAA;;;;;WAAA;;AAWL,IAAA,AAAK,wCAAA;;;;;WAAA;;AAWL,IAAA,AAAK,sCAAA;;;;;WAAA;;AAWL,IAAA,AAAK,8CAAA;;;;;;;WAAA;;AAaL,IAAA,AAAK,0CAAA;;;;;WAAA;;AAWL,IAAA,AAAK,kDAAA;;;;;;WAAA;;AAYL,IAAA,AAAK,sCAAA;;;;;WAAA;;AAylBL,SAAS,eAAe,KAAa;IAC1C,OAAO,OAAO,MAAM,CAAC,cAAc,QAAQ,CAAC;AAC9C;AAKO,SAAS,mBAAmB,KAAa;IAC9C,OAAO,OAAO,MAAM,CAAC,kBAAkB,QAAQ,CAAC;AAClD;AAKO,SAAS,cAAc,KAAa;IACzC,OAAO,OAAO,MAAM,CAAC,aAAa,QAAQ,CAAC;AAC7C;AAKO,SAAS,eAAe,KAAa;IAC1C,OAAO,OAAO,MAAM,CAAC,cAAc,QAAQ,CAAC;AAC9C;AAKO,SAAS,qBAAqB,IAAkB;IACrD,MAAM,SAAuC;QAC3C,UAAqB,EAAE;QACvB,WAAsB,EAAE;QACxB,cAAyB,EAAE;QAC3B,oBAA+B,EAAE;QACjC,qBAAgC,EAAE;QAClC,aAAwB,EAAE;QAC1B,SAAoB,EAAE;IACxB;IACA,OAAO,MAAM,CAAC,KAAK,IAAI;AACzB;AAKO,SAAS,yBAAyB,QAA0B;IACjE,MAAM,SAA2C;QAC/C,OAAsB,EAAE;QACxB,UAAyB,EAAE;QAC3B,QAAuB,EAAE;QACzB,YAA2B,EAAE;IAC/B;IACA,OAAO,MAAM,CAAC,SAAS,IAAI;AAC7B;AAKO,SAAS,yBAAyB,QAA0B;IACjE,MAAM,SAA2C;QAC/C,OAAsB,EAAE;QACxB,UAAyB,EAAE;QAC3B,QAAuB,EAAE;QACzB,YAA2B,EAAE;IAC/B;IACA,OAAO,MAAM,CAAC,SAAS,IAAI;AAC7B;AAKO,SAAS,uBAAuB,QAAwB;IAC7D,MAAM,SAAyC;QAC7C,OAAoB,EAAE;QACtB,UAAuB,EAAE;QACzB,QAAqB,EAAE;QACvB,UAAuB,EAAE;IAC3B;IACA,OAAO,MAAM,CAAC,SAAS,IAAI;AAC7B;AAKO,SAAS,qBAAqB,MAAoB;IACvD,MAAM,SAAuC;QAC3C,WAAsB,EAAE;QACxB,eAA0B,EAAE;QAC5B,aAAwB,EAAE;QAC1B,aAAwB,EAAE;IAC5B;IACA,OAAO,MAAM,CAAC,OAAO,IAAI;AAC3B","debugId":null}},
    {"offset": {"line": 10361, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/incidentReportsSlice.ts"],"sourcesContent":["/**\r\n * WF-COMP-311 | incidentReportsSlice.ts - Incident Reports Redux Slice\r\n * Purpose: Production-grade state management for comprehensive incident reporting system\r\n * Upstream: ../../services/modules/incidentsApi | Dependencies: @reduxjs/toolkit, react-hot-toast\r\n * Downstream: Incident report components, emergency notification system\r\n * Related: communicationSlice (notifications), complianceSlice (audit trails), studentsSlice\r\n * Exports: Reducer, actions, thunks, selectors | Key Features: Witness statements, follow-up tracking\r\n * Last Updated: 2025-10-26 | File Type: .ts\r\n * Critical Path: Incident creation â†’ Witness collection â†’ Follow-up actions â†’ Resolution â†’ Compliance reporting\r\n * LLM Context: Redux slice for incident management with HIPAA-compliant audit trails\r\n */\r\n\r\n/**\r\n * @module pages/incidents/store/incidentReportsSlice\r\n *\r\n * @description\r\n * Production-grade Redux state management for the comprehensive incident reporting system.\r\n * Manages incidents, witness statements, and follow-up actions with complete CRUD operations,\r\n * advanced filtering capabilities, and real-time notification integration.\r\n *\r\n * ## Architecture\r\n *\r\n * This slice follows a domain-driven design pattern with:\r\n * - Normalized state structure for efficient updates\r\n * - Granular loading states for each operation type\r\n * - Comprehensive error handling with user-friendly messages\r\n * - Optimistic UI updates for better user experience\r\n * - Cache invalidation and refresh logic\r\n * - Pagination support for large datasets\r\n *\r\n * ## State Structure\r\n *\r\n * The state is organized into logical sections:\r\n * - **Data**: reports, selectedReport, witnessStatements, followUpActions, searchResults\r\n * - **Pagination**: page metadata for list views\r\n * - **Filters**: active filter criteria for queries\r\n * - **UI State**: sorting, view modes (list/grid/detail)\r\n * - **Loading States**: operation-specific flags (list, detail, witnesses, actions, creating, updating, deleting, searching)\r\n * - **Error States**: operation-specific error messages\r\n * - **Cache Management**: timestamps and invalidation flags\r\n *\r\n * ## Key Features\r\n *\r\n * - **Complete CRUD Operations**: Create, read, update, delete incident reports\r\n * - **Witness Management**: Collect and manage witness statements with verification workflow\r\n * - **Follow-up Tracking**: Track action items with assignment, priority, and completion status\r\n * - **Advanced Filtering**: Filter by student, type, severity, status, date range\r\n * - **Full-text Search**: Search across descriptions, locations, actions taken, student names\r\n * - **Optimistic Updates**: Immediate UI feedback with rollback on error\r\n * - **Real-time Notifications**: Automatic parent notification for high/critical severity incidents\r\n *\r\n * @remarks\r\n * ## Incident Reporting Workflow\r\n *\r\n * 1. **Incident Creation**: Nurse documents incident with type, severity, description, location, actions taken\r\n * 2. **Automatic Notifications**: High/Critical severity triggers automatic parent/guardian notifications\r\n * 3. **Witness Collection**: Staff, students, parents can provide witness statements\r\n * 4. **Follow-up Actions**: Assign trackable action items with due dates and responsible parties\r\n * 5. **Status Tracking**: Monitor incident through lifecycle (OPEN â†’ UNDER_REVIEW â†’ RESOLVED â†’ CLOSED)\r\n * 6. **Compliance Reporting**: Generate audit trails for regulatory compliance\r\n *\r\n * ## Severity Levels and Notification Rules\r\n *\r\n * - **LOW**: Minor incidents, no automatic notification\r\n * - **MEDIUM**: Standard incidents, parent notification recommended\r\n * - **HIGH**: Serious incidents, automatic parent notification triggered\r\n * - **CRITICAL**: Emergency incidents, immediate multi-channel notification (SMS, email, voice)\r\n *\r\n * ## Witness Statement Verification\r\n *\r\n * - Statements collected from students, staff, parents, other witnesses\r\n * - Verification workflow tracks statement review and confirmation\r\n * - Digital signatures supported for statement authentication\r\n * - Statements immutable once verified (audit trail preservation)\r\n *\r\n * ## Follow-up Action Management\r\n *\r\n * - Actions assigned to specific staff members\r\n * - Priority levels: LOW, MEDIUM, HIGH, URGENT\r\n * - Due date tracking with overdue alerts\r\n * - Completion status with notes and outcomes\r\n * - Escalation rules for overdue actions\r\n *\r\n * ## HIPAA Compliance\r\n *\r\n * - All incident data treated as PHI (Protected Health Information)\r\n * - Audit logging for all data access and modifications\r\n * - Role-based access control enforced at API and UI levels\r\n * - Data retention policies comply with healthcare regulations\r\n * - Secure deletion (archival, not true deletion) for compliance\r\n *\r\n * ## Performance Considerations\r\n *\r\n * - Pagination reduces initial load time for large incident lists\r\n * - Selective loading of witness statements and follow-up actions (on-demand)\r\n * - Client-side sorting for small datasets, server-side for large datasets\r\n * - Cache invalidation triggers refetch only when necessary\r\n * - Optimistic updates minimize perceived latency\r\n *\r\n * @see {@link module:pages/communication/store/communicationSlice} for emergency notification integration\r\n * @see {@link module:pages/compliance/store/complianceSlice} for compliance reporting and audit trails\r\n * @see {@link module:pages/students/store/studentsSlice} for student data integration\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch incident reports with filters\r\n * dispatch(fetchIncidentReports({\r\n *   severity: [IncidentSeverity.HIGH, IncidentSeverity.CRITICAL],\r\n *   status: [IncidentStatus.UNDER_REVIEW],\r\n *   startDate: '2025-01-01',\r\n *   page: 1,\r\n *   limit: 20\r\n * }));\r\n *\r\n * // Create new incident with automatic notification\r\n * dispatch(createIncidentReport({\r\n *   studentId: 'student-123',\r\n *   type: IncidentType.INJURY,\r\n *   severity: IncidentSeverity.HIGH,  // Triggers automatic parent notification\r\n *   description: 'Student injured during recess',\r\n *   location: 'Playground',\r\n *   actionsTaken: 'First aid administered, ice pack applied',\r\n *   occurredAt: '2025-01-15T10:30:00Z'\r\n * }));\r\n *\r\n * // Add witness statement\r\n * dispatch(createWitnessStatement({\r\n *   incidentReportId: 'incident-456',\r\n *   witnessName: 'Teacher Jane Doe',\r\n *   witnessType: 'STAFF',\r\n *   statement: 'I witnessed the incident from the classroom window...',\r\n *   contactInfo: 'jane.doe@school.edu'\r\n * }));\r\n *\r\n * // Create follow-up action\r\n * dispatch(createFollowUpAction({\r\n *   incidentReportId: 'incident-456',\r\n *   description: 'Schedule parent meeting to discuss incident',\r\n *   assignedTo: 'user-789',\r\n *   priority: 'HIGH',\r\n *   dueDate: '2025-01-20T17:00:00Z'\r\n * }));\r\n *\r\n * // Access state in components\r\n * const reports = useSelector(selectIncidentReports);\r\n * const criticalIncidents = useSelector(selectCriticalIncidents);\r\n * const isLoading = useSelector(selectIsLoading('list'));\r\n * const statistics = useSelector(selectReportStatistics);\r\n * ```\r\n */\r\n\r\nimport { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\r\nimport { apiActions } from '@/lib/api';\r\nimport {\r\n  IncidentSeverity,\r\n  IncidentReport,\r\n  WitnessStatement,\r\n  FollowUpAction,\r\n  CreateIncidentReportRequest,\r\n  UpdateIncidentReportRequest,\r\n  IncidentReportFilters,\r\n  IncidentSearchParams,\r\n  IncidentType,\r\n  IncidentStatus,\r\n  CreateWitnessStatementRequest,\r\n  CreateFollowUpActionRequest,\r\n} from '@/types/domain/incidents';\r\nimport toast from 'react-hot-toast';\r\nimport debug from 'debug';\r\n\r\nconst log = debug('whitecross:incident-reports-slice');\r\n\r\n// =====================\r\n// STATE INTERFACE\r\n// =====================\r\n\r\n/**\r\n * Sort configuration for incident reports list.\r\n *\r\n * Defines the sorting column and order for incident report displays.\r\n * Supports sorting by occurrence time, severity, type, status, and report time.\r\n *\r\n * @interface SortConfig\r\n *\r\n * @property {('occurredAt'|'severity'|'type'|'status'|'reportedAt')} column - Column to sort by\r\n * @property {('asc'|'desc')} order - Sort direction (ascending or descending)\r\n *\r\n * @example\r\n * ```typescript\r\n * const sortConfig: SortConfig = {\r\n *   column: 'occurredAt',\r\n *   order: 'desc'  // Most recent first\r\n * };\r\n * ```\r\n */\r\nexport interface SortConfig {\r\n  column: 'occurredAt' | 'severity' | 'type' | 'status' | 'reportedAt';\r\n  order: 'asc' | 'desc';\r\n}\r\n\r\n/**\r\n * View mode for incident reports display.\r\n *\r\n * Determines how incidents are rendered in the UI:\r\n * - **list**: Compact list view with essential information\r\n * - **grid**: Card-based grid layout with thumbnails\r\n * - **detail**: Full detail view for single incident\r\n *\r\n * @typedef {('list'|'grid'|'detail')} ViewMode\r\n */\r\nexport type ViewMode = 'list' | 'grid' | 'detail';\r\n\r\n/**\r\n * Pagination metadata for incident reports.\r\n *\r\n * Tracks pagination state for list views with page number, items per page,\r\n * total item count, and total page count.\r\n *\r\n * @interface PaginationMeta\r\n *\r\n * @property {number} page - Current page number (1-indexed)\r\n * @property {number} limit - Number of items per page\r\n * @property {number} total - Total number of items across all pages\r\n * @property {number} pages - Total number of pages\r\n *\r\n * @example\r\n * ```typescript\r\n * const pagination: PaginationMeta = {\r\n *   page: 1,\r\n *   limit: 20,\r\n *   total: 156,\r\n *   pages: 8\r\n * };\r\n * ```\r\n */\r\ninterface PaginationMeta {\r\n  page: number;\r\n  limit: number;\r\n  total: number;\r\n  pages: number;\r\n}\r\n\r\n/**\r\n * Loading states for different incident report operations.\r\n *\r\n * Provides granular loading flags for each async operation type,\r\n * enabling precise UI loading state management.\r\n *\r\n * @interface LoadingStates\r\n *\r\n * @property {boolean} list - Loading incident reports list\r\n * @property {boolean} detail - Loading single incident detail\r\n * @property {boolean} witnesses - Loading witness statements\r\n * @property {boolean} actions - Loading follow-up actions\r\n * @property {boolean} creating - Creating new incident report\r\n * @property {boolean} updating - Updating existing incident\r\n * @property {boolean} deleting - Deleting incident report\r\n * @property {boolean} searching - Searching incident reports\r\n *\r\n * @example\r\n * ```typescript\r\n * // Check if any operation is in progress\r\n * const isAnyLoading = Object.values(loading).some(v => v);\r\n * ```\r\n */\r\ninterface LoadingStates {\r\n  list: boolean;\r\n  detail: boolean;\r\n  witnesses: boolean;\r\n  actions: boolean;\r\n  creating: boolean;\r\n  updating: boolean;\r\n  deleting: boolean;\r\n  searching: boolean;\r\n}\r\n\r\n/**\r\n * Error states for different incident report operations.\r\n *\r\n * Stores operation-specific error messages for granular error handling\r\n * and user-friendly error display.\r\n *\r\n * @interface ErrorStates\r\n *\r\n * @property {string|null} list - Error fetching incident list\r\n * @property {string|null} detail - Error fetching incident detail\r\n * @property {string|null} witnesses - Error fetching witness statements\r\n * @property {string|null} actions - Error fetching follow-up actions\r\n * @property {string|null} create - Error creating incident\r\n * @property {string|null} update - Error updating incident\r\n * @property {string|null} delete - Error deleting incident\r\n * @property {string|null} search - Error searching incidents\r\n *\r\n * @example\r\n * ```typescript\r\n * // Display error for specific operation\r\n * if (errors.create) {\r\n *   toast.error(errors.create);\r\n * }\r\n * ```\r\n */\r\ninterface ErrorStates {\r\n  list: string | null;\r\n  detail: string | null;\r\n  witnesses: string | null;\r\n  actions: string | null;\r\n  create: string | null;\r\n  update: string | null;\r\n  delete: string | null;\r\n  search: string | null;\r\n}\r\n\r\n/**\r\n * Main state interface for incident reports Redux slice.\r\n *\r\n * Comprehensive state structure managing all aspects of incident reporting\r\n * including data, pagination, filters, UI state, loading/error states,\r\n * and cache management.\r\n *\r\n * @interface IncidentReportsState\r\n *\r\n * @property {IncidentReport[]} reports - Array of incident report entities\r\n * @property {IncidentReport|null} selectedReport - Currently viewed incident (detail view)\r\n * @property {WitnessStatement[]} witnessStatements - Statements for selected incident\r\n * @property {FollowUpAction[]} followUpActions - Actions for selected incident\r\n * @property {IncidentReport[]} searchResults - Search query results\r\n * @property {PaginationMeta} pagination - Page metadata for list views\r\n * @property {IncidentReportFilters} filters - Active filter criteria\r\n * @property {string} searchQuery - Current search query text\r\n * @property {SortConfig} sortConfig - Current sort configuration\r\n * @property {ViewMode} viewMode - Current view mode (list/grid/detail)\r\n * @property {LoadingStates} loading - Operation-specific loading flags\r\n * @property {ErrorStates} errors - Operation-specific error messages\r\n * @property {number|null} lastFetched - Timestamp of last successful fetch\r\n * @property {boolean} cacheInvalidated - Flag indicating cache needs refresh\r\n *\r\n * @see {@link LoadingStates} for loading state structure\r\n * @see {@link ErrorStates} for error state structure\r\n * @see {@link PaginationMeta} for pagination structure\r\n * @see {@link SortConfig} for sort configuration\r\n */\r\ninterface IncidentReportsState {\r\n  // Data\r\n  reports: IncidentReport[];\r\n  selectedReport: IncidentReport | null;\r\n  witnessStatements: WitnessStatement[];\r\n  followUpActions: FollowUpAction[];\r\n  searchResults: IncidentReport[];\r\n\r\n  // Pagination\r\n  pagination: PaginationMeta;\r\n\r\n  // Filters\r\n  filters: IncidentReportFilters;\r\n  searchQuery: string;\r\n\r\n  // UI State\r\n  sortConfig: SortConfig;\r\n  viewMode: ViewMode;\r\n\r\n  // Loading States\r\n  loading: LoadingStates;\r\n\r\n  // Error States\r\n  errors: ErrorStates;\r\n\r\n  // Cache Management\r\n  lastFetched: number | null;\r\n  cacheInvalidated: boolean;\r\n}\r\n\r\n// =====================\r\n// INITIAL STATE\r\n// =====================\r\n\r\n/**\r\n * Initial state for incident reports slice.\r\n *\r\n * Provides sensible defaults for all state properties with empty data arrays,\r\n * default pagination (20 items per page), descending sort by occurrence time,\r\n * and list view mode.\r\n *\r\n * @const {IncidentReportsState} initialState\r\n */\r\nconst initialState: IncidentReportsState = {\r\n  // Data\r\n  reports: [],\r\n  selectedReport: null,\r\n  witnessStatements: [],\r\n  followUpActions: [],\r\n  searchResults: [],\r\n\r\n  // Pagination\r\n  pagination: {\r\n    page: 1,\r\n    limit: 20,\r\n    total: 0,\r\n    pages: 0,\r\n  },\r\n\r\n  // Filters\r\n  filters: {\r\n    page: 1,\r\n    limit: 20,\r\n  },\r\n  searchQuery: '',\r\n\r\n  // UI State\r\n  sortConfig: {\r\n    column: 'occurredAt',\r\n    order: 'desc',\r\n  },\r\n  viewMode: 'list',\r\n\r\n  // Loading States\r\n  loading: {\r\n    list: false,\r\n    detail: false,\r\n    witnesses: false,\r\n    actions: false,\r\n    creating: false,\r\n    updating: false,\r\n    deleting: false,\r\n    searching: false,\r\n  },\r\n\r\n  // Error States\r\n  errors: {\r\n    list: null,\r\n    detail: null,\r\n    witnesses: null,\r\n    actions: null,\r\n    create: null,\r\n    update: null,\r\n    delete: null,\r\n    search: null,\r\n  },\r\n\r\n  // Cache Management\r\n  lastFetched: null,\r\n  cacheInvalidated: false,\r\n};\r\n\r\n// =====================\r\n// ASYNC THUNKS\r\n// =====================\r\n\r\n/**\r\n * Fetch incident reports with pagination and filters.\r\n *\r\n * Retrieves paginated list of incident reports with optional filtering by student,\r\n * type, severity, status, and date range. Supports server-side pagination and sorting.\r\n *\r\n * @async\r\n * @function fetchIncidentReports\r\n *\r\n * @param {IncidentReportFilters} [filters] - Optional filter criteria\r\n * @param {string} [filters.studentId] - Filter by specific student\r\n * @param {IncidentType[]} [filters.types] - Filter by incident types\r\n * @param {IncidentSeverity[]} [filters.severity] - Filter by severity levels\r\n * @param {IncidentStatus[]} [filters.status] - Filter by status values\r\n * @param {string} [filters.startDate] - Filter by start date (ISO 8601)\r\n * @param {string} [filters.endDate] - Filter by end date (ISO 8601)\r\n * @param {number} [filters.page=1] - Page number\r\n * @param {number} [filters.limit=20] - Items per page\r\n *\r\n * @returns {Promise<{reports: IncidentReport[], pagination: PaginationMeta}>} Paginated incident reports\r\n *\r\n * @throws {Error} When API request fails or user lacks permissions\r\n *\r\n * @example\r\n * ```typescript\r\n * // Fetch recent high-severity incidents\r\n * dispatch(fetchIncidentReports({\r\n *   severity: [IncidentSeverity.HIGH, IncidentSeverity.CRITICAL],\r\n *   startDate: '2025-01-01',\r\n *   page: 1,\r\n *   limit: 20\r\n * }));\r\n * ```\r\n */\r\nexport const fetchIncidentReports = createAsyncThunk(\r\n  'incidentReports/fetchIncidentReports',\r\n  async (filters: IncidentReportFilters | undefined, { rejectWithValue }) => {\r\n    try {\r\n      log('Fetching incident reports with filters:', filters);\r\n      const response = await apiActions.incidents.getAll(filters);\r\n      return response;\r\n    } catch (error: any) {\r\n      log('Error fetching incident reports:', error);\r\n      return rejectWithValue(error.message || 'Failed to fetch incident reports');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Fetch single incident report by ID.\r\n *\r\n * Retrieves complete incident report with all associations including student data,\r\n * reporter information, witness statements, and follow-up actions.\r\n *\r\n * @async\r\n * @function fetchIncidentReportById\r\n *\r\n * @param {string} id - Incident report unique identifier\r\n *\r\n * @returns {Promise<IncidentReport>} Complete incident report with associations\r\n *\r\n * @throws {Error} When incident not found or user lacks permissions\r\n *\r\n * @remarks\r\n * This operation performs eager loading of related data. For performance,\r\n * witness statements and follow-up actions can be loaded separately using\r\n * `fetchWitnessStatements` and `fetchFollowUpActions` if needed.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Load incident detail for editing\r\n * dispatch(fetchIncidentReportById('incident-123'));\r\n * ```\r\n */\r\nexport const fetchIncidentReportById = createAsyncThunk(\r\n  'incidentReports/fetchIncidentReportById',\r\n  async (id: string, { rejectWithValue }) => {\r\n    try {\r\n      log('Fetching incident report by ID:', id);\r\n      const response = await apiActions.incidents.getById(id);\r\n      return response.report;\r\n    } catch (error: any) {\r\n      log('Error fetching incident report:', error);\r\n      return rejectWithValue(error.message || 'Failed to fetch incident report');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Create new incident report.\r\n *\r\n * Creates incident report with automatic parent notification for high/critical severity.\r\n * Implements optimistic UI updates for immediate feedback. Validates required fields\r\n * and enforces business rules before submission.\r\n *\r\n * @async\r\n * @function createIncidentReport\r\n *\r\n * @param {CreateIncidentReportRequest} data - Incident report data\r\n * @param {string} data.studentId - Student unique identifier\r\n * @param {IncidentType} data.type - Incident type (INJURY, ILLNESS, BEHAVIORAL, etc.)\r\n * @param {IncidentSeverity} data.severity - Severity level (LOW, MEDIUM, HIGH, CRITICAL)\r\n * @param {string} data.description - Detailed incident description\r\n * @param {string} [data.location] - Incident location\r\n * @param {string} [data.actionsTaken] - Actions taken by staff\r\n * @param {string} data.occurredAt - Incident occurrence timestamp (ISO 8601)\r\n * @param {boolean} [data.parentNotified=false] - Whether parent was notified\r\n * @param {boolean} [data.followUpRequired=false] - Whether follow-up is needed\r\n *\r\n * @returns {Promise<IncidentReport>} Created incident report\r\n *\r\n * @throws {Error} When validation fails or API request fails\r\n *\r\n * @remarks\r\n * ## Automatic Notifications\r\n *\r\n * - **HIGH severity**: Triggers automatic parent/guardian email notification\r\n * - **CRITICAL severity**: Triggers multi-channel notification (email + SMS + voice call)\r\n *\r\n * ## Audit Trail\r\n *\r\n * All incident creations are logged in the compliance audit system with:\r\n * - User who created the report\r\n * - Creation timestamp\r\n * - IP address and session information\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create injury incident with automatic notification\r\n * dispatch(createIncidentReport({\r\n *   studentId: 'student-123',\r\n *   type: IncidentType.INJURY,\r\n *   severity: IncidentSeverity.HIGH,\r\n *   description: 'Student fell on playground, scraped knee',\r\n *   location: 'Playground - Swing Set Area',\r\n *   actionsTaken: 'First aid administered, ice pack applied, bandage applied',\r\n *   occurredAt: new Date().toISOString(),\r\n *   parentNotified: false,  // Will be set to true after automatic notification\r\n *   followUpRequired: true\r\n * }));\r\n * ```\r\n */\r\nexport const createIncidentReport = createAsyncThunk(\r\n  'incidentReports/createIncidentReport',\r\n  async (data: CreateIncidentReportRequest, { rejectWithValue }) => {\r\n    try {\r\n      log('Creating incident report:', data);\r\n      const response = await apiActions.incidents.create(data);\r\n      toast.success('Incident report created successfully');\r\n      return response.report;\r\n    } catch (error: any) {\r\n      log('Error creating incident report:', error);\r\n      toast.error(error.message || 'Failed to create incident report');\r\n      return rejectWithValue(error.message || 'Failed to create incident report');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Update existing incident report.\r\n *\r\n * Updates incident report with partial data. Supports optimistic UI updates\r\n * for immediate feedback. Validates permissions and business rules before update.\r\n *\r\n * @async\r\n * @function updateIncidentReport\r\n *\r\n * @param {Object} params - Update parameters\r\n * @param {string} params.id - Incident report unique identifier\r\n * @param {UpdateIncidentReportRequest} params.data - Partial update data\r\n *\r\n * @returns {Promise<IncidentReport>} Updated incident report\r\n *\r\n * @throws {Error} When incident not found, validation fails, or user lacks permissions\r\n *\r\n * @remarks\r\n * Updates are subject to RBAC (Role-Based Access Control):\r\n * - Only the original reporter or administrators can update incidents\r\n * - Certain fields (e.g., student ID) cannot be modified after creation\r\n * - All updates are logged in the audit trail\r\n *\r\n * @example\r\n * ```typescript\r\n * // Update incident status and add resolution notes\r\n * dispatch(updateIncidentReport({\r\n *   id: 'incident-123',\r\n *   data: {\r\n *     status: IncidentStatus.RESOLVED,\r\n *     resolutionNotes: 'Parent contacted, follow-up scheduled',\r\n *     parentNotified: true\r\n *   }\r\n * }));\r\n * ```\r\n */\r\nexport const updateIncidentReport = createAsyncThunk(\r\n  'incidentReports/updateIncidentReport',\r\n  async (\r\n    { id, data }: { id: string; data: UpdateIncidentReportRequest },\r\n    { rejectWithValue }\r\n  ) => {\r\n    try {\r\n      log('Updating incident report:', id, data);\r\n      const response = await apiActions.incidents.update(id, data);\r\n      toast.success('Incident report updated successfully');\r\n      return response.report;\r\n    } catch (error: any) {\r\n      log('Error updating incident report:', error);\r\n      toast.error(error.message || 'Failed to update incident report');\r\n      return rejectWithValue(error.message || 'Failed to update incident report');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Delete incident report.\r\n *\r\n * Soft-deletes incident report for HIPAA compliance (archival rather than true deletion).\r\n * Requires administrator permissions. All related data (witness statements,\r\n * follow-up actions) are also archived.\r\n *\r\n * @async\r\n * @function deleteIncidentReport\r\n *\r\n * @param {string} id - Incident report unique identifier\r\n *\r\n * @returns {Promise<string>} Deleted incident ID\r\n *\r\n * @throws {Error} When incident not found or user lacks permissions\r\n *\r\n * @remarks\r\n * ## HIPAA Compliance Note\r\n *\r\n * This operation performs a soft delete (sets isActive=false) rather than\r\n * physically removing the record. This ensures:\r\n * - Audit trail preservation\r\n * - Data recovery capability if needed\r\n * - Compliance with healthcare data retention regulations\r\n *\r\n * Use with caution - consider changing status to CLOSED instead of deleting.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Archive incident report (soft delete)\r\n * dispatch(deleteIncidentReport('incident-123'));\r\n * ```\r\n */\r\nexport const deleteIncidentReport = createAsyncThunk(\r\n  'incidentReports/deleteIncidentReport',\r\n  async (id: string, { rejectWithValue }) => {\r\n    try {\r\n      log('Deleting incident report:', id);\r\n      await apiActions.incidents.delete(id);\r\n      toast.success('Incident report deleted successfully');\r\n      return id;\r\n    } catch (error: any) {\r\n      log('Error deleting incident report:', error);\r\n      toast.error(error.message || 'Failed to delete incident report');\r\n      return rejectWithValue(error.message || 'Failed to delete incident report');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Search incident reports.\r\n *\r\n * Performs full-text search across incident descriptions, locations, actions taken,\r\n * and student names. Supports pagination and returns ranked results by relevance.\r\n *\r\n * @async\r\n * @function searchIncidentReports\r\n *\r\n * @param {IncidentSearchParams} params - Search parameters\r\n * @param {string} params.query - Search query text\r\n * @param {number} [params.page=1] - Page number\r\n * @param {number} [params.limit=20] - Items per page\r\n * @param {string[]} [params.types] - Filter by incident types\r\n * @param {string[]} [params.severity] - Filter by severity levels\r\n *\r\n * @returns {Promise<{reports: IncidentReport[], pagination: PaginationMeta}>} Search results\r\n *\r\n * @throws {Error} When search fails or query is invalid\r\n *\r\n * @remarks\r\n * Search is performed server-side with full-text indexing for performance.\r\n * Results are ranked by relevance and filtered by user permissions.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Search for playground injuries\r\n * dispatch(searchIncidentReports({\r\n *   query: 'playground injury',\r\n *   types: [IncidentType.INJURY],\r\n *   page: 1,\r\n *   limit: 10\r\n * }));\r\n * ```\r\n */\r\nexport const searchIncidentReports = createAsyncThunk(\r\n  'incidentReports/searchIncidentReports',\r\n  async (params: IncidentSearchParams, { rejectWithValue }) => {\r\n    try {\r\n      log('Searching incident reports:', params);\r\n      const response = await apiActions.incidents.search(params);\r\n      return response;\r\n    } catch (error: any) {\r\n      log('Error searching incident reports:', error);\r\n      return rejectWithValue(error.message || 'Failed to search incident reports');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Fetch witness statements for incident.\r\n *\r\n * Retrieves all witness statements associated with the specified incident report.\r\n * Includes statement content, witness information, timestamps, and verification status.\r\n *\r\n * @async\r\n * @function fetchWitnessStatements\r\n *\r\n * @param {string} incidentReportId - Incident report unique identifier\r\n *\r\n * @returns {Promise<WitnessStatement[]>} Array of witness statements\r\n *\r\n * @throws {Error} When incident not found or user lacks permissions\r\n *\r\n * @remarks\r\n * Witness statements are immutable once marked as verified. This ensures\r\n * audit trail integrity and prevents tampering with evidence.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Load witness statements for incident detail view\r\n * dispatch(fetchWitnessStatements('incident-123'));\r\n * ```\r\n */\r\nexport const fetchWitnessStatements = createAsyncThunk(\r\n  'incidentReports/fetchWitnessStatements',\r\n  async (incidentReportId: string, { rejectWithValue }) => {\r\n    try {\r\n      log('Fetching witness statements for incident:', incidentReportId);\r\n      const response = await apiActions.incidents.getWitnessStatements(incidentReportId);\r\n      return response.statements;\r\n    } catch (error: any) {\r\n      log('Error fetching witness statements:', error);\r\n      return rejectWithValue(error.message || 'Failed to fetch witness statements');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Create witness statement.\r\n *\r\n * Records statement from student, staff member, parent, or other witness.\r\n * Captures statement content, witness information, and contact details.\r\n *\r\n * @async\r\n * @function createWitnessStatement\r\n *\r\n * @param {CreateWitnessStatementRequest} data - Witness statement data\r\n * @param {string} data.incidentReportId - Related incident ID\r\n * @param {string} data.witnessName - Name of witness providing statement\r\n * @param {('STUDENT'|'STAFF'|'PARENT'|'OTHER')} data.witnessType - Type of witness\r\n * @param {string} data.statement - Statement content\r\n * @param {string} [data.contactInfo] - Witness contact information\r\n *\r\n * @returns {Promise<WitnessStatement>} Created witness statement\r\n *\r\n * @throws {Error} When validation fails or API request fails\r\n *\r\n * @remarks\r\n * ## Verification Workflow\r\n *\r\n * 1. Statement is created in PENDING status\r\n * 2. Administrator reviews statement for completeness\r\n * 3. Administrator marks statement as VERIFIED\r\n * 4. Verified statements become immutable (audit trail preservation)\r\n *\r\n * ## Digital Signatures\r\n *\r\n * For legal compliance, witness statements can include digital signatures.\r\n * This provides non-repudiation and authenticity verification.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Add teacher witness statement\r\n * dispatch(createWitnessStatement({\r\n *   incidentReportId: 'incident-123',\r\n *   witnessName: 'Jane Doe',\r\n *   witnessType: 'STAFF',\r\n *   statement: 'I observed the student fall from the swing...',\r\n *   contactInfo: 'jane.doe@school.edu'\r\n * }));\r\n * ```\r\n */\r\nexport const createWitnessStatement = createAsyncThunk(\r\n  'incidentReports/createWitnessStatement',\r\n  async (data: CreateWitnessStatementRequest, { rejectWithValue }) => {\r\n    try {\r\n      log('Creating witness statement:', data);\r\n      const response = await apiActions.incidents.addWitnessStatement(data);\r\n      toast.success('Witness statement added successfully');\r\n      return response.statement;\r\n    } catch (error: any) {\r\n      log('Error creating witness statement:', error);\r\n      toast.error(error.message || 'Failed to add witness statement');\r\n      return rejectWithValue(error.message || 'Failed to add witness statement');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Fetch follow-up actions for incident.\r\n *\r\n * Retrieves all follow-up actions associated with the specified incident report.\r\n * Includes action descriptions, assignments, priorities, due dates, and completion status.\r\n *\r\n * @async\r\n * @function fetchFollowUpActions\r\n *\r\n * @param {string} incidentReportId - Incident report unique identifier\r\n *\r\n * @returns {Promise<FollowUpAction[]>} Array of follow-up actions\r\n *\r\n * @throws {Error} When incident not found or user lacks permissions\r\n *\r\n * @remarks\r\n * Follow-up actions support assignment tracking and automated escalation\r\n * for overdue items. Completion status is tracked with notes and outcomes.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Load follow-up actions for incident detail view\r\n * dispatch(fetchFollowUpActions('incident-123'));\r\n * ```\r\n */\r\nexport const fetchFollowUpActions = createAsyncThunk(\r\n  'incidentReports/fetchFollowUpActions',\r\n  async (incidentReportId: string, { rejectWithValue }) => {\r\n    try {\r\n      log('Fetching follow-up actions for incident:', incidentReportId);\r\n      const response = await apiActions.incidents.getFollowUpActions(incidentReportId);\r\n      return response.actions;\r\n    } catch (error: any) {\r\n      log('Error fetching follow-up actions:', error);\r\n      return rejectWithValue(error.message || 'Failed to fetch follow-up actions');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Create follow-up action.\r\n *\r\n * Creates trackable action item with assignment, priority, and due date.\r\n * Actions can be assigned to staff members with automatic notification.\r\n *\r\n * @async\r\n * @function createFollowUpAction\r\n *\r\n * @param {CreateFollowUpActionRequest} data - Follow-up action data\r\n * @param {string} data.incidentReportId - Related incident ID\r\n * @param {string} data.description - Action description\r\n * @param {string} [data.assignedTo] - User ID of assigned staff member\r\n * @param {('LOW'|'MEDIUM'|'HIGH'|'URGENT')} data.priority - Action priority\r\n * @param {string} [data.dueDate] - Due date (ISO 8601)\r\n *\r\n * @returns {Promise<FollowUpAction>} Created follow-up action\r\n *\r\n * @throws {Error} When validation fails or API request fails\r\n *\r\n * @remarks\r\n * ## Assignment Notification\r\n *\r\n * When an action is assigned to a staff member, they receive:\r\n * - Email notification with action details\r\n * - In-app notification\r\n * - Calendar event (if due date specified)\r\n *\r\n * ## Escalation Rules\r\n *\r\n * Overdue actions trigger automatic escalation:\r\n * - 1 day overdue: Reminder to assignee\r\n * - 3 days overdue: Notification to supervisor\r\n * - 7 days overdue: Notification to administrator\r\n *\r\n * @example\r\n * ```typescript\r\n * // Create urgent follow-up action with assignment\r\n * dispatch(createFollowUpAction({\r\n *   incidentReportId: 'incident-123',\r\n *   description: 'Schedule parent meeting to discuss incident',\r\n *   assignedTo: 'user-789',\r\n *   priority: 'URGENT',\r\n *   dueDate: '2025-01-20T17:00:00Z'\r\n * }));\r\n * ```\r\n */\r\nexport const createFollowUpAction = createAsyncThunk(\r\n  'incidentReports/createFollowUpAction',\r\n  async (data: CreateFollowUpActionRequest, { rejectWithValue }) => {\r\n    try {\r\n      log('Creating follow-up action:', data);\r\n      const response = await apiActions.incidents.addFollowUpAction(data);\r\n      toast.success('Follow-up action created successfully');\r\n      return response.action;\r\n    } catch (error: any) {\r\n      log('Error creating follow-up action:', error);\r\n      toast.error(error.message || 'Failed to create follow-up action');\r\n      return rejectWithValue(error.message || 'Failed to create follow-up action');\r\n    }\r\n  }\r\n);\r\n\r\n// =====================\r\n// SLICE DEFINITION\r\n// =====================\r\n\r\nconst incidentReportsSlice = createSlice({\r\n  name: 'incidentReports',\r\n  initialState,\r\n  reducers: {\r\n    /**\r\n     * Set filters for incident reports list.\r\n     *\r\n     * Updates active filter criteria and triggers cache invalidation to refetch data.\r\n     * Filters are merged with existing filters, allowing partial updates.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<Partial<IncidentReportFilters>>} action - Filter updates\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(setFilters({\r\n     *   severity: [IncidentSeverity.HIGH, IncidentSeverity.CRITICAL],\r\n     *   startDate: '2025-01-01'\r\n     * }));\r\n     * ```\r\n     */\r\n    setFilters: (state, action: PayloadAction<Partial<IncidentReportFilters>>) => {\r\n      state.filters = {\r\n        ...state.filters,\r\n        ...action.payload,\r\n      };\r\n      state.cacheInvalidated = true;\r\n      log('Filters updated:', state.filters);\r\n    },\r\n\r\n    /**\r\n     * Set search query.\r\n     *\r\n     * Updates the search query text for full-text search across incident reports.\r\n     * Does not trigger automatic search - use with searchIncidentReports thunk.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<string>} action - Search query text\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(setSearchQuery('playground injury'));\r\n     * ```\r\n     */\r\n    setSearchQuery: (state, action: PayloadAction<string>) => {\r\n      state.searchQuery = action.payload;\r\n      log('Search query set:', action.payload);\r\n    },\r\n\r\n    /**\r\n     * Set selected incident report for detail view.\r\n     *\r\n     * Updates the currently selected incident, typically used when navigating\r\n     * to incident detail page or opening detail modal.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<IncidentReport>} action - Incident report to select\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(setSelectedIncidentReport(incident));\r\n     * ```\r\n     */\r\n    setSelectedIncidentReport: (state, action: PayloadAction<IncidentReport>) => {\r\n      state.selectedReport = action.payload;\r\n      log('Selected incident report set:', action.payload.id);\r\n    },\r\n\r\n    /**\r\n     * Clear selected incident report.\r\n     *\r\n     * Clears the currently selected incident and associated data (witness statements,\r\n     * follow-up actions). Used when navigating away from detail view.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(clearSelectedIncident());\r\n     * ```\r\n     */\r\n    clearSelectedIncident: (state) => {\r\n      state.selectedReport = null;\r\n      state.witnessStatements = [];\r\n      state.followUpActions = [];\r\n      state.errors.detail = null;\r\n      log('Selected incident cleared');\r\n    },\r\n\r\n    /**\r\n     * Set sort configuration.\r\n     *\r\n     * Updates sort column and order for list view. Triggers client-side re-sorting\r\n     * of loaded data.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<SortConfig>} action - Sort configuration\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(setSortOrder({\r\n     *   column: 'severity',\r\n     *   order: 'desc'  // Critical incidents first\r\n     * }));\r\n     * ```\r\n     */\r\n    setSortOrder: (state, action: PayloadAction<SortConfig>) => {\r\n      state.sortConfig = action.payload;\r\n      log('Sort order updated:', action.payload);\r\n    },\r\n\r\n    /**\r\n     * Set view mode.\r\n     *\r\n     * Switches between list, grid, and detail view modes for incident display.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<ViewMode>} action - View mode (list/grid/detail)\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(setViewMode('grid'));\r\n     * ```\r\n     */\r\n    setViewMode: (state, action: PayloadAction<ViewMode>) => {\r\n      state.viewMode = action.payload;\r\n      log('View mode changed:', action.payload);\r\n    },\r\n\r\n    /**\r\n     * Clear all errors.\r\n     *\r\n     * Resets all error states to null. Used for dismissing error messages\r\n     * or resetting error state on page navigation.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(clearErrors());\r\n     * ```\r\n     */\r\n    clearErrors: (state) => {\r\n      state.errors = initialState.errors;\r\n      log('All errors cleared');\r\n    },\r\n\r\n    /**\r\n     * Clear specific error.\r\n     *\r\n     * Resets a single error state to null. Used for dismissing individual\r\n     * error messages without clearing all errors.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<keyof ErrorStates>} action - Error key to clear\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(clearError('create'));\r\n     * ```\r\n     */\r\n    clearError: (state, action: PayloadAction<keyof ErrorStates>) => {\r\n      state.errors[action.payload] = null;\r\n      log('Error cleared:', action.payload);\r\n    },\r\n\r\n    /**\r\n     * Reset state to initial values.\r\n     *\r\n     * Resets entire slice state to initial values. Used when logging out\r\n     * or changing context (e.g., switching schools).\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(resetState());\r\n     * ```\r\n     */\r\n    resetState: (state) => {\r\n      Object.assign(state, initialState);\r\n      log('State reset to initial values');\r\n    },\r\n\r\n    /**\r\n     * Invalidate cache.\r\n     *\r\n     * Marks cache as invalidated, forcing refetch of data on next request.\r\n     * Used when external changes may have affected incident data.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * dispatch(invalidateCache());\r\n     * ```\r\n     */\r\n    invalidateCache: (state) => {\r\n      state.cacheInvalidated = true;\r\n      state.lastFetched = null;\r\n      log('Cache invalidated');\r\n    },\r\n\r\n    /**\r\n     * Optimistic update for incident report.\r\n     *\r\n     * Updates local state immediately before API confirmation for better UX.\r\n     * If API call fails, state should be rolled back or error shown.\r\n     *\r\n     * @param {IncidentReportsState} state - Current state\r\n     * @param {PayloadAction<{id: string, data: Partial<IncidentReport>}>} action - Update payload\r\n     *\r\n     * @remarks\r\n     * Use this for immediate UI feedback on user actions. Ensure proper\r\n     * error handling to rollback changes if API call fails.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * // Immediately update UI while API call is in progress\r\n     * dispatch(optimisticUpdateReport({\r\n     *   id: 'incident-123',\r\n     *   data: { status: IncidentStatus.RESOLVED }\r\n     * }));\r\n     * ```\r\n     */\r\n    optimisticUpdateReport: (\r\n      state,\r\n      action: PayloadAction<{ id: string; data: Partial<IncidentReport> }>\r\n    ) => {\r\n      const { id, data } = action.payload;\r\n      const index = state.reports.findIndex((report) => report.id === id);\r\n      if (index !== -1) {\r\n        state.reports[index] = { ...state.reports[index], ...data };\r\n      }\r\n      if (state.selectedReport?.id === id) {\r\n        state.selectedReport = { ...state.selectedReport, ...data };\r\n      }\r\n      log('Optimistic update applied:', id);\r\n    },\r\n  },\r\n\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // =====================\r\n      // FETCH INCIDENT REPORTS\r\n      // =====================\r\n      .addCase(fetchIncidentReports.pending, (state) => {\r\n        state.loading.list = true;\r\n        state.errors.list = null;\r\n      })\r\n      .addCase(fetchIncidentReports.fulfilled, (state, action) => {\r\n        state.reports = action.payload.reports;\r\n        state.pagination = action.payload.pagination;\r\n        state.loading.list = false;\r\n        state.errors.list = null;\r\n        state.lastFetched = Date.now();\r\n        state.cacheInvalidated = false;\r\n        log('Incident reports fetched successfully:', action.payload.reports.length);\r\n      })\r\n      .addCase(fetchIncidentReports.rejected, (state, action) => {\r\n        state.loading.list = false;\r\n        state.errors.list = action.payload as string;\r\n        log('Error fetching incident reports:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // FETCH INCIDENT REPORT BY ID\r\n      // =====================\r\n      .addCase(fetchIncidentReportById.pending, (state) => {\r\n        state.loading.detail = true;\r\n        state.errors.detail = null;\r\n      })\r\n      .addCase(fetchIncidentReportById.fulfilled, (state, action) => {\r\n        state.selectedReport = action.payload;\r\n        state.loading.detail = false;\r\n        state.errors.detail = null;\r\n        log('Incident report fetched by ID:', action.payload.id);\r\n      })\r\n      .addCase(fetchIncidentReportById.rejected, (state, action) => {\r\n        state.loading.detail = false;\r\n        state.errors.detail = action.payload as string;\r\n        log('Error fetching incident report by ID:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // CREATE INCIDENT REPORT\r\n      // =====================\r\n      .addCase(createIncidentReport.pending, (state) => {\r\n        state.loading.creating = true;\r\n        state.errors.create = null;\r\n      })\r\n      .addCase(createIncidentReport.fulfilled, (state, action) => {\r\n        // Add new report to the beginning of the list\r\n        state.reports.unshift(action.payload);\r\n        state.pagination.total += 1;\r\n        state.loading.creating = false;\r\n        state.errors.create = null;\r\n        state.cacheInvalidated = true;\r\n        log('Incident report created:', action.payload.id);\r\n      })\r\n      .addCase(createIncidentReport.rejected, (state, action) => {\r\n        state.loading.creating = false;\r\n        state.errors.create = action.payload as string;\r\n        log('Error creating incident report:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // UPDATE INCIDENT REPORT\r\n      // =====================\r\n      .addCase(updateIncidentReport.pending, (state) => {\r\n        state.loading.updating = true;\r\n        state.errors.update = null;\r\n      })\r\n      .addCase(updateIncidentReport.fulfilled, (state, action) => {\r\n        // Update report in list\r\n        const index = state.reports.findIndex((r) => r.id === action.payload.id);\r\n        if (index !== -1) {\r\n          state.reports[index] = action.payload;\r\n        }\r\n        // Update selected report if it's the same one\r\n        if (state.selectedReport?.id === action.payload.id) {\r\n          state.selectedReport = action.payload;\r\n        }\r\n        state.loading.updating = false;\r\n        state.errors.update = null;\r\n        state.cacheInvalidated = true;\r\n        log('Incident report updated:', action.payload.id);\r\n      })\r\n      .addCase(updateIncidentReport.rejected, (state, action) => {\r\n        state.loading.updating = false;\r\n        state.errors.update = action.payload as string;\r\n        log('Error updating incident report:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // DELETE INCIDENT REPORT\r\n      // =====================\r\n      .addCase(deleteIncidentReport.pending, (state) => {\r\n        state.loading.deleting = true;\r\n        state.errors.delete = null;\r\n      })\r\n      .addCase(deleteIncidentReport.fulfilled, (state, action) => {\r\n        // Remove report from list\r\n        state.reports = state.reports.filter((r) => r.id !== action.payload);\r\n        state.pagination.total -= 1;\r\n        // Clear selected report if it was deleted\r\n        if (state.selectedReport?.id === action.payload) {\r\n          state.selectedReport = null;\r\n        }\r\n        state.loading.deleting = false;\r\n        state.errors.delete = null;\r\n        state.cacheInvalidated = true;\r\n        log('Incident report deleted:', action.payload);\r\n      })\r\n      .addCase(deleteIncidentReport.rejected, (state, action) => {\r\n        state.loading.deleting = false;\r\n        state.errors.delete = action.payload as string;\r\n        log('Error deleting incident report:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // SEARCH INCIDENT REPORTS\r\n      // =====================\r\n      .addCase(searchIncidentReports.pending, (state) => {\r\n        state.loading.searching = true;\r\n        state.errors.search = null;\r\n      })\r\n      .addCase(searchIncidentReports.fulfilled, (state, action) => {\r\n        state.searchResults = action.payload.reports;\r\n        state.loading.searching = false;\r\n        state.errors.search = null;\r\n        log('Search completed:', action.payload.reports.length, 'results');\r\n      })\r\n      .addCase(searchIncidentReports.rejected, (state, action) => {\r\n        state.loading.searching = false;\r\n        state.errors.search = action.payload as string;\r\n        log('Error searching incident reports:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // FETCH WITNESS STATEMENTS\r\n      // =====================\r\n      .addCase(fetchWitnessStatements.pending, (state) => {\r\n        state.loading.witnesses = true;\r\n        state.errors.witnesses = null;\r\n      })\r\n      .addCase(fetchWitnessStatements.fulfilled, (state, action) => {\r\n        state.witnessStatements = action.payload;\r\n        state.loading.witnesses = false;\r\n        state.errors.witnesses = null;\r\n        log('Witness statements fetched:', action.payload.length);\r\n      })\r\n      .addCase(fetchWitnessStatements.rejected, (state, action) => {\r\n        state.loading.witnesses = false;\r\n        state.errors.witnesses = action.payload as string;\r\n        log('Error fetching witness statements:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // CREATE WITNESS STATEMENT\r\n      // =====================\r\n      .addCase(createWitnessStatement.fulfilled, (state, action) => {\r\n        state.witnessStatements.push(action.payload);\r\n        log('Witness statement created:', action.payload.id);\r\n      })\r\n\r\n      // =====================\r\n      // FETCH FOLLOW-UP ACTIONS\r\n      // =====================\r\n      .addCase(fetchFollowUpActions.pending, (state) => {\r\n        state.loading.actions = true;\r\n        state.errors.actions = null;\r\n      })\r\n      .addCase(fetchFollowUpActions.fulfilled, (state, action) => {\r\n        state.followUpActions = action.payload;\r\n        state.loading.actions = false;\r\n        state.errors.actions = null;\r\n        log('Follow-up actions fetched:', action.payload.length);\r\n      })\r\n      .addCase(fetchFollowUpActions.rejected, (state, action) => {\r\n        state.loading.actions = false;\r\n        state.errors.actions = action.payload as string;\r\n        log('Error fetching follow-up actions:', action.payload);\r\n      })\r\n\r\n      // =====================\r\n      // CREATE FOLLOW-UP ACTION\r\n      // =====================\r\n      .addCase(createFollowUpAction.fulfilled, (state, action) => {\r\n        state.followUpActions.push(action.payload);\r\n        log('Follow-up action created:', action.payload.id);\r\n      });\r\n  },\r\n});\r\n\r\n// =====================\r\n// EXPORTS\r\n// =====================\r\n\r\nexport const {\r\n  setFilters,\r\n  setSearchQuery,\r\n  setSelectedIncidentReport,\r\n  clearSelectedIncident,\r\n  setSortOrder,\r\n  setViewMode,\r\n  clearErrors,\r\n  clearError,\r\n  resetState,\r\n  invalidateCache,\r\n  optimisticUpdateReport,\r\n} = incidentReportsSlice.actions;\r\n\r\n/**\r\n * Incident reports actions object for compatibility.\r\n *\r\n * Provides grouped access to all slice actions for easier imports.\r\n *\r\n * @const {Object} incidentReportsActions\r\n */\r\nexport const incidentReportsActions = incidentReportsSlice.actions;\r\n\r\nexport default incidentReportsSlice.reducer;\r\n\r\n// =====================\r\n// SELECTORS\r\n// =====================\r\n\r\nimport type { RootState } from '@/stores/store';\r\n\r\n/**\r\n * Select all incident reports.\r\n *\r\n * @function selectIncidentReports\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} Array of all loaded incident reports\r\n *\r\n * @example\r\n * ```typescript\r\n * const reports = useSelector(selectIncidentReports);\r\n * ```\r\n */\r\nexport const selectIncidentReports = (state: RootState) =>\r\n  state.incidentReports.reports;\r\n\r\n/**\r\n * Select currently selected/active incident report.\r\n *\r\n * @function selectCurrentIncident\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport|null} Selected incident or null if none selected\r\n *\r\n * @example\r\n * ```typescript\r\n * const currentIncident = useSelector(selectCurrentIncident);\r\n * ```\r\n */\r\nexport const selectCurrentIncident = (state: RootState) =>\r\n  state.incidentReports.selectedReport;\r\n\r\n/**\r\n * Select witness statements for current incident.\r\n *\r\n * @function selectWitnessStatements\r\n * @param {RootState} state - Redux root state\r\n * @returns {WitnessStatement[]} Array of witness statements\r\n *\r\n * @example\r\n * ```typescript\r\n * const statements = useSelector(selectWitnessStatements);\r\n * ```\r\n */\r\nexport const selectWitnessStatements = (state: RootState) =>\r\n  state.incidentReports.witnessStatements;\r\n\r\n/**\r\n * Select follow-up actions for current incident.\r\n *\r\n * @function selectFollowUpActions\r\n * @param {RootState} state - Redux root state\r\n * @returns {FollowUpAction[]} Array of follow-up actions\r\n *\r\n * @example\r\n * ```typescript\r\n * const actions = useSelector(selectFollowUpActions);\r\n * ```\r\n */\r\nexport const selectFollowUpActions = (state: RootState) =>\r\n  state.incidentReports.followUpActions;\r\n\r\n/**\r\n * Select search results.\r\n *\r\n * @function selectSearchResults\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} Array of search results\r\n *\r\n * @example\r\n * ```typescript\r\n * const searchResults = useSelector(selectSearchResults);\r\n * ```\r\n */\r\nexport const selectSearchResults = (state: RootState) =>\r\n  state.incidentReports.searchResults;\r\n\r\n/**\r\n * Select pagination metadata.\r\n *\r\n * @function selectPagination\r\n * @param {RootState} state - Redux root state\r\n * @returns {PaginationMeta} Pagination metadata (page, limit, total, pages)\r\n *\r\n * @example\r\n * ```typescript\r\n * const { page, total, pages } = useSelector(selectPagination);\r\n * ```\r\n */\r\nexport const selectPagination = (state: RootState) =>\r\n  state.incidentReports.pagination;\r\n\r\n/**\r\n * Select current filters.\r\n *\r\n * @function selectFilters\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReportFilters} Active filter criteria\r\n *\r\n * @example\r\n * ```typescript\r\n * const filters = useSelector(selectFilters);\r\n * ```\r\n */\r\nexport const selectFilters = (state: RootState) => state.incidentReports.filters;\r\n\r\n/**\r\n * Select search query.\r\n *\r\n * @function selectSearchQuery\r\n * @param {RootState} state - Redux root state\r\n * @returns {string} Current search query text\r\n *\r\n * @example\r\n * ```typescript\r\n * const query = useSelector(selectSearchQuery);\r\n * ```\r\n */\r\nexport const selectSearchQuery = (state: RootState) =>\r\n  state.incidentReports.searchQuery;\r\n\r\n/**\r\n * Select sort configuration.\r\n *\r\n * @function selectSortConfig\r\n * @param {RootState} state - Redux root state\r\n * @returns {SortConfig} Current sort configuration (column, order)\r\n *\r\n * @example\r\n * ```typescript\r\n * const { column, order } = useSelector(selectSortConfig);\r\n * ```\r\n */\r\nexport const selectSortConfig = (state: RootState) =>\r\n  state.incidentReports.sortConfig;\r\n\r\n/**\r\n * Select view mode.\r\n *\r\n * @function selectViewMode\r\n * @param {RootState} state - Redux root state\r\n * @returns {ViewMode} Current view mode (list/grid/detail)\r\n *\r\n * @example\r\n * ```typescript\r\n * const viewMode = useSelector(selectViewMode);\r\n * ```\r\n */\r\nexport const selectViewMode = (state: RootState) => state.incidentReports.viewMode;\r\n\r\n/**\r\n * Select all loading states.\r\n *\r\n * @function selectLoadingStates\r\n * @param {RootState} state - Redux root state\r\n * @returns {LoadingStates} Object with all loading flags\r\n *\r\n * @example\r\n * ```typescript\r\n * const loading = useSelector(selectLoadingStates);\r\n * const isAnyLoading = Object.values(loading).some(v => v);\r\n * ```\r\n */\r\nexport const selectLoadingStates = (state: RootState) =>\r\n  state.incidentReports.loading;\r\n\r\n/**\r\n * Select specific loading state.\r\n *\r\n * Higher-order selector that returns a selector for a specific loading flag.\r\n *\r\n * @function selectIsLoading\r\n * @param {keyof LoadingStates} key - Loading state key\r\n * @returns {(state: RootState) => boolean} Selector for specific loading flag\r\n *\r\n * @example\r\n * ```typescript\r\n * const isListLoading = useSelector(selectIsLoading('list'));\r\n * const isCreating = useSelector(selectIsLoading('creating'));\r\n * ```\r\n */\r\nexport const selectIsLoading = (key: keyof LoadingStates) => (state: RootState) =>\r\n  state.incidentReports.loading[key];\r\n\r\n/**\r\n * Select all error states.\r\n *\r\n * @function selectErrorStates\r\n * @param {RootState} state - Redux root state\r\n * @returns {ErrorStates} Object with all error messages\r\n *\r\n * @example\r\n * ```typescript\r\n * const errors = useSelector(selectErrorStates);\r\n * ```\r\n */\r\nexport const selectErrorStates = (state: RootState) => state.incidentReports.errors;\r\n\r\n/**\r\n * Select specific error state.\r\n *\r\n * Higher-order selector that returns a selector for a specific error message.\r\n *\r\n * @function selectError\r\n * @param {keyof ErrorStates} key - Error state key\r\n * @returns {(state: RootState) => string|null} Selector for specific error message\r\n *\r\n * @example\r\n * ```typescript\r\n * const createError = useSelector(selectError('create'));\r\n * if (createError) toast.error(createError);\r\n * ```\r\n */\r\nexport const selectError = (key: keyof ErrorStates) => (state: RootState) =>\r\n  state.incidentReports.errors[key];\r\n\r\n/**\r\n * Select whether cache is invalidated.\r\n *\r\n * @function selectIsCacheInvalidated\r\n * @param {RootState} state - Redux root state\r\n * @returns {boolean} True if cache needs refresh\r\n *\r\n * @example\r\n * ```typescript\r\n * const needsRefresh = useSelector(selectIsCacheInvalidated);\r\n * ```\r\n */\r\nexport const selectIsCacheInvalidated = (state: RootState) =>\r\n  state.incidentReports.cacheInvalidated;\r\n\r\n/**\r\n * Select last fetched timestamp.\r\n *\r\n * @function selectLastFetched\r\n * @param {RootState} state - Redux root state\r\n * @returns {number|null} Timestamp of last fetch or null if never fetched\r\n *\r\n * @example\r\n * ```typescript\r\n * const lastFetched = useSelector(selectLastFetched);\r\n * const isStale = lastFetched && Date.now() - lastFetched > 300000; // 5 minutes\r\n * ```\r\n */\r\nexport const selectLastFetched = (state: RootState) =>\r\n  state.incidentReports.lastFetched;\r\n\r\n/**\r\n * Select filtered and sorted incident reports.\r\n *\r\n * Derived selector that applies client-side sorting based on current sort configuration.\r\n * Creates a new sorted array without mutating the original.\r\n *\r\n * @function selectFilteredAndSortedReports\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} Sorted array of incident reports\r\n *\r\n * @remarks\r\n * This selector performs client-side sorting on already-loaded data.\r\n * For large datasets, consider using server-side sorting via filter parameters.\r\n *\r\n * Severity sorting uses ordinal values: LOW=1, MEDIUM=2, HIGH=3, CRITICAL=4\r\n *\r\n * @example\r\n * ```typescript\r\n * const sortedReports = useSelector(selectFilteredAndSortedReports);\r\n * ```\r\n */\r\nexport const selectFilteredAndSortedReports = (state: RootState) => {\r\n  const { reports, sortConfig } = state.incidentReports;\r\n\r\n  const sortedReports = [...reports].sort((a, b) => {\r\n    const { column, order } = sortConfig;\r\n\r\n    let aValue: any;\r\n    let bValue: any;\r\n\r\n    switch (column) {\r\n      case 'occurredAt':\r\n      case 'reportedAt':\r\n        aValue = new Date(a[column] || 0).getTime();\r\n        bValue = new Date(b[column] || 0).getTime();\r\n        break;\r\n      case 'severity':\r\n        const severityOrder = { LOW: 1, MEDIUM: 2, HIGH: 3, CRITICAL: 4 };\r\n        aValue = severityOrder[a.severity] || 0;\r\n        bValue = severityOrder[b.severity] || 0;\r\n        break;\r\n      default:\r\n        aValue = a[column];\r\n        bValue = b[column];\r\n    }\r\n\r\n    if (aValue < bValue) return order === 'asc' ? -1 : 1;\r\n    if (aValue > bValue) return order === 'asc' ? 1 : -1;\r\n    return 0;\r\n  });\r\n\r\n  return sortedReports;\r\n};\r\n\r\n/**\r\n * Select incident reports by type.\r\n *\r\n * Higher-order selector that filters incidents by specific type.\r\n *\r\n * @function selectIncidentsByType\r\n * @param {IncidentType} type - Incident type to filter by\r\n * @returns {(state: RootState) => IncidentReport[]} Selector for incidents of specified type\r\n *\r\n * @example\r\n * ```typescript\r\n * const injuries = useSelector(selectIncidentsByType(IncidentType.INJURY));\r\n * const behavioral = useSelector(selectIncidentsByType(IncidentType.BEHAVIORAL));\r\n * ```\r\n */\r\nexport const selectIncidentsByType = (type: IncidentType) => (state: RootState) =>\r\n  state.incidentReports.reports.filter((report: any) => report.type === type);\r\n\r\n/**\r\n * Select incident reports by severity.\r\n *\r\n * Higher-order selector that filters incidents by specific severity level.\r\n *\r\n * @function selectIncidentsBySeverity\r\n * @param {IncidentSeverity} severity - Severity level to filter by\r\n * @returns {(state: RootState) => IncidentReport[]} Selector for incidents of specified severity\r\n *\r\n * @example\r\n * ```typescript\r\n * const criticalIncidents = useSelector(selectIncidentsBySeverity(IncidentSeverity.CRITICAL));\r\n * ```\r\n */\r\nexport const selectIncidentsBySeverity = (severity: IncidentSeverity) => (\r\n  state: RootState\r\n) => state.incidentReports.reports.filter((report: any) => report.severity === severity);\r\n\r\n/**\r\n * Select incident reports by status.\r\n *\r\n * Higher-order selector that filters incidents by specific status.\r\n *\r\n * @function selectIncidentsByStatus\r\n * @param {IncidentStatus} status - Status to filter by\r\n * @returns {(state: RootState) => IncidentReport[]} Selector for incidents with specified status\r\n *\r\n * @example\r\n * ```typescript\r\n * const openIncidents = useSelector(selectIncidentsByStatus(IncidentStatus.OPEN));\r\n * const resolved = useSelector(selectIncidentsByStatus(IncidentStatus.RESOLVED));\r\n * ```\r\n */\r\nexport const selectIncidentsByStatus = (status: IncidentStatus) => (state: RootState) =>\r\n  state.incidentReports.reports.filter((report: any) => report.status === status);\r\n\r\n/**\r\n * Select incident reports requiring follow-up.\r\n *\r\n * Filters incidents where followUpRequired flag is true.\r\n *\r\n * @function selectIncidentsRequiringFollowUp\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} Incidents requiring follow-up actions\r\n *\r\n * @example\r\n * ```typescript\r\n * const needsFollowUp = useSelector(selectIncidentsRequiringFollowUp);\r\n * ```\r\n */\r\nexport const selectIncidentsRequiringFollowUp = (state: RootState) =>\r\n  state.incidentReports.reports.filter((report: any) => report.followUpRequired);\r\n\r\n/**\r\n * Select incident reports with unnotified parents.\r\n *\r\n * Filters incidents where parent notification has not been completed.\r\n * Useful for generating notification task lists.\r\n *\r\n * @function selectIncidentsWithUnnotifiedParents\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} Incidents with unnotified parents\r\n *\r\n * @example\r\n * ```typescript\r\n * const needsNotification = useSelector(selectIncidentsWithUnnotifiedParents);\r\n * ```\r\n */\r\nexport const selectIncidentsWithUnnotifiedParents = (state: RootState) =>\r\n  state.incidentReports.reports.filter((report: any) => !report.parentNotified);\r\n\r\n/**\r\n * Select critical incidents (HIGH or CRITICAL severity).\r\n *\r\n * Filters incidents requiring immediate attention due to high severity.\r\n * These incidents typically trigger automatic parent notifications.\r\n *\r\n * @function selectCriticalIncidents\r\n * @param {RootState} state - Redux root state\r\n * @returns {IncidentReport[]} High and critical severity incidents\r\n *\r\n * @example\r\n * ```typescript\r\n * const criticalIncidents = useSelector(selectCriticalIncidents);\r\n * // Display urgent notification badge if any critical incidents exist\r\n * if (criticalIncidents.length > 0) {\r\n *   showUrgentBadge(criticalIncidents.length);\r\n * }\r\n * ```\r\n */\r\nexport const selectCriticalIncidents = (state: RootState) =>\r\n  state.incidentReports.reports.filter(\r\n    (report: any) =>\r\n      report.severity === IncidentSeverity.HIGH ||\r\n      report.severity === IncidentSeverity.CRITICAL\r\n  );\r\n\r\n/**\r\n * Select statistics for current reports.\r\n *\r\n * Derived selector that calculates analytics on loaded incident reports including\r\n * counts by type, severity, status, and notification/follow-up rates.\r\n *\r\n * @function selectReportStatistics\r\n * @param {RootState} state - Redux root state\r\n * @returns {Object} Statistics object\r\n * @returns {number} return.total - Total number of loaded reports\r\n * @returns {Record<string, number>} return.byType - Count of incidents by type\r\n * @returns {Record<string, number>} return.bySeverity - Count of incidents by severity\r\n * @returns {Record<string, number>} return.byStatus - Count of incidents by status\r\n * @returns {number} return.parentNotificationRate - Percentage of incidents with parent notification\r\n * @returns {number} return.followUpRate - Percentage of incidents requiring follow-up\r\n *\r\n * @remarks\r\n * This selector performs calculations on client-side data. For comprehensive\r\n * analytics across all incidents (not just loaded ones), use a dedicated\r\n * analytics API endpoint.\r\n *\r\n * @example\r\n * ```typescript\r\n * const stats = useSelector(selectReportStatistics);\r\n * console.log(`Critical incidents: ${stats.bySeverity.CRITICAL || 0}`);\r\n * console.log(`Parent notification rate: ${stats.parentNotificationRate.toFixed(1)}%`);\r\n * ```\r\n */\r\nexport const selectReportStatistics = (state: RootState) => {\r\n  const { reports } = state.incidentReports;\r\n\r\n  return {\r\n    total: reports.length,\r\n    byType: reports.reduce((acc: any, report: any) => {\r\n      acc[report.type] = (acc[report.type] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>),\r\n    bySeverity: reports.reduce((acc: any, report: any) => {\r\n      acc[report.severity] = (acc[report.severity] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>),\r\n    byStatus: reports.reduce((acc: any, report: any) => {\r\n      acc[report.status || 'OPEN'] = (acc[report.status || 'OPEN'] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>),\r\n    parentNotificationRate:\r\n      reports.length > 0\r\n        ? (reports.filter((r: any) => r.parentNotified).length / reports.length) * 100\r\n        : 0,\r\n    followUpRate:\r\n      reports.length > 0\r\n        ? (reports.filter((r: any) => r.followUpRequired).length / reports.length) * 100\r\n        : 0,\r\n  };\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 11254, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/types/domain/administration.ts"],"sourcesContent":["/**\r\n * WF-COMP-315 | administration.ts - React component or utility module\r\n * Purpose: react component or utility module\r\n * Upstream: React, external libs | Dependencies: React ecosystem\r\n * Downstream: Components, pages, app routing | Called by: React component tree\r\n * Related: Other components, hooks, services, types\r\n * Exports: functions, interfaces | Key Features: Standard module\r\n * Last Updated: 2025-10-17 | File Type: .ts\r\n * Critical Path: Component mount â†’ Render â†’ User interaction â†’ State updates\r\n * LLM Context: react component or utility module, part of React frontend architecture\r\n */\r\n\r\n/**\r\n * Administration Module Types\r\n *\r\n * Comprehensive type definitions for the Administration module including:\r\n * - District and School management\r\n * - System configuration with history tracking\r\n * - License management and feature control\r\n * - Backup operations and monitoring\r\n * - Performance metrics collection\r\n * - Training module management and completion tracking\r\n * - User management\r\n * - Audit logging\r\n */\r\n\r\n// ==================== ENUMS ====================\r\n\r\n/**\r\n * Configuration category types\r\n */\r\nexport enum ConfigCategory {\r\n  GENERAL = 'GENERAL',\r\n  SECURITY = 'SECURITY',\r\n  NOTIFICATION = 'NOTIFICATION',\r\n  INTEGRATION = 'INTEGRATION',\r\n  BACKUP = 'BACKUP',\r\n  PERFORMANCE = 'PERFORMANCE',\r\n  HEALTHCARE = 'HEALTHCARE',\r\n  MEDICATION = 'MEDICATION',\r\n  APPOINTMENTS = 'APPOINTMENTS',\r\n  UI = 'UI',\r\n  QUERY = 'QUERY',\r\n  FILE_UPLOAD = 'FILE_UPLOAD',\r\n  RATE_LIMITING = 'RATE_LIMITING',\r\n  SESSION = 'SESSION',\r\n  EMAIL = 'EMAIL',\r\n  SMS = 'SMS',\r\n}\r\n\r\n/**\r\n * Configuration value data types\r\n */\r\nexport enum ConfigValueType {\r\n  STRING = 'STRING',\r\n  NUMBER = 'NUMBER',\r\n  BOOLEAN = 'BOOLEAN',\r\n  JSON = 'JSON',\r\n  ARRAY = 'ARRAY',\r\n  DATE = 'DATE',\r\n  TIME = 'TIME',\r\n  DATETIME = 'DATETIME',\r\n  EMAIL = 'EMAIL',\r\n  URL = 'URL',\r\n  COLOR = 'COLOR',\r\n  ENUM = 'ENUM',\r\n}\r\n\r\n/**\r\n * Configuration scope levels\r\n */\r\nexport enum ConfigScope {\r\n  SYSTEM = 'SYSTEM',\r\n  DISTRICT = 'DISTRICT',\r\n  SCHOOL = 'SCHOOL',\r\n  USER = 'USER',\r\n}\r\n\r\n/**\r\n * Backup types\r\n */\r\nexport enum BackupType {\r\n  AUTOMATIC = 'AUTOMATIC',\r\n  MANUAL = 'MANUAL',\r\n  SCHEDULED = 'SCHEDULED',\r\n}\r\n\r\n/**\r\n * Backup status\r\n */\r\nexport enum BackupStatus {\r\n  IN_PROGRESS = 'IN_PROGRESS',\r\n  COMPLETED = 'COMPLETED',\r\n  FAILED = 'FAILED',\r\n}\r\n\r\n/**\r\n * Performance metric types\r\n */\r\nexport enum MetricType {\r\n  CPU_USAGE = 'CPU_USAGE',\r\n  MEMORY_USAGE = 'MEMORY_USAGE',\r\n  DISK_USAGE = 'DISK_USAGE',\r\n  API_RESPONSE_TIME = 'API_RESPONSE_TIME',\r\n  DATABASE_QUERY_TIME = 'DATABASE_QUERY_TIME',\r\n  ACTIVE_USERS = 'ACTIVE_USERS',\r\n  ERROR_RATE = 'ERROR_RATE',\r\n  REQUEST_COUNT = 'REQUEST_COUNT',\r\n}\r\n\r\n/**\r\n * License types\r\n */\r\nexport enum LicenseType {\r\n  TRIAL = 'TRIAL',\r\n  BASIC = 'BASIC',\r\n  PROFESSIONAL = 'PROFESSIONAL',\r\n  ENTERPRISE = 'ENTERPRISE',\r\n}\r\n\r\n/**\r\n * License status\r\n */\r\nexport enum LicenseStatus {\r\n  ACTIVE = 'ACTIVE',\r\n  EXPIRED = 'EXPIRED',\r\n  SUSPENDED = 'SUSPENDED',\r\n  CANCELLED = 'CANCELLED',\r\n}\r\n\r\n/**\r\n * Training module categories\r\n */\r\nexport enum TrainingCategory {\r\n  HIPAA_COMPLIANCE = 'HIPAA_COMPLIANCE',\r\n  MEDICATION_MANAGEMENT = 'MEDICATION_MANAGEMENT',\r\n  EMERGENCY_PROCEDURES = 'EMERGENCY_PROCEDURES',\r\n  SYSTEM_TRAINING = 'SYSTEM_TRAINING',\r\n  SAFETY_PROTOCOLS = 'SAFETY_PROTOCOLS',\r\n  DATA_SECURITY = 'DATA_SECURITY',\r\n}\r\n\r\n/**\r\n * Audit log actions\r\n */\r\nexport enum AuditAction {\r\n  CREATE = 'CREATE',\r\n  READ = 'READ',\r\n  UPDATE = 'UPDATE',\r\n  DELETE = 'DELETE',\r\n  LOGIN = 'LOGIN',\r\n  LOGOUT = 'LOGOUT',\r\n  EXPORT = 'EXPORT',\r\n  IMPORT = 'IMPORT',\r\n  BACKUP = 'BACKUP',\r\n  RESTORE = 'RESTORE',\r\n}\r\n\r\n/**\r\n * User roles\r\n */\r\nexport enum UserRole {\r\n  ADMIN = 'ADMIN',\r\n  NURSE = 'NURSE',\r\n  SCHOOL_ADMIN = 'SCHOOL_ADMIN',\r\n  DISTRICT_ADMIN = 'DISTRICT_ADMIN',\r\n  VIEWER = 'VIEWER',\r\n  COUNSELOR = 'COUNSELOR',\r\n}\r\n\r\n// ==================== DISTRICT & SCHOOL TYPES ====================\r\n\r\n/**\r\n * District entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/District.ts\r\n */\r\nexport interface District {\r\n  id: string;\r\n  name: string;\r\n  code: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n\r\n  // Frontend-only relationship fields\r\n  schools?: School[];\r\n  licenses?: License[];\r\n}\r\n\r\n/**\r\n * School entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/School.ts\r\n */\r\nexport interface School {\r\n  id: string;\r\n  name: string;\r\n  code: string;\r\n  districtId: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  principal?: string;\r\n  totalEnrollment?: number;\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n\r\n  // Frontend-only relationship field\r\n  district?: {\r\n    id: string;\r\n    name: string;\r\n    code: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Create district request\r\n */\r\nexport interface CreateDistrictData {\r\n  name: string;\r\n  code: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  website?: string;\r\n}\r\n\r\n/**\r\n * Update district request\r\n */\r\nexport interface UpdateDistrictData {\r\n  name?: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  website?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Create school request\r\n */\r\nexport interface CreateSchoolData {\r\n  name: string;\r\n  code: string;\r\n  districtId: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  principal?: string;\r\n  totalEnrollment?: number;\r\n}\r\n\r\n/**\r\n * Update school request\r\n */\r\nexport interface UpdateSchoolData {\r\n  name?: string;\r\n  address?: string;\r\n  city?: string;\r\n  state?: string;\r\n  zipCode?: string;\r\n  phone?: string;\r\n  email?: string;\r\n  principal?: string;\r\n  totalEnrollment?: number;\r\n  isActive?: boolean;\r\n}\r\n\r\n// ==================== SYSTEM CONFIGURATION TYPES ====================\r\n\r\n/**\r\n * System configuration entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/SystemConfiguration.ts\r\n */\r\nexport interface SystemConfiguration {\r\n  id: string;\r\n  key: string;\r\n  value: string;\r\n  valueType: ConfigValueType;\r\n  category: ConfigCategory;\r\n  subCategory?: string;\r\n  description?: string;\r\n  defaultValue?: string;\r\n  validValues: string[];\r\n  minValue?: number;\r\n  maxValue?: number;\r\n  isPublic: boolean;\r\n  isEditable: boolean;\r\n  requiresRestart: boolean;\r\n  scope: ConfigScope;\r\n  scopeId?: string;\r\n  tags: string[];\r\n  sortOrder: number;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n/**\r\n * Configuration history tracking\r\n *\r\n * @aligned_with backend/src/database/models/administration/ConfigurationHistory.ts\r\n */\r\nexport interface ConfigurationHistory {\r\n  id: string;\r\n  configurationId: string;\r\n  configKey: string;\r\n  oldValue?: string;\r\n  newValue: string;\r\n  changedBy: string;\r\n  changedByName?: string;\r\n  changeReason?: string;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n  createdAt: string;\r\n}\r\n\r\n/**\r\n * Configuration data for create/update\r\n */\r\nexport interface ConfigurationData {\r\n  key: string;\r\n  value: string;\r\n  category: ConfigCategory;\r\n  valueType?: ConfigValueType;\r\n  subCategory?: string;\r\n  description?: string;\r\n  isPublic?: boolean;\r\n  isEditable?: boolean;\r\n  requiresRestart?: boolean;\r\n  scope?: ConfigScope;\r\n  scopeId?: string;\r\n  tags?: string[];\r\n  sortOrder?: number;\r\n}\r\n\r\n/**\r\n * System settings grouped by category\r\n */\r\nexport interface SystemSettings {\r\n  [category: string]: SystemSettingItem[];\r\n}\r\n\r\n/**\r\n * Individual setting item\r\n */\r\nexport interface SystemSettingItem {\r\n  key: string;\r\n  value: string;\r\n  valueType: ConfigValueType;\r\n  description?: string;\r\n  isPublic: boolean;\r\n  isEditable: boolean;\r\n  requiresRestart: boolean;\r\n  category: ConfigCategory;\r\n  subCategory?: string;\r\n  scope?: ConfigScope;\r\n  tags?: string[];\r\n}\r\n\r\n// ==================== LICENSE MANAGEMENT TYPES ====================\r\n\r\n/**\r\n * License entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/License.ts\r\n */\r\nexport interface License {\r\n  id: string;\r\n  licenseKey: string;\r\n  type: LicenseType;\r\n  status: LicenseStatus;\r\n  maxUsers?: number;\r\n  maxSchools?: number;\r\n  features: string[];\r\n  issuedTo?: string;\r\n  issuedAt: string;\r\n  expiresAt?: string;\r\n  activatedAt?: string;\r\n  deactivatedAt?: string;\r\n  notes?: string;\r\n  districtId?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n\r\n  // Frontend-only relationship field\r\n  district?: {\r\n    id: string;\r\n    name: string;\r\n    code: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Create license request\r\n */\r\nexport interface CreateLicenseData {\r\n  licenseKey: string;\r\n  type: LicenseType;\r\n  maxUsers?: number;\r\n  maxSchools?: number;\r\n  features: string[];\r\n  issuedTo?: string;\r\n  expiresAt?: Date | string;\r\n  districtId?: string;\r\n  notes?: string;\r\n}\r\n\r\n/**\r\n * Update license request\r\n */\r\nexport interface UpdateLicenseData {\r\n  licenseKey?: string;\r\n  type?: LicenseType;\r\n  status?: LicenseStatus;\r\n  maxUsers?: number;\r\n  maxSchools?: number;\r\n  features?: string[];\r\n  issuedTo?: string;\r\n  expiresAt?: Date | string;\r\n  districtId?: string;\r\n  notes?: string;\r\n}\r\n\r\n// ==================== BACKUP & RECOVERY TYPES ====================\r\n\r\n/**\r\n * Backup log entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/BackupLog.ts\r\n * @note Backend has timestamps: false, so no updatedAt field\r\n */\r\nexport interface BackupLog {\r\n  id: string;\r\n  type: BackupType;\r\n  status: BackupStatus;\r\n  fileName?: string;\r\n  fileSize?: number;\r\n  location?: string;\r\n  startedAt: string;\r\n  completedAt?: string;\r\n  error?: string;\r\n  triggeredBy?: string;\r\n  createdAt: string;\r\n}\r\n\r\n/**\r\n * Create backup request\r\n */\r\nexport interface CreateBackupData {\r\n  type: BackupType;\r\n  triggeredBy?: string;\r\n}\r\n\r\n// ==================== PERFORMANCE MONITORING TYPES ====================\r\n\r\n/**\r\n * Performance metric entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/PerformanceMetric.ts\r\n * @note Backend has timestamps: false, so no createdAt field\r\n */\r\nexport interface PerformanceMetric {\r\n  id: string;\r\n  metricType: MetricType;\r\n  value: number;\r\n  unit?: string;\r\n  context?: Record<string, any>;\r\n  recordedAt: string;\r\n}\r\n\r\n/**\r\n * System health metrics\r\n */\r\nexport interface SystemHealth {\r\n  status: string;\r\n  timestamp: Date | string;\r\n  overall?: {\r\n    uptime: number;\r\n    lastRestart: Date | string;\r\n    version: string;\r\n  };\r\n  services?: Array<{\r\n    name: string;\r\n    status: 'operational' | 'degraded' | 'down';\r\n    responseTime: number;\r\n    uptime: number;\r\n    lastCheck: Date | string;\r\n    errorRate?: number;\r\n  }>;\r\n  alerts?: Array<{\r\n    id: string;\r\n    severity: 'info' | 'warning' | 'error' | 'critical';\r\n    service: string;\r\n    message: string;\r\n    timestamp: Date | string;\r\n    acknowledged: boolean;\r\n  }>;\r\n  metrics: {\r\n    cpu?: number | {\r\n      usage: number;\r\n      cores: number;\r\n      temperature?: number;\r\n    };\r\n    memory?: number | {\r\n      used: number;\r\n      total: number;\r\n      percentage: number;\r\n    };\r\n    disk?: number | {\r\n      used: number;\r\n      total: number;\r\n      percentage: number;\r\n    };\r\n    database?: string;\r\n    apiResponseTime?: number;\r\n    uptime?: string;\r\n    connections?: number;\r\n    errorRate?: number;\r\n    queuedJobs?: number;\r\n    cacheHitRate?: number;\r\n  };\r\n  statistics?: {\r\n    totalUsers: number;\r\n    activeUsers: number;\r\n    totalDistricts: number;\r\n    totalSchools: number;\r\n  };\r\n  system?: {\r\n    platform: string;\r\n    arch: string;\r\n    nodeVersion: string;\r\n    totalMemoryGB: string;\r\n    freeMemoryGB: string;\r\n    cpuCount: number;\r\n    cpuModel: string;\r\n    processHeapUsedMB: string;\r\n    processHeapTotalMB: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Record metric request\r\n */\r\nexport interface RecordMetricData {\r\n  metricType: MetricType;\r\n  value: number;\r\n  unit?: string;\r\n  context?: Record<string, any>;\r\n}\r\n\r\n// ==================== TRAINING MODULE TYPES ====================\r\n\r\n/**\r\n * Training module entity\r\n *\r\n * @aligned_with backend/src/database/models/administration/TrainingModule.ts\r\n */\r\nexport interface TrainingModule {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  content: string;\r\n  duration?: number;\r\n  category: TrainingCategory;\r\n  isRequired: boolean;\r\n  order: number;\r\n  attachments: string[];\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n\r\n  // Frontend-only relationship field\r\n  completions?: TrainingCompletion[];\r\n}\r\n\r\n/**\r\n * Training completion tracking\r\n *\r\n * @aligned_with backend/src/database/models/administration/TrainingCompletion.ts\r\n * @note Backend has timestamps: false, so no updatedAt field\r\n */\r\nexport interface TrainingCompletion {\r\n  id: string;\r\n  userId: string;\r\n  moduleId: string;\r\n  score?: number;\r\n  completedAt: string;\r\n  expiresAt?: string;\r\n  certificateUrl?: string;\r\n  notes?: string;\r\n  createdAt: string;\r\n\r\n  // Frontend-only relationship field\r\n  module?: TrainingModule;\r\n}\r\n\r\n/**\r\n * Create training module request\r\n */\r\nexport interface CreateTrainingModuleData {\r\n  title: string;\r\n  description?: string;\r\n  content: string;\r\n  duration?: number;\r\n  category: TrainingCategory;\r\n  isRequired?: boolean;\r\n  order?: number;\r\n  attachments?: string[];\r\n}\r\n\r\n/**\r\n * Update training module request\r\n */\r\nexport interface UpdateTrainingModuleData {\r\n  title?: string;\r\n  description?: string;\r\n  content?: string;\r\n  duration?: number;\r\n  category?: TrainingCategory;\r\n  isRequired?: boolean;\r\n  order?: number;\r\n  attachments?: string[];\r\n}\r\n\r\n/**\r\n * Training completion request\r\n */\r\nexport interface RecordTrainingCompletionData {\r\n  score?: number;\r\n}\r\n\r\n/**\r\n * User training progress\r\n */\r\nexport interface UserTrainingProgress {\r\n  completions: TrainingCompletion[];\r\n  totalModules: number;\r\n  completedModules: number;\r\n  requiredModules: number;\r\n  completedRequired: number;\r\n  completionPercentage: number;\r\n}\r\n\r\n// ==================== USER MANAGEMENT TYPES ====================\r\n\r\n/**\r\n * User entity\r\n */\r\nexport interface User {\r\n  id: string;\r\n  email: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  role: UserRole;\r\n  isActive: boolean;\r\n  schoolId?: string;\r\n  districtId?: string;\r\n  lastLoginAt?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n/**\r\n * Create user request\r\n */\r\nexport interface CreateUserData {\r\n  email: string;\r\n  password: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  role: UserRole;\r\n  schoolId?: string;\r\n  districtId?: string;\r\n}\r\n\r\n/**\r\n * Update user request\r\n */\r\nexport interface UpdateUserData {\r\n  email?: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  role?: UserRole;\r\n  isActive?: boolean;\r\n  schoolId?: string;\r\n  districtId?: string;\r\n}\r\n\r\n// ==================== AUDIT LOGGING TYPES ====================\r\n\r\n/**\r\n * Audit log entity\r\n */\r\nexport interface AuditLog {\r\n  id: string;\r\n  action: AuditAction;\r\n  entityType: string;\r\n  entityId?: string;\r\n  userId?: string;\r\n  changes?: Record<string, any>;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n  createdAt: string;\r\n}\r\n\r\n/**\r\n * Create audit log request\r\n */\r\nexport interface CreateAuditLogData {\r\n  action: AuditAction;\r\n  entityType: string;\r\n  entityId?: string;\r\n  userId?: string;\r\n  changes?: Record<string, any>;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n}\r\n\r\n// ==================== PAGINATION & FILTER TYPES ====================\r\n\r\n/**\r\n * Pagination parameters\r\n */\r\nexport interface PaginationParams {\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n/**\r\n * Pagination result metadata\r\n */\r\nexport interface PaginationResult {\r\n  page: number;\r\n  limit: number;\r\n  total: number;\r\n  totalPages: number;\r\n}\r\n\r\n/**\r\n * Paginated response wrapper\r\n */\r\nexport interface PaginatedResponse<T> {\r\n  data: T[];\r\n  pagination: PaginationResult;\r\n}\r\n\r\n/**\r\n * User filter parameters\r\n */\r\nexport interface UserFilters extends PaginationParams {\r\n  search?: string;\r\n  role?: UserRole;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Audit log filter parameters\r\n */\r\nexport interface AuditLogFilters extends PaginationParams {\r\n  userId?: string;\r\n  entityType?: string;\r\n  entityId?: string;\r\n  action?: AuditAction;\r\n  startDate?: Date | string;\r\n  endDate?: Date | string;\r\n}\r\n\r\n/**\r\n * Metric filter parameters\r\n */\r\nexport interface MetricFilters {\r\n  metricType?: MetricType;\r\n  startDate?: Date | string;\r\n  endDate?: Date | string;\r\n  limit?: number;\r\n}\r\n\r\n// ==================== API RESPONSE TYPES ====================\r\n\r\n/**\r\n * Generic API response\r\n */\r\nexport interface ApiResponse<T> {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: {\r\n    message: string;\r\n  };\r\n  errors?: Array<{\r\n    field: string;\r\n    message: string;\r\n  }>;\r\n}\r\n\r\n/**\r\n * Success response with message\r\n */\r\nexport interface SuccessResponse {\r\n  success: boolean;\r\n  message: string;\r\n}\r\n\r\n// ==================== TYPE GUARDS ====================\r\n\r\n/**\r\n * Check if value is a valid ConfigCategory\r\n */\r\nexport function isConfigCategory(value: any): value is ConfigCategory {\r\n  return Object.values(ConfigCategory).includes(value);\r\n}\r\n\r\n/**\r\n * Check if value is a valid LicenseType\r\n */\r\nexport function isLicenseType(value: any): value is LicenseType {\r\n  return Object.values(LicenseType).includes(value);\r\n}\r\n\r\n/**\r\n * Check if value is a valid TrainingCategory\r\n */\r\nexport function isTrainingCategory(value: any): value is TrainingCategory {\r\n  return Object.values(TrainingCategory).includes(value);\r\n}\r\n\r\n/**\r\n * Check if value is a valid UserRole\r\n */\r\nexport function isUserRole(value: any): value is UserRole {\r\n  return Object.values(UserRole).includes(value);\r\n}\r\n\r\n/**\r\n * Check if value is a valid MetricType\r\n */\r\nexport function isMetricType(value: any): value is MetricType {\r\n  return Object.values(MetricType).includes(value);\r\n}\r\n\r\n/**\r\n * Check if value is a valid AuditAction\r\n */\r\nexport function isAuditAction(value: any): value is AuditAction {\r\n  return Object.values(AuditAction).includes(value);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;CAUC,GAED;;;;;;;;;;;;CAYC,GAED,kDAAkD;AAElD;;CAEC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACM,IAAA,AAAK,wCAAA;;;;;;;;;;;;;;;;;WAAA;;AAsBL,IAAA,AAAK,yCAAA;;;;;;;;;;;;;WAAA;;AAkBL,IAAA,AAAK,qCAAA;;;;;WAAA;;AAUL,IAAA,AAAK,oCAAA;;;;WAAA;;AASL,IAAA,AAAK,sCAAA;;;;WAAA;;AASL,IAAA,AAAK,oCAAA;;;;;;;;;WAAA;;AAcL,IAAA,AAAK,qCAAA;;;;;WAAA;;AAUL,IAAA,AAAK,uCAAA;;;;;WAAA;;AAUL,IAAA,AAAK,0CAAA;;;;;;;WAAA;;AAYL,IAAA,AAAK,qCAAA;;;;;;;;;;;WAAA;;AAgBL,IAAA,AAAK,kCAAA;;;;;;;WAAA;;AA4pBL,SAAS,iBAAiB,KAAU;IACzC,OAAO,OAAO,MAAM,CAAC,gBAAgB,QAAQ,CAAC;AAChD;AAKO,SAAS,cAAc,KAAU;IACtC,OAAO,OAAO,MAAM,CAAC,aAAa,QAAQ,CAAC;AAC7C;AAKO,SAAS,mBAAmB,KAAU;IAC3C,OAAO,OAAO,MAAM,CAAC,kBAAkB,QAAQ,CAAC;AAClD;AAKO,SAAS,WAAW,KAAU;IACnC,OAAO,OAAO,MAAM,CAAC,UAAU,QAAQ,CAAC;AAC1C;AAKO,SAAS,aAAa,KAAU;IACrC,OAAO,OAAO,MAAM,CAAC,YAAY,QAAQ,CAAC;AAC5C;AAKO,SAAS,cAAc,KAAU;IACtC,OAAO,OAAO,MAAM,CAAC,aAAa,QAAQ,CAAC;AAC7C","debugId":null}},
    {"offset": {"line": 11446, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/settingsSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview System Settings Redux Slice for White Cross Healthcare Platform\r\n *\r\n * Manages system-wide configuration settings and administrative preferences for the\r\n * healthcare platform. Provides comprehensive state management for configuration\r\n * CRUD operations, settings validation, and real-time configuration updates.\r\n *\r\n * **Key Features:**\r\n * - System configuration management (database, API, security settings)\r\n * - User preference management (UI themes, notifications, defaults)\r\n * - Feature flag and toggle management\r\n * - Multi-tenant configuration support (school/district level)\r\n * - Configuration validation and type enforcement\r\n * - Real-time configuration updates across browser tabs\r\n * - Configuration versioning and rollback capabilities\r\n * - Environment-specific settings (dev, staging, production)\r\n * - Configuration import/export functionality\r\n *\r\n * **HIPAA Compliance:**\r\n * - Configuration settings may contain sensitive information (API keys, server URLs)\r\n * - PHI-related settings (data retention policies, audit configurations) require special handling\r\n * - All configuration changes generate audit logs for compliance tracking\r\n * - Role-based access control for sensitive configuration categories\r\n * - Encrypted storage for sensitive configuration values\r\n * - Configuration access logging for security monitoring\r\n *\r\n * **Configuration Categories:**\r\n * - **SYSTEM**: Core system settings (database, cache, logging)\r\n * - **SECURITY**: Authentication, authorization, encryption settings\r\n * - **NOTIFICATIONS**: Email, SMS, push notification configurations\r\n * - **INTEGRATIONS**: Third-party API configurations (SIS, EMR, payment processors)\r\n * - **UI**: User interface preferences and customizations\r\n * - **FEATURES**: Feature flags and experimental functionality toggles\r\n * - **COMPLIANCE**: HIPAA, FERPA, and other regulatory compliance settings\r\n * - **PERFORMANCE**: Caching, rate limiting, and optimization settings\r\n *\r\n * **State Management:**\r\n * - Uses entity slice factory pattern for standardized CRUD operations\r\n * - Normalized state structure with EntityAdapter for efficient lookups\r\n * - Category-based organization for settings management\r\n * - Type-safe configuration values with validation\r\n * - Optimistic updates for immediate UI responsiveness\r\n * - Configuration caching with intelligent invalidation\r\n *\r\n * **Security Considerations:**\r\n * - Sensitive values (passwords, API keys) are encrypted at rest\r\n * - Role-based access control for configuration categories\r\n * - Configuration change audit logging\r\n * - Input validation and sanitization for all configuration values\r\n * - Secure configuration backup and restore procedures\r\n *\r\n * **Integration:**\r\n * - Backend API: `services/modules/administrationApi.ts`\r\n * - Type definitions: `types/administration.ts`\r\n * - Redux store: `stores/reduxStore.ts`\r\n * - Used by: Admin panels, system monitoring, feature toggles\r\n *\r\n * @module stores/slices/settingsSlice\r\n * @requires @reduxjs/toolkit\r\n * @requires services/modules/administrationApi\r\n * @requires types/administration\r\n * @security System configuration management, sensitive data handling\r\n * @compliance HIPAA-compliant configuration operations\r\n *\r\n * @example System configuration management\r\n * ```typescript\r\n * import { useDispatch, useSelector } from 'react-redux';\r\n * import { settingsThunks, selectSettingsByCategory } from '@/stores/slices/settingsSlice';\r\n *\r\n * function SystemSettings() {\r\n *   const dispatch = useDispatch();\r\n *   const systemSettings = useSelector(state => \r\n *     selectSettingsByCategory(state, 'SYSTEM')\r\n *   );\r\n *\r\n *   const updateSetting = async (key: string, value: string) => {\r\n *     await dispatch(settingsThunks.update({\r\n *       id: key,\r\n *       data: { key, value, category: 'SYSTEM' }\r\n *     }));\r\n *   };\r\n *\r\n *   return (\r\n *     <div>\r\n *       {systemSettings.map(setting => (\r\n *         <ConfigurationInput\r\n *           key={setting.id}\r\n *           setting={setting}\r\n *           onChange={(value) => updateSetting(setting.key, value)}\r\n *         />\r\n *       ))}\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @example Feature flag management\r\n * ```typescript\r\n * function FeatureToggle({ featureKey, children }) {\r\n *   const featureEnabled = useSelector(state => \r\n *     selectSettingValue(state, `feature.${featureKey}.enabled`)\r\n *   );\r\n *\r\n *   if (featureEnabled === 'true') {\r\n *     return children;\r\n *   }\r\n *\r\n *   return null;\r\n * }\r\n *\r\n * // Usage\r\n * <FeatureToggle featureKey=\"experimental_dashboard\">\r\n *   <ExperimentalDashboard />\r\n * </FeatureToggle>\r\n * ```\r\n *\r\n * @example Bulk configuration update\r\n * ```typescript\r\n * function BulkConfigurationUpdate() {\r\n *   const dispatch = useDispatch();\r\n *\r\n *   const updateNotificationSettings = async (settings) => {\r\n *     // Update multiple notification-related settings\r\n *     const updates = Object.entries(settings).map(([key, value]) => ({\r\n *       id: `notification.${key}`,\r\n *       data: { key: `notification.${key}`, value, category: 'NOTIFICATIONS' }\r\n *     }));\r\n *\r\n *     // Use Promise.all for concurrent updates\r\n *     await Promise.all(\r\n *       updates.map(update => \r\n *         dispatch(settingsThunks.update(update))\r\n *       )\r\n *     );\r\n *   };\r\n *\r\n *   return (\r\n *     <button onClick={() => updateNotificationSettings({\r\n *       'email.enabled': 'true',\r\n *       'sms.enabled': 'false',\r\n *       'push.enabled': 'true'\r\n *     })}>\r\n *       Update Notification Settings\r\n *     </button>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @see {@link ../../services/modules/administrationApi.ts} for API integration\r\n * @see {@link ../reduxStore.ts} for store configuration\r\n * @see {@link ../../types/administration.ts} for type definitions\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { SystemConfiguration, ConfigurationData, ConfigCategory, ConfigValueType, ConfigScope } from '@/types/domain/administration';\r\nimport { apiActions } from '@/lib/api';\r\nimport type { RootState } from '@/stores/store';\r\n\r\n// Create API service adapter for settings\r\nconst settingsApiService: EntityApiService<SystemConfiguration, ConfigurationData, ConfigurationData> = {\r\n  async getAll() {\r\n    const response = await apiActions.administration.getSettings();\r\n    // Convert settings object to array of configuration items\r\n    const configurations: SystemConfiguration[] = [];\r\n    \r\n    if (response.data) {\r\n      Object.entries(response.data).forEach(([category, items]) => {\r\n        if (Array.isArray(items)) {\r\n          items.forEach((item: Record<string, unknown>) => {\r\n            configurations.push({\r\n              id: item.id as string || `${category}-${item.key}`,\r\n              key: item.key as string,\r\n              value: item.value as string,\r\n              category: category as ConfigCategory,\r\n              valueType: item.valueType as ConfigValueType,\r\n              description: item.description as string,\r\n              isPublic: item.isPublic as boolean ?? false,\r\n              isEditable: item.isEditable as boolean ?? true,\r\n              requiresRestart: item.requiresRestart as boolean ?? false,\r\n              scope: item.scope as ConfigScope || ConfigScope.SYSTEM,\r\n              createdAt: item.createdAt as string || new Date().toISOString(),\r\n              updatedAt: item.updatedAt as string || new Date().toISOString(),\r\n              validValues: item.validValues as string[] || undefined,\r\n              tags: item.tags as string[] || [],\r\n              sortOrder: item.sortOrder as number || 0,\r\n            });\r\n          });\r\n        }\r\n      });\r\n    }\r\n    \r\n    return {\r\n      data: configurations,\r\n      total: configurations.length,\r\n    };\r\n  },\r\n\r\n  async getById(id: string) {\r\n    const response = await apiActions.administration.getSettings();\r\n    let foundConfig: SystemConfiguration | null = null;\r\n    \r\n    if (response.data) {\r\n      Object.entries(response.data).forEach(([category, items]) => {\r\n        if (Array.isArray(items)) {\r\n          const item = items.find((i: any) => i.id === id || `${category}-${i.key}` === id);\r\n          if (item) {\r\n            foundConfig = {\r\n              id: item.id || `${category}-${item.key}`,\r\n              key: item.key,\r\n              value: item.value,\r\n              category: category as ConfigCategory,\r\n              valueType: item.valueType,\r\n              description: item.description,\r\n              isPublic: item.isPublic ?? false,\r\n              isEditable: item.isEditable ?? true,\r\n              requiresRestart: item.requiresRestart ?? false,\r\n              scope: item.scope || 'SYSTEM',\r\n              createdAt: item.createdAt || new Date().toISOString(),\r\n              updatedAt: item.updatedAt || new Date().toISOString(),\r\n            };\r\n          }\r\n        }\r\n      });\r\n    }\r\n    \r\n    if (!foundConfig) {\r\n      throw new Error(`Configuration with id ${id} not found`);\r\n    }\r\n    \r\n    return { data: foundConfig };\r\n  },\r\n\r\n  async create(data: ConfigurationData) {\r\n    const response = await apiActions.administration.setConfiguration(data);\r\n    return { data: response.data };\r\n  },\r\n\r\n  async update(id: string, data: ConfigurationData) {\r\n    const response = await apiActions.administration.setConfiguration({ ...data, id });\r\n    return { data: response.data };\r\n  },\r\n\r\n  async delete(id: string) {\r\n    // Settings typically aren't deleted, but we can mark them as inactive\r\n    // For now, just return success\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n// Create the settings slice using the factory\r\nconst settingsSliceFactory = createEntitySlice<SystemConfiguration, ConfigurationData, ConfigurationData>(\r\n  'settings',\r\n  settingsApiService,\r\n  {\r\n    enableBulkOperations: false,\r\n  }\r\n);\r\n\r\n// Export the slice and its components\r\nexport const settingsSlice = settingsSliceFactory.slice;\r\nexport const settingsReducer = settingsSlice.reducer;\r\nexport const settingsActions = settingsSliceFactory.actions;\r\nexport const settingsSelectors = settingsSliceFactory.adapter.getSelectors((state: RootState) => state.settings);\r\nexport const settingsThunks = settingsSliceFactory.thunks;\r\n\r\n// Export custom selectors\r\nexport const selectSettingsByCategory = (state: RootState, category: ConfigCategory): SystemConfiguration[] => {\r\n  const allSettings = settingsSelectors.selectAll(state) as SystemConfiguration[];\r\n  return allSettings.filter(setting => setting.category === category);\r\n};\r\n\r\nexport const selectPublicSettings = (state: RootState): SystemConfiguration[] => {\r\n  const allSettings = settingsSelectors.selectAll(state) as SystemConfiguration[];\r\n  return allSettings.filter(setting => setting.isPublic);\r\n};\r\n\r\nexport const selectEditableSettings = (state: RootState): SystemConfiguration[] => {\r\n  const allSettings = settingsSelectors.selectAll(state) as SystemConfiguration[];\r\n  return allSettings.filter(setting => setting.isEditable);\r\n};\r\n\r\nexport const selectSettingByKey = (state: RootState, key: string): SystemConfiguration | undefined => {\r\n  const allSettings = settingsSelectors.selectAll(state) as SystemConfiguration[];\r\n  return allSettings.find(setting => setting.key === key);\r\n};\r\n\r\nexport const selectSettingValue = (state: RootState, key: string): string | undefined => {\r\n  const setting = selectSettingByKey(state, key);\r\n  return setting?.value;\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 11751, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/services/configurationApi.ts"],"sourcesContent":["/**\r\n * WF-COMP-254 | configurationApi.ts - React component or utility module\r\n * Purpose: react component or utility module\r\n * Upstream: ./api | Dependencies: ./api\r\n * Downstream: Components, pages, app routing | Called by: React component tree\r\n * Related: Other components, hooks, services, types\r\n * Exports: constants, interfaces | Key Features: Standard module\r\n * Last Updated: 2025-10-17 | File Type: .ts\r\n * Critical Path: Component mount â†’ Render â†’ User interaction â†’ State updates\r\n * LLM Context: react component or utility module, part of React frontend architecture\r\n */\r\n\r\nimport { apiInstance } from './config/apiConfig';\r\n\r\nexport interface SystemConfiguration {\r\n  id: string;\r\n  key: string;\r\n  value: string;\r\n  valueType: string;\r\n  category: string;\r\n  subCategory?: string;\r\n  description?: string;\r\n  defaultValue?: string;\r\n  validValues?: string[];\r\n  minValue?: number;\r\n  maxValue?: number;\r\n  isPublic: boolean;\r\n  isEditable: boolean;\r\n  requiresRestart: boolean;\r\n  scope: string;\r\n  scopeId?: string;\r\n  tags: string[];\r\n  sortOrder: number;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface ConfigurationHistory {\r\n  id: string;\r\n  configKey: string;\r\n  oldValue: string | null;\r\n  newValue: string;\r\n  changedBy: string;\r\n  changedByName?: string;\r\n  changeReason?: string;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n  createdAt: string;\r\n  configuration?: {\r\n    key: string;\r\n    category: string;\r\n    description?: string;\r\n  };\r\n}\r\n\r\nexport interface ConfigurationFilter {\r\n  category?: string;\r\n  subCategory?: string;\r\n  scope?: string;\r\n  scopeId?: string;\r\n  tags?: string | string[];\r\n  isPublic?: boolean;\r\n  isEditable?: boolean;\r\n}\r\n\r\nexport interface ConfigurationUpdate {\r\n  value: string;\r\n  changeReason?: string;\r\n  scopeId?: string;\r\n}\r\n\r\nexport interface BulkUpdateItem {\r\n  key: string;\r\n  value: string;\r\n  scopeId?: string;\r\n}\r\n\r\nexport interface BulkUpdatePayload {\r\n  updates: BulkUpdateItem[];\r\n  changeReason?: string;\r\n}\r\n\r\nexport interface CreateConfigurationPayload {\r\n  key: string;\r\n  value: string;\r\n  valueType: string;\r\n  category: string;\r\n  subCategory?: string;\r\n  description?: string;\r\n  defaultValue?: string;\r\n  validValues?: string[];\r\n  minValue?: number;\r\n  maxValue?: number;\r\n  isPublic?: boolean;\r\n  isEditable?: boolean;\r\n  requiresRestart?: boolean;\r\n  scope?: string;\r\n  scopeId?: string;\r\n  tags?: string[];\r\n  sortOrder?: number;\r\n}\r\n\r\nexport interface ImportConfigurationsPayload {\r\n  configurations: string;\r\n  overwrite?: boolean;\r\n}\r\n\r\nexport const configurationApi = {\r\n  /**\r\n   * Get all configurations with optional filtering\r\n   */\r\n  getAll: async (filter?: ConfigurationFilter) => {\r\n    const params = new URLSearchParams();\r\n    if (filter) {\r\n      Object.entries(filter).forEach(([key, value]) => {\r\n        if (value !== undefined && value !== null) {\r\n          if (Array.isArray(value)) {\r\n            value.forEach(v => params.append(key, v));\r\n          } else {\r\n            params.append(key, String(value));\r\n          }\r\n        }\r\n      });\r\n    }\r\n    const queryString = params.toString();\r\n    const response = await apiInstance.get(`/configurations${queryString ? `?${queryString}` : ''}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get public configurations (no auth required)\r\n   */\r\n  getPublic: async () => {\r\n    const response = await apiInstance.get('/configurations/public');\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get a specific configuration by key\r\n   */\r\n  getByKey: async (key: string, scopeId?: string) => {\r\n    const params = scopeId ? `?scopeId=${scopeId}` : '';\r\n    const response = await apiInstance.get(`/configurations/${key}${params}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get configurations by category\r\n   */\r\n  getByCategory: async (category: string, scopeId?: string) => {\r\n    const params = scopeId ? `?scopeId=${scopeId}` : '';\r\n    const response = await apiInstance.get(`/configurations/category/${category}${params}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Update a configuration value\r\n   */\r\n  update: async (key: string, data: ConfigurationUpdate) => {\r\n    const response = await apiInstance.put(`/configurations/${key}`, data);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Bulk update configurations\r\n   */\r\n  bulkUpdate: async (data: BulkUpdatePayload) => {\r\n    const response = await apiInstance.put('/configurations/bulk', data);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Create a new configuration\r\n   */\r\n  create: async (data: CreateConfigurationPayload) => {\r\n    const response = await apiInstance.post('/configurations', data);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Delete a configuration\r\n   */\r\n  delete: async (key: string, scopeId?: string) => {\r\n    const params = scopeId ? `?scopeId=${scopeId}` : '';\r\n    const response = await apiInstance.delete(`/configurations/${key}${params}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Reset configuration to default value\r\n   */\r\n  resetToDefault: async (key: string, scopeId?: string) => {\r\n    const params = scopeId ? `?scopeId=${scopeId}` : '';\r\n    const response = await apiInstance.post(`/configurations/${key}/reset${params}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get configuration change history\r\n   */\r\n  getHistory: async (key: string, limit: number = 50) => {\r\n    const response = await apiInstance.get(`/configurations/${key}/history?limit=${limit}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get recent configuration changes\r\n   */\r\n  getRecentChanges: async (limit: number = 100) => {\r\n    const response = await apiInstance.get(`/configurations/history/recent?limit=${limit}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Get configuration changes by user\r\n   */\r\n  getChangesByUser: async (userId: string, limit: number = 50) => {\r\n    const response = await apiInstance.get(`/configurations/history/user/${userId}?limit=${limit}`);\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Export configurations as JSON\r\n   */\r\n  export: async (filter?: { category?: string; scope?: string }) => {\r\n    const params = new URLSearchParams();\r\n    if (filter?.category) params.append('category', filter.category);\r\n    if (filter?.scope) params.append('scope', filter.scope);\r\n    const queryString = params.toString();\r\n    const response = await apiInstance.get(`/configurations/export${queryString ? `?${queryString}` : ''}`, {\r\n      responseType: 'blob'\r\n    });\r\n    return response.data;\r\n  },\r\n\r\n  /**\r\n   * Import configurations from JSON\r\n   */\r\n  import: async (data: ImportConfigurationsPayload) => {\r\n    const response = await apiInstance.post('/configurations/import', data);\r\n    return response.data;\r\n  }\r\n};\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;CAUC;;;;AAED;;AA+FO,MAAM,mBAAmB;IAC9B;;GAEC,GACD,QAAQ,OAAO;QACb,MAAM,SAAS,IAAI;QACnB,IAAI,QAAQ;YACV,OAAO,OAAO,CAAC,QAAQ,OAAO,CAAC,CAAC,CAAC,KAAK,MAAM;gBAC1C,IAAI,UAAU,aAAa,UAAU,MAAM;oBACzC,IAAI,MAAM,OAAO,CAAC,QAAQ;wBACxB,MAAM,OAAO,CAAC,CAAA,IAAK,OAAO,MAAM,CAAC,KAAK;oBACxC,OAAO;wBACL,OAAO,MAAM,CAAC,KAAK,OAAO;oBAC5B;gBACF;YACF;QACF;QACA,MAAM,cAAc,OAAO,QAAQ;QACnC,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC,EAAE,aAAa,GAAG,IAAI;QAC/F,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,WAAW;QACT,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC;QACvC,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,UAAU,OAAO,KAAa;QAC5B,MAAM,SAAS,UAAU,CAAC,SAAS,EAAE,SAAS,GAAG;QACjD,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,MAAM,QAAQ;QACxE,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,eAAe,OAAO,UAAkB;QACtC,MAAM,SAAS,UAAU,CAAC,SAAS,EAAE,SAAS,GAAG;QACjD,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,yBAAyB,EAAE,WAAW,QAAQ;QACtF,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,QAAQ,OAAO,KAAa;QAC1B,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,KAAK,EAAE;QACjE,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,YAAY,OAAO;QACjB,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,wBAAwB;QAC/D,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,QAAQ,OAAO;QACb,MAAM,WAAW,MAAM,qKAAW,CAAC,IAAI,CAAC,mBAAmB;QAC3D,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,QAAQ,OAAO,KAAa;QAC1B,MAAM,SAAS,UAAU,CAAC,SAAS,EAAE,SAAS,GAAG;QACjD,MAAM,WAAW,MAAM,qKAAW,CAAC,MAAM,CAAC,CAAC,gBAAgB,EAAE,MAAM,QAAQ;QAC3E,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,gBAAgB,OAAO,KAAa;QAClC,MAAM,SAAS,UAAU,CAAC,SAAS,EAAE,SAAS,GAAG;QACjD,MAAM,WAAW,MAAM,qKAAW,CAAC,IAAI,CAAC,CAAC,gBAAgB,EAAE,IAAI,MAAM,EAAE,QAAQ;QAC/E,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,YAAY,OAAO,KAAa,QAAgB,EAAE;QAChD,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,IAAI,eAAe,EAAE,OAAO;QACtF,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,kBAAkB,OAAO,QAAgB,GAAG;QAC1C,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,qCAAqC,EAAE,OAAO;QACtF,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,kBAAkB,OAAO,QAAgB,QAAgB,EAAE;QACzD,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,6BAA6B,EAAE,OAAO,OAAO,EAAE,OAAO;QAC9F,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,QAAQ,OAAO;QACb,MAAM,SAAS,IAAI;QACnB,IAAI,QAAQ,UAAU,OAAO,MAAM,CAAC,YAAY,OAAO,QAAQ;QAC/D,IAAI,QAAQ,OAAO,OAAO,MAAM,CAAC,SAAS,OAAO,KAAK;QACtD,MAAM,cAAc,OAAO,QAAQ;QACnC,MAAM,WAAW,MAAM,qKAAW,CAAC,GAAG,CAAC,CAAC,sBAAsB,EAAE,cAAc,CAAC,CAAC,EAAE,aAAa,GAAG,IAAI,EAAE;YACtG,cAAc;QAChB;QACA,OAAO,SAAS,IAAI;IACtB;IAEA;;GAEC,GACD,QAAQ,OAAO;QACb,MAAM,WAAW,MAAM,qKAAW,CAAC,IAAI,CAAC,0BAA0B;QAClE,OAAO,SAAS,IAAI;IACtB;AACF","debugId":null}},
    {"offset": {"line": 11880, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/configurationSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview System Configuration Management Redux Slice\r\n * \r\n * This slice manages comprehensive system configuration functionality for the healthcare management\r\n * system, including application settings, user preferences, organizational policies, clinical\r\n * workflows, security parameters, and integration configurations. Designed specifically for\r\n * healthcare environments with complex configuration hierarchies and compliance requirements.\r\n * \r\n * Key Features:\r\n * - Hierarchical configuration management (Global â†’ Organization â†’ Department â†’ User)\r\n * - Real-time configuration updates with hot-reload capabilities\r\n * - Configuration versioning and rollback functionality\r\n * - Audit trail for all configuration changes\r\n * - Role-based configuration access control\r\n * - Configuration validation and schema enforcement\r\n * - Import/export capabilities for system migration\r\n * - Environment-specific configuration management\r\n * - Configuration templates for quick deployment\r\n * - HIPAA-compliant configuration handling for PHI-related settings\r\n * \r\n * Healthcare Configuration Categories:\r\n * - Clinical Workflows: Treatment protocols, care pathways, clinical decision support\r\n * - Security Settings: Authentication, authorization, encryption, audit policies\r\n * - Integration Config: EMR systems, lab interfaces, billing systems, pharmacy\r\n * - User Interface: Theme preferences, layout settings, accessibility options\r\n * - Compliance Rules: HIPAA policies, state regulations, quality measures\r\n * - Notification Settings: Alert thresholds, escalation procedures, communication preferences\r\n * - Reporting Config: Dashboard layouts, report templates, data retention policies\r\n * - System Parameters: Performance tuning, resource limits, backup schedules\r\n * \r\n * HIPAA Compliance Features:\r\n * - Configuration access logging for audit trails\r\n * - PHI-related configuration encryption at rest\r\n * - Role-based access to sensitive configuration areas\r\n * - Automatic configuration backup with retention policies\r\n * - Configuration change approval workflows for critical settings\r\n * - Emergency configuration override capabilities\r\n * - Configuration integrity monitoring and validation\r\n * \r\n * Configuration Hierarchy:\r\n * - System Level: Core application settings, security policies\r\n * - Organization Level: Institution-specific policies, branding\r\n * - Department Level: Unit-specific workflows, resource allocation\r\n * - User Level: Personal preferences, dashboard customization\r\n * - Role Level: Role-specific default configurations\r\n * \r\n * Performance Optimizations:\r\n * - Configuration caching with intelligent invalidation\r\n * - Lazy loading of configuration sections\r\n * - Optimistic updates for non-critical configurations\r\n * - Background synchronization of configuration changes\r\n * - Configuration bundling for reduced API calls\r\n * - Client-side configuration validation\r\n * \r\n * @example\r\n * // Basic configuration management\r\n * const dispatch = useAppDispatch();\r\n * \r\n * // Fetch all configurations\r\n * dispatch(fetchConfigurations({\r\n *   category: 'clinical_workflows',\r\n *   scope: 'department',\r\n *   scopeId: 'cardiology'\r\n * }));\r\n * \r\n * // Update a specific configuration\r\n * dispatch(updateConfiguration({\r\n *   key: 'medication_alert_threshold',\r\n *   data: {\r\n *     value: '72',\r\n *     description: 'Hours before medication expiry alert',\r\n *     requiresRestart: false\r\n *   }\r\n * }));\r\n * \r\n * @example\r\n * // Configuration filtering and search\r\n * // Set filters for configuration management\r\n * dispatch(setFilters({\r\n *   category: 'security',\r\n *   searchTerm: 'password',\r\n *   isEditable: true\r\n * }));\r\n * \r\n * // Get filtered configurations\r\n * const filteredConfigs = useAppSelector(selectFilteredConfigurations);\r\n * \r\n * @example\r\n * // Bulk configuration operations\r\n * // Bulk update multiple configurations\r\n * dispatch(bulkUpdateConfigurations({\r\n *   updates: [\r\n *     { key: 'session_timeout', value: '30' },\r\n *     { key: 'password_complexity', value: 'high' },\r\n *     { key: 'mfa_required', value: 'true' }\r\n *   ],\r\n *   reason: 'Security policy update Q4 2024'\r\n * }));\r\n * \r\n * // Export configurations for backup\r\n * dispatch(exportConfigurations({\r\n *   category: 'clinical_workflows',\r\n *   scope: 'organization'\r\n * }));\r\n * \r\n * @example\r\n * // Configuration history and audit\r\n * // View configuration history\r\n * dispatch(fetchConfigurationHistory({\r\n *   key: 'patient_chart_timeout',\r\n *   limit: 50\r\n * }));\r\n * \r\n * // View recent changes across system\r\n * dispatch(fetchRecentChanges(25));\r\n * \r\n * // Reset configuration to default\r\n * dispatch(resetConfigurationToDefault({\r\n *   key: 'dashboard_layout',\r\n *   scopeId: 'user_123'\r\n * }));\r\n * \r\n * @example\r\n * // Advanced configuration selectors\r\n * // Get configurations by category\r\n * const clinicalConfigs = useAppSelector(selectConfigurationsByCategory).clinical_workflows;\r\n * \r\n * // Get editable configurations only\r\n * const editableConfigs = useAppSelector(selectEditableConfigurations);\r\n * \r\n * // Get configurations requiring restart\r\n * const restartRequired = useAppSelector(selectConfigurationsRequiringRestart);\r\n * \r\n * Integration Points:\r\n * - User Management System: User-specific configuration preferences\r\n * - Security Service: Authentication and authorization settings\r\n * - Audit Logging: Configuration change tracking and compliance\r\n * - EMR Integration: Clinical workflow and data exchange settings\r\n * - Notification Service: Alert and messaging configuration\r\n * - Backup Service: Configuration backup and restore procedures\r\n * - Template Engine: Configuration-driven UI customization\r\n * \r\n * Security Considerations:\r\n * - Sensitive configurations encrypted at rest and in transit\r\n * - Role-based access control for configuration categories\r\n * - Configuration change approval workflows for critical settings\r\n * - Audit logging for all configuration access and modifications\r\n * - Configuration validation to prevent security misconfigurations\r\n * - Emergency override capabilities with detailed justification\r\n * \r\n * Clinical Workflow Integration:\r\n * - Care pathway configuration management\r\n * - Clinical decision support rule configuration\r\n * - Treatment protocol customization\r\n * - Quality measure and reporting configuration\r\n * - Clinical alert and notification thresholds\r\n * - Patient flow and scheduling parameters\r\n * \r\n * Compliance and Audit:\r\n * - HIPAA-compliant configuration management\r\n * - Audit trail for all configuration changes\r\n * - Configuration backup and retention policies\r\n * - Regulatory compliance reporting\r\n * - Configuration validation against compliance rules\r\n * - Change management workflows for critical configurations\r\n * \r\n * @author [Your Organization] - Healthcare IT Configuration Team\r\n * @version 2.1.0\r\n * @since 2024-01-15\r\n * @see {@link https://your-docs.com/configuration-management} Configuration Management Guide\r\n * @see {@link https://your-docs.com/system-administration} System Administration Documentation  \r\n * @see {@link https://your-docs.com/compliance-configuration} Compliance Configuration Guide\r\n */\r\n\r\nimport { createSlice, createAsyncThunk, createSelector, PayloadAction } from '@reduxjs/toolkit';\r\nimport { configurationApi } from '@/services/configurationApi';\r\nimport type {\r\n  SystemConfiguration,\r\n  ConfigurationHistory,\r\n  ConfigurationFilter,\r\n  ConfigurationUpdate,\r\n  CreateConfigurationPayload,\r\n  BulkUpdatePayload,\r\n  ImportConfigurationsPayload,\r\n} from '../../services/configurationApi';\r\n\r\n// Service Adapter Class\r\nexport class ConfigurationApiService {\r\n  // Configuration management\r\n  async getConfigurations(filter?: ConfigurationFilter) {\r\n    return await configurationApi.getAll(filter);\r\n  }\r\n\r\n  async getPublicConfigurations() {\r\n    return await configurationApi.getPublic();\r\n  }\r\n\r\n  async getConfigurationByKey(key: string, scopeId?: string) {\r\n    return await configurationApi.getByKey(key, scopeId);\r\n  }\r\n\r\n  async getConfigurationsByCategory(category: string, scopeId?: string) {\r\n    return await configurationApi.getByCategory(category, scopeId);\r\n  }\r\n\r\n  async updateConfiguration(key: string, data: ConfigurationUpdate) {\r\n    return await configurationApi.update(key, data);\r\n  }\r\n\r\n  async bulkUpdateConfigurations(data: BulkUpdatePayload) {\r\n    return await configurationApi.bulkUpdate(data);\r\n  }\r\n\r\n  async createConfiguration(data: CreateConfigurationPayload) {\r\n    return await configurationApi.create(data);\r\n  }\r\n\r\n  async deleteConfiguration(key: string, scopeId?: string) {\r\n    return await configurationApi.delete(key, scopeId);\r\n  }\r\n\r\n  async resetConfigurationToDefault(key: string, scopeId?: string) {\r\n    return await configurationApi.resetToDefault(key, scopeId);\r\n  }\r\n\r\n  // History and audit\r\n  async getConfigurationHistory(key: string, limit?: number) {\r\n    return await configurationApi.getHistory(key, limit);\r\n  }\r\n\r\n  async getRecentChanges(limit?: number) {\r\n    return await configurationApi.getRecentChanges(limit);\r\n  }\r\n\r\n  async getChangesByUser(userId: string, limit?: number) {\r\n    return await configurationApi.getChangesByUser(userId, limit);\r\n  }\r\n\r\n  // Import/Export\r\n  async exportConfigurations(filter?: { category?: string; scope?: string }) {\r\n    return await configurationApi.export(filter);\r\n  }\r\n\r\n  async importConfigurations(data: ImportConfigurationsPayload) {\r\n    return await configurationApi.import(data);\r\n  }\r\n}\r\n\r\n// Create service instance\r\nconst configurationService = new ConfigurationApiService();\r\n\r\n// State interface\r\ninterface ConfigurationState {\r\n  configurations: SystemConfiguration[];\r\n  publicConfigurations: SystemConfiguration[];\r\n  currentConfiguration: SystemConfiguration | null;\r\n  history: ConfigurationHistory[];\r\n  recentChanges: ConfigurationHistory[];\r\n  categories: string[];\r\n  selectedConfigurations: string[];\r\n  filters: {\r\n    category: string | null;\r\n    subCategory: string | null;\r\n    scope: string | null;\r\n    scopeId: string | null;\r\n    tags: string[];\r\n    isPublic: boolean | null;\r\n    isEditable: boolean | null;\r\n    searchTerm: string;\r\n  };\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n  historyPagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n  };\r\n  loading: {\r\n    configurations: boolean;\r\n    publicConfigurations: boolean;\r\n    currentConfiguration: boolean;\r\n    history: boolean;\r\n    recentChanges: boolean;\r\n    update: boolean;\r\n    bulkUpdate: boolean;\r\n    create: boolean;\r\n    delete: boolean;\r\n    reset: boolean;\r\n    export: boolean;\r\n    import: boolean;\r\n  };\r\n  error: {\r\n    configurations: string | null;\r\n    publicConfigurations: string | null;\r\n    currentConfiguration: string | null;\r\n    history: string | null;\r\n    recentChanges: string | null;\r\n    update: string | null;\r\n    bulkUpdate: string | null;\r\n    create: string | null;\r\n    delete: string | null;\r\n    reset: string | null;\r\n    export: string | null;\r\n    import: string | null;\r\n  };\r\n}\r\n\r\n// Initial state\r\nconst initialState: ConfigurationState = {\r\n  configurations: [],\r\n  publicConfigurations: [],\r\n  currentConfiguration: null,\r\n  history: [],\r\n  recentChanges: [],\r\n  categories: [],\r\n  selectedConfigurations: [],\r\n  filters: {\r\n    category: null,\r\n    subCategory: null,\r\n    scope: null,\r\n    scopeId: null,\r\n    tags: [],\r\n    isPublic: null,\r\n    isEditable: null,\r\n    searchTerm: '',\r\n  },\r\n  pagination: {\r\n    page: 1,\r\n    limit: 50,\r\n    total: 0,\r\n    totalPages: 0,\r\n  },\r\n  historyPagination: {\r\n    page: 1,\r\n    limit: 25,\r\n    total: 0,\r\n    totalPages: 0,\r\n  },\r\n  loading: {\r\n    configurations: false,\r\n    publicConfigurations: false,\r\n    currentConfiguration: false,\r\n    history: false,\r\n    recentChanges: false,\r\n    update: false,\r\n    bulkUpdate: false,\r\n    create: false,\r\n    delete: false,\r\n    reset: false,\r\n    export: false,\r\n    import: false,\r\n  },\r\n  error: {\r\n    configurations: null,\r\n    publicConfigurations: null,\r\n    currentConfiguration: null,\r\n    history: null,\r\n    recentChanges: null,\r\n    update: null,\r\n    bulkUpdate: null,\r\n    create: null,\r\n    delete: null,\r\n    reset: null,\r\n    export: null,\r\n    import: null,\r\n  },\r\n};\r\n\r\n// Async thunks\r\nexport const fetchConfigurations = createAsyncThunk(\r\n  'configuration/fetchConfigurations',\r\n  async (filter?: ConfigurationFilter) => {\r\n    const response = await configurationService.getConfigurations(filter);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchPublicConfigurations = createAsyncThunk(\r\n  'configuration/fetchPublicConfigurations',\r\n  async () => {\r\n    const response = await configurationService.getPublicConfigurations();\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchConfigurationByKey = createAsyncThunk(\r\n  'configuration/fetchConfigurationByKey',\r\n  async ({ key, scopeId }: { key: string; scopeId?: string }) => {\r\n    const response = await configurationService.getConfigurationByKey(key, scopeId);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchConfigurationsByCategory = createAsyncThunk(\r\n  'configuration/fetchConfigurationsByCategory',\r\n  async ({ category, scopeId }: { category: string; scopeId?: string }) => {\r\n    const response = await configurationService.getConfigurationsByCategory(category, scopeId);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const updateConfiguration = createAsyncThunk(\r\n  'configuration/updateConfiguration',\r\n  async ({ key, data }: { key: string; data: ConfigurationUpdate }) => {\r\n    const response = await configurationService.updateConfiguration(key, data);\r\n    return { key, ...response };\r\n  }\r\n);\r\n\r\nexport const bulkUpdateConfigurations = createAsyncThunk(\r\n  'configuration/bulkUpdateConfigurations',\r\n  async (data: BulkUpdatePayload) => {\r\n    const response = await configurationService.bulkUpdateConfigurations(data);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const createConfiguration = createAsyncThunk(\r\n  'configuration/createConfiguration',\r\n  async (data: CreateConfigurationPayload) => {\r\n    const response = await configurationService.createConfiguration(data);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const deleteConfiguration = createAsyncThunk(\r\n  'configuration/deleteConfiguration',\r\n  async ({ key, scopeId }: { key: string; scopeId?: string }) => {\r\n    await configurationService.deleteConfiguration(key, scopeId);\r\n    return { key, scopeId };\r\n  }\r\n);\r\n\r\nexport const resetConfigurationToDefault = createAsyncThunk(\r\n  'configuration/resetConfigurationToDefault',\r\n  async ({ key, scopeId }: { key: string; scopeId?: string }) => {\r\n    const response = await configurationService.resetConfigurationToDefault(key, scopeId);\r\n    return { key, ...response };\r\n  }\r\n);\r\n\r\nexport const fetchConfigurationHistory = createAsyncThunk(\r\n  'configuration/fetchConfigurationHistory',\r\n  async ({ key, limit }: { key: string; limit?: number }) => {\r\n    const response = await configurationService.getConfigurationHistory(key, limit);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchRecentChanges = createAsyncThunk(\r\n  'configuration/fetchRecentChanges',\r\n  async (limit?: number) => {\r\n    const response = await configurationService.getRecentChanges(limit);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchChangesByUser = createAsyncThunk(\r\n  'configuration/fetchChangesByUser',\r\n  async ({ userId, limit }: { userId: string; limit?: number }) => {\r\n    const response = await configurationService.getChangesByUser(userId, limit);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const exportConfigurations = createAsyncThunk(\r\n  'configuration/exportConfigurations',\r\n  async (filter?: { category?: string; scope?: string }) => {\r\n    const response = await configurationService.exportConfigurations(filter);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const importConfigurations = createAsyncThunk(\r\n  'configuration/importConfigurations',\r\n  async (data: ImportConfigurationsPayload) => {\r\n    const response = await configurationService.importConfigurations(data);\r\n    return response;\r\n  }\r\n);\r\n\r\n// Slice\r\nconst configurationSlice = createSlice({\r\n  name: 'configuration',\r\n  initialState,\r\n  reducers: {\r\n    clearCurrentConfiguration: (state) => {\r\n      state.currentConfiguration = null;\r\n      state.error.currentConfiguration = null;\r\n    },\r\n    setFilters: (state, action: PayloadAction<Partial<ConfigurationState['filters']>>) => {\r\n      state.filters = { ...state.filters, ...action.payload };\r\n      state.pagination.page = 1; // Reset pagination when filters change\r\n    },\r\n    setPagination: (state, action: PayloadAction<Partial<ConfigurationState['pagination']>>) => {\r\n      state.pagination = { ...state.pagination, ...action.payload };\r\n    },\r\n    setHistoryPagination: (state, action: PayloadAction<Partial<ConfigurationState['historyPagination']>>) => {\r\n      state.historyPagination = { ...state.historyPagination, ...action.payload };\r\n    },\r\n    toggleConfigurationSelection: (state, action: PayloadAction<string>) => {\r\n      const key = action.payload;\r\n      const index = state.selectedConfigurations.indexOf(key);\r\n      if (index > -1) {\r\n        state.selectedConfigurations.splice(index, 1);\r\n      } else {\r\n        state.selectedConfigurations.push(key);\r\n      }\r\n    },\r\n    selectAllConfigurations: (state) => {\r\n      state.selectedConfigurations = state.configurations.map(c => c.key);\r\n    },\r\n    clearSelection: (state) => {\r\n      state.selectedConfigurations = [];\r\n    },\r\n    clearErrors: (state) => {\r\n      state.error = {\r\n        configurations: null,\r\n        publicConfigurations: null,\r\n        currentConfiguration: null,\r\n        history: null,\r\n        recentChanges: null,\r\n        update: null,\r\n        bulkUpdate: null,\r\n        create: null,\r\n        delete: null,\r\n        reset: null,\r\n        export: null,\r\n        import: null,\r\n      };\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    // Fetch configurations\r\n    builder\r\n      .addCase(fetchConfigurations.pending, (state) => {\r\n        state.loading.configurations = true;\r\n        state.error.configurations = null;\r\n      })\r\n      .addCase(fetchConfigurations.fulfilled, (state, action) => {\r\n        state.loading.configurations = false;\r\n        state.configurations = action.payload.data || [];\r\n        state.categories = [...new Set(state.configurations.map(c => c.category))].sort();\r\n        state.pagination.total = action.payload.total || state.configurations.length;\r\n        state.pagination.totalPages = Math.ceil(state.pagination.total / state.pagination.limit);\r\n      })\r\n      .addCase(fetchConfigurations.rejected, (state, action) => {\r\n        state.loading.configurations = false;\r\n        state.error.configurations = action.error.message || 'Failed to fetch configurations';\r\n      });\r\n\r\n    // Fetch public configurations\r\n    builder\r\n      .addCase(fetchPublicConfigurations.pending, (state) => {\r\n        state.loading.publicConfigurations = true;\r\n        state.error.publicConfigurations = null;\r\n      })\r\n      .addCase(fetchPublicConfigurations.fulfilled, (state, action) => {\r\n        state.loading.publicConfigurations = false;\r\n        state.publicConfigurations = action.payload.data || [];\r\n      })\r\n      .addCase(fetchPublicConfigurations.rejected, (state, action) => {\r\n        state.loading.publicConfigurations = false;\r\n        state.error.publicConfigurations = action.error.message || 'Failed to fetch public configurations';\r\n      });\r\n\r\n    // Fetch configuration by key\r\n    builder\r\n      .addCase(fetchConfigurationByKey.pending, (state) => {\r\n        state.loading.currentConfiguration = true;\r\n        state.error.currentConfiguration = null;\r\n      })\r\n      .addCase(fetchConfigurationByKey.fulfilled, (state, action) => {\r\n        state.loading.currentConfiguration = false;\r\n        state.currentConfiguration = action.payload.data;\r\n      })\r\n      .addCase(fetchConfigurationByKey.rejected, (state, action) => {\r\n        state.loading.currentConfiguration = false;\r\n        state.error.currentConfiguration = action.error.message || 'Failed to fetch configuration';\r\n      });\r\n\r\n    // Update configuration\r\n    builder\r\n      .addCase(updateConfiguration.pending, (state) => {\r\n        state.loading.update = true;\r\n        state.error.update = null;\r\n      })\r\n      .addCase(updateConfiguration.fulfilled, (state, action) => {\r\n        state.loading.update = false;\r\n        const index = state.configurations.findIndex(c => c.key === action.payload.key);\r\n        if (index > -1 && action.payload.data) {\r\n          state.configurations[index] = action.payload.data;\r\n        }\r\n        if (state.currentConfiguration?.key === action.payload.key && action.payload.data) {\r\n          state.currentConfiguration = action.payload.data;\r\n        }\r\n      })\r\n      .addCase(updateConfiguration.rejected, (state, action) => {\r\n        state.loading.update = false;\r\n        state.error.update = action.error.message || 'Failed to update configuration';\r\n      });\r\n\r\n    // Create configuration\r\n    builder\r\n      .addCase(createConfiguration.pending, (state) => {\r\n        state.loading.create = true;\r\n        state.error.create = null;\r\n      })\r\n      .addCase(createConfiguration.fulfilled, (state, action) => {\r\n        state.loading.create = false;\r\n        if (action.payload.data) {\r\n          state.configurations.push(action.payload.data);\r\n          state.pagination.total += 1;\r\n        }\r\n      })\r\n      .addCase(createConfiguration.rejected, (state, action) => {\r\n        state.loading.create = false;\r\n        state.error.create = action.error.message || 'Failed to create configuration';\r\n      });\r\n\r\n    // Delete configuration\r\n    builder\r\n      .addCase(deleteConfiguration.pending, (state) => {\r\n        state.loading.delete = true;\r\n        state.error.delete = null;\r\n      })\r\n      .addCase(deleteConfiguration.fulfilled, (state, action) => {\r\n        state.loading.delete = false;\r\n        state.configurations = state.configurations.filter(c => c.key !== action.payload.key);\r\n        state.pagination.total = Math.max(0, state.pagination.total - 1);\r\n        if (state.currentConfiguration?.key === action.payload.key) {\r\n          state.currentConfiguration = null;\r\n        }\r\n      })\r\n      .addCase(deleteConfiguration.rejected, (state, action) => {\r\n        state.loading.delete = false;\r\n        state.error.delete = action.error.message || 'Failed to delete configuration';\r\n      });\r\n\r\n    // Fetch configuration history\r\n    builder\r\n      .addCase(fetchConfigurationHistory.pending, (state) => {\r\n        state.loading.history = true;\r\n        state.error.history = null;\r\n      })\r\n      .addCase(fetchConfigurationHistory.fulfilled, (state, action) => {\r\n        state.loading.history = false;\r\n        state.history = action.payload.data || [];\r\n        state.historyPagination.total = action.payload.total || state.history.length;\r\n        state.historyPagination.totalPages = Math.ceil(state.historyPagination.total / state.historyPagination.limit);\r\n      })\r\n      .addCase(fetchConfigurationHistory.rejected, (state, action) => {\r\n        state.loading.history = false;\r\n        state.error.history = action.error.message || 'Failed to fetch configuration history';\r\n      });\r\n\r\n    // Fetch recent changes\r\n    builder\r\n      .addCase(fetchRecentChanges.pending, (state) => {\r\n        state.loading.recentChanges = true;\r\n        state.error.recentChanges = null;\r\n      })\r\n      .addCase(fetchRecentChanges.fulfilled, (state, action) => {\r\n        state.loading.recentChanges = false;\r\n        state.recentChanges = action.payload.data || [];\r\n      })\r\n      .addCase(fetchRecentChanges.rejected, (state, action) => {\r\n        state.loading.recentChanges = false;\r\n        state.error.recentChanges = action.error.message || 'Failed to fetch recent changes';\r\n      });\r\n\r\n    // Bulk update\r\n    builder\r\n      .addCase(bulkUpdateConfigurations.pending, (state) => {\r\n        state.loading.bulkUpdate = true;\r\n        state.error.bulkUpdate = null;\r\n      })\r\n      .addCase(bulkUpdateConfigurations.fulfilled, (state, action) => {\r\n        state.loading.bulkUpdate = false;\r\n        // Refresh configurations after bulk update\r\n        state.selectedConfigurations = [];\r\n      })\r\n      .addCase(bulkUpdateConfigurations.rejected, (state, action) => {\r\n        state.loading.bulkUpdate = false;\r\n        state.error.bulkUpdate = action.error.message || 'Failed to bulk update configurations';\r\n      });\r\n\r\n    // Export configurations\r\n    builder\r\n      .addCase(exportConfigurations.pending, (state) => {\r\n        state.loading.export = true;\r\n        state.error.export = null;\r\n      })\r\n      .addCase(exportConfigurations.fulfilled, (state, action) => {\r\n        state.loading.export = false;\r\n      })\r\n      .addCase(exportConfigurations.rejected, (state, action) => {\r\n        state.loading.export = false;\r\n        state.error.export = action.error.message || 'Failed to export configurations';\r\n      });\r\n\r\n    // Import configurations\r\n    builder\r\n      .addCase(importConfigurations.pending, (state) => {\r\n        state.loading.import = true;\r\n        state.error.import = null;\r\n      })\r\n      .addCase(importConfigurations.fulfilled, (state, action) => {\r\n        state.loading.import = false;\r\n      })\r\n      .addCase(importConfigurations.rejected, (state, action) => {\r\n        state.loading.import = false;\r\n        state.error.import = action.error.message || 'Failed to import configurations';\r\n      });\r\n  },\r\n});\r\n\r\n// Export actions\r\nexport const {\r\n  clearCurrentConfiguration,\r\n  setFilters,\r\n  setPagination,\r\n  setHistoryPagination,\r\n  toggleConfigurationSelection,\r\n  selectAllConfigurations,\r\n  clearSelection,\r\n  clearErrors,\r\n} = configurationSlice.actions;\r\n\r\n// Selectors\r\nexport const selectConfigurations = (state: { configuration: ConfigurationState }) => state.configuration.configurations;\r\nexport const selectPublicConfigurations = (state: { configuration: ConfigurationState }) => state.configuration.publicConfigurations;\r\nexport const selectCurrentConfiguration = (state: { configuration: ConfigurationState }) => state.configuration.currentConfiguration;\r\nexport const selectHistory = (state: { configuration: ConfigurationState }) => state.configuration.history;\r\nexport const selectRecentChanges = (state: { configuration: ConfigurationState }) => state.configuration.recentChanges;\r\nexport const selectCategories = (state: { configuration: ConfigurationState }) => state.configuration.categories;\r\nexport const selectSelectedConfigurations = (state: { configuration: ConfigurationState }) => state.configuration.selectedConfigurations;\r\nexport const selectFilters = (state: { configuration: ConfigurationState }) => state.configuration.filters;\r\nexport const selectPagination = (state: { configuration: ConfigurationState }) => state.configuration.pagination;\r\nexport const selectHistoryPagination = (state: { configuration: ConfigurationState }) => state.configuration.historyPagination;\r\nexport const selectLoading = (state: { configuration: ConfigurationState }) => state.configuration.loading;\r\nexport const selectErrors = (state: { configuration: ConfigurationState }) => state.configuration.error;\r\n\r\n// Advanced selectors\r\nexport const selectFilteredConfigurations = createSelector(\r\n  [selectConfigurations, selectFilters],\r\n  (configurations, filters) => {\r\n    return configurations.filter(config => {\r\n      if (filters.category && config.category !== filters.category) return false;\r\n      if (filters.subCategory && config.subCategory !== filters.subCategory) return false;\r\n      if (filters.scope && config.scope !== filters.scope) return false;\r\n      if (filters.scopeId && config.scopeId !== filters.scopeId) return false;\r\n      if (filters.isPublic !== null && config.isPublic !== filters.isPublic) return false;\r\n      if (filters.isEditable !== null && config.isEditable !== filters.isEditable) return false;\r\n      if (filters.tags.length > 0 && !filters.tags.some(tag => config.tags.includes(tag))) return false;\r\n      if (filters.searchTerm) {\r\n        const term = filters.searchTerm.toLowerCase();\r\n        return config.key.toLowerCase().includes(term) ||\r\n               config.description?.toLowerCase().includes(term) ||\r\n               config.category.toLowerCase().includes(term);\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n);\r\n\r\nexport const selectConfigurationsByCategory = createSelector(\r\n  [selectConfigurations],\r\n  (configurations) => {\r\n    const grouped: Record<string, SystemConfiguration[]> = {};\r\n    configurations.forEach(config => {\r\n      if (!grouped[config.category]) {\r\n        grouped[config.category] = [];\r\n      }\r\n      grouped[config.category].push(config);\r\n    });\r\n    return grouped;\r\n  }\r\n);\r\n\r\nexport const selectEditableConfigurations = createSelector(\r\n  [selectConfigurations],\r\n  (configurations) => configurations.filter(c => c.isEditable)\r\n);\r\n\r\nexport const selectConfigurationsRequiringRestart = createSelector(\r\n  [selectConfigurations],\r\n  (configurations) => configurations.filter(c => c.requiresRestart)\r\n);\r\n\r\nexport const selectConfigurationMetrics = createSelector(\r\n  [selectConfigurations],\r\n  (configurations) => {\r\n    const total = configurations.length;\r\n    const editable = configurations.filter(c => c.isEditable).length;\r\n    const publicCount = configurations.filter(c => c.isPublic).length;\r\n    const requiresRestart = configurations.filter(c => c.requiresRestart).length;\r\n    const categories = new Set(configurations.map(c => c.category)).size;\r\n\r\n    return {\r\n      total,\r\n      editable,\r\n      public: publicCount,\r\n      requiresRestart,\r\n      categories,\r\n    };\r\n  }\r\n);\r\n\r\nexport default configurationSlice.reducer;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 12589, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/communicationSlice.ts"],"sourcesContent":["/**\r\n * @module pages/communication/store/communicationSlice\r\n *\r\n * @description\r\n * Production-grade Redux state management for the communication and messaging system.\r\n * Manages email, SMS, and in-app messages with support for emergency broadcasts,\r\n * scheduled messaging, and multi-channel delivery tracking.\r\n *\r\n * ## Architecture\r\n *\r\n * This slice uses the entity slice factory pattern (`createEntitySlice`) for standardized\r\n * CRUD operations with normalized state management via Redux Toolkit's `EntityAdapter`.\r\n * This provides optimized entity management with built-in selectors and reducers.\r\n *\r\n * ## State Structure\r\n *\r\n * The state is normalized using EntityAdapter pattern:\r\n * - **entities**: Normalized message entities by ID for O(1) lookups\r\n * - **ids**: Ordered array of message IDs for iteration\r\n * - **loading**: Operation-specific loading flags\r\n * - **error**: Operation-specific error messages\r\n * - **pagination**: Page metadata for list views\r\n *\r\n * ## Key Features\r\n *\r\n * - **Multi-channel Messaging**: Email, SMS, in-app, and push notifications\r\n * - **Emergency Broadcasts**: Priority messaging with immediate delivery\r\n * - **Scheduled Messages**: Queue messages for future delivery\r\n * - **Delivery Tracking**: Real-time status updates for message delivery\r\n * - **Message Templates**: Pre-configured templates for common communications\r\n * - **Category Filtering**: Filter by announcement, emergency, general, alert, reminder\r\n * - **Priority Handling**: Support for normal, high, and urgent priority levels\r\n *\r\n * @remarks\r\n * ## Communication Workflows\r\n *\r\n * ### Emergency Broadcast Pattern\r\n *\r\n * 1. Create emergency message with EMERGENCY category and HIGH/URGENT priority\r\n * 2. System automatically selects multi-channel delivery (email + SMS + push)\r\n * 3. Message bypasses scheduling queue for immediate delivery\r\n * 4. Delivery status tracked in real-time with confirmation timestamps\r\n * 5. Failed deliveries trigger automatic retry with exponential backoff\r\n * 6. Administrator notified of delivery failures for urgent messages\r\n *\r\n * ### Scheduled Messaging Workflow\r\n *\r\n * 1. Create message with `scheduledAt` timestamp in the future\r\n * 2. Message stored in queue with SCHEDULED status\r\n * 3. Background job processes queue at scheduled times\r\n * 4. Message status updated to SENT upon delivery\r\n * 5. Delivery failures logged with error details\r\n * 6. Scheduled messages can be canceled or rescheduled before delivery\r\n *\r\n * ### Message Delivery Status Tracking\r\n *\r\n * - **DRAFT**: Message created but not sent\r\n * - **SCHEDULED**: Queued for future delivery\r\n * - **SENDING**: Currently being delivered\r\n * - **SENT**: Successfully delivered\r\n * - **DELIVERED**: Confirmed received by recipient\r\n * - **READ**: Recipient opened/read the message\r\n * - **FAILED**: Delivery failed (see error details)\r\n * - **CANCELED**: Scheduled message canceled before delivery\r\n *\r\n * ## Real-time Integration\r\n *\r\n * Integrates with WebSocket for real-time delivery status updates:\r\n * - Delivery confirmations pushed to client as they occur\r\n * - Read receipts updated in real-time for in-app messages\r\n * - Failed delivery notifications trigger UI alerts\r\n *\r\n * ## HIPAA Compliance\r\n *\r\n * - All message content containing PHI is encrypted at rest and in transit\r\n * - Audit logging for all message creation, delivery, and read events\r\n * - Role-based access control for message visibility\r\n * - Automatic data retention and purge policies\r\n *\r\n * ## Performance Considerations\r\n *\r\n * - Entity normalization enables efficient updates and lookups\r\n * - Pagination reduces initial load time for message lists\r\n * - Selective loading of message content (list vs detail view)\r\n * - Message search uses server-side full-text indexing\r\n * - Client-side filtering for small result sets\r\n *\r\n * @see {@link module:pages/incidents/store/incidentReportsSlice} for emergency incident notifications\r\n * @see {@link module:pages/contacts/store/contactsSlice} for contact notification cascades\r\n * @see {@link module:pages/students/store/studentsSlice} for parent/guardian contact information\r\n *\r\n * @example\r\n * ```typescript\r\n * // Send emergency broadcast to all parents\r\n * dispatch(communicationThunks.create({\r\n *   recipients: parentIds,\r\n *   subject: 'Emergency: School Closure',\r\n *   content: 'Due to weather conditions, school is closed today.',\r\n *   category: 'EMERGENCY',\r\n *   priority: 'URGENT',\r\n *   channels: ['EMAIL', 'SMS', 'PUSH']\r\n * }));\r\n *\r\n * // Schedule announcement for future delivery\r\n * dispatch(communicationThunks.create({\r\n *   recipients: allParents,\r\n *   subject: 'Upcoming Event Reminder',\r\n *   content: 'Parent-teacher conferences next week...',\r\n *   category: 'ANNOUNCEMENT',\r\n *   scheduledAt: '2025-02-01T08:00:00Z'\r\n * }));\r\n *\r\n * // Fetch recent messages with category filter\r\n * dispatch(communicationThunks.fetchAll({\r\n *   category: 'EMERGENCY',\r\n *   startDate: '2025-01-01',\r\n *   limit: 50\r\n * }));\r\n *\r\n * // Access messages using entity selectors\r\n * const allMessages = useSelector(communicationSelectors.selectAll);\r\n * const messageById = useSelector(state =>\r\n *   communicationSelectors.selectById(state, messageId)\r\n * );\r\n * const emergencyMessages = useSelector(selectEmergencyMessages);\r\n * const scheduledMessages = useSelector(selectScheduledMessages);\r\n * ```\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { apiActions } from '@/lib/api';\r\nimport type {\r\n  Message,\r\n  CreateMessageData,\r\n  MessageFilters\r\n} from '../../types/communication';\r\n\r\n/**\r\n * Message update payload.\r\n *\r\n * Partial update data for modifying existing messages. Only mutable fields\r\n * can be updated; immutable fields (e.g., senderId, createdAt) are excluded.\r\n *\r\n * @interface UpdateMessageData\r\n *\r\n * @property {string} [subject] - Updated message subject line\r\n * @property {string} [content] - Updated message body content\r\n * @property {string} [status] - Updated delivery status (DRAFT, SCHEDULED, SENT, etc.)\r\n * @property {string} [priority] - Updated priority level (NORMAL, HIGH, URGENT)\r\n *\r\n * @remarks\r\n * Only messages in DRAFT or SCHEDULED status can be updated.\r\n * Messages that have been sent cannot be modified (immutable for audit trail).\r\n *\r\n * @example\r\n * ```typescript\r\n * const updates: UpdateMessageData = {\r\n *   subject: 'Updated: School Event',\r\n *   scheduledAt: '2025-02-15T10:00:00Z'\r\n * };\r\n * ```\r\n */\r\ninterface UpdateMessageData {\r\n  subject?: string;\r\n  content?: string;\r\n  status?: string;\r\n  priority?: string;\r\n}\r\n\r\n/**\r\n * Communication API service adapter.\r\n *\r\n * Adapts the communication API to the entity service interface required by\r\n * the slice factory. Provides standardized CRUD operations with consistent\r\n * error handling and response formatting.\r\n *\r\n * @const {EntityApiService<Message, CreateMessageData, UpdateMessageData>}\r\n *\r\n * @remarks\r\n * ## API Integration Notes\r\n *\r\n * - `getAll`: Supports pagination and filtering by category, sender, priority\r\n * - `getById`: Loads full message with delivery tracking and read receipts\r\n * - `create`: Validates recipients and enforces business rules\r\n * - `update`: Only allows updates to DRAFT/SCHEDULED messages\r\n * - `delete`: Soft-deletes messages for audit trail preservation\r\n *\r\n * ## Error Handling\r\n *\r\n * All methods handle common error scenarios:\r\n * - Invalid recipient IDs (rejected with validation error)\r\n * - Missing required fields (subject, content, recipients)\r\n * - Unauthorized access (RBAC permission check failures)\r\n * - Network errors (automatic retry with exponential backoff)\r\n *\r\n * @example\r\n * ```typescript\r\n * // Direct API usage (normally handled by thunks)\r\n * const response = await communicationApiService.getAll({\r\n *   category: 'EMERGENCY',\r\n *   page: 1,\r\n *   limit: 20\r\n * });\r\n * ```\r\n */\r\nconst communicationApiService: EntityApiService<Message, CreateMessageData, UpdateMessageData> = {\r\n  /**\r\n   * Fetch all messages with optional filtering.\r\n   *\r\n   * @async\r\n   * @param {MessageFilters} [params] - Filter and pagination parameters\r\n   * @returns {Promise<{data: Message[], total?: number, pagination?: Object}>}\r\n   */\r\n  async getAll(params?: MessageFilters) {\r\n    const response = await apiActions.communication.getMessages(params);\r\n    return {\r\n      data: response.messages || [],\r\n      total: response.pagination?.total,\r\n      pagination: response.pagination,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetch single message by ID.\r\n   *\r\n   * @async\r\n   * @param {string} id - Message unique identifier\r\n   * @returns {Promise<{data: Message}>}\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.communication.getMessageById(id);\r\n    return { data: response.message };\r\n  },\r\n\r\n  /**\r\n   * Create new message.\r\n   *\r\n   * @async\r\n   * @param {CreateMessageData} data - Message creation data\r\n   * @returns {Promise<{data: Message}>}\r\n   */\r\n  async create(data: CreateMessageData) {\r\n    const response = await apiActions.communication.sendMessage(data);\r\n    return { data: response.message };\r\n  },\r\n\r\n  /**\r\n   * Update existing message.\r\n   *\r\n   * @async\r\n   * @param {string} id - Message unique identifier\r\n   * @param {UpdateMessageData} data - Partial update data\r\n   * @returns {Promise<{data: Message}>}\r\n   * @throws {Error} When attempting to update sent messages\r\n   */\r\n  async update(id: string, data: UpdateMessageData) {\r\n    // Note: Update functionality may need to be implemented in the API\r\n    // For now, return the original message structure\r\n    throw new Error('Message update not implemented in API');\r\n  },\r\n\r\n  /**\r\n   * Delete message.\r\n   *\r\n   * @async\r\n   * @param {string} id - Message unique identifier\r\n   * @returns {Promise<{success: boolean}>}\r\n   * @throws {Error} When attempting to delete sent messages\r\n   */\r\n  async delete(id: string) {\r\n    // Note: Delete functionality may need to be implemented in the API\r\n    // For now, return success\r\n    throw new Error('Message delete not implemented in API');\r\n  },\r\n};\r\n\r\n/**\r\n * Communication slice factory instance.\r\n *\r\n * Creates the Redux slice using the entity factory pattern with standardized\r\n * CRUD operations, normalized state, and built-in selectors.\r\n *\r\n * @const\r\n *\r\n * @property {Object} slice - Redux slice with reducers and actions\r\n * @property {EntityAdapter} adapter - Entity adapter with normalized selectors\r\n * @property {Object} thunks - Async thunk creators for API operations\r\n * @property {Object} actions - Synchronous action creators\r\n */\r\nconst communicationSliceFactory = createEntitySlice<Message, CreateMessageData, UpdateMessageData>(\r\n  'communication',\r\n  communicationApiService,\r\n  {\r\n    enableBulkOperations: true,\r\n  }\r\n);\r\n\r\n// Export the slice and its components\r\nexport const communicationSlice = communicationSliceFactory.slice;\r\nexport const communicationReducer = communicationSlice.reducer;\r\nexport const communicationActions = communicationSliceFactory.actions;\r\nexport const communicationSelectors = communicationSliceFactory.adapter.getSelectors((state: any) => state.communication);\r\nexport const communicationThunks = communicationSliceFactory.thunks;\r\n\r\n// =====================\r\n// CUSTOM SELECTORS\r\n// =====================\r\n\r\n/**\r\n * Filter messages by category.\r\n *\r\n * Custom selector that filters messages by specific category type.\r\n * Categories include: ANNOUNCEMENT, EMERGENCY, GENERAL, ALERT, REMINDER.\r\n *\r\n * @function selectMessagesByCategory\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} category - Message category to filter by\r\n *\r\n * @returns {Message[]} Filtered array of messages matching the category\r\n *\r\n * @example\r\n * ```typescript\r\n * const announcements = selectMessagesByCategory(state, 'ANNOUNCEMENT');\r\n * const emergencies = selectMessagesByCategory(state, 'EMERGENCY');\r\n * ```\r\n */\r\nexport const selectMessagesByCategory = (state: any, category: string): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  return allMessages.filter(message => message.category === category);\r\n};\r\n\r\n/**\r\n * Filter messages by sender.\r\n *\r\n * Custom selector that filters messages sent by a specific user.\r\n * Useful for viewing sent messages or filtering by staff member.\r\n *\r\n * @function selectMessagesBySender\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} senderId - Sender user ID to filter by\r\n *\r\n * @returns {Message[]} Filtered array of messages from the specified sender\r\n *\r\n * @example\r\n * ```typescript\r\n * const mySentMessages = selectMessagesBySender(state, currentUserId);\r\n * ```\r\n */\r\nexport const selectMessagesBySender = (state: any, senderId: string): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  return allMessages.filter(message => message.senderId === senderId);\r\n};\r\n\r\n/**\r\n * Filter messages by priority.\r\n *\r\n * Custom selector that filters messages by priority level.\r\n * Priority levels: NORMAL, HIGH, URGENT.\r\n *\r\n * @function selectMessagesByPriority\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} priority - Priority level to filter by\r\n *\r\n * @returns {Message[]} Filtered array of messages with the specified priority\r\n *\r\n * @remarks\r\n * URGENT priority messages bypass normal queueing and are delivered immediately\r\n * across all configured channels (email, SMS, push notification).\r\n *\r\n * @example\r\n * ```typescript\r\n * const urgentMessages = selectMessagesByPriority(state, 'URGENT');\r\n * const normalMessages = selectMessagesByPriority(state, 'NORMAL');\r\n * ```\r\n */\r\nexport const selectMessagesByPriority = (state: any, priority: string): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  return allMessages.filter(message => message.priority === priority);\r\n};\r\n\r\n/**\r\n * Get all scheduled (future) messages.\r\n *\r\n * Derived selector that returns messages with `scheduledAt` timestamp in the future.\r\n * These messages are queued for delivery but have not been sent yet.\r\n *\r\n * @function selectScheduledMessages\r\n *\r\n * @param {any} state - Redux root state\r\n *\r\n * @returns {Message[]} Array of scheduled messages not yet sent\r\n *\r\n * @remarks\r\n * Scheduled messages can be canceled or rescheduled before their scheduled time.\r\n * After the scheduled time passes, they are automatically sent by the background\r\n * job processor and their status changes from SCHEDULED to SENT.\r\n *\r\n * @example\r\n * ```typescript\r\n * const upcomingMessages = selectScheduledMessages(state);\r\n * // Display count of messages pending delivery\r\n * console.log(`${upcomingMessages.length} messages scheduled for delivery`);\r\n * ```\r\n */\r\nexport const selectScheduledMessages = (state: any): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  return allMessages.filter(message => message.scheduledAt && new Date(message.scheduledAt) > new Date());\r\n};\r\n\r\n/**\r\n * Get all emergency messages.\r\n *\r\n * Derived selector that filters messages with EMERGENCY category.\r\n * Provides quick access to critical communications for emergency response coordination.\r\n *\r\n * @function selectEmergencyMessages\r\n *\r\n * @param {any} state - Redux root state\r\n *\r\n * @returns {Message[]} Array of emergency messages\r\n *\r\n * @remarks\r\n * ## Emergency Message Handling\r\n *\r\n * Emergency messages receive special treatment:\r\n * - **Immediate Delivery**: Bypass normal queueing, sent immediately\r\n * - **Multi-channel**: Delivered via all available channels (email, SMS, push)\r\n * - **Delivery Tracking**: Real-time status updates with confirmation timestamps\r\n * - **Retry Logic**: Automatic retry on failure with exponential backoff\r\n * - **Administrator Alerts**: Delivery failures trigger admin notifications\r\n *\r\n * @example\r\n * ```typescript\r\n * const emergencies = selectEmergencyMessages(state);\r\n * // Show alert badge if any emergency messages in last hour\r\n * const recentEmergencies = emergencies.filter(msg =>\r\n *   new Date(msg.createdAt) > new Date(Date.now() - 3600000)\r\n * );\r\n * if (recentEmergencies.length > 0) {\r\n *   showEmergencyAlert(recentEmergencies);\r\n * }\r\n * ```\r\n */\r\nexport const selectEmergencyMessages = (state: any): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  return allMessages.filter(message => message.category === 'EMERGENCY');\r\n};\r\n\r\n/**\r\n * Get recent messages within specified time window.\r\n *\r\n * Derived selector that filters messages created within the last N days.\r\n * Results are sorted by creation date in descending order (most recent first).\r\n *\r\n * @function selectRecentMessages\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {number} [days=7] - Number of days to look back (default: 7)\r\n *\r\n * @returns {Message[]} Array of recent messages, sorted by creation date descending\r\n *\r\n * @remarks\r\n * This selector performs client-side filtering and sorting. For large message\r\n * volumes, consider using server-side filtering with date range parameters.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Get messages from last 7 days (default)\r\n * const lastWeek = selectRecentMessages(state);\r\n *\r\n * // Get messages from last 24 hours\r\n * const last24Hours = selectRecentMessages(state, 1);\r\n *\r\n * // Get messages from last 30 days\r\n * const lastMonth = selectRecentMessages(state, 30);\r\n * ```\r\n */\r\nexport const selectRecentMessages = (state: any, days: number = 7): Message[] => {\r\n  const allMessages = communicationSelectors.selectAll(state) as Message[];\r\n  const cutoffDate = new Date();\r\n  cutoffDate.setDate(cutoffDate.getDate() - days);\r\n\r\n  return allMessages.filter(message => {\r\n    const messageDate = new Date(message.createdAt);\r\n    return messageDate >= cutoffDate;\r\n  }).sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 12897, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/documentsSlice.ts"],"sourcesContent":["/**\r\n * @module pages/documents/store/documentsSlice\r\n *\r\n * @description\r\n * Production-grade Redux state management for document management system.\r\n * Handles CRUD operations for documents with support for versioning, digital signatures,\r\n * audit trails, and HIPAA-compliant access control.\r\n *\r\n * ## Architecture\r\n *\r\n * This slice uses the entity slice factory pattern (`createEntitySlice`) for standardized\r\n * CRUD operations with normalized state management via Redux Toolkit's `EntityAdapter`.\r\n * This provides optimized entity management with O(1) lookups and efficient updates.\r\n *\r\n * ## State Structure\r\n *\r\n * The state is normalized using EntityAdapter pattern:\r\n * - **entities**: Normalized document entities by ID for fast lookups\r\n * - **ids**: Ordered array of document IDs for iteration\r\n * - **loading**: Operation-specific loading flags\r\n * - **error**: Operation-specific error messages\r\n * - **pagination**: Page metadata for list views\r\n *\r\n * ## Key Features\r\n *\r\n * - **Document Upload**: Support for multiple file types with size validation\r\n * - **Version Control**: Automatic versioning with audit trail\r\n * - **Digital Signatures**: Electronic signature capture and validation\r\n * - **Access Control**: Role-based document visibility and permissions\r\n * - **Tag System**: Flexible tagging for categorization and search\r\n * - **Status Tracking**: DRAFT, PENDING_REVIEW, APPROVED, ARCHIVED workflow\r\n * - **Audit Trail**: Complete history of document access and modifications\r\n *\r\n * @remarks\r\n * ## Document Management Workflows\r\n *\r\n * ### Document Upload and Processing\r\n *\r\n * 1. User selects file(s) for upload\r\n * 2. Client validates file type, size, and content\r\n * 3. File uploaded to secure storage (S3/Azure Blob)\r\n * 4. Document metadata created with PENDING_REVIEW status\r\n * 5. OCR/text extraction performed for searchability\r\n * 6. Virus scanning completed before approval\r\n * 7. Administrator reviews and approves document\r\n * 8. Document status updated to APPROVED\r\n *\r\n * ### Document Versioning Workflow\r\n *\r\n * 1. User uploads new version of existing document\r\n * 2. Previous version archived with version number\r\n * 3. New version created with incremented version number\r\n * 4. Audit trail updated with version change details\r\n * 5. Users notified of new version availability\r\n * 6. Previous versions remain accessible for compliance\r\n *\r\n * ### Digital Signature Workflow\r\n *\r\n * 1. Document marked as requiring signature\r\n * 2. Signature request sent to designated signers\r\n * 3. Signer reviews document content\r\n * 4. Electronic signature captured (typed, drawn, or image)\r\n * 5. Signature cryptographically bound to document\r\n * 6. Timestamp and IP address recorded\r\n * 7. Document locked for editing after signing\r\n * 8. Signed document archived with certificate\r\n *\r\n * ### Document Access Audit Trail\r\n *\r\n * All document operations are logged:\r\n * - **View**: User ID, timestamp, IP address, duration\r\n * - **Download**: User ID, timestamp, IP address, file hash\r\n * - **Edit**: User ID, timestamp, changes made, previous version\r\n * - **Share**: User ID, timestamp, recipient(s), expiration\r\n * - **Delete**: User ID, timestamp, reason, soft delete only\r\n *\r\n * ## PHI Handling\r\n *\r\n * Documents containing PHI (Protected Health Information) receive special handling:\r\n * - Encryption at rest using AES-256\r\n * - Encryption in transit using TLS 1.3\r\n * - Access limited to authorized users only\r\n * - Audit logging for all access attempts\r\n * - Automatic expiration for shared links\r\n * - Watermarks on downloaded copies\r\n *\r\n * ## Document Retention Policy\r\n *\r\n * - **Medical Records**: Retained for 7 years after last treatment\r\n * - **Consent Forms**: Retained for 7 years after student graduation\r\n * - **Incident Reports**: Retained for 10 years\r\n * - **General Documents**: Retained for 3 years\r\n * - **Archived Documents**: Moved to cold storage after retention period\r\n * - **Deletion**: Physical deletion only after legal hold clearance\r\n *\r\n * ## Performance Considerations\r\n *\r\n * - Pagination for large document lists\r\n * - Lazy loading of document content (metadata first, content on-demand)\r\n * - Thumbnail generation for image documents\r\n * - PDF preview generation for quick viewing\r\n * - Client-side caching with cache invalidation\r\n * - Compression for large files during upload/download\r\n *\r\n * @see {@link module:pages/compliance/store/complianceSlice} for compliance document tracking\r\n * @see {@link module:pages/students/store/studentsSlice} for student-specific documents\r\n * @see {@link module:pages/incidents/store/incidentReportsSlice} for incident documentation\r\n *\r\n * @example\r\n * ```typescript\r\n * // Upload new document\r\n * dispatch(documentsThunks.create({\r\n *   name: 'Consent Form - Annual Physical',\r\n *   type: 'application/pdf',\r\n *   size: 245678,\r\n *   url: 's3://bucket/documents/consent-form.pdf',\r\n *   studentId: 'student-123',\r\n *   tags: ['consent', 'medical', 'physical'],\r\n *   category: 'CONSENT_FORM'\r\n * }));\r\n *\r\n * // Fetch student documents\r\n * dispatch(documentsThunks.fetchAll({\r\n *   studentId: 'student-123',\r\n *   category: 'MEDICAL_RECORDS',\r\n *   isActive: true\r\n * }));\r\n *\r\n * // Update document status\r\n * dispatch(documentsThunks.update('doc-456', {\r\n *   status: 'APPROVED',\r\n *   reviewedBy: currentUserId,\r\n *   reviewedAt: new Date().toISOString()\r\n * }));\r\n *\r\n * // Access documents using selectors\r\n * const allDocuments = useSelector(documentsSelectors.selectAll);\r\n * const studentDocs = useSelector(state =>\r\n *   selectDocumentsByStudent(state, studentId)\r\n * );\r\n * const activeDocuments = useSelector(selectActiveDocuments);\r\n * const recentDocuments = useSelector(state =>\r\n *   selectRecentDocuments(state, 30)\r\n * );\r\n * ```\r\n */\r\n\r\nimport { createEntitySlice, EntityApiService } from '@/stores/sliceFactory';\r\nimport { apiActions } from '@/lib/api';\r\nimport type { Document as DocumentType } from '@/types/documents';\r\n\r\n// Use the imported Document type instead of local interface\r\ntype Document = DocumentType;\r\n\r\n/**\r\n * Document creation data.\r\n *\r\n * Defines the structure for creating new documents in the system.\r\n *\r\n * @interface CreateDocumentData\r\n *\r\n * @property {string} name - Document filename\r\n * @property {string} type - MIME type (e.g., application/pdf, image/jpeg)\r\n * @property {number} size - File size in bytes\r\n * @property {string} url - Storage URL (S3/Azure Blob)\r\n * @property {string} [studentId] - Associated student ID (for student-specific documents)\r\n * @property {string[]} [tags] - Tags for categorization and search\r\n *\r\n * @example\r\n * ```typescript\r\n * const newDoc: CreateDocumentData = {\r\n *   name: 'vaccination-record.pdf',\r\n *   type: 'application/pdf',\r\n *   size: 156789,\r\n *   url: 's3://documents/vaccination-record.pdf',\r\n *   studentId: 'student-123',\r\n *   tags: ['vaccination', 'medical', 'immunization']\r\n * };\r\n * ```\r\n */\r\ninterface CreateDocumentData {\r\n  name: string;\r\n  type: string;\r\n  size: number;\r\n  url: string;\r\n  studentId?: string;\r\n  tags?: string[];\r\n}\r\n\r\n/**\r\n * Document update data.\r\n *\r\n * Partial update data for modifying existing documents.\r\n *\r\n * @interface UpdateDocumentData\r\n *\r\n * @property {string} [name] - Updated document name\r\n * @property {string[]} [tags] - Updated tags\r\n * @property {boolean} [isActive] - Active/archived status\r\n *\r\n * @remarks\r\n * Only metadata can be updated after document creation.\r\n * To update content, upload a new version using versioning workflow.\r\n *\r\n * @example\r\n * ```typescript\r\n * const updates: UpdateDocumentData = {\r\n *   tags: ['consent', 'medical', 'updated'],\r\n *   isActive: true\r\n * };\r\n * ```\r\n */\r\ninterface UpdateDocumentData {\r\n  name?: string;\r\n  tags?: string[];\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Document filters for querying.\r\n *\r\n * Defines available filter options for document queries.\r\n *\r\n * @interface DocumentFilters\r\n *\r\n * @property {string} [studentId] - Filter by student\r\n * @property {string} [type] - Filter by MIME type\r\n * @property {string} [uploadedBy] - Filter by uploader user ID\r\n * @property {string[]} [tags] - Filter by tags\r\n * @property {boolean} [isActive] - Filter by active status\r\n * @property {number} [page] - Page number for pagination\r\n * @property {number} [limit] - Items per page\r\n *\r\n * @example\r\n * ```typescript\r\n * const filters: DocumentFilters = {\r\n *   studentId: 'student-123',\r\n *   category: 'MEDICAL_RECORDS',\r\n *   isActive: true,\r\n *   page: 1,\r\n *   limit: 20\r\n * };\r\n * ```\r\n */\r\ninterface DocumentFilters {\r\n  studentId?: string;\r\n  type?: string;\r\n  uploadedBy?: string;\r\n  tags?: string[];\r\n  isActive?: boolean;\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\n/**\r\n * Documents API service adapter.\r\n *\r\n * Adapts the documents API to the entity service interface required by\r\n * the slice factory. Provides standardized CRUD operations with consistent\r\n * error handling and response formatting.\r\n *\r\n * @const {EntityApiService<Document, CreateDocumentData, UpdateDocumentData>}\r\n *\r\n * @remarks\r\n * ## API Integration Notes\r\n *\r\n * - `getAll`: Supports filtering by student, type, category, tags, status\r\n * - `getById`: Loads full document metadata with access history\r\n * - `create`: Validates file type and size before storage\r\n * - `update`: Only metadata updates allowed (name, tags, status)\r\n * - `delete`: Soft-deletes documents for audit trail preservation\r\n *\r\n * ## Error Handling\r\n *\r\n * All methods handle common error scenarios:\r\n * - Invalid file types (rejected with validation error)\r\n * - File size exceeding limits (rejected with size error)\r\n * - Unauthorized access (RBAC permission check failures)\r\n * - Storage failures (automatic retry with exponential backoff)\r\n * - Virus detection (document quarantined, user notified)\r\n */\r\nconst documentsApiService: EntityApiService<Document, CreateDocumentData, UpdateDocumentData> = {\r\n  /**\r\n   * Fetch all documents with optional filtering.\r\n   *\r\n   * @async\r\n   * @param {DocumentFilters} [params] - Filter and pagination parameters\r\n   * @returns {Promise<{data: Document[], total: number, pagination?: Object}>}\r\n   */\r\n  async getAll(params?: DocumentFilters) {\r\n    const response = await apiActions.documents.getDocuments(params);\r\n    return {\r\n      data: response.documents || [],\r\n      total: response.pagination?.total || 0,\r\n      pagination: response.pagination ? {\r\n        page: response.pagination.page,\r\n        pageSize: response.pagination.limit,\r\n        total: response.pagination.total,\r\n        totalPages: response.pagination.pages\r\n      } : undefined,\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Fetch single document by ID.\r\n   *\r\n   * @async\r\n   * @param {string} id - Document unique identifier\r\n   * @returns {Promise<{data: Document}>}\r\n   */\r\n  async getById(id: string) {\r\n    const response = await apiActions.documents.getDocumentById(id);\r\n    return { data: response.document };\r\n  },\r\n\r\n  /**\r\n   * Create new document.\r\n   *\r\n   * @async\r\n   * @param {CreateDocumentData} data - Document creation data\r\n   * @returns {Promise<{data: Document}>}\r\n   */\r\n  async create(data: CreateDocumentData) {\r\n    const response = await apiActions.documents.createDocument(data as any);\r\n    return { data: response.document };\r\n  },\r\n\r\n  /**\r\n   * Update existing document metadata.\r\n   *\r\n   * @async\r\n   * @param {string} id - Document unique identifier\r\n   * @param {UpdateDocumentData} data - Partial update data\r\n   * @returns {Promise<{data: Document}>}\r\n   */\r\n  async update(id: string, data: UpdateDocumentData) {\r\n    const response = await apiActions.documents.updateDocument(id, data as any);\r\n    return { data: response.document };\r\n  },\r\n\r\n  /**\r\n   * Delete document (soft delete).\r\n   *\r\n   * @async\r\n   * @param {string} id - Document unique identifier\r\n   * @returns {Promise<{success: boolean}>}\r\n   */\r\n  async delete(id: string) {\r\n    await apiActions.documents.deleteDocument(id);\r\n    return { success: true };\r\n  },\r\n};\r\n\r\n/**\r\n * Documents slice factory instance.\r\n *\r\n * Creates the Redux slice using the entity factory pattern with standardized\r\n * CRUD operations, normalized state, and built-in selectors.\r\n *\r\n * @const\r\n *\r\n * @property {Object} slice - Redux slice with reducers and actions\r\n * @property {EntityAdapter} adapter - Entity adapter with normalized selectors\r\n * @property {Object} thunks - Async thunk creators for API operations\r\n * @property {Object} actions - Synchronous action creators\r\n */\r\nconst documentsSliceFactory = createEntitySlice<Document, CreateDocumentData, UpdateDocumentData>(\r\n  'documents',\r\n  documentsApiService,\r\n  {\r\n    enableBulkOperations: true,\r\n  }\r\n);\r\n\r\n// Export the slice and its components\r\nexport const documentsSlice = documentsSliceFactory.slice;\r\nexport const documentsReducer = documentsSlice.reducer;\r\nexport const documentsActions = documentsSliceFactory.actions;\r\nexport const documentsSelectors = documentsSliceFactory.adapter.getSelectors((state: any) => state.documents);\r\nexport const documentsThunks = documentsSliceFactory.thunks;\r\n\r\n// =====================\r\n// CUSTOM SELECTORS\r\n// =====================\r\n\r\n/**\r\n * Select documents by student ID.\r\n *\r\n * Custom selector that filters documents belonging to a specific student.\r\n *\r\n * @function selectDocumentsByStudent\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} studentId - Student unique identifier\r\n *\r\n * @returns {Document[]} Filtered array of student's documents\r\n *\r\n * @example\r\n * ```typescript\r\n * const studentDocuments = selectDocumentsByStudent(state, 'student-123');\r\n * ```\r\n */\r\nexport const selectDocumentsByStudent = (state: any, studentId: string): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  return allDocuments.filter(document => document.studentId === studentId);\r\n};\r\n\r\n/**\r\n * Select active documents.\r\n *\r\n * Derived selector that filters documents with APPROVED or PENDING_REVIEW status.\r\n * Excludes archived and draft documents.\r\n *\r\n * @function selectActiveDocuments\r\n *\r\n * @param {any} state - Redux root state\r\n *\r\n * @returns {Document[]} Array of active documents\r\n *\r\n * @remarks\r\n * Active documents are those that are currently in use and accessible.\r\n * Archived documents are excluded for performance but can be queried separately.\r\n *\r\n * @example\r\n * ```typescript\r\n * const activeDocuments = selectActiveDocuments(state);\r\n * ```\r\n */\r\nexport const selectActiveDocuments = (state: any): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  return allDocuments.filter(document =>\r\n    document.status === 'APPROVED' || document.status === 'PENDING_REVIEW'\r\n  );\r\n};\r\n\r\n/**\r\n * Select documents by category/type.\r\n *\r\n * Custom selector that filters documents by category (e.g., MEDICAL_RECORDS, CONSENT_FORMS).\r\n *\r\n * @function selectDocumentsByType\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} category - Document category to filter by\r\n *\r\n * @returns {Document[]} Filtered array of documents in the category\r\n *\r\n * @example\r\n * ```typescript\r\n * const medicalRecords = selectDocumentsByType(state, 'MEDICAL_RECORDS');\r\n * const consentForms = selectDocumentsByType(state, 'CONSENT_FORMS');\r\n * ```\r\n */\r\nexport const selectDocumentsByType = (state: any, category: string): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  return allDocuments.filter(document => document.category === category);\r\n};\r\n\r\n/**\r\n * Select documents by uploader.\r\n *\r\n * Custom selector that filters documents uploaded by a specific user.\r\n *\r\n * @function selectDocumentsByUploader\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} uploadedBy - Uploader user ID\r\n *\r\n * @returns {Document[]} Filtered array of documents uploaded by the user\r\n *\r\n * @example\r\n * ```typescript\r\n * const myUploads = selectDocumentsByUploader(state, currentUserId);\r\n * ```\r\n */\r\nexport const selectDocumentsByUploader = (state: any, uploadedBy: string): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  return allDocuments.filter(document => document.uploadedBy === uploadedBy);\r\n};\r\n\r\n/**\r\n * Select documents by tag.\r\n *\r\n * Custom selector that filters documents containing a specific tag.\r\n *\r\n * @function selectDocumentsByTag\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {string} tag - Tag to filter by\r\n *\r\n * @returns {Document[]} Filtered array of documents with the tag\r\n *\r\n * @remarks\r\n * Tags are case-insensitive for filtering. Documents can have multiple tags.\r\n *\r\n * @example\r\n * ```typescript\r\n * const vaccinationDocs = selectDocumentsByTag(state, 'vaccination');\r\n * const urgentDocs = selectDocumentsByTag(state, 'urgent');\r\n * ```\r\n */\r\nexport const selectDocumentsByTag = (state: any, tag: string): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  return allDocuments.filter(document =>\r\n    document.tags && document.tags.includes(tag)\r\n  );\r\n};\r\n\r\n/**\r\n * Select recent documents within time window.\r\n *\r\n * Derived selector that filters documents created within the last N days.\r\n * Results are sorted by creation date in descending order (most recent first).\r\n *\r\n * @function selectRecentDocuments\r\n *\r\n * @param {any} state - Redux root state\r\n * @param {number} [days=7] - Number of days to look back (default: 7)\r\n *\r\n * @returns {Document[]} Array of recent documents, sorted by creation date descending\r\n *\r\n * @remarks\r\n * This selector performs client-side filtering and sorting. For large document\r\n * collections, consider using server-side filtering with date range parameters.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Get documents from last 7 days (default)\r\n * const lastWeek = selectRecentDocuments(state);\r\n *\r\n * // Get documents from last 24 hours\r\n * const today = selectRecentDocuments(state, 1);\r\n *\r\n * // Get documents from last 30 days\r\n * const lastMonth = selectRecentDocuments(state, 30);\r\n * ```\r\n */\r\nexport const selectRecentDocuments = (state: any, days: number = 7): Document[] => {\r\n  const allDocuments = documentsSelectors.selectAll(state) as Document[];\r\n  const cutoffDate = new Date();\r\n  cutoffDate.setDate(cutoffDate.getDate() - days);\r\n\r\n  return allDocuments.filter(document => {\r\n    const createdDate = new Date(document.createdAt!);\r\n    return createdDate >= cutoffDate;\r\n  }).sort((a, b) => new Date(b.createdAt!).getTime() - new Date(a.createdAt!).getTime());\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 13219, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/contactsSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Emergency Contacts Redux Slice for White Cross Healthcare Platform\r\n *\r\n * Manages emergency contact information and communication workflows for student safety.\r\n * Provides comprehensive state management for emergency contact CRUD operations,\r\n * notification systems, and contact verification processes.\r\n *\r\n * **Key Features:**\r\n * - Emergency contact CRUD operations with validation\r\n * - Multi-channel notification system (SMS, email, voice)\r\n * - Contact verification and authentication workflows\r\n * - Student-contact relationship management\r\n * - Real-time notification status tracking\r\n * - Emergency communication statistics and reporting\r\n * - Contact priority management (PRIMARY, SECONDARY)\r\n * - Parent/guardian consent tracking\r\n *\r\n * **HIPAA Compliance:**\r\n * - Emergency contact information is considered PHI (names, phones, relationships)\r\n * - All operations generate audit logs for compliance tracking\r\n * - State is NOT persisted to localStorage (memory-only for PHI protection)\r\n * - Cross-tab synchronization uses BroadcastChannel API\r\n * - Contact verification data expires after configured time limit\r\n * - All communication attempts are logged with timestamps\r\n *\r\n * **Emergency Workflows:**\r\n * - **Contact Cascade**: Automatic progression through contact priority levels\r\n * - **Verification Required**: Contact authentication before sensitive communications\r\n * - **Multi-Channel Delivery**: Simultaneous SMS, email, and voice notifications\r\n * - **Delivery Confirmation**: Real-time status updates for all notification attempts\r\n * - **Failed Contact Escalation**: Automatic escalation when contacts unreachable\r\n *\r\n * **State Management:**\r\n * - Uses manual thunk pattern for specialized emergency contact API integration\r\n * - Normalized state structure for efficient contact lookups and updates\r\n * - Separate loading states for each operation type (CRUD, notifications, verification)\r\n * - Comprehensive error handling with user-friendly messages\r\n * - Optimistic updates for immediate UI responsiveness\r\n *\r\n * **Integration:**\r\n * - Backend API: `services/modules/emergencyContactsApi.ts`\r\n * - Type definitions: `types/student.types.ts`\r\n * - Redux store: `stores/reduxStore.ts`\r\n * - Used by: Emergency response systems, parent communication, incident reporting\r\n *\r\n * @module stores/slices/contactsSlice\r\n * @requires @reduxjs/toolkit\r\n * @requires services/modules/emergencyContactsApi\r\n * @requires types/student.types\r\n * @security Emergency contact management, PHI handling\r\n * @compliance HIPAA-compliant emergency contact operations\r\n *\r\n * @example Emergency notification workflow\r\n * ```typescript\r\n * import { useDispatch, useSelector } from 'react-redux';\r\n * import { notifyStudent, fetchContactsByStudent } from '@/stores/slices/contactsSlice';\r\n *\r\n * function EmergencyNotification({ studentId }) {\r\n *   const dispatch = useDispatch();\r\n *   const { contacts, notificationResults, notificationsLoading } = useSelector(\r\n *     (state) => state.contacts\r\n *   );\r\n *\r\n *   const sendEmergencyAlert = async () => {\r\n *     // Send notification to all emergency contacts\r\n *     await dispatch(notifyStudent({\r\n *       studentId,\r\n *       notification: {\r\n *         subject: 'Emergency: Student Incident',\r\n *         message: 'Your child requires immediate attention. Please contact the school.',\r\n *         urgency: 'HIGH',\r\n *         channels: ['SMS', 'EMAIL', 'VOICE']\r\n *       }\r\n *     }));\r\n *   };\r\n *\r\n *   return (\r\n *     <button onClick={sendEmergencyAlert} disabled={notificationsLoading}>\r\n *       {notificationsLoading ? 'Notifying...' : 'Send Emergency Alert'}\r\n *     </button>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @example Contact verification flow\r\n * ```typescript\r\n * function ContactVerification({ contactId }) {\r\n *   const dispatch = useDispatch();\r\n *   const { verificationResponse, verificationLoading } = useSelector(\r\n *     (state) => state.contacts\r\n *   );\r\n *\r\n *   const verifyContact = async (method) => {\r\n *     const result = await dispatch(verifyContact({ contactId, method }));\r\n *     \r\n *     if (result.verified) {\r\n *       // Proceed with sensitive communication\r\n *       console.log('Contact verified, proceeding with communication');\r\n *     } else {\r\n *       // Request alternative verification\r\n *       console.log('Verification failed, try alternative method');\r\n *     }\r\n *   };\r\n *\r\n *   return (\r\n *     <div>\r\n *       <button onClick={() => verifyContact('sms')}>Verify via SMS</button>\r\n *       <button onClick={() => verifyContact('voice')}>Verify via Voice Call</button>\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @see {@link ../../services/modules/emergencyContactsApi.ts} for API integration\r\n * @see {@link ../reduxStore.ts} for store configuration\r\n * @see {@link ../../types/student.types.ts} for type definitions\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport { apiActions } from '@/lib/api';\r\nimport { CreateEmergencyContactData, UpdateEmergencyContactData } from '@/services/modules/emergencyContactsApi';\r\nimport {\r\n  EmergencyContact,\r\n  EmergencyNotificationData,\r\n  EmergencyNotificationResult,\r\n  ContactVerificationResponse,\r\n  EmergencyContactStatistics,\r\n} from '../../types/student.types';\r\n\r\n// Contacts API Service Adapter\r\nexport class ContactsApiService {\r\n  // Emergency contacts\r\n  async getContactsByStudent(studentId: string) {\r\n    return apiActions.emergencyContacts.getByStudent(studentId);\r\n  }\r\n\r\n  async createEmergencyContact(data: CreateEmergencyContactData) {\r\n    return apiActions.emergencyContacts.create(data);\r\n  }\r\n\r\n  async updateEmergencyContact(id: string, data: UpdateEmergencyContactData) {\r\n    return apiActions.emergencyContacts.update(id, data);\r\n  }\r\n\r\n  async deleteEmergencyContact(id: string) {\r\n    return apiActions.emergencyContacts.delete(id);\r\n  }\r\n\r\n  // Notifications\r\n  async notifyStudent(studentId: string, notification: Omit<EmergencyNotificationData, 'studentId'>) {\r\n    return apiActions.emergencyContacts.notifyStudent(studentId, notification);\r\n  }\r\n\r\n  async notifyContact(contactId: string, notification: Omit<EmergencyNotificationData, 'studentId'>) {\r\n    return apiActions.emergencyContacts.notifyContact(contactId, notification);\r\n  }\r\n\r\n  // Verification\r\n  async verifyContact(contactId: string, method: 'sms' | 'email' | 'voice') {\r\n    return apiActions.emergencyContacts.verify(contactId, method);\r\n  }\r\n\r\n  // Statistics\r\n  async getStatistics() {\r\n    return apiActions.emergencyContacts.getStatistics();\r\n  }\r\n}\r\n\r\n// Create contacts API service instance\r\nexport const contactsApiService = new ContactsApiService();\r\n\r\n// State interface\r\nexport interface ContactsState {\r\n  // Contacts\r\n  contacts: EmergencyContact[];\r\n  contactsLoading: boolean;\r\n  contactsError: string | null;\r\n  \r\n  // Selected student contacts\r\n  selectedStudentId: string | null;\r\n  selectedStudentContacts: EmergencyContact[];\r\n  \r\n  // Notifications\r\n  notificationResults: EmergencyNotificationResult[];\r\n  notificationsLoading: boolean;\r\n  notificationsError: string | null;\r\n  \r\n  // Verification\r\n  verificationResponse: ContactVerificationResponse | null;\r\n  verificationLoading: boolean;\r\n  verificationError: string | null;\r\n  \r\n  // Statistics\r\n  statistics: EmergencyContactStatistics | null;\r\n  statisticsLoading: boolean;\r\n  statisticsError: string | null;\r\n}\r\n\r\n// Initial state\r\nconst initialState: ContactsState = {\r\n  contacts: [],\r\n  contactsLoading: false,\r\n  contactsError: null,\r\n  \r\n  selectedStudentId: null,\r\n  selectedStudentContacts: [],\r\n  \r\n  notificationResults: [],\r\n  notificationsLoading: false,\r\n  notificationsError: null,\r\n  \r\n  verificationResponse: null,\r\n  verificationLoading: false,\r\n  verificationError: null,\r\n  \r\n  statistics: null,\r\n  statisticsLoading: false,\r\n  statisticsError: null,\r\n};\r\n\r\n// Async thunks\r\nexport const fetchContactsByStudent = createAsyncThunk(\r\n  'contacts/fetchByStudent',\r\n  async (studentId: string) => {\r\n    const response = await contactsApiService.getContactsByStudent(studentId);\r\n    return { studentId, contacts: response.contacts };\r\n  }\r\n);\r\n\r\nexport const createEmergencyContact = createAsyncThunk(\r\n  'contacts/create',\r\n  async (data: CreateEmergencyContactData) => {\r\n    const response = await contactsApiService.createEmergencyContact(data);\r\n    return response.contact;\r\n  }\r\n);\r\n\r\nexport const updateEmergencyContact = createAsyncThunk(\r\n  'contacts/update',\r\n  async ({ id, data }: { id: string; data: UpdateEmergencyContactData }) => {\r\n    const response = await contactsApiService.updateEmergencyContact(id, data);\r\n    return response.contact;\r\n  }\r\n);\r\n\r\nexport const deleteEmergencyContact = createAsyncThunk(\r\n  'contacts/delete',\r\n  async (id: string) => {\r\n    await contactsApiService.deleteEmergencyContact(id);\r\n    return id;\r\n  }\r\n);\r\n\r\nexport const notifyStudent = createAsyncThunk(\r\n  'contacts/notifyStudent',\r\n  async ({ studentId, notification }: { studentId: string; notification: Omit<EmergencyNotificationData, 'studentId'> }) => {\r\n    const response = await contactsApiService.notifyStudent(studentId, notification);\r\n    return response.results;\r\n  }\r\n);\r\n\r\nexport const notifyContact = createAsyncThunk(\r\n  'contacts/notifyContact',\r\n  async ({ contactId, notification }: { contactId: string; notification: Omit<EmergencyNotificationData, 'studentId'> }) => {\r\n    const response = await contactsApiService.notifyContact(contactId, notification);\r\n    return response.result;\r\n  }\r\n);\r\n\r\nexport const verifyContact = createAsyncThunk(\r\n  'contacts/verify',\r\n  async ({ contactId, method }: { contactId: string; method: 'sms' | 'email' | 'voice' }) => {\r\n    const response = await contactsApiService.verifyContact(contactId, method);\r\n    return response;\r\n  }\r\n);\r\n\r\nexport const fetchContactStatistics = createAsyncThunk(\r\n  'contacts/fetchStatistics',\r\n  async () => {\r\n    const statistics = await contactsApiService.getStatistics();\r\n    return statistics;\r\n  }\r\n);\r\n\r\n// Slice\r\nconst contactsSlice = createSlice({\r\n  name: 'contacts',\r\n  initialState,\r\n  reducers: {\r\n    // Clear errors\r\n    clearContactsError: (state) => {\r\n      state.contactsError = null;\r\n    },\r\n    clearNotificationsError: (state) => {\r\n      state.notificationsError = null;\r\n    },\r\n    clearVerificationError: (state) => {\r\n      state.verificationError = null;\r\n    },\r\n    clearStatisticsError: (state) => {\r\n      state.statisticsError = null;\r\n    },\r\n    \r\n    // Set selected student\r\n    setSelectedStudent: (state, action) => {\r\n      state.selectedStudentId = action.payload;\r\n    },\r\n    \r\n    // Clear verification response\r\n    clearVerificationResponse: (state) => {\r\n      state.verificationResponse = null;\r\n    },\r\n    \r\n    // Clear notification results\r\n    clearNotificationResults: (state) => {\r\n      state.notificationResults = [];\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    // Fetch contacts by student\r\n    builder\r\n      .addCase(fetchContactsByStudent.pending, (state) => {\r\n        state.contactsLoading = true;\r\n        state.contactsError = null;\r\n      })\r\n      .addCase(fetchContactsByStudent.fulfilled, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.selectedStudentId = action.payload.studentId;\r\n        state.selectedStudentContacts = action.payload.contacts;\r\n        // Also update the main contacts array\r\n        state.contacts = action.payload.contacts;\r\n      })\r\n      .addCase(fetchContactsByStudent.rejected, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.contactsError = action.error.message || 'Failed to fetch contacts';\r\n      })\r\n\r\n    // Create emergency contact\r\n      .addCase(createEmergencyContact.pending, (state) => {\r\n        state.contactsLoading = true;\r\n        state.contactsError = null;\r\n      })\r\n      .addCase(createEmergencyContact.fulfilled, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.contacts.push(action.payload);\r\n        if (state.selectedStudentId === action.payload.studentId) {\r\n          state.selectedStudentContacts.push(action.payload);\r\n        }\r\n      })\r\n      .addCase(createEmergencyContact.rejected, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.contactsError = action.error.message || 'Failed to create contact';\r\n      })\r\n\r\n    // Update emergency contact\r\n      .addCase(updateEmergencyContact.pending, (state) => {\r\n        state.contactsLoading = true;\r\n        state.contactsError = null;\r\n      })\r\n      .addCase(updateEmergencyContact.fulfilled, (state, action) => {\r\n        state.contactsLoading = false;\r\n        const updatedContact = action.payload;\r\n        \r\n        // Update in main contacts array\r\n        const contactIndex = state.contacts.findIndex(c => c.id === updatedContact.id);\r\n        if (contactIndex !== -1) {\r\n          state.contacts[contactIndex] = updatedContact;\r\n        }\r\n        \r\n        // Update in selected student contacts\r\n        const studentContactIndex = state.selectedStudentContacts.findIndex(c => c.id === updatedContact.id);\r\n        if (studentContactIndex !== -1) {\r\n          state.selectedStudentContacts[studentContactIndex] = updatedContact;\r\n        }\r\n      })\r\n      .addCase(updateEmergencyContact.rejected, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.contactsError = action.error.message || 'Failed to update contact';\r\n      })\r\n\r\n    // Delete emergency contact\r\n      .addCase(deleteEmergencyContact.pending, (state) => {\r\n        state.contactsLoading = true;\r\n        state.contactsError = null;\r\n      })\r\n      .addCase(deleteEmergencyContact.fulfilled, (state, action) => {\r\n        state.contactsLoading = false;\r\n        const deletedId = action.payload;\r\n        \r\n        // Remove from main contacts array\r\n        state.contacts = state.contacts.filter(c => c.id !== deletedId);\r\n        \r\n        // Remove from selected student contacts\r\n        state.selectedStudentContacts = state.selectedStudentContacts.filter(c => c.id !== deletedId);\r\n      })\r\n      .addCase(deleteEmergencyContact.rejected, (state, action) => {\r\n        state.contactsLoading = false;\r\n        state.contactsError = action.error.message || 'Failed to delete contact';\r\n      })\r\n\r\n    // Notify student\r\n      .addCase(notifyStudent.pending, (state) => {\r\n        state.notificationsLoading = true;\r\n        state.notificationsError = null;\r\n      })\r\n      .addCase(notifyStudent.fulfilled, (state, action) => {\r\n        state.notificationsLoading = false;\r\n        state.notificationResults = action.payload;\r\n      })\r\n      .addCase(notifyStudent.rejected, (state, action) => {\r\n        state.notificationsLoading = false;\r\n        state.notificationsError = action.error.message || 'Failed to send notifications';\r\n      })\r\n\r\n    // Notify contact\r\n      .addCase(notifyContact.pending, (state) => {\r\n        state.notificationsLoading = true;\r\n        state.notificationsError = null;\r\n      })\r\n      .addCase(notifyContact.fulfilled, (state, action) => {\r\n        state.notificationsLoading = false;\r\n        state.notificationResults = [action.payload];\r\n      })\r\n      .addCase(notifyContact.rejected, (state, action) => {\r\n        state.notificationsLoading = false;\r\n        state.notificationsError = action.error.message || 'Failed to send notification';\r\n      })\r\n\r\n    // Verify contact\r\n      .addCase(verifyContact.pending, (state) => {\r\n        state.verificationLoading = true;\r\n        state.verificationError = null;\r\n      })\r\n      .addCase(verifyContact.fulfilled, (state, action) => {\r\n        state.verificationLoading = false;\r\n        state.verificationResponse = action.payload;\r\n      })\r\n      .addCase(verifyContact.rejected, (state, action) => {\r\n        state.verificationLoading = false;\r\n        state.verificationError = action.error.message || 'Failed to verify contact';\r\n      })\r\n\r\n    // Fetch statistics\r\n      .addCase(fetchContactStatistics.pending, (state) => {\r\n        state.statisticsLoading = true;\r\n        state.statisticsError = null;\r\n      })\r\n      .addCase(fetchContactStatistics.fulfilled, (state, action) => {\r\n        state.statisticsLoading = false;\r\n        state.statistics = action.payload;\r\n      })\r\n      .addCase(fetchContactStatistics.rejected, (state, action) => {\r\n        state.statisticsLoading = false;\r\n        state.statisticsError = action.error.message || 'Failed to fetch statistics';\r\n      });\r\n  },\r\n});\r\n\r\n// Selectors\r\nexport const selectContacts = (state: { contacts: ContactsState }) => state.contacts.contacts;\r\nexport const selectContactsLoading = (state: { contacts: ContactsState }) => state.contacts.contactsLoading;\r\nexport const selectContactsError = (state: { contacts: ContactsState }) => state.contacts.contactsError;\r\n\r\nexport const selectSelectedStudentId = (state: { contacts: ContactsState }) => state.contacts.selectedStudentId;\r\nexport const selectSelectedStudentContacts = (state: { contacts: ContactsState }) => state.contacts.selectedStudentContacts;\r\n\r\nexport const selectNotificationResults = (state: { contacts: ContactsState }) => state.contacts.notificationResults;\r\nexport const selectNotificationsLoading = (state: { contacts: ContactsState }) => state.contacts.notificationsLoading;\r\nexport const selectNotificationsError = (state: { contacts: ContactsState }) => state.contacts.notificationsError;\r\n\r\nexport const selectVerificationResponse = (state: { contacts: ContactsState }) => state.contacts.verificationResponse;\r\nexport const selectVerificationLoading = (state: { contacts: ContactsState }) => state.contacts.verificationLoading;\r\nexport const selectVerificationError = (state: { contacts: ContactsState }) => state.contacts.verificationError;\r\n\r\nexport const selectContactStatistics = (state: { contacts: ContactsState }) => state.contacts.statistics;\r\nexport const selectStatisticsLoading = (state: { contacts: ContactsState }) => state.contacts.statisticsLoading;\r\nexport const selectStatisticsError = (state: { contacts: ContactsState }) => state.contacts.statisticsError;\r\n\r\n// Derived selectors\r\nexport const selectPrimaryContacts = (state: { contacts: ContactsState }) => {\r\n  return state.contacts.selectedStudentContacts.filter(contact => contact.priority === 'PRIMARY');\r\n};\r\n\r\nexport const selectSecondaryContacts = (state: { contacts: ContactsState }) => {\r\n  return state.contacts.selectedStudentContacts.filter(contact => contact.priority === 'SECONDARY');\r\n};\r\n\r\nexport const selectVerifiedContacts = (state: { contacts: ContactsState }) => {\r\n  return state.contacts.selectedStudentContacts.filter(contact => contact.verificationStatus === 'VERIFIED');\r\n};\r\n\r\nexport const selectUnverifiedContacts = (state: { contacts: ContactsState }) => {\r\n  return state.contacts.selectedStudentContacts.filter(contact => contact.verificationStatus !== 'VERIFIED');\r\n};\r\n\r\n// Export actions and reducer\r\nexport const {\r\n  clearContactsError,\r\n  clearNotificationsError,\r\n  clearVerificationError,\r\n  clearStatisticsError,\r\n  setSelectedStudent,\r\n  clearVerificationResponse,\r\n  clearNotificationResults,\r\n} = contactsSlice.actions;\r\n\r\nexport default contactsSlice.reducer;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAqHC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAED;AACA;;;AAWO,MAAM;IACX,qBAAqB;IACrB,MAAM,qBAAqB,SAAiB,EAAE;QAC5C,OAAO,wJAAU,CAAC,iBAAiB,CAAC,YAAY,CAAC;IACnD;IAEA,MAAM,uBAAuB,IAAgC,EAAE;QAC7D,OAAO,wJAAU,CAAC,iBAAiB,CAAC,MAAM,CAAC;IAC7C;IAEA,MAAM,uBAAuB,EAAU,EAAE,IAAgC,EAAE;QACzE,OAAO,wJAAU,CAAC,iBAAiB,CAAC,MAAM,CAAC,IAAI;IACjD;IAEA,MAAM,uBAAuB,EAAU,EAAE;QACvC,OAAO,wJAAU,CAAC,iBAAiB,CAAC,MAAM,CAAC;IAC7C;IAEA,gBAAgB;IAChB,MAAM,cAAc,SAAiB,EAAE,YAA0D,EAAE;QACjG,OAAO,wJAAU,CAAC,iBAAiB,CAAC,aAAa,CAAC,WAAW;IAC/D;IAEA,MAAM,cAAc,SAAiB,EAAE,YAA0D,EAAE;QACjG,OAAO,wJAAU,CAAC,iBAAiB,CAAC,aAAa,CAAC,WAAW;IAC/D;IAEA,eAAe;IACf,MAAM,cAAc,SAAiB,EAAE,MAAiC,EAAE;QACxE,OAAO,wJAAU,CAAC,iBAAiB,CAAC,MAAM,CAAC,WAAW;IACxD;IAEA,aAAa;IACb,MAAM,gBAAgB;QACpB,OAAO,wJAAU,CAAC,iBAAiB,CAAC,aAAa;IACnD;AACF;AAGO,MAAM,qBAAqB,IAAI;AA6BtC,gBAAgB;AAChB,MAAM,eAA8B;IAClC,UAAU,EAAE;IACZ,iBAAiB;IACjB,eAAe;IAEf,mBAAmB;IACnB,yBAAyB,EAAE;IAE3B,qBAAqB,EAAE;IACvB,sBAAsB;IACtB,oBAAoB;IAEpB,sBAAsB;IACtB,qBAAqB;IACrB,mBAAmB;IAEnB,YAAY;IACZ,mBAAmB;IACnB,iBAAiB;AACnB;AAGO,MAAM,yBAAyB,IAAA,+MAAgB,EACpD,2BACA,OAAO;IACL,MAAM,WAAW,MAAM,mBAAmB,oBAAoB,CAAC;IAC/D,OAAO;QAAE;QAAW,UAAU,SAAS,QAAQ;IAAC;AAClD;AAGK,MAAM,yBAAyB,IAAA,+MAAgB,EACpD,mBACA,OAAO;IACL,MAAM,WAAW,MAAM,mBAAmB,sBAAsB,CAAC;IACjE,OAAO,SAAS,OAAO;AACzB;AAGK,MAAM,yBAAyB,IAAA,+MAAgB,EACpD,mBACA,OAAO,EAAE,EAAE,EAAE,IAAI,EAAoD;IACnE,MAAM,WAAW,MAAM,mBAAmB,sBAAsB,CAAC,IAAI;IACrE,OAAO,SAAS,OAAO;AACzB;AAGK,MAAM,yBAAyB,IAAA,+MAAgB,EACpD,mBACA,OAAO;IACL,MAAM,mBAAmB,sBAAsB,CAAC;IAChD,OAAO;AACT;AAGK,MAAM,gBAAgB,IAAA,+MAAgB,EAC3C,0BACA,OAAO,EAAE,SAAS,EAAE,YAAY,EAAqF;IACnH,MAAM,WAAW,MAAM,mBAAmB,aAAa,CAAC,WAAW;IACnE,OAAO,SAAS,OAAO;AACzB;AAGK,MAAM,gBAAgB,IAAA,+MAAgB,EAC3C,0BACA,OAAO,EAAE,SAAS,EAAE,YAAY,EAAqF;IACnH,MAAM,WAAW,MAAM,mBAAmB,aAAa,CAAC,WAAW;IACnE,OAAO,SAAS,MAAM;AACxB;AAGK,MAAM,gBAAgB,IAAA,+MAAgB,EAC3C,mBACA,OAAO,EAAE,SAAS,EAAE,MAAM,EAA4D;IACpF,MAAM,WAAW,MAAM,mBAAmB,aAAa,CAAC,WAAW;IACnE,OAAO;AACT;AAGK,MAAM,yBAAyB,IAAA,+MAAgB,EACpD,4BACA;IACE,MAAM,aAAa,MAAM,mBAAmB,aAAa;IACzD,OAAO;AACT;AAGF,QAAQ;AACR,MAAM,gBAAgB,IAAA,0MAAW,EAAC;IAChC,MAAM;IACN;IACA,UAAU;QACR,eAAe;QACf,oBAAoB,CAAC;YACnB,MAAM,aAAa,GAAG;QACxB;QACA,yBAAyB,CAAC;YACxB,MAAM,kBAAkB,GAAG;QAC7B;QACA,wBAAwB,CAAC;YACvB,MAAM,iBAAiB,GAAG;QAC5B;QACA,sBAAsB,CAAC;YACrB,MAAM,eAAe,GAAG;QAC1B;QAEA,uBAAuB;QACvB,oBAAoB,CAAC,OAAO;YAC1B,MAAM,iBAAiB,GAAG,OAAO,OAAO;QAC1C;QAEA,8BAA8B;QAC9B,2BAA2B,CAAC;YAC1B,MAAM,oBAAoB,GAAG;QAC/B;QAEA,6BAA6B;QAC7B,0BAA0B,CAAC;YACzB,MAAM,mBAAmB,GAAG,EAAE;QAChC;IACF;IACA,eAAe,CAAC;QACd,4BAA4B;QAC5B,QACG,OAAO,CAAC,uBAAuB,OAAO,EAAE,CAAC;YACxC,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG;QACxB,GACC,OAAO,CAAC,uBAAuB,SAAS,EAAE,CAAC,OAAO;YACjD,MAAM,eAAe,GAAG;YACxB,MAAM,iBAAiB,GAAG,OAAO,OAAO,CAAC,SAAS;YAClD,MAAM,uBAAuB,GAAG,OAAO,OAAO,CAAC,QAAQ;YACvD,sCAAsC;YACtC,MAAM,QAAQ,GAAG,OAAO,OAAO,CAAC,QAAQ;QAC1C,GACC,OAAO,CAAC,uBAAuB,QAAQ,EAAE,CAAC,OAAO;YAChD,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QAChD,EAEF,2BAA2B;SACxB,OAAO,CAAC,uBAAuB,OAAO,EAAE,CAAC;YACxC,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG;QACxB,GACC,OAAO,CAAC,uBAAuB,SAAS,EAAE,CAAC,OAAO;YACjD,MAAM,eAAe,GAAG;YACxB,MAAM,QAAQ,CAAC,IAAI,CAAC,OAAO,OAAO;YAClC,IAAI,MAAM,iBAAiB,KAAK,OAAO,OAAO,CAAC,SAAS,EAAE;gBACxD,MAAM,uBAAuB,CAAC,IAAI,CAAC,OAAO,OAAO;YACnD;QACF,GACC,OAAO,CAAC,uBAAuB,QAAQ,EAAE,CAAC,OAAO;YAChD,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QAChD,EAEF,2BAA2B;SACxB,OAAO,CAAC,uBAAuB,OAAO,EAAE,CAAC;YACxC,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG;QACxB,GACC,OAAO,CAAC,uBAAuB,SAAS,EAAE,CAAC,OAAO;YACjD,MAAM,eAAe,GAAG;YACxB,MAAM,iBAAiB,OAAO,OAAO;YAErC,gCAAgC;YAChC,MAAM,eAAe,MAAM,QAAQ,CAAC,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,eAAe,EAAE;YAC7E,IAAI,iBAAiB,CAAC,GAAG;gBACvB,MAAM,QAAQ,CAAC,aAAa,GAAG;YACjC;YAEA,sCAAsC;YACtC,MAAM,sBAAsB,MAAM,uBAAuB,CAAC,SAAS,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,eAAe,EAAE;YACnG,IAAI,wBAAwB,CAAC,GAAG;gBAC9B,MAAM,uBAAuB,CAAC,oBAAoB,GAAG;YACvD;QACF,GACC,OAAO,CAAC,uBAAuB,QAAQ,EAAE,CAAC,OAAO;YAChD,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QAChD,EAEF,2BAA2B;SACxB,OAAO,CAAC,uBAAuB,OAAO,EAAE,CAAC;YACxC,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG;QACxB,GACC,OAAO,CAAC,uBAAuB,SAAS,EAAE,CAAC,OAAO;YACjD,MAAM,eAAe,GAAG;YACxB,MAAM,YAAY,OAAO,OAAO;YAEhC,kCAAkC;YAClC,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YAErD,wCAAwC;YACxC,MAAM,uBAAuB,GAAG,MAAM,uBAAuB,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QACrF,GACC,OAAO,CAAC,uBAAuB,QAAQ,EAAE,CAAC,OAAO;YAChD,MAAM,eAAe,GAAG;YACxB,MAAM,aAAa,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QAChD,EAEF,iBAAiB;SACd,OAAO,CAAC,cAAc,OAAO,EAAE,CAAC;YAC/B,MAAM,oBAAoB,GAAG;YAC7B,MAAM,kBAAkB,GAAG;QAC7B,GACC,OAAO,CAAC,cAAc,SAAS,EAAE,CAAC,OAAO;YACxC,MAAM,oBAAoB,GAAG;YAC7B,MAAM,mBAAmB,GAAG,OAAO,OAAO;QAC5C,GACC,OAAO,CAAC,cAAc,QAAQ,EAAE,CAAC,OAAO;YACvC,MAAM,oBAAoB,GAAG;YAC7B,MAAM,kBAAkB,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QACrD,EAEF,iBAAiB;SACd,OAAO,CAAC,cAAc,OAAO,EAAE,CAAC;YAC/B,MAAM,oBAAoB,GAAG;YAC7B,MAAM,kBAAkB,GAAG;QAC7B,GACC,OAAO,CAAC,cAAc,SAAS,EAAE,CAAC,OAAO;YACxC,MAAM,oBAAoB,GAAG;YAC7B,MAAM,mBAAmB,GAAG;gBAAC,OAAO,OAAO;aAAC;QAC9C,GACC,OAAO,CAAC,cAAc,QAAQ,EAAE,CAAC,OAAO;YACvC,MAAM,oBAAoB,GAAG;YAC7B,MAAM,kBAAkB,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QACrD,EAEF,iBAAiB;SACd,OAAO,CAAC,cAAc,OAAO,EAAE,CAAC;YAC/B,MAAM,mBAAmB,GAAG;YAC5B,MAAM,iBAAiB,GAAG;QAC5B,GACC,OAAO,CAAC,cAAc,SAAS,EAAE,CAAC,OAAO;YACxC,MAAM,mBAAmB,GAAG;YAC5B,MAAM,oBAAoB,GAAG,OAAO,OAAO;QAC7C,GACC,OAAO,CAAC,cAAc,QAAQ,EAAE,CAAC,OAAO;YACvC,MAAM,mBAAmB,GAAG;YAC5B,MAAM,iBAAiB,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QACpD,EAEF,mBAAmB;SAChB,OAAO,CAAC,uBAAuB,OAAO,EAAE,CAAC;YACxC,MAAM,iBAAiB,GAAG;YAC1B,MAAM,eAAe,GAAG;QAC1B,GACC,OAAO,CAAC,uBAAuB,SAAS,EAAE,CAAC,OAAO;YACjD,MAAM,iBAAiB,GAAG;YAC1B,MAAM,UAAU,GAAG,OAAO,OAAO;QACnC,GACC,OAAO,CAAC,uBAAuB,QAAQ,EAAE,CAAC,OAAO;YAChD,MAAM,iBAAiB,GAAG;YAC1B,MAAM,eAAe,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QAClD;IACJ;AACF;AAGO,MAAM,iBAAiB,CAAC,QAAuC,MAAM,QAAQ,CAAC,QAAQ;AACtF,MAAM,wBAAwB,CAAC,QAAuC,MAAM,QAAQ,CAAC,eAAe;AACpG,MAAM,sBAAsB,CAAC,QAAuC,MAAM,QAAQ,CAAC,aAAa;AAEhG,MAAM,0BAA0B,CAAC,QAAuC,MAAM,QAAQ,CAAC,iBAAiB;AACxG,MAAM,gCAAgC,CAAC,QAAuC,MAAM,QAAQ,CAAC,uBAAuB;AAEpH,MAAM,4BAA4B,CAAC,QAAuC,MAAM,QAAQ,CAAC,mBAAmB;AAC5G,MAAM,6BAA6B,CAAC,QAAuC,MAAM,QAAQ,CAAC,oBAAoB;AAC9G,MAAM,2BAA2B,CAAC,QAAuC,MAAM,QAAQ,CAAC,kBAAkB;AAE1G,MAAM,6BAA6B,CAAC,QAAuC,MAAM,QAAQ,CAAC,oBAAoB;AAC9G,MAAM,4BAA4B,CAAC,QAAuC,MAAM,QAAQ,CAAC,mBAAmB;AAC5G,MAAM,0BAA0B,CAAC,QAAuC,MAAM,QAAQ,CAAC,iBAAiB;AAExG,MAAM,0BAA0B,CAAC,QAAuC,MAAM,QAAQ,CAAC,UAAU;AACjG,MAAM,0BAA0B,CAAC,QAAuC,MAAM,QAAQ,CAAC,iBAAiB;AACxG,MAAM,wBAAwB,CAAC,QAAuC,MAAM,QAAQ,CAAC,eAAe;AAGpG,MAAM,wBAAwB,CAAC;IACpC,OAAO,MAAM,QAAQ,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAA,UAAW,QAAQ,QAAQ,KAAK;AACvF;AAEO,MAAM,0BAA0B,CAAC;IACtC,OAAO,MAAM,QAAQ,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAA,UAAW,QAAQ,QAAQ,KAAK;AACvF;AAEO,MAAM,yBAAyB,CAAC;IACrC,OAAO,MAAM,QAAQ,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAA,UAAW,QAAQ,kBAAkB,KAAK;AACjG;AAEO,MAAM,2BAA2B,CAAC;IACvC,OAAO,MAAM,QAAQ,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAA,UAAW,QAAQ,kBAAkB,KAAK;AACjG;AAGO,MAAM,EACX,kBAAkB,EAClB,uBAAuB,EACvB,sBAAsB,EACtB,oBAAoB,EACpB,kBAAkB,EAClB,yBAAyB,EACzB,wBAAwB,EACzB,GAAG,cAAc,OAAO;uCAEV,cAAc,OAAO","debugId":null}},
    {"offset": {"line": 13666, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/themeSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Theme and UI Preferences Redux Slice for White Cross Healthcare Platform\r\n *\r\n * Manages global UI theme, accessibility preferences, and user interface customizations\r\n * for the healthcare platform. Provides comprehensive state management for visual\r\n * preferences, accessibility compliance, and responsive design settings.\r\n *\r\n * **Key Features:**\r\n * - Dark/light/system theme modes with automatic system preference detection\r\n * - Healthcare-optimized color schemes (blue, teal, purple, green)\r\n * - UI density settings for optimal healthcare workflow efficiency\r\n * - Comprehensive accessibility preferences (high contrast, reduced motion, font scaling)\r\n * - Sidebar and tooltip visibility controls\r\n * - Cross-device preference synchronization\r\n * - Real-time theme switching without page reload\r\n * - SSR-compatible with hydration-safe theme detection\r\n *\r\n * **HIPAA Compliance:**\r\n * - Theme preferences contain NO PHI data - safe for localStorage persistence\r\n * - All preferences are user-specific and do not contain patient information\r\n * - Theme settings do not affect data security or access controls\r\n * - Accessibility preferences support compliance with ADA and Section 508 requirements\r\n * - No audit logging required for theme changes (non-PHI preference data)\r\n *\r\n * **Healthcare UI Considerations:**\r\n * - **High Contrast Mode**: Essential for medical professionals working in varied lighting\r\n * - **Font Scaling**: Critical for readability of patient data and medication information\r\n * - **Reduced Motion**: Important for users with vestibular disorders or motion sensitivity\r\n * - **UI Density**: Optimized spacing for efficiency in clinical workflows\r\n * - **Color Schemes**: Designed for medical environments with appropriate contrast ratios\r\n *\r\n * **Accessibility Features:**\r\n * - WCAG 2.1 AA compliant color combinations\r\n * - Keyboard navigation support indicators\r\n * - Screen reader compatibility modes\r\n * - Motion reduction for vestibular disorder accommodation\r\n * - Font scaling from 80% to 150% for vision accommodation\r\n * - High contrast mode with enhanced color separation\r\n *\r\n * **State Persistence:**\r\n * - All preferences persisted to localStorage (non-PHI data)\r\n * - Cross-browser tab synchronization via storage events\r\n * - Server-side rendering safe with hydration protection\r\n * - Preference export/import for user account migration\r\n * - Default fallbacks for new users and corrupted preferences\r\n *\r\n * **Integration:**\r\n * - CSS custom properties integration for real-time theme updates\r\n * - Tailwind CSS theme configuration synchronization\r\n * - Next.js App Router SSR compatibility\r\n * - React Query integration for preference caching\r\n * - WebSocket integration for cross-device synchronization (future)\r\n *\r\n * @module stores/slices/themeSlice\r\n * @requires @reduxjs/toolkit\r\n * @security Non-PHI user preferences, localStorage safe\r\n * @compliance ADA and Section 508 accessibility compliance\r\n *\r\n * @example Complete theme management\r\n * ```typescript\r\n * import { useAppSelector, useAppDispatch } from '@/stores/hooks';\r\n * import { \r\n *   toggleTheme, \r\n *   setColorScheme, \r\n *   setFontSizeMultiplier,\r\n *   toggleHighContrast \r\n * } from '@/stores/slices/themeSlice';\r\n *\r\n * function ThemeControls() {\r\n *   const theme = useAppSelector(selectTheme);\r\n *   const dispatch = useAppDispatch();\r\n *\r\n *   return (\r\n *     <div className=\"theme-controls\">\r\n *       <button onClick={() => dispatch(toggleTheme())}>\r\n *         {theme.mode === 'dark' ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark'}\r\n *       </button>\r\n *       \r\n *       <select \r\n *         value={theme.colorScheme} \r\n *         onChange={(e) => dispatch(setColorScheme(e.target.value))}\r\n *       >\r\n *         <option value=\"blue\">Healthcare Blue</option>\r\n *         <option value=\"teal\">Medical Teal</option>\r\n *         <option value=\"purple\">Wellness Purple</option>\r\n *         <option value=\"green\">Health Green</option>\r\n *       </select>\r\n *       \r\n *       <label>\r\n *         Font Size: {Math.round(theme.fontSizeMultiplier * 100)}%\r\n *         <input \r\n *           type=\"range\" \r\n *           min=\"0.8\" \r\n *           max=\"1.5\" \r\n *           step=\"0.1\"\r\n *           value={theme.fontSizeMultiplier}\r\n *           onChange={(e) => dispatch(setFontSizeMultiplier(parseFloat(e.target.value)))}\r\n *         />\r\n *       </label>\r\n *       \r\n *       <button \r\n *         onClick={() => dispatch(toggleHighContrast())}\r\n *         className={theme.highContrast ? 'active' : ''}\r\n *       >\r\n *         High Contrast: {theme.highContrast ? 'ON' : 'OFF'}\r\n *       </button>\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @example Accessibility-aware component\r\n * ```typescript\r\n * function AccessibleComponent() {\r\n *   const { reducedMotion, highContrast, fontSizeMultiplier } = useAppSelector(selectTheme);\r\n *   \r\n *   return (\r\n *     <div \r\n *       className={`\r\n *         ${reducedMotion ? 'motion-reduce' : 'motion-normal'}\r\n *         ${highContrast ? 'high-contrast' : 'normal-contrast'}\r\n *       `}\r\n *       style={{ \r\n *         fontSize: `${fontSizeMultiplier}rem`,\r\n *         transition: reducedMotion ? 'none' : 'all 0.3s ease'\r\n *       }}\r\n *     >\r\n *       Content that respects accessibility preferences\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @example System theme detection with SSR safety\r\n * ```typescript\r\n * function ThemeProvider({ children }) {\r\n *   const effectiveMode = useAppSelector(selectEffectiveThemeMode);\r\n *   const [mounted, setMounted] = useState(false);\r\n *\r\n *   useEffect(() => {\r\n *     setMounted(true);\r\n *   }, []);\r\n *\r\n *   // Prevent hydration mismatch\r\n *   if (!mounted) {\r\n *     return <div className=\"theme-loading\">{children}</div>;\r\n *   }\r\n *\r\n *   return (\r\n *     <div className={`theme-${effectiveMode}`} data-theme={effectiveMode}>\r\n *       {children}\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n *\r\n * @see {@link ../reduxStore.ts} for store configuration\r\n * @see {@link ../../components/ThemeProvider.tsx} for theme context integration\r\n * @since 1.0.0\r\n */\r\n\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\n\r\n/**\r\n * Theme mode options\r\n */\r\nexport type ThemeMode = 'light' | 'dark' | 'system';\r\n\r\n/**\r\n * Color scheme options for healthcare UI\r\n */\r\nexport type ColorScheme = 'blue' | 'teal' | 'purple' | 'green';\r\n\r\n/**\r\n * UI density options\r\n */\r\nexport type UIDensity = 'comfortable' | 'compact' | 'spacious';\r\n\r\n/**\r\n * Theme state interface\r\n */\r\nexport interface ThemeState {\r\n  /**\r\n   * Current theme mode\r\n   */\r\n  mode: ThemeMode;\r\n\r\n  /**\r\n   * Color scheme for UI elements\r\n   */\r\n  colorScheme: ColorScheme;\r\n\r\n  /**\r\n   * UI density setting\r\n   */\r\n  density: UIDensity;\r\n\r\n  /**\r\n   * High contrast mode for accessibility\r\n   */\r\n  highContrast: boolean;\r\n\r\n  /**\r\n   * Reduced motion for accessibility\r\n   */\r\n  reducedMotion: boolean;\r\n\r\n  /**\r\n   * Font size multiplier (1.0 = normal, 1.2 = 20% larger)\r\n   */\r\n  fontSizeMultiplier: number;\r\n\r\n  /**\r\n   * Show tooltips for UI elements\r\n   */\r\n  showTooltips: boolean;\r\n\r\n  /**\r\n   * Sidebar collapsed state\r\n   */\r\n  sidebarCollapsed: boolean;\r\n}\r\n\r\n/**\r\n * Initial theme state with defaults\r\n */\r\nconst initialState: ThemeState = {\r\n  mode: 'system',\r\n  colorScheme: 'blue',\r\n  density: 'comfortable',\r\n  highContrast: false,\r\n  reducedMotion: false,\r\n  fontSizeMultiplier: 1.0,\r\n  showTooltips: true,\r\n  sidebarCollapsed: false,\r\n};\r\n\r\n/**\r\n * Theme slice with reducers for UI preferences\r\n */\r\nconst themeSlice = createSlice({\r\n  name: 'theme',\r\n  initialState,\r\n  reducers: {\r\n    /**\r\n     * Set theme mode (light, dark, or system)\r\n     */\r\n    setThemeMode: (state, action: PayloadAction<ThemeMode>) => {\r\n      state.mode = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle between light and dark mode\r\n     */\r\n    toggleTheme: (state) => {\r\n      if (state.mode === 'light') {\r\n        state.mode = 'dark';\r\n      } else if (state.mode === 'dark') {\r\n        state.mode = 'light';\r\n      } else {\r\n        // If system, toggle to opposite of current system preference\r\n        const prefersDark = typeof window !== 'undefined' &&\r\n          window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n        state.mode = prefersDark ? 'light' : 'dark';\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Set color scheme for UI\r\n     */\r\n    setColorScheme: (state, action: PayloadAction<ColorScheme>) => {\r\n      state.colorScheme = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Set UI density\r\n     */\r\n    setDensity: (state, action: PayloadAction<UIDensity>) => {\r\n      state.density = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle high contrast mode\r\n     */\r\n    toggleHighContrast: (state) => {\r\n      state.highContrast = !state.highContrast;\r\n    },\r\n\r\n    /**\r\n     * Set high contrast mode\r\n     */\r\n    setHighContrast: (state, action: PayloadAction<boolean>) => {\r\n      state.highContrast = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle reduced motion\r\n     */\r\n    toggleReducedMotion: (state) => {\r\n      state.reducedMotion = !state.reducedMotion;\r\n    },\r\n\r\n    /**\r\n     * Set reduced motion\r\n     */\r\n    setReducedMotion: (state, action: PayloadAction<boolean>) => {\r\n      state.reducedMotion = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Set font size multiplier\r\n     */\r\n    setFontSizeMultiplier: (state, action: PayloadAction<number>) => {\r\n      // Clamp between 0.8 and 1.5\r\n      state.fontSizeMultiplier = Math.max(0.8, Math.min(1.5, action.payload));\r\n    },\r\n\r\n    /**\r\n     * Toggle tooltips visibility\r\n     */\r\n    toggleTooltips: (state) => {\r\n      state.showTooltips = !state.showTooltips;\r\n    },\r\n\r\n    /**\r\n     * Set tooltips visibility\r\n     */\r\n    setShowTooltips: (state, action: PayloadAction<boolean>) => {\r\n      state.showTooltips = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle sidebar collapsed state\r\n     */\r\n    toggleSidebar: (state) => {\r\n      state.sidebarCollapsed = !state.sidebarCollapsed;\r\n    },\r\n\r\n    /**\r\n     * Set sidebar collapsed state\r\n     */\r\n    setSidebarCollapsed: (state, action: PayloadAction<boolean>) => {\r\n      state.sidebarCollapsed = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Reset theme to defaults\r\n     */\r\n    resetTheme: (state) => {\r\n      Object.assign(state, initialState);\r\n    },\r\n  },\r\n});\r\n\r\n// Export actions\r\nexport const {\r\n  setThemeMode,\r\n  toggleTheme,\r\n  setColorScheme,\r\n  setDensity,\r\n  toggleHighContrast,\r\n  setHighContrast,\r\n  toggleReducedMotion,\r\n  setReducedMotion,\r\n  setFontSizeMultiplier,\r\n  toggleTooltips,\r\n  setShowTooltips,\r\n  toggleSidebar,\r\n  setSidebarCollapsed,\r\n  resetTheme,\r\n} = themeSlice.actions;\r\n\r\n// Export reducer\r\nexport default themeSlice.reducer;\r\n\r\n// Selectors\r\nexport const selectTheme = (state: { theme: ThemeState }) => state.theme;\r\nexport const selectThemeMode = (state: { theme: ThemeState }) => state.theme.mode;\r\nexport const selectColorScheme = (state: { theme: ThemeState }) => state.theme.colorScheme;\r\nexport const selectDensity = (state: { theme: ThemeState }) => state.theme.density;\r\nexport const selectIsHighContrast = (state: { theme: ThemeState }) => state.theme.highContrast;\r\nexport const selectIsReducedMotion = (state: { theme: ThemeState }) => state.theme.reducedMotion;\r\nexport const selectFontSizeMultiplier = (state: { theme: ThemeState }) => state.theme.fontSizeMultiplier;\r\nexport const selectShowTooltips = (state: { theme: ThemeState }) => state.theme.showTooltips;\r\nexport const selectIsSidebarCollapsed = (state: { theme: ThemeState }) => state.theme.sidebarCollapsed;\r\n\r\n/**\r\n * Get effective theme mode (resolves 'system' to actual mode)\r\n */\r\nexport const selectEffectiveThemeMode = (state: { theme: ThemeState }): 'light' | 'dark' => {\r\n  const { mode } = state.theme;\r\n\r\n  if (mode === 'system') {\r\n    // Check system preference\r\n    if (typeof window !== 'undefined') {\r\n      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n    }\r\n    return 'light'; // Default for SSR\r\n  }\r\n\r\n  return mode;\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 14009, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/notificationsSlice.ts"],"sourcesContent":["/**\r\n * @fileoverview Notifications Slice - In-App Notifications Management\r\n * @module stores/slices/notificationsSlice\r\n * @category Store\r\n *\r\n * Manages in-app notifications, alerts, and toast messages.\r\n * Session-only (NOT persisted to localStorage for HIPAA compliance).\r\n *\r\n * Features:\r\n * - Real-time notification management\r\n * - Toast notifications\r\n * - Priority-based display\r\n * - Read/unread tracking\r\n * - Auto-dismiss logic\r\n * - SSR-compatible (session-only)\r\n * - NOT persisted (PHI may be in notifications)\r\n *\r\n * @example\r\n * ```typescript\r\n * import { useAppSelector, useAppDispatch } from '@/stores/hooks';\r\n * import { addNotification, markAsRead } from '@/stores/slices/notificationsSlice';\r\n *\r\n * function NotificationCenter() {\r\n *   const notifications = useAppSelector(state => state.notifications.items);\r\n *   const dispatch = useAppDispatch();\r\n *\r\n *   const notify = () => {\r\n *     dispatch(addNotification({\r\n *       title: 'New Appointment',\r\n *       message: 'You have a new appointment scheduled',\r\n *       type: 'info',\r\n *       priority: 'medium',\r\n *     }));\r\n *   };\r\n *\r\n *   return (\r\n *     <div>\r\n *       {notifications.map(notif => (\r\n *         <NotificationItem\r\n *           key={notif.id}\r\n *           {...notif}\r\n *           onRead={() => dispatch(markAsRead(notif.id))}\r\n *         />\r\n *       ))}\r\n *     </div>\r\n *   );\r\n * }\r\n * ```\r\n */\r\n\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { nanoid } from 'nanoid';\r\n\r\n/**\r\n * Notification type\r\n */\r\nexport type NotificationType = 'info' | 'success' | 'warning' | 'error' | 'system';\r\n\r\n/**\r\n * Notification priority\r\n */\r\nexport type NotificationPriority = 'low' | 'medium' | 'high' | 'critical';\r\n\r\n/**\r\n * Single notification item\r\n */\r\nexport interface Notification {\r\n  /**\r\n   * Unique notification ID\r\n   */\r\n  id: string;\r\n\r\n  /**\r\n   * Notification title\r\n   */\r\n  title: string;\r\n\r\n  /**\r\n   * Notification message body\r\n   */\r\n  message: string;\r\n\r\n  /**\r\n   * Notification type\r\n   */\r\n  type: NotificationType;\r\n\r\n  /**\r\n   * Priority level\r\n   */\r\n  priority: NotificationPriority;\r\n\r\n  /**\r\n   * Read status\r\n   */\r\n  read: boolean;\r\n\r\n  /**\r\n   * Creation timestamp\r\n   */\r\n  createdAt: string;\r\n\r\n  /**\r\n   * Optional action link\r\n   */\r\n  actionUrl?: string;\r\n\r\n  /**\r\n   * Optional action label\r\n   */\r\n  actionLabel?: string;\r\n\r\n  /**\r\n   * Auto-dismiss after milliseconds (0 = no auto-dismiss)\r\n   */\r\n  autoDismiss?: number;\r\n\r\n  /**\r\n   * Optional metadata (e.g., studentId, medicationId)\r\n   * Note: May contain references to PHI entities\r\n   */\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\n/**\r\n * Notifications state interface\r\n */\r\nexport interface NotificationsState {\r\n  /**\r\n   * All notifications\r\n   */\r\n  items: Notification[];\r\n\r\n  /**\r\n   * Total unread count\r\n   */\r\n  unreadCount: number;\r\n\r\n  /**\r\n   * Show notification center\r\n   */\r\n  showCenter: boolean;\r\n\r\n  /**\r\n   * Enable toast notifications\r\n   */\r\n  toastsEnabled: boolean;\r\n\r\n  /**\r\n   * Enable sound for notifications\r\n   */\r\n  soundEnabled: boolean;\r\n}\r\n\r\n/**\r\n * Initial notifications state\r\n */\r\nconst initialState: NotificationsState = {\r\n  items: [],\r\n  unreadCount: 0,\r\n  showCenter: false,\r\n  toastsEnabled: true,\r\n  soundEnabled: false,\r\n};\r\n\r\n/**\r\n * Notifications slice with reducers\r\n */\r\nconst notificationsSlice = createSlice({\r\n  name: 'notifications',\r\n  initialState,\r\n  reducers: {\r\n    /**\r\n     * Add a new notification\r\n     */\r\n    addNotification: (state, action: PayloadAction<Omit<Notification, 'id' | 'read' | 'createdAt'>>) => {\r\n      const notification: Notification = {\r\n        ...action.payload,\r\n        id: nanoid(),\r\n        read: false,\r\n        createdAt: new Date().toISOString(),\r\n      };\r\n\r\n      // Add to beginning (newest first)\r\n      state.items.unshift(notification);\r\n\r\n      // Update unread count\r\n      state.unreadCount += 1;\r\n\r\n      // Limit to 100 notifications\r\n      if (state.items.length > 100) {\r\n        state.items = state.items.slice(0, 100);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Add multiple notifications\r\n     */\r\n    addNotifications: (state, action: PayloadAction<Array<Omit<Notification, 'id' | 'read' | 'createdAt'>>>) => {\r\n      const notifications: Notification[] = action.payload.map(notif => ({\r\n        ...notif,\r\n        id: nanoid(),\r\n        read: false,\r\n        createdAt: new Date().toISOString(),\r\n      }));\r\n\r\n      state.items.unshift(...notifications);\r\n      state.unreadCount += notifications.length;\r\n\r\n      // Limit to 100 notifications\r\n      if (state.items.length > 100) {\r\n        state.items = state.items.slice(0, 100);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Mark notification as read\r\n     */\r\n    markAsRead: (state, action: PayloadAction<string>) => {\r\n      const notification = state.items.find(n => n.id === action.payload);\r\n      if (notification && !notification.read) {\r\n        notification.read = true;\r\n        state.unreadCount = Math.max(0, state.unreadCount - 1);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Mark all notifications as read\r\n     */\r\n    markAllAsRead: (state) => {\r\n      state.items.forEach(notification => {\r\n        notification.read = true;\r\n      });\r\n      state.unreadCount = 0;\r\n    },\r\n\r\n    /**\r\n     * Remove notification\r\n     */\r\n    removeNotification: (state, action: PayloadAction<string>) => {\r\n      const index = state.items.findIndex(n => n.id === action.payload);\r\n      if (index !== -1) {\r\n        const wasUnread = !state.items[index].read;\r\n        state.items.splice(index, 1);\r\n        if (wasUnread) {\r\n          state.unreadCount = Math.max(0, state.unreadCount - 1);\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Clear all notifications\r\n     */\r\n    clearAllNotifications: (state) => {\r\n      state.items = [];\r\n      state.unreadCount = 0;\r\n    },\r\n\r\n    /**\r\n     * Clear read notifications\r\n     */\r\n    clearReadNotifications: (state) => {\r\n      state.items = state.items.filter(n => !n.read);\r\n    },\r\n\r\n    /**\r\n     * Toggle notification center visibility\r\n     */\r\n    toggleNotificationCenter: (state) => {\r\n      state.showCenter = !state.showCenter;\r\n    },\r\n\r\n    /**\r\n     * Set notification center visibility\r\n     */\r\n    setShowCenter: (state, action: PayloadAction<boolean>) => {\r\n      state.showCenter = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle toasts enabled\r\n     */\r\n    toggleToasts: (state) => {\r\n      state.toastsEnabled = !state.toastsEnabled;\r\n    },\r\n\r\n    /**\r\n     * Set toasts enabled\r\n     */\r\n    setToastsEnabled: (state, action: PayloadAction<boolean>) => {\r\n      state.toastsEnabled = action.payload;\r\n    },\r\n\r\n    /**\r\n     * Toggle sound enabled\r\n     */\r\n    toggleSound: (state) => {\r\n      state.soundEnabled = !state.soundEnabled;\r\n    },\r\n\r\n    /**\r\n     * Set sound enabled\r\n     */\r\n    setSoundEnabled: (state, action: PayloadAction<boolean>) => {\r\n      state.soundEnabled = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\n// Export actions\r\nexport const {\r\n  addNotification,\r\n  addNotifications,\r\n  markAsRead,\r\n  markAllAsRead,\r\n  removeNotification,\r\n  clearAllNotifications,\r\n  clearReadNotifications,\r\n  toggleNotificationCenter,\r\n  setShowCenter,\r\n  toggleToasts,\r\n  setToastsEnabled,\r\n  toggleSound,\r\n  setSoundEnabled,\r\n} = notificationsSlice.actions;\r\n\r\n// Export reducer\r\nexport default notificationsSlice.reducer;\r\n\r\n// Selectors\r\nexport const selectNotifications = (state: { notifications: NotificationsState }) => state.notifications.items;\r\nexport const selectUnreadCount = (state: { notifications: NotificationsState }) => state.notifications.unreadCount;\r\nexport const selectShowCenter = (state: { notifications: NotificationsState }) => state.notifications.showCenter;\r\nexport const selectToastsEnabled = (state: { notifications: NotificationsState }) => state.notifications.toastsEnabled;\r\nexport const selectSoundEnabled = (state: { notifications: NotificationsState }) => state.notifications.soundEnabled;\r\n\r\n/**\r\n * Select unread notifications\r\n */\r\nexport const selectUnreadNotifications = (state: { notifications: NotificationsState }) =>\r\n  state.notifications.items.filter(n => !n.read);\r\n\r\n/**\r\n * Select notifications by type\r\n */\r\nexport const selectNotificationsByType = (type: NotificationType) => (state: { notifications: NotificationsState }) =>\r\n  state.notifications.items.filter(n => n.type === type);\r\n\r\n/**\r\n * Select notifications by priority\r\n */\r\nexport const selectNotificationsByPriority = (priority: NotificationPriority) => (state: { notifications: NotificationsState }) =>\r\n  state.notifications.items.filter(n => n.priority === priority);\r\n\r\n/**\r\n * Select critical unread notifications\r\n */\r\nexport const selectCriticalUnreadNotifications = (state: { notifications: NotificationsState }) =>\r\n  state.notifications.items.filter(n => !n.read && n.priority === 'critical');\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 14245, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/slices/index.ts"],"sourcesContent":["/**\r\n * @fileoverview Redux Slices - Central export point for all Redux slices\r\n * @module stores/slices\r\n * @category Store\r\n *\r\n * Exports all Redux slices for easy import throughout the application.\r\n * Slices are organized by domain following Domain-Driven Design principles.\r\n */\r\n\r\n// ============================================================\r\n// CORE SLICES - Authentication & Authorization\r\n// ============================================================\r\n// MOVED: authReducer â†’ @/identity-access/stores/authSlice\r\n// MOVED: accessControlReducer â†’ @/identity-access/stores/accessControlSlice\r\n\r\nexport { usersReducer, usersSlice } from './usersSlice';\r\n\r\n// ============================================================\r\n// DASHBOARD & OVERVIEW\r\n// ============================================================\r\nexport { default as dashboardReducer } from './dashboardSlice';\r\n\r\n// ============================================================\r\n// HEALTHCARE DOMAIN\r\n// ============================================================\r\nexport { healthRecordsReducer, healthRecordsSlice } from './healthRecordsSlice';\r\n\r\nexport { medicationsReducer, medicationsSlice } from './medicationsSlice';\r\n\r\nexport { appointmentsReducer, appointmentsSlice } from './appointmentsSlice';\r\n\r\n// ============================================================\r\n// STUDENT MANAGEMENT\r\n// ============================================================\r\nexport { studentsReducer, studentsSlice } from './studentsSlice';\r\n\r\nexport { emergencyContactsReducer, emergencyContactsSlice } from './emergencyContactsSlice';\r\n\r\n// ============================================================\r\n// INCIDENT MANAGEMENT\r\n// ============================================================\r\nexport { default as incidentReportsReducer } from './incidentReportsSlice';\r\n\r\n// ============================================================\r\n// ADMINISTRATION\r\n// ============================================================\r\n// REMOVED: districtsReducer - Unused, legacy pages-old only\r\n// REMOVED: schoolsReducer - Unused, legacy pages-old only\r\nexport { settingsReducer } from './settingsSlice';\r\n// REMOVED: adminReducer - Unused, 43KB removed\r\nexport { default as configurationReducer } from './configurationSlice';\r\n\r\n// ============================================================\r\n// COMMUNICATION & DOCUMENTATION\r\n// ============================================================\r\nexport { communicationReducer } from './communicationSlice';\r\nexport { documentsReducer } from './documentsSlice';\r\nexport { default as contactsReducer } from './contactsSlice';\r\n\r\n// ============================================================\r\n// OPERATIONS & INVENTORY\r\n// ============================================================\r\n// REMOVED: inventoryReducer - Unused, legacy pages-old only (24KB)\r\n// REMOVED: reportsReducer - Unused, legacy pages-old only\r\n// REMOVED: budgetReducer - Unused, legacy pages-old only\r\n// REMOVED: purchaseOrderReducer - Unused, legacy pages-old only (25KB)\r\n// REMOVED: vendorReducer - Unused, legacy pages-old only (18KB)\r\n// REMOVED: integrationReducer - Unused, legacy pages-old only (32KB)\r\n\r\n// ============================================================\r\n// COMPLIANCE & ACCESS CONTROL\r\n// ============================================================\r\n// REMOVED: complianceReducer - Unused, legacy pages-old only (25KB)\r\n\r\n// ============================================================\r\n// UI PREFERENCES & NOTIFICATIONS (NEW)\r\n// ============================================================\r\nexport { default as themeReducer } from './themeSlice';\r\nexport type { ThemeState, ThemeMode, ColorScheme, UIDensity } from './themeSlice';\r\n\r\nexport { default as notificationsReducer } from './notificationsSlice';\r\nexport type { NotificationsState, Notification, NotificationType, NotificationPriority } from './notificationsSlice';\r\n"],"names":[],"mappings":"AAAA;;;;;;;CAOC,GAED,+DAA+D;AAC/D,+CAA+C;AAC/C,+DAA+D;AAC/D,0DAA0D;AAC1D,4EAA4E;;AAE5E;AAEA,+DAA+D;AAC/D,uBAAuB;AACvB,+DAA+D;AAC/D;AAEA,+DAA+D;AAC/D,oBAAoB;AACpB,+DAA+D;AAC/D;AAEA;AAEA;AAEA,+DAA+D;AAC/D,qBAAqB;AACrB,+DAA+D;AAC/D;AAEA;AAEA,+DAA+D;AAC/D,sBAAsB;AACtB,+DAA+D;AAC/D;AAEA,+DAA+D;AAC/D,iBAAiB;AACjB,+DAA+D;AAC/D,4DAA4D;AAC5D,0DAA0D;AAC1D;AACA,+CAA+C;AAC/C;AAEA,+DAA+D;AAC/D,gCAAgC;AAChC,+DAA+D;AAC/D;AACA;AACA;AAEA,+DAA+D;AAC/D,yBAAyB;AACzB,+DAA+D;AAC/D,mEAAmE;AACnE,0DAA0D;AAC1D,yDAAyD;AACzD,uEAAuE;AACvE,gEAAgE;AAChE,qEAAqE;AAErE,+DAA+D;AAC/D,8BAA8B;AAC9B,+DAA+D;AAC/D,oEAAoE;AAEpE,+DAA+D;AAC/D,uCAAuC;AACvC,+DAA+D;AAC/D;AAGA","debugId":null}},
    {"offset": {"line": 14365, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/stores/store.ts"],"sourcesContent":["/**\r\n * @fileoverview Redux Store Configuration for Next.js 15 with App Router\r\n * @module stores/store\r\n * @category Store\r\n *\r\n * Enterprise-grade Redux store configured for Next.js 15 with SSR/SSG support.\r\n * Follows Domain-Driven Design with HIPAA-compliant state management.\r\n *\r\n * Architecture:\r\n * - **Domain-based organization**: State organized by business domains\r\n * - **Type-safe**: Full TypeScript integration with Redux Toolkit\r\n * - **SSR compatible**: Client-side only with proper hydration\r\n * - **Performance**: Selective persistence and memoized selectors\r\n * - **HIPAA compliance**: PHI exclusion from browser storage\r\n *\r\n * State Domains:\r\n * - **Core**: Auth, users, settings, dashboard\r\n * - **Healthcare**: Health records, medications, appointments\r\n * - **Student Management**: Students, emergency contacts\r\n * - **Communication**: Messages, notifications, templates\r\n * - **Administration**: Districts, schools, inventory, reports\r\n * - **Compliance**: Access control, audit logs\r\n *\r\n * Key Features:\r\n * - Client-side state management only (no SSR state)\r\n * - Selective persistence (localStorage for non-PHI, sessionStorage for auth)\r\n * - Redux DevTools integration in development\r\n * - Type-safe throughout with TypeScript\r\n * - Compatible with React Query for server state\r\n *\r\n * HIPAA Compliance:\r\n * - PHI fields excluded from localStorage\r\n * - Auth tokens in sessionStorage only\r\n * - Audit logging for sensitive state access\r\n * - No server-side state serialization\r\n *\r\n * State Persistence Strategy:\r\n * - **localStorage**: UI preferences, filters (non-PHI only)\r\n * - **sessionStorage**: Auth tokens (cleared on browser close)\r\n * - **Memory only**: All PHI data (students, health records, medications)\r\n * - **No SSR persistence**: State reconstructed on client\r\n *\r\n * @example\r\n * ```typescript\r\n * // Use in client components only\r\n * 'use client';\r\n * import { useAppSelector, useAppDispatch } from '@/stores/hooks';\r\n *\r\n * function MyComponent() {\r\n *   const user = useAppSelector(state => state.auth.user);\r\n *   const dispatch = useAppDispatch();\r\n * }\r\n * ```\r\n */\r\n\r\n'use client';\r\n\r\nimport { configureStore, combineReducers, Middleware } from '@reduxjs/toolkit';\r\n\r\n// Import identity-access reducers\r\nimport { authReducer, accessControlReducer } from '@/identity-access/stores';\r\n\r\n// Import all domain reducers\r\nimport {\r\n  // Core\r\n  usersReducer,\r\n\r\n  // Dashboard\r\n  dashboardReducer,\r\n\r\n  // Healthcare\r\n  healthRecordsReducer,\r\n  medicationsReducer,\r\n  appointmentsReducer,\r\n\r\n  // Student Management\r\n  studentsReducer,\r\n  emergencyContactsReducer,\r\n\r\n  // Incident Management\r\n  incidentReportsReducer,\r\n\r\n  // Administration\r\n  settingsReducer,\r\n  configurationReducer,\r\n\r\n  // Communication & Documentation\r\n  communicationReducer,\r\n  documentsReducer,\r\n  contactsReducer,\r\n\r\n  // REMOVED 10 unused Redux slices:\r\n  // - districtsReducer, schoolsReducer, adminReducer (43KB)\r\n  // - inventoryReducer (24KB), reportsReducer, budgetReducer\r\n  // - purchaseOrderReducer (25KB), vendorReducer (18KB)\r\n  // - integrationReducer (32KB), complianceReducer (25KB)\r\n  // Total removed: ~192KB of Redux code\r\n} from './slices';\r\n\r\n// ==========================================\r\n// ROOT REDUCER\r\n// ==========================================\r\n\r\n/**\r\n * Root reducer combining all domain reducers\r\n * Organized by domain for clear separation of concerns\r\n */\r\nconst rootReducer = combineReducers({\r\n  // ============================================================\r\n  // AUTHENTICATION & AUTHORIZATION (from @/identity-access)\r\n  // ============================================================\r\n  auth: authReducer,\r\n  accessControl: accessControlReducer,\r\n  users: usersReducer,\r\n\r\n  // ============================================================\r\n  // DASHBOARD & OVERVIEW\r\n  // ============================================================\r\n  dashboard: dashboardReducer,\r\n\r\n  // ============================================================\r\n  // CORE DOMAINS - INCIDENT MANAGEMENT\r\n  // ============================================================\r\n  incidentReports: incidentReportsReducer,\r\n\r\n  // ============================================================\r\n  // ADMINISTRATION & CONFIGURATION\r\n  // ============================================================\r\n  // REMOVED: districts, schools (unused in active code)\r\n  settings: settingsReducer,\r\n  // REMOVED: admin (43KB, unused in active code)\r\n  configuration: configurationReducer,\r\n\r\n  // ============================================================\r\n  // STUDENT & HEALTH MANAGEMENT\r\n  // ============================================================\r\n  students: studentsReducer,\r\n  healthRecords: healthRecordsReducer,\r\n  medications: medicationsReducer,\r\n  appointments: appointmentsReducer,\r\n  emergencyContacts: emergencyContactsReducer,\r\n\r\n  // ============================================================\r\n  // COMMUNICATION & DOCUMENTATION\r\n  // ============================================================\r\n  communication: communicationReducer,\r\n  documents: documentsReducer,\r\n  contacts: contactsReducer,\r\n\r\n  // ============================================================\r\n  // OPERATIONS & INVENTORY - ALL REMOVED\r\n  // ============================================================\r\n  // REMOVED 6 slices: inventory (24KB), reports, budget,\r\n  // purchaseOrder (25KB), vendor (18KB), integration (32KB)\r\n  // Total: ~192KB of unused Redux state management code\r\n\r\n  // ============================================================\r\n  // COMPLIANCE & ACCESS CONTROL\r\n  // ============================================================\r\n  // REMOVED: compliance (25KB, unused in active code)\r\n});\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS (defined early to avoid circular deps)\r\n// ==========================================\r\n\r\n/**\r\n * Root state type derived from the root reducer\r\n * Use this type for all selectors and state access\r\n */\r\nexport type RootState = ReturnType<typeof rootReducer>;\r\n\r\n// ==========================================\r\n// PERSISTENCE MIDDLEWARE (HIPAA-COMPLIANT)\r\n// ==========================================\r\n\r\n/**\r\n * Selective persistence middleware\r\n * Only persists non-PHI data to localStorage\r\n * Auth tokens go to sessionStorage only\r\n */\r\nconst persistenceMiddleware: Middleware = (store) => (next) => (action) => {\r\n  const result = next(action);\r\n\r\n  // Only run on client side\r\n  if (typeof window === 'undefined') return result;\r\n\r\n  const state = store.getState();\r\n\r\n  try {\r\n    // Persist UI preferences only (no PHI)\r\n    const uiState = {\r\n      settings: state.settings,\r\n      // Filters and UI state from various slices (no actual data)\r\n      incidentReportsUI: state.incidentReports ? {\r\n        filters: state.incidentReports.filters,\r\n        sortConfig: state.incidentReports.sortConfig,\r\n        viewMode: state.incidentReports.viewMode,\r\n      } : undefined,\r\n    };\r\n\r\n    localStorage.setItem('whitecross_ui_state', JSON.stringify(uiState));\r\n\r\n    // Persist auth to sessionStorage (cleared on browser close)\r\n    if (state.auth) {\r\n      const authState = {\r\n        user: state.auth.user,\r\n        isAuthenticated: state.auth.isAuthenticated,\r\n        // DO NOT persist tokens for security\r\n      };\r\n      sessionStorage.setItem('whitecross_auth', JSON.stringify(authState));\r\n    }\r\n  } catch (error) {\r\n    console.error('[Redux Persistence] Error persisting state:', error);\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\n/**\r\n * Audit logging middleware for HIPAA compliance\r\n * Logs access to sensitive state slices\r\n */\r\nconst auditMiddleware: Middleware = (_store) => (next) => (action) => {\r\n  // Log sensitive actions in development\r\n  if (process.env.NODE_ENV === 'development') {\r\n    const sensitiveActions = [\r\n      'healthRecords/',\r\n      'medications/',\r\n      'students/',\r\n      'emergencyContacts/',\r\n    ];\r\n\r\n    const actionType = (action as { type: string }).type;\r\n    if (sensitiveActions.some(prefix => actionType.startsWith(prefix))) {\r\n      console.log('[Audit] Sensitive action dispatched:', actionType);\r\n    }\r\n  }\r\n\r\n  return next(action);\r\n};\r\n\r\n// ==========================================\r\n// LOAD PERSISTED STATE\r\n// ==========================================\r\n\r\n/**\r\n * Load persisted state from browser storage\r\n * Called before store creation\r\n */\r\nfunction loadPersistedState() {\r\n  if (typeof window === 'undefined') return undefined;\r\n\r\n  try {\r\n    // Load UI preferences\r\n    const uiStateJson = localStorage.getItem('whitecross_ui_state');\r\n    const uiState = uiStateJson ? JSON.parse(uiStateJson) : {};\r\n\r\n    // Load auth from session storage\r\n    const authStateJson = sessionStorage.getItem('whitecross_auth');\r\n    const authState = authStateJson ? JSON.parse(authStateJson) : {};\r\n\r\n    // Map persisted UI state keys to actual reducer keys\r\n    const mappedState: Partial<RootState> = {\r\n      auth: authState,\r\n    };\r\n\r\n    // Map settings directly\r\n    if (uiState.settings) {\r\n      mappedState.settings = uiState.settings;\r\n    }\r\n\r\n    // Map incidentReportsUI to incidentReports (only UI preferences, not data)\r\n    if (uiState.incidentReportsUI) {\r\n      mappedState.incidentReports = uiState.incidentReportsUI as any;\r\n    }\r\n\r\n    return mappedState;\r\n  } catch (error) {\r\n    console.error('[Redux] Error loading persisted state:', error);\r\n    // Clear corrupted localStorage\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.removeItem('whitecross_ui_state');\r\n    }\r\n    return undefined;\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// STORE CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Configure and create the Redux store\r\n * Client-side only with persistence and audit middleware\r\n */\r\nexport const makeStore = () => {\r\n  return configureStore({\r\n    reducer: rootReducer,\r\n    preloadedState: loadPersistedState(),\r\n    middleware: (getDefaultMiddleware) =>\r\n      getDefaultMiddleware({\r\n        serializableCheck: {\r\n          // Ignore these action types\r\n          ignoredActions: [\r\n            'persist/PERSIST',\r\n            'persist/REHYDRATE',\r\n          ],\r\n          // Ignore these field paths in all actions\r\n          ignoredActionPaths: ['payload.date', 'meta.arg.originalArgs'],\r\n          // Ignore these paths in the state\r\n          ignoredPaths: [\r\n            'incidentReports.filters.startDate',\r\n            'incidentReports.filters.endDate',\r\n          ],\r\n        },\r\n        // Disable immutability check in production for performance\r\n        immutableCheck: process.env.NODE_ENV === 'development',\r\n      })\r\n        .concat(persistenceMiddleware)\r\n        .concat(auditMiddleware),\r\n    devTools: process.env.NODE_ENV === 'development',\r\n  });\r\n};\r\n\r\n/**\r\n * Create store instance for client-side use\r\n * NOTE: In Next.js 15 App Router, each client gets its own store instance\r\n */\r\nexport const store = makeStore();\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS (Additional Store Types)\r\n// ==========================================\r\n\r\n/**\r\n * App dispatch type including thunk actions\r\n * Use this type for all dispatch calls\r\n */\r\nexport type AppDispatch = typeof store.dispatch;\r\n\r\n/**\r\n * Store type for use in contexts and providers\r\n */\r\nexport type AppStore = typeof store;\r\n\r\n// ==========================================\r\n// UTILITY FUNCTIONS\r\n// ==========================================\r\n\r\n/**\r\n * Type guard to validate if a given state object is a valid RootState\r\n *\r\n * @param state - The state object to validate\r\n * @returns True if state is valid RootState, false otherwise\r\n */\r\nexport function isValidRootState(state: unknown): state is RootState {\r\n  return (\r\n    state !== null &&\r\n    typeof state === 'object' &&\r\n    'auth' in state &&\r\n    'students' in state &&\r\n    'healthRecords' in state\r\n  );\r\n}\r\n\r\n/**\r\n * Clears all persisted state from browser storage\r\n * Should be called on logout for HIPAA compliance\r\n *\r\n * @example\r\n * ```typescript\r\n * const handleLogout = () => {\r\n *   clearPersistedState();\r\n *   // ... logout logic\r\n * };\r\n * ```\r\n */\r\nexport function clearPersistedState(): void {\r\n  if (typeof window === 'undefined') return;\r\n\r\n  try {\r\n    // Clear localStorage\r\n    const localKeys = Object.keys(localStorage).filter((key) =>\r\n      key.startsWith('whitecross_')\r\n    );\r\n    localKeys.forEach((key) => localStorage.removeItem(key));\r\n\r\n    // Clear sessionStorage\r\n    const sessionKeys = Object.keys(sessionStorage).filter((key) =>\r\n      key.startsWith('whitecross_')\r\n    );\r\n    sessionKeys.forEach((key) => sessionStorage.removeItem(key));\r\n\r\n    console.log('[Redux] Cleared all persisted state');\r\n  } catch (error) {\r\n    console.error('[Redux] Error clearing persisted state:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Get storage usage statistics for monitoring\r\n *\r\n * @returns Storage stats for localStorage and sessionStorage\r\n */\r\nexport function getStorageStats(): {\r\n  localStorage: { used: number; available: number; percentage: number };\r\n  sessionStorage: { used: number; available: number; percentage: number };\r\n} {\r\n  if (typeof window === 'undefined') {\r\n    return {\r\n      localStorage: { used: 0, available: 0, percentage: 0 },\r\n      sessionStorage: { used: 0, available: 0, percentage: 0 },\r\n    };\r\n  }\r\n\r\n  const getSize = (storage: Storage): number => {\r\n    let size = 0;\r\n    for (const key in storage) {\r\n      if (storage.hasOwnProperty(key) && key.startsWith('whitecross_')) {\r\n        size += storage[key].length + key.length;\r\n      }\r\n    }\r\n    return size;\r\n  };\r\n\r\n  const maxSize = 5 * 1024 * 1024; // 5MB typical browser limit\r\n  const localUsed = getSize(localStorage);\r\n  const sessionUsed = getSize(sessionStorage);\r\n\r\n  return {\r\n    localStorage: {\r\n      used: localUsed,\r\n      available: maxSize - localUsed,\r\n      percentage: (localUsed / maxSize) * 100,\r\n    },\r\n    sessionStorage: {\r\n      used: sessionUsed,\r\n      available: maxSize - sessionUsed,\r\n      percentage: (sessionUsed / maxSize) * 100,\r\n    },\r\n  };\r\n}\r\n\r\n// Export store instance as default\r\nexport default store;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 14609, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/providers/ReduxProvider.tsx"],"sourcesContent":["/**\r\n * @fileoverview Redux Store Provider - Consolidated\r\n * @module providers/ReduxProvider\r\n * @category State Management\r\n *\r\n * Provides Redux store to the component tree in Next.js App Router.\r\n * Must be used in client components only.\r\n *\r\n * Features:\r\n * - Client-side only (no SSR)\r\n * - Automatic store creation per client\r\n * - Type-safe context\r\n * - Compatible with React 19\r\n * - State persistence (non-PHI only)\r\n *\r\n * @example\r\n * ```typescript\r\n * import { ReduxProvider } from '@/providers/ReduxProvider';\r\n *\r\n * export default function RootLayout({ children }) {\r\n *   return (\r\n *     <ReduxProvider>\r\n *       {children}\r\n *     </ReduxProvider>\r\n *   );\r\n * }\r\n * ```\r\n */\r\n\r\n'use client';\r\n\r\nimport { useState, type ReactNode } from 'react';\r\nimport { Provider } from 'react-redux';\r\nimport { makeStore, type AppStore } from '@/stores/store';\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS\r\n// ==========================================\r\n\r\ninterface ReduxProviderProps {\r\n  /** Child components to wrap */\r\n  children: ReactNode;\r\n}\r\n\r\n// ==========================================\r\n// PROVIDER COMPONENT\r\n// ==========================================\r\n\r\n/**\r\n * Redux Store Provider Component\r\n *\r\n * Wraps the app with Redux Provider for client-side state management.\r\n * Creates a new store instance per client using lazy initialization.\r\n *\r\n * @param {ReduxProviderProps} props - Component props\r\n * @param {ReactNode} props.children - Child components to wrap\r\n * @returns {JSX.Element} Provider tree\r\n */\r\nexport function ReduxProvider({ children }: ReduxProviderProps) {\r\n  // Create store instance once per client using useState with lazy initialization\r\n  const [store] = useState<AppStore>(() => makeStore());\r\n\r\n  return <Provider store={store}>{children}</Provider>;\r\n}\r\n\r\nexport default ReduxProvider;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;CA2BC;;;;;;;AAID;AACA;AACA;AAJA;;;;;AA6BO,SAAS,cAAc,EAAE,QAAQ,EAAsB;IAC5D,gFAAgF;IAChF,MAAM,CAAC,MAAM,GAAG,IAAA,iNAAQ,EAAW,IAAM,IAAA,mIAAS;IAElD,qBAAO,8OAAC,qKAAQ;QAAC,OAAO;kBAAQ;;;;;;AAClC;uCAEe","debugId":null}},
    {"offset": {"line": 14668, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/config/apolloClient.ts"],"sourcesContent":["/**\r\n * WF-COMP-APOLLO-001 | apolloClient.ts - Apollo Client Configuration\r\n * Purpose: Configure Apollo Client for GraphQL API integration\r\n *\r\n * Features:\r\n * - GraphQL query and mutation support\r\n * - Authentication integration\r\n * - Error handling and retry logic\r\n * - Cache management\r\n * - Healthcare-specific policies\r\n *\r\n * Security:\r\n * - JWT token integration\r\n * - PHI data handling\r\n * - Audit logging integration\r\n *\r\n * Last Updated: 2025-10-26 | File Type: .ts\r\n */\r\n\r\nimport { ApolloClient, InMemoryCache, HttpLink, from, ApolloLink } from '@apollo/client';\r\nimport { onError } from '@apollo/client/link/error';\r\nimport { setContext } from '@apollo/client/link/context';\r\nimport { RetryLink } from '@apollo/client/link/retry';\r\nimport toast from 'react-hot-toast';\r\n\r\n// ==========================================\r\n// CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Retrieves the GraphQL endpoint URL from environment variables.\r\n *\r\n * Constructs the full GraphQL endpoint URL using the API base URL from environment variables,\r\n * ensuring the correct path format for GraphQL queries and mutations.\r\n *\r\n * @returns {string} The complete GraphQL endpoint URL\r\n *\r\n * @example\r\n * ```typescript\r\n * // Development\r\n * // Returns: \"http://localhost:3001/graphql\"\r\n *\r\n * // Production\r\n * // Returns: \"https://api.example.com/graphql\"\r\n * ```\r\n */\r\nfunction getGraphQLEndpoint(): string {\r\n  const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3001/api';\r\n  // GraphQL is at /graphql not /api/graphql\r\n  return baseUrl.replace('/api', '/graphql');\r\n}\r\n\r\n/**\r\n * Retrieves the authentication JWT token from browser localStorage.\r\n *\r\n * Safely accesses localStorage to retrieve the user's authentication token,\r\n * handling server-side rendering where localStorage is unavailable.\r\n *\r\n * @returns {string | null} The JWT token string, or null if not available or on server\r\n *\r\n * @example\r\n * ```typescript\r\n * const token = getAuthToken();\r\n * if (token) {\r\n *   // User is authenticated\r\n *   headers.authorization = `Bearer ${token}`;\r\n * }\r\n * ```\r\n */\r\nfunction getAuthToken(): string | null {\r\n  try {\r\n    if (typeof window !== 'undefined') {\r\n      const token = localStorage.getItem('auth_token');\r\n      return token;\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('[Apollo] Failed to get auth token:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// APOLLO LINKS\r\n// ==========================================\r\n\r\n/**\r\n * HTTP Link for Apollo Client - handles GraphQL request transmission.\r\n *\r\n * Configured to send GraphQL queries and mutations to the backend server\r\n * with cookie-based session management support for authentication.\r\n *\r\n * @constant {HttpLink}\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/link/apollo-link-http/\r\n */\r\nconst httpLink = new HttpLink({\r\n  uri: getGraphQLEndpoint(),\r\n  credentials: 'include', // Include cookies for session management\r\n});\r\n\r\n/**\r\n * Authentication Link - adds JWT token and custom headers to GraphQL requests.\r\n *\r\n * Intercepts every GraphQL request to inject authentication credentials and\r\n * client metadata into request headers. This ensures all API calls are properly\r\n * authenticated and versioned.\r\n *\r\n * Headers Added:\r\n * - authorization: JWT Bearer token (if user is authenticated)\r\n * - Content-Type: application/json\r\n * - X-Client-Version: Frontend application version for API compatibility tracking\r\n *\r\n * @constant {ApolloLink}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Request headers when authenticated:\r\n * {\r\n *   authorization: \"Bearer eyJhbGciOiJIUzI1NiIs...\",\r\n *   \"Content-Type\": \"application/json\",\r\n *   \"X-Client-Version\": \"1.0.0\"\r\n * }\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/link/apollo-link-context/\r\n */\r\nconst authLink = setContext((_, { headers }) => {\r\n  const token = getAuthToken();\r\n\r\n  return {\r\n    headers: {\r\n      ...headers,\r\n      ...(token && { authorization: `Bearer ${token}` }),\r\n      'Content-Type': 'application/json',\r\n      'X-Client-Version': process.env.NEXT_PUBLIC_APP_VERSION || '1.0.0',\r\n    },\r\n  };\r\n});\r\n\r\n/**\r\n * Retry Link - handles transient failures with exponential backoff strategy.\r\n *\r\n * Automatically retries failed GraphQL requests for network errors and server errors (5xx),\r\n * using exponential backoff with jitter to avoid thundering herd problems. Client errors\r\n * (4xx) are not retried as they indicate invalid requests.\r\n *\r\n * Retry Strategy:\r\n * - Initial delay: 300ms\r\n * - Maximum delay: 5000ms (5 seconds)\r\n * - Maximum attempts: 3\r\n * - Jitter enabled: adds randomness to prevent synchronized retries\r\n *\r\n * Retry Conditions:\r\n * - Network errors: Always retry\r\n * - 5xx server errors: Retry (server issues)\r\n * - 4xx client errors: No retry (invalid request)\r\n *\r\n * @constant {RetryLink}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Failed request timeline with exponential backoff:\r\n * // Attempt 1: fails at t=0\r\n * // Attempt 2: retry at t=300ms (+ jitter)\r\n * // Attempt 3: retry at t=900ms (300 * 2^1 + jitter)\r\n * // Final failure if all attempts exhausted\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/link/apollo-link-retry/\r\n */\r\nconst retryLink = new RetryLink({\r\n  delay: {\r\n    initial: 300,\r\n    max: 5000,\r\n    jitter: true,\r\n  },\r\n  attempts: {\r\n    max: 3,\r\n    retryIf: (error, _operation) => {\r\n      // Retry on network errors or 5xx server errors\r\n      const statusCode = (error as any)?.statusCode;\r\n      return !!error && (!statusCode || statusCode >= 500);\r\n    },\r\n  },\r\n});\r\n\r\n/**\r\n * Error Link - centralized GraphQL and network error handling.\r\n *\r\n * Intercepts all GraphQL errors and network failures to provide consistent error handling,\r\n * user notifications, and automatic session management. Logs errors for debugging and\r\n * implements authentication flows when sessions expire.\r\n *\r\n * Error Types Handled:\r\n * - GraphQL errors: Query/mutation validation errors, server-side errors\r\n * - Network errors: Connection failures, HTTP status errors\r\n * - Authentication errors: Expired sessions, invalid tokens (redirects to login)\r\n * - Authorization errors: Insufficient permissions (displays error message)\r\n *\r\n * Authentication Flow:\r\n * - UNAUTHENTICATED error -> Clear token, show message, redirect to /login\r\n * - 401 status code -> Clear token, show message, redirect to /login\r\n * - FORBIDDEN error -> Show permission denied message\r\n *\r\n * User Experience:\r\n * - Displays toast notifications for user-friendly error messages\r\n * - Hides network errors during background refetches\r\n * - Provides specific messages for rate limiting (429) and server errors (5xx)\r\n *\r\n * @constant {ApolloLink}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Authentication error handling:\r\n * // 1. User makes query with expired token\r\n * // 2. Server returns UNAUTHENTICATED error\r\n * // 3. Error link clears localStorage token\r\n * // 4. User sees \"Session expired\" toast\r\n * // 5. Redirected to /login page\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/link/apollo-link-error/\r\n */\r\nconst errorLink = onError(({ graphQLErrors, networkError, operation, forward }) => {\r\n  if (graphQLErrors) {\r\n    graphQLErrors.forEach(({ message, locations, path, extensions }) => {\r\n      console.error(\r\n        `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`\r\n      );\r\n\r\n      // Handle authentication errors\r\n      if (extensions?.code === 'UNAUTHENTICATED') {\r\n        if (typeof window !== 'undefined') {\r\n          localStorage.removeItem('auth_token');\r\n          toast.error('Session expired. Please login again.');\r\n          // Redirect to login - in Next.js we'll handle this differently\r\n          window.location.href = '/login';\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Handle authorization errors\r\n      if (extensions?.code === 'FORBIDDEN') {\r\n        toast.error('You do not have permission to perform this action');\r\n        return;\r\n      }\r\n\r\n      // Show user-friendly error messages\r\n      if (!message.includes('Network')) {\r\n        toast.error(message || 'An unexpected error occurred');\r\n      }\r\n    });\r\n  }\r\n\r\n  if (networkError) {\r\n    console.error(`[Network error]:`, networkError);\r\n\r\n    // Handle specific network errors\r\n    if ('statusCode' in networkError) {\r\n      switch (networkError.statusCode) {\r\n        case 401:\r\n          if (typeof window !== 'undefined') {\r\n            localStorage.removeItem('auth_token');\r\n            toast.error('Authentication required');\r\n            window.location.href = '/login';\r\n          }\r\n          break;\r\n        case 403:\r\n          toast.error('Access denied');\r\n          break;\r\n        case 404:\r\n          toast.error('Resource not found');\r\n          break;\r\n        case 429:\r\n          toast.error('Too many requests. Please try again later.');\r\n          break;\r\n        case 500:\r\n          toast.error('Server error. Please try again.');\r\n          break;\r\n        default:\r\n          if (networkError.statusCode >= 500) {\r\n            toast.error('Server error. Please try again.');\r\n          }\r\n      }\r\n    } else {\r\n      // Connection errors\r\n      toast.error('Connection error. Please check your internet connection.');\r\n    }\r\n  }\r\n});\r\n\r\n// ==========================================\r\n// CACHE CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Apollo InMemory Cache with healthcare-specific type policies.\r\n *\r\n * Configures normalized caching for GraphQL data with custom merge strategies\r\n * for paginated queries and computed fields. Optimizes data fetching and reduces\r\n * redundant network requests for healthcare application data.\r\n *\r\n * Type Policies:\r\n * - Query.contacts: Offset-based pagination with position-aware merging\r\n * - Query.students: Offset-based pagination with position-aware merging\r\n * - Contact.fullName: Computed field from firstName + lastName\r\n * - Student.fullName: Computed field from firstName + lastName\r\n *\r\n * Cache Normalization:\r\n * - Entities are stored by ID for efficient updates\r\n * - Pagination preserves item positions across fetches\r\n * - Computed fields reduce redundant data storage\r\n *\r\n * @constant {InMemoryCache}\r\n *\r\n * @example\r\n * ```typescript\r\n * // Pagination merge behavior:\r\n * // Fetch 1: offset=0, limit=10 -> [items 0-9]\r\n * // Fetch 2: offset=10, limit=10 -> [items 0-19]\r\n * // Cache now contains complete dataset [0-19]\r\n *\r\n * // Computed field behavior:\r\n * const student = cache.readFragment({\r\n *   id: 'Student:123',\r\n *   fragment: gql`fragment StudentName on Student { fullName }`\r\n * });\r\n * // Returns computed \"John Doe\" from stored firstName + lastName\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/caching/cache-configuration/\r\n */\r\nconst cache = new InMemoryCache({\r\n  typePolicies: {\r\n    Query: {\r\n      fields: {\r\n        // Pagination handling for contacts\r\n        contacts: {\r\n          keyArgs: false,\r\n          merge(existing, incoming, { args }) {\r\n            const merged = existing ? existing.slice(0) : [];\r\n            const { offset = 0 } = args || {};\r\n            \r\n            for (let i = 0; i < incoming.length; ++i) {\r\n              merged[offset + i] = incoming[i];\r\n            }\r\n            \r\n            return merged;\r\n          },\r\n        },\r\n        \r\n        // Pagination handling for students\r\n        students: {\r\n          keyArgs: false,\r\n          merge(existing, incoming, { args }) {\r\n            const merged = existing ? existing.slice(0) : [];\r\n            const { offset = 0 } = args || {};\r\n            \r\n            for (let i = 0; i < incoming.length; ++i) {\r\n              merged[offset + i] = incoming[i];\r\n            }\r\n            \r\n            return merged;\r\n          },\r\n        },\r\n      },\r\n    },\r\n    \r\n    Contact: {\r\n      fields: {\r\n        // Handle computed fields\r\n        fullName: {\r\n          read(existing, { readField }) {\r\n            return existing || `${readField('firstName')} ${readField('lastName')}`;\r\n          },\r\n        },\r\n      },\r\n    },\r\n    \r\n    Student: {\r\n      fields: {\r\n        // Handle computed fields\r\n        fullName: {\r\n          read(existing, { readField }) {\r\n            return existing || `${readField('firstName')} ${readField('lastName')}`;\r\n          },\r\n        },\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\n// ==========================================\r\n// APOLLO CLIENT\r\n// ==========================================\r\n\r\n/**\r\n * Configured Apollo Client instance for GraphQL operations.\r\n *\r\n * Main client instance used throughout the application for executing GraphQL\r\n * queries, mutations, and subscriptions. Combines authentication, retry logic,\r\n * error handling, and caching into a single client.\r\n *\r\n * Link Chain (order matters):\r\n * 1. retryLink: Retry failed requests with exponential backoff\r\n * 2. errorLink: Handle and log errors, manage authentication\r\n * 3. authLink: Add JWT token and headers to requests\r\n * 4. httpLink: Send requests to GraphQL endpoint\r\n *\r\n * Default Options:\r\n * - watchQuery: Returns partial data and errors for better UX\r\n * - query: Returns partial data and errors\r\n * - mutate: Returns partial data and errors\r\n *\r\n * DevTools:\r\n * - Enabled in development for debugging queries and cache\r\n * - Disabled in production for security and performance\r\n *\r\n * @constant {ApolloClient}\r\n *\r\n * @example\r\n * ```typescript\r\n * import { apolloClient } from '@/config/apolloClient';\r\n *\r\n * // Execute a query\r\n * const { data } = await apolloClient.query({\r\n *   query: GET_STUDENTS,\r\n *   variables: { limit: 10 }\r\n * });\r\n *\r\n * // Execute a mutation\r\n * const { data } = await apolloClient.mutate({\r\n *   mutation: CREATE_STUDENT,\r\n *   variables: { input: studentData }\r\n * });\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/core/ApolloClient/\r\n */\r\nexport const apolloClient = new ApolloClient({\r\n  link: from([\r\n    retryLink,\r\n    errorLink,\r\n    authLink,\r\n    httpLink,\r\n  ]),\r\n  cache,\r\n  defaultOptions: {\r\n    watchQuery: {\r\n      errorPolicy: 'all',\r\n      notifyOnNetworkStatusChange: true,\r\n    },\r\n    query: {\r\n      errorPolicy: 'all',\r\n    },\r\n    mutate: {\r\n      errorPolicy: 'all',\r\n    },\r\n  },\r\n  connectToDevTools: process.env.NODE_ENV === 'development',\r\n});\r\n\r\n/**\r\n * Resets Apollo Client cache and clears authentication storage.\r\n *\r\n * Completely clears all cached GraphQL data and removes the authentication token\r\n * from localStorage. Typically called during logout to ensure no stale data remains\r\n * and to force fresh data fetches on next login.\r\n *\r\n * Operations Performed:\r\n * 1. Clears all cached queries and fragments from Apollo cache\r\n * 2. Removes auth_token from browser localStorage\r\n * 3. Resets cache to initial empty state\r\n *\r\n * Use Cases:\r\n * - User logout: Clear all cached patient/healthcare data\r\n * - Account switching: Ensure clean slate for new user\r\n * - Session expiry: Reset cache when authentication fails\r\n * - Development: Reset state during debugging\r\n *\r\n * @returns {Promise<void>} Resolves when cache is cleared\r\n *\r\n * @example\r\n * ```typescript\r\n * // Logout flow\r\n * async function handleLogout() {\r\n *   await resetApolloClient();\r\n *   router.push('/login');\r\n * }\r\n *\r\n * // Account switching\r\n * async function switchAccount(newUserId: string) {\r\n *   await resetApolloClient();\r\n *   await authenticate(newUserId);\r\n * }\r\n * ```\r\n *\r\n * @see https://www.apollographql.com/docs/react/api/core/ApolloClient/#ApolloClient.clearStore\r\n */\r\nexport async function resetApolloClient(): Promise<void> {\r\n  try {\r\n    await apolloClient.clearStore();\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.removeItem('auth_token');\r\n    }\r\n  } catch (error) {\r\n    console.error('[Apollo] Failed to reset client:', error);\r\n  }\r\n}\r\n\r\nexport default apolloClient;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 15071, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/providers/ApolloProvider.tsx"],"sourcesContent":["/**\r\n * @fileoverview Apollo GraphQL Provider - Consolidated\r\n * @module providers/ApolloProvider\r\n * @category State Management\r\n *\r\n * Provides Apollo Client to the Next.js application with:\r\n * - Client-side rendering support\r\n * - Server-side rendering support\r\n * - Streaming support for React Server Components\r\n * - Automatic cache hydration\r\n *\r\n * @example\r\n * ```typescript\r\n * import { ApolloProvider } from '@/providers/ApolloProvider';\r\n *\r\n * export default function RootLayout({ children }) {\r\n *   return (\r\n *     <ApolloProvider>\r\n *       {children}\r\n *     </ApolloProvider>\r\n *   );\r\n * }\r\n * ```\r\n */\r\n\r\n'use client';\r\n\r\nimport { ApolloProvider as ApolloProviderBase } from '@apollo/client/react';\r\nimport { apolloClient } from '@/config/apolloClient';\r\nimport type { ReactNode } from 'react';\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS\r\n// ==========================================\r\n\r\ninterface ApolloProviderProps {\r\n  /** Child components to wrap */\r\n  children: ReactNode;\r\n}\r\n\r\n// ==========================================\r\n// PROVIDER COMPONENT\r\n// ==========================================\r\n\r\n/**\r\n * Apollo Provider wrapper for Next.js App Router\r\n *\r\n * Wraps the application with Apollo Client for GraphQL data fetching.\r\n *\r\n * @param {ApolloProviderProps} props - Component props\r\n * @param {ReactNode} props.children - Child components to wrap\r\n * @returns {JSX.Element} Provider tree\r\n */\r\nexport function ApolloProvider({ children }: ApolloProviderProps) {\r\n  return <ApolloProviderBase client={apolloClient}>{children}</ApolloProviderBase>;\r\n}\r\n\r\nexport default ApolloProvider;\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;CAuBC;;;;;;;AAID;AACA;AAHA;;;;AA4BO,SAAS,eAAe,EAAE,QAAQ,EAAuB;IAC9D,qBAAO,8OAAC,0LAAkB;QAAC,QAAQ,6IAAY;kBAAG;;;;;;AACpD;uCAEe","debugId":null}},
    {"offset": {"line": 15140, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/components/session/SessionWarningModal.tsx"],"sourcesContent":["'use client';\r\n\r\n/**\r\n * SessionWarningModal Component\r\n *\r\n * Displays a modal warning when user session is about to expire due to inactivity.\r\n * Provides options to extend the session or logout immediately.\r\n *\r\n * Features:\r\n * - Countdown timer showing remaining time\r\n * - Focus trap for accessibility\r\n * - Keyboard navigation (Escape to extend, Enter to confirm)\r\n * - ARIA attributes for screen readers\r\n * - Live region for countdown announcements\r\n *\r\n * @module components/session/SessionWarningModal\r\n */\r\n\r\nimport React, { useEffect, useState, useCallback, useRef } from 'react';\r\n\r\n// ==========================================\r\n// TYPES & INTERFACES\r\n// ==========================================\r\n\r\n/**\r\n * Props for SessionWarningModal component\r\n */\r\nexport interface SessionWarningModalProps {\r\n  /**\r\n   * Whether the modal is visible\r\n   */\r\n  isOpen: boolean;\r\n\r\n  /**\r\n   * Time remaining in seconds before session expires\r\n   */\r\n  timeRemainingSeconds: number;\r\n\r\n  /**\r\n   * Callback when user chooses to extend session\r\n   */\r\n  onExtendSession: () => void;\r\n\r\n  /**\r\n   * Callback when user chooses to logout or session expires\r\n   */\r\n  onLogout: () => void;\r\n}\r\n\r\n// ==========================================\r\n// COMPONENT\r\n// ==========================================\r\n\r\n/**\r\n * SessionWarningModal - Alert users of impending session expiration\r\n *\r\n * This component displays a modal dialog warning users that their session\r\n * is about to expire due to inactivity. It includes:\r\n * - A countdown timer\r\n * - Options to extend session or logout\r\n * - Full keyboard accessibility\r\n * - Screen reader support\r\n *\r\n * @example\r\n * ```tsx\r\n * <SessionWarningModal\r\n *   isOpen={showWarning}\r\n *   timeRemainingSeconds={120}\r\n *   onExtendSession={() => {\r\n *     updateActivity();\r\n *     setShowWarning(false);\r\n *   }}\r\n *   onLogout={handleLogout}\r\n * />\r\n * ```\r\n */\r\nexport function SessionWarningModal({\r\n  isOpen,\r\n  timeRemainingSeconds,\r\n  onExtendSession,\r\n  onLogout,\r\n}: SessionWarningModalProps) {\r\n  // ==========================================\r\n  // STATE & REFS\r\n  // ==========================================\r\n\r\n  const [countdown, setCountdown] = useState(timeRemainingSeconds);\r\n  const extendButtonRef = useRef<HTMLButtonElement>(null);\r\n  const modalRef = useRef<HTMLDivElement>(null);\r\n\r\n  // ==========================================\r\n  // COUNTDOWN LOGIC\r\n  // ==========================================\r\n\r\n  // Sync countdown with prop changes\r\n  useEffect(() => {\r\n    setCountdown(timeRemainingSeconds);\r\n  }, [timeRemainingSeconds]);\r\n\r\n  // Countdown interval\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const interval = setInterval(() => {\r\n      setCountdown((prev) => {\r\n        if (prev <= 1) {\r\n          clearInterval(interval);\r\n          onLogout();\r\n          return 0;\r\n        }\r\n        return prev - 1;\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isOpen, onLogout]);\r\n\r\n  // ==========================================\r\n  // FOCUS MANAGEMENT\r\n  // ==========================================\r\n\r\n  // Focus trap and initial focus\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    // Focus the extend button when modal opens\r\n    const focusTimeout = setTimeout(() => {\r\n      extendButtonRef.current?.focus();\r\n    }, 100);\r\n\r\n    // Store previously focused element\r\n    const previouslyFocusedElement = document.activeElement as HTMLElement;\r\n\r\n    // Focus trap handler\r\n    const handleTabKey = (e: KeyboardEvent) => {\r\n      if (!modalRef.current) return;\r\n\r\n      const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(\r\n        'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\r\n      );\r\n\r\n      const firstElement = focusableElements[0];\r\n      const lastElement = focusableElements[focusableElements.length - 1];\r\n\r\n      if (e.shiftKey && document.activeElement === firstElement) {\r\n        e.preventDefault();\r\n        lastElement.focus();\r\n      } else if (!e.shiftKey && document.activeElement === lastElement) {\r\n        e.preventDefault();\r\n        firstElement.focus();\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Tab') {\r\n        handleTabKey(e);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n\r\n    return () => {\r\n      clearTimeout(focusTimeout);\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n      // Restore focus to previously focused element\r\n      previouslyFocusedElement?.focus();\r\n    };\r\n  }, [isOpen]);\r\n\r\n  // ==========================================\r\n  // KEYBOARD HANDLERS\r\n  // ==========================================\r\n\r\n  const handleKeyDown = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        onExtendSession();\r\n      }\r\n    },\r\n    [onExtendSession]\r\n  );\r\n\r\n  // ==========================================\r\n  // STABLE HANDLERS\r\n  // ==========================================\r\n\r\n  const handleExtend = useCallback(() => {\r\n    onExtendSession();\r\n  }, [onExtendSession]);\r\n\r\n  const handleLogout = useCallback(() => {\r\n    onLogout();\r\n  }, [onLogout]);\r\n\r\n  // ==========================================\r\n  // COUNTDOWN FORMATTING\r\n  // ==========================================\r\n\r\n  const minutes = Math.floor(countdown / 60);\r\n  const seconds = countdown % 60;\r\n  const formattedTime = `${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n\r\n  // Determine announcement for screen readers (announce every 30 seconds)\r\n  const shouldAnnounce = countdown % 30 === 0 || countdown <= 10;\r\n  const screenReaderAnnouncement = shouldAnnounce\r\n    ? `Session expires in ${minutes} ${minutes === 1 ? 'minute' : 'minutes'} and ${seconds} ${seconds === 1 ? 'second' : 'seconds'}`\r\n    : '';\r\n\r\n  // ==========================================\r\n  // RENDER\r\n  // ==========================================\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\"\r\n      role=\"alertdialog\"\r\n      aria-modal=\"true\"\r\n      aria-labelledby=\"session-warning-title\"\r\n      aria-describedby=\"session-warning-description\"\r\n      onKeyDown={handleKeyDown}\r\n      data-testid=\"session-warning-modal\"\r\n    >\r\n      <div\r\n        ref={modalRef}\r\n        className=\"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4\"\r\n        data-testid=\"session-warning-modal-content\"\r\n      >\r\n        {/* Header with Icon */}\r\n        <div className=\"flex items-center mb-4\">\r\n          <svg\r\n            className=\"w-6 h-6 text-yellow-500 mr-3 flex-shrink-0\"\r\n            fill=\"none\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth=\"2\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"currentColor\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <path d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n          </svg>\r\n          <h2\r\n            id=\"session-warning-title\"\r\n            className=\"text-xl font-semibold text-gray-900\"\r\n          >\r\n            Session Expiring Soon\r\n          </h2>\r\n        </div>\r\n\r\n        {/* Description */}\r\n        <p\r\n          id=\"session-warning-description\"\r\n          className=\"text-gray-600 mb-6\"\r\n        >\r\n          Your session will expire in{' '}\r\n          <span\r\n            className=\"font-bold text-red-600\"\r\n            data-testid=\"countdown-display\"\r\n          >\r\n            {formattedTime}\r\n          </span>{' '}\r\n          due to inactivity. For security and HIPAA compliance, you will be\r\n          automatically logged out.\r\n        </p>\r\n\r\n        {/* Screen Reader Live Region */}\r\n        <div\r\n          aria-live=\"polite\"\r\n          aria-atomic=\"true\"\r\n          className=\"sr-only\"\r\n          data-testid=\"countdown-announcement\"\r\n        >\r\n          {screenReaderAnnouncement}\r\n        </div>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex gap-3 justify-end\">\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors\"\r\n            type=\"button\"\r\n            data-testid=\"logout-button\"\r\n          >\r\n            Logout Now\r\n          </button>\r\n          <button\r\n            ref={extendButtonRef}\r\n            onClick={handleExtend}\r\n            className=\"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors\"\r\n            type=\"button\"\r\n            data-testid=\"extend-session-button\"\r\n          >\r\n            Stay Logged In\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Export as default as well for flexibility\r\nexport default SessionWarningModal;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 15412, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/components/session/index.ts"],"sourcesContent":["/**\r\n * Session Components - Barrel Export\r\n *\r\n * Exports all session-related components for the identity-access module.\r\n *\r\n * @module components/session\r\n */\r\n\r\nexport { SessionWarningModal } from './SessionWarningModal';\r\nexport type { SessionWarningModalProps } from './SessionWarningModal';\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;AAED","debugId":null}},
    {"offset": {"line": 15425, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/contexts/AuthContext.tsx"],"sourcesContent":["'use client';\r\n\r\n/**\r\n * Authentication Context - HIPAA-Compliant Session Management\r\n *\r\n * Provides centralized authentication state management with:\r\n * - JWT token management via HTTP-only secure cookies\r\n * - Automatic token refresh before expiration\r\n * - Session timeout enforcement (15 min idle for HIPAA)\r\n * - Multi-tab synchronization via BroadcastChannel (when available)\r\n * - Audit logging for authentication events\r\n * - Secure storage practices (no PHI in localStorage)\r\n * - Edge Runtime compatible (graceful fallback when BroadcastChannel unavailable)\r\n *\r\n * @module contexts/AuthContext\r\n */\r\n\r\nimport React, { createContext, useContext, useEffect, useState, useCallback, useRef, useMemo } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n  loginUser,\r\n  logoutUser,\r\n  refreshAuthToken,\r\n  setUserFromSession,\r\n  clearAuthError,\r\n} from '@/identity-access/stores/authSlice';\r\nimport { AppDispatch, RootState } from '@/stores/store';\r\nimport type { User } from '@/types';\r\nimport { SessionWarningModal } from '@/identity-access/components/session';\r\n\r\n// ==========================================\r\n// TYPES & INTERFACES\r\n// ==========================================\r\n\r\ninterface AuthContextValue {\r\n  user: User | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  sessionExpiresAt: number | null;\r\n  lastActivityAt: number;\r\n  login: (email: string, password: string, rememberMe?: boolean) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n  refreshToken: () => Promise<void>;\r\n  clearError: () => void;\r\n  updateActivity: () => void;\r\n  checkSession: () => boolean;\r\n  hasRole: (role: string | string[]) => boolean;\r\n  hasPermission: (permission: string) => boolean;\r\n}\r\n\r\n// ==========================================\r\n// CONSTANTS\r\n// ==========================================\r\n\r\nconst HIPAA_IDLE_TIMEOUT = 15 * 60 * 1000; // 15 minutes in milliseconds\r\nconst SESSION_WARNING_TIME = 2 * 60 * 1000; // 2 minutes before timeout\r\nconst TOKEN_REFRESH_INTERVAL = 50 * 60 * 1000; // Refresh token every 50 minutes\r\nconst ACTIVITY_CHECK_INTERVAL = 30 * 1000; // Check activity every 30 seconds\r\nconst BROADCAST_CHANNEL_NAME = 'auth_sync';\r\n\r\n// ==========================================\r\n// CONTEXT CREATION\r\n// ==========================================\r\n\r\nconst AuthContext = createContext<AuthContextValue | undefined>(undefined);\r\n\r\n// ==========================================\r\n// AUTH PROVIDER COMPONENT\r\n// ==========================================\r\n\r\ninterface AuthProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function AuthProvider({ children }: AuthProviderProps) {\r\n  const router = useRouter();\r\n  const dispatch = useDispatch<AppDispatch>();\r\n\r\n  // Redux state selectors\r\n  const authState = useSelector((state: RootState) => state.auth);\r\n  const { user, isAuthenticated, isLoading, error, sessionExpiresAt } = authState;\r\n\r\n  // Local state for activity tracking - initialize with 0 to avoid SSR hydration mismatch\r\n  const [lastActivityAt, setLastActivityAt] = useState<number>(0);\r\n  const [showSessionWarning, setShowSessionWarning] = useState(false);\r\n  const [isHydrated, setIsHydrated] = useState(false);\r\n\r\n  // Refs for intervals and broadcast channel\r\n  const activityCheckInterval = useRef<ReturnType<typeof setTimeout> | undefined>(undefined);\r\n  const tokenRefreshInterval = useRef<ReturnType<typeof setTimeout> | undefined>(undefined);\r\n  const broadcastChannel = useRef<BroadcastChannel | null>(null);\r\n  const isBroadcastChannelSupported = useRef<boolean>(false);\r\n\r\n  // ==========================================\r\n  // HYDRATION HANDLING\r\n  // ==========================================\r\n\r\n  // Handle client-side hydration to avoid SSR mismatch\r\n  useEffect(() => {\r\n    setIsHydrated(true);\r\n    setLastActivityAt(Date.now());\r\n  }, []);\r\n\r\n  // ==========================================\r\n  // ACTIVITY TRACKING\r\n  // ==========================================\r\n\r\n  const updateActivity = useCallback(() => {\r\n    if (!isHydrated) return; // Don't update activity until hydrated\r\n    \r\n    const now = Date.now();\r\n    setLastActivityAt(now);\r\n\r\n    // Broadcast activity to other tabs (only if supported)\r\n    if (isBroadcastChannelSupported.current && broadcastChannel.current) {\r\n      try {\r\n        broadcastChannel.current.postMessage({\r\n          type: 'activity_update',\r\n          timestamp: now,\r\n        });\r\n      } catch (error) {\r\n        console.warn('[Auth] Failed to broadcast activity:', error);\r\n      }\r\n    }\r\n  }, [isHydrated]);\r\n\r\n  // Track user activity events\r\n  useEffect(() => {\r\n    if (!isAuthenticated) return;\r\n\r\n    const events = ['mousedown', 'keydown', 'scroll', 'touchstart', 'click'];\r\n\r\n    events.forEach(event => {\r\n      window.addEventListener(event, updateActivity, { passive: true });\r\n    });\r\n\r\n    return () => {\r\n      events.forEach(event => {\r\n        window.removeEventListener(event, updateActivity);\r\n      });\r\n    };\r\n  }, [isAuthenticated, updateActivity]);\r\n\r\n  // ==========================================\r\n  // SESSION TIMEOUT CHECKING\r\n  // ==========================================\r\n\r\n  const checkSession = useCallback((): boolean => {\r\n    if (!isAuthenticated || !isHydrated) return false;\r\n\r\n    const now = Date.now();\r\n    const idleTime = now - lastActivityAt;\r\n\r\n    // Don't check session until we have a valid lastActivityAt\r\n    if (lastActivityAt === 0) return true;\r\n\r\n    // Check HIPAA idle timeout\r\n    if (idleTime >= HIPAA_IDLE_TIMEOUT) {\r\n      console.warn('[Auth] Session timeout due to inactivity');\r\n      dispatch(logoutUser(undefined));\r\n      router.push('/session-expired?reason=idle');\r\n      return false;\r\n    }\r\n\r\n    // Show warning if approaching timeout\r\n    if (idleTime >= HIPAA_IDLE_TIMEOUT - SESSION_WARNING_TIME && !showSessionWarning) {\r\n      setShowSessionWarning(true);\r\n    } else if (idleTime < HIPAA_IDLE_TIMEOUT - SESSION_WARNING_TIME && showSessionWarning) {\r\n      setShowSessionWarning(false);\r\n    }\r\n\r\n    // Check token expiration\r\n    if (sessionExpiresAt && now >= sessionExpiresAt) {\r\n      console.warn('[Auth] Session timeout due to token expiration');\r\n      dispatch(logoutUser(undefined));\r\n      router.push('/session-expired?reason=token');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }, [isAuthenticated, isHydrated, lastActivityAt, sessionExpiresAt, showSessionWarning, dispatch, router]);\r\n\r\n  // Periodic session checking\r\n  useEffect(() => {\r\n    if (!isAuthenticated) return;\r\n\r\n    activityCheckInterval.current = setInterval(() => {\r\n      checkSession();\r\n    }, ACTIVITY_CHECK_INTERVAL);\r\n\r\n    return () => {\r\n      if (activityCheckInterval.current) {\r\n        clearInterval(activityCheckInterval.current);\r\n      }\r\n    };\r\n  }, [isAuthenticated, checkSession]);\r\n\r\n  // ==========================================\r\n  // TOKEN REFRESH\r\n  // ==========================================\r\n\r\n  const refreshToken = useCallback(async () => {\r\n    try {\r\n      await dispatch(refreshAuthToken()).unwrap();\r\n      updateActivity(); // Reset activity on successful refresh\r\n    } catch (error) {\r\n      console.error('[Auth] Token refresh failed:', error);\r\n      dispatch(logoutUser(undefined));\r\n      router.push('/session-expired?reason=refresh_failed');\r\n    }\r\n  }, [dispatch, router, updateActivity]);\r\n\r\n  // Automatic token refresh\r\n  useEffect(() => {\r\n    if (!isAuthenticated) return;\r\n\r\n    tokenRefreshInterval.current = setInterval(() => {\r\n      refreshToken();\r\n    }, TOKEN_REFRESH_INTERVAL);\r\n\r\n    return () => {\r\n      if (tokenRefreshInterval.current) {\r\n        clearInterval(tokenRefreshInterval.current);\r\n      }\r\n    };\r\n  }, [isAuthenticated, refreshToken]);\r\n\r\n  // ==========================================\r\n  // MULTI-TAB SYNCHRONIZATION\r\n  // ==========================================\r\n\r\n  useEffect(() => {\r\n    // Only initialize BroadcastChannel in browser environment where it's supported\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // Check if BroadcastChannel is available via window (not available in Edge Runtime)\r\n    // Using window/globalThis reference prevents static analysis issues\r\n    const BroadcastChannelConstructor = (typeof window !== 'undefined' && 'BroadcastChannel' in window)\r\n      ? (window as typeof globalThis & { BroadcastChannel: typeof BroadcastChannel }).BroadcastChannel\r\n      : undefined;\r\n\r\n    if (!BroadcastChannelConstructor) {\r\n      console.info('[Auth] BroadcastChannel not available - multi-tab sync disabled');\r\n      isBroadcastChannelSupported.current = false;\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Create broadcast channel for cross-tab communication using dynamic constructor\r\n      broadcastChannel.current = new BroadcastChannelConstructor(BROADCAST_CHANNEL_NAME);\r\n      isBroadcastChannelSupported.current = true;\r\n\r\n      // Handle messages from other tabs\r\n      broadcastChannel.current.onmessage = (event: MessageEvent) => {\r\n        const { type, timestamp } = event.data;\r\n\r\n        switch (type) {\r\n          case 'logout':\r\n            // Sync logout across tabs\r\n            dispatch(logoutUser(undefined));\r\n            router.push('/login');\r\n            break;\r\n\r\n          case 'login':\r\n            // Sync login across tabs\r\n            if (event.data.user) {\r\n              dispatch(setUserFromSession(event.data.user));\r\n            }\r\n            break;\r\n\r\n          case 'activity_update':\r\n            // Sync activity across tabs\r\n            if (timestamp > lastActivityAt) {\r\n              setLastActivityAt(timestamp);\r\n            }\r\n            break;\r\n\r\n          default:\r\n            break;\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.warn('[Auth] Failed to initialize BroadcastChannel:', error);\r\n      isBroadcastChannelSupported.current = false;\r\n      broadcastChannel.current = null;\r\n    }\r\n\r\n    return () => {\r\n      if (broadcastChannel.current) {\r\n        try {\r\n          broadcastChannel.current.close();\r\n        } catch (error) {\r\n          console.warn('[Auth] Error closing BroadcastChannel:', error);\r\n        }\r\n        broadcastChannel.current = null;\r\n      }\r\n    };\r\n  }, [dispatch, router, lastActivityAt]);\r\n\r\n  // ==========================================\r\n  // SESSION RESTORATION\r\n  // ==========================================\r\n\r\n  useEffect(() => {\r\n    // On mount, check for existing session in cookies\r\n    const restoreSession = async () => {\r\n      // This will be handled by middleware and API calls\r\n      // Token is in HTTP-only cookie, not accessible to JS\r\n      // Backend will validate on first API call\r\n    };\r\n\r\n    restoreSession();\r\n  }, []);\r\n\r\n  // ==========================================\r\n  // AUTH METHODS\r\n  // ==========================================\r\n\r\n  const login = useCallback(async (email: string, password: string, rememberMe = false) => {\r\n    try {\r\n      const result = await dispatch(loginUser({ email, password })).unwrap();\r\n\r\n      updateActivity();\r\n\r\n      // Broadcast login to other tabs (only if supported)\r\n      if (isBroadcastChannelSupported.current && broadcastChannel.current) {\r\n        try {\r\n          broadcastChannel.current.postMessage({\r\n            type: 'login',\r\n            user: result.user,\r\n          });\r\n        } catch (error) {\r\n          console.warn('[Auth] Failed to broadcast login:', error);\r\n        }\r\n      }\r\n\r\n      // Audit log login event\r\n      console.log('[Auth] User logged in:', { userId: result.user.id, role: result.user.role });\r\n    } catch (error) {\r\n      console.error('[Auth] Login failed:', error);\r\n      throw error;\r\n    }\r\n  }, [dispatch, updateActivity]);\r\n\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      await dispatch(logoutUser(undefined)).unwrap();\r\n\r\n      // Broadcast logout to other tabs (only if supported)\r\n      if (isBroadcastChannelSupported.current && broadcastChannel.current) {\r\n        try {\r\n          broadcastChannel.current.postMessage({ type: 'logout' });\r\n        } catch (error) {\r\n          console.warn('[Auth] Failed to broadcast logout:', error);\r\n        }\r\n      }\r\n\r\n      // Audit log logout event\r\n      console.log('[Auth] User logged out');\r\n\r\n      router.push('/login');\r\n    } catch (error) {\r\n      console.error('[Auth] Logout failed:', error);\r\n      // Still redirect to login even if server logout fails\r\n      router.push('/login');\r\n    }\r\n  }, [dispatch, router]);\r\n\r\n  const clearError = useCallback(() => {\r\n    dispatch(clearAuthError());\r\n  }, [dispatch]);\r\n\r\n  // ==========================================\r\n  // AUTHORIZATION HELPERS\r\n  // ==========================================\r\n\r\n  const hasRole = useCallback((role: string | string[]): boolean => {\r\n    if (!user) return false;\r\n\r\n    const roles = Array.isArray(role) ? role : [role];\r\n    return roles.includes(user.role);\r\n  }, [user]);\r\n\r\n  const hasPermission = useCallback((permission: string): boolean => {\r\n    if (!user || !user.permissions) return false;\r\n\r\n    return user.permissions.includes(permission);\r\n  }, [user]);\r\n\r\n  // ==========================================\r\n  // CONTEXT VALUE\r\n  // ==========================================\r\n\r\n  const value: AuthContextValue = useMemo(\r\n    () => ({\r\n      user,\r\n      isAuthenticated,\r\n      isLoading,\r\n      error,\r\n      sessionExpiresAt,\r\n      lastActivityAt,\r\n      login,\r\n      logout,\r\n      refreshToken,\r\n      clearError,\r\n      updateActivity,\r\n      checkSession,\r\n      hasRole,\r\n      hasPermission,\r\n    }),\r\n    [\r\n      user,\r\n      isAuthenticated,\r\n      isLoading,\r\n      error,\r\n      sessionExpiresAt,\r\n      lastActivityAt,\r\n      login,\r\n      logout,\r\n      refreshToken,\r\n      clearError,\r\n      updateActivity,\r\n      checkSession,\r\n      hasRole,\r\n      hasPermission,\r\n    ]\r\n  );\r\n\r\n  // Calculate time remaining for SessionWarningModal\r\n  const timeRemainingSeconds = useMemo(() => {\r\n    if (!isHydrated || lastActivityAt === 0) return 120; // Default 2 minutes\r\n    const timeRemaining = HIPAA_IDLE_TIMEOUT - (Date.now() - lastActivityAt);\r\n    return Math.floor(Math.max(0, timeRemaining) / 1000);\r\n  }, [lastActivityAt, isHydrated]);\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n      {showSessionWarning && (\r\n        <SessionWarningModal\r\n          isOpen={showSessionWarning}\r\n          timeRemainingSeconds={timeRemainingSeconds}\r\n          onExtendSession={() => {\r\n            updateActivity();\r\n            setShowSessionWarning(false);\r\n          }}\r\n          onLogout={logout}\r\n        />\r\n      )}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\n// ==========================================\r\n// CUSTOM HOOK\r\n// ==========================================\r\n\r\n/**\r\n * useAuth Hook\r\n *\r\n * Access authentication context from any component.\r\n * Must be used within an AuthProvider.\r\n *\r\n * @example\r\n * ```tsx\r\n * const { user, login, logout, hasRole } = useAuth();\r\n *\r\n * if (hasRole('ADMIN')) {\r\n *   // Show admin features\r\n * }\r\n * ```\r\n */\r\nexport function useAuth(): AuthContextValue {\r\n  const context = useContext(AuthContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\n/**\r\n * Backward compatibility alias for useAuth\r\n * @deprecated Use useAuth instead\r\n */\r\nexport const useAuthContext = useAuth;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 15815, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/contexts/NavigationContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useCallback, useMemo, useEffect } from 'react';\r\n\r\n/**\r\n * Breadcrumb item interface for navigation trail\r\n */\r\nexport interface BreadcrumbItem {\r\n  /** Display label for the breadcrumb */\r\n  label: string;\r\n  /** URL path for the breadcrumb link */\r\n  href: string;\r\n  /** Whether this is the current/active breadcrumb */\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Navigation history entry for tracking user navigation\r\n */\r\nexport interface NavigationHistoryEntry {\r\n  /** Route path */\r\n  path: string;\r\n  /** Timestamp when route was visited */\r\n  timestamp: number;\r\n  /** Optional route title */\r\n  title?: string;\r\n}\r\n\r\n/**\r\n * Navigation state interface\r\n */\r\nexport interface NavigationState {\r\n  /** Desktop sidebar open/closed state */\r\n  isSidebarOpen: boolean;\r\n  /** Mobile sidebar open/closed state */\r\n  isMobileSidebarOpen: boolean;\r\n  /** Currently active route path */\r\n  activeRoute: string;\r\n  /** Current breadcrumb trail */\r\n  breadcrumbs: BreadcrumbItem[];\r\n  /** Navigation history (last 50 entries) */\r\n  navigationHistory: NavigationHistoryEntry[];\r\n  /** Sidebar collapsed state (mini sidebar) */\r\n  isSidebarCollapsed: boolean;\r\n  /** Notification center open/closed state */\r\n  notificationOpen: boolean;\r\n}\r\n\r\n/**\r\n * Navigation context actions interface\r\n */\r\nexport interface NavigationActions {\r\n  /** Toggle desktop sidebar open/closed */\r\n  toggleSidebar: () => void;\r\n  /** Set desktop sidebar open/closed explicitly */\r\n  setSidebarOpen: (open: boolean) => void;\r\n  /** Toggle mobile sidebar open/closed */\r\n  toggleMobileSidebar: () => void;\r\n  /** Set mobile sidebar open/closed explicitly */\r\n  setMobileSidebarOpen: (open: boolean) => void;\r\n  /** Set the active route */\r\n  setActiveRoute: (route: string) => void;\r\n  /** Set breadcrumbs for the current view */\r\n  setBreadcrumbs: (breadcrumbs: BreadcrumbItem[]) => void;\r\n  /** Add entry to navigation history */\r\n  addToHistory: (entry: Omit<NavigationHistoryEntry, 'timestamp'>) => void;\r\n  /** Clear navigation history */\r\n  clearHistory: () => void;\r\n  /** Toggle sidebar collapsed state (mini sidebar) */\r\n  toggleSidebarCollapsed: () => void;\r\n  /** Set sidebar collapsed state explicitly */\r\n  setSidebarCollapsed: (collapsed: boolean) => void;\r\n  /** Navigate back to previous route in history */\r\n  navigateBack: () => NavigationHistoryEntry | null;\r\n  /** Toggle notification center open/closed */\r\n  toggleNotificationCenter: () => void;\r\n  /** Set notification center open/closed explicitly */\r\n  setNotificationOpen: (open: boolean) => void;\r\n}\r\n\r\n/**\r\n * Combined navigation context type\r\n */\r\nexport interface NavigationContextType extends NavigationState, NavigationActions {}\r\n\r\n/**\r\n * Navigation context - provides navigation state and actions throughout the app\r\n */\r\nconst NavigationContext = createContext<NavigationContextType | undefined>(undefined);\r\n\r\n/**\r\n * Props for NavigationProvider component\r\n */\r\nexport interface NavigationProviderProps {\r\n  /** Child components */\r\n  children: React.ReactNode;\r\n  /** Initial sidebar open state (default: true for desktop) */\r\n  initialSidebarOpen?: boolean;\r\n  /** Initial sidebar collapsed state (default: false) */\r\n  initialSidebarCollapsed?: boolean;\r\n  /** Maximum history entries to keep (default: 50) */\r\n  maxHistoryEntries?: number;\r\n  /** Enable localStorage persistence (default: true) */\r\n  persistState?: boolean;\r\n}\r\n\r\n/**\r\n * Storage keys for state persistence\r\n */\r\nconst STORAGE_KEYS = {\r\n  SIDEBAR_OPEN: 'navigation_sidebar_open',\r\n  SIDEBAR_COLLAPSED: 'navigation_sidebar_collapsed',\r\n  ACTIVE_ROUTE: 'navigation_active_route',\r\n} as const;\r\n\r\n/**\r\n * NavigationProvider - Provides navigation state and actions to the component tree\r\n *\r\n * @example\r\n * ```tsx\r\n * <NavigationProvider>\r\n *   <App />\r\n * </NavigationProvider>\r\n * ```\r\n */\r\nexport const NavigationProvider: React.FC<NavigationProviderProps> = ({\r\n  children,\r\n  initialSidebarOpen = true,\r\n  initialSidebarCollapsed = false,\r\n  maxHistoryEntries = 50,\r\n  persistState = true,\r\n}) => {\r\n  // Initialize state from localStorage if persistence is enabled\r\n  const getInitialSidebarOpen = useCallback((): boolean => {\r\n    if (typeof window === 'undefined' || !persistState) {\r\n      return initialSidebarOpen;\r\n    }\r\n\r\n    try {\r\n      const stored = localStorage.getItem(STORAGE_KEYS.SIDEBAR_OPEN);\r\n      return stored !== null ? stored === 'true' : initialSidebarOpen;\r\n    } catch (error) {\r\n      console.warn('Failed to read sidebar state from localStorage:', error);\r\n      return initialSidebarOpen;\r\n    }\r\n  }, [initialSidebarOpen, persistState]);\r\n\r\n  const getInitialSidebarCollapsed = useCallback((): boolean => {\r\n    if (typeof window === 'undefined' || !persistState) {\r\n      return initialSidebarCollapsed;\r\n    }\r\n\r\n    try {\r\n      const stored = localStorage.getItem(STORAGE_KEYS.SIDEBAR_COLLAPSED);\r\n      return stored !== null ? stored === 'true' : initialSidebarCollapsed;\r\n    } catch (error) {\r\n      console.warn('Failed to read sidebar collapsed state from localStorage:', error);\r\n      return initialSidebarCollapsed;\r\n    }\r\n  }, [initialSidebarCollapsed, persistState]);\r\n\r\n  const getInitialActiveRoute = useCallback((): string => {\r\n    if (typeof window === 'undefined') {\r\n      return '/';\r\n    }\r\n\r\n    if (persistState) {\r\n      try {\r\n        const stored = localStorage.getItem(STORAGE_KEYS.ACTIVE_ROUTE);\r\n        if (stored) return stored;\r\n      } catch (error) {\r\n        console.warn('Failed to read active route from localStorage:', error);\r\n      }\r\n    }\r\n\r\n    return window.location.pathname;\r\n  }, [persistState]);\r\n\r\n  // State management\r\n  const [isSidebarOpen, setIsSidebarOpen] = useState<boolean>(getInitialSidebarOpen);\r\n  const [isMobileSidebarOpen, setIsMobileSidebarOpen] = useState<boolean>(false);\r\n  const [activeRoute, setActiveRouteState] = useState<string>(getInitialActiveRoute);\r\n  const [breadcrumbs, setBreadcrumbsState] = useState<BreadcrumbItem[]>([]);\r\n  const [navigationHistory, setNavigationHistory] = useState<NavigationHistoryEntry[]>([]);\r\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState<boolean>(getInitialSidebarCollapsed);\r\n  const [notificationOpen, setNotificationOpenState] = useState<boolean>(false);\r\n\r\n  // Persist sidebar state to localStorage\r\n  useEffect(() => {\r\n    if (!persistState || typeof window === 'undefined') return;\r\n\r\n    try {\r\n      localStorage.setItem(STORAGE_KEYS.SIDEBAR_OPEN, String(isSidebarOpen));\r\n    } catch (error) {\r\n      console.warn('Failed to persist sidebar state:', error);\r\n    }\r\n  }, [isSidebarOpen, persistState]);\r\n\r\n  // Persist sidebar collapsed state to localStorage\r\n  useEffect(() => {\r\n    if (!persistState || typeof window === 'undefined') return;\r\n\r\n    try {\r\n      localStorage.setItem(STORAGE_KEYS.SIDEBAR_COLLAPSED, String(isSidebarCollapsed));\r\n    } catch (error) {\r\n      console.warn('Failed to persist sidebar collapsed state:', error);\r\n    }\r\n  }, [isSidebarCollapsed, persistState]);\r\n\r\n  // Persist active route to localStorage\r\n  useEffect(() => {\r\n    if (!persistState || typeof window === 'undefined') return;\r\n\r\n    try {\r\n      localStorage.setItem(STORAGE_KEYS.ACTIVE_ROUTE, activeRoute);\r\n    } catch (error) {\r\n      console.warn('Failed to persist active route:', error);\r\n    }\r\n  }, [activeRoute, persistState]);\r\n\r\n  // Close mobile sidebar when switching to desktop view\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    const handleResize = () => {\r\n      if (window.innerWidth >= 768 && isMobileSidebarOpen) {\r\n        setIsMobileSidebarOpen(false);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, [isMobileSidebarOpen]);\r\n\r\n  /**\r\n   * Toggle desktop sidebar open/closed\r\n   */\r\n  const toggleSidebar = useCallback(() => {\r\n    setIsSidebarOpen((prev) => !prev);\r\n  }, []);\r\n\r\n  /**\r\n   * Set desktop sidebar open/closed explicitly\r\n   */\r\n  const setSidebarOpen = useCallback((open: boolean) => {\r\n    setIsSidebarOpen(open);\r\n  }, []);\r\n\r\n  /**\r\n   * Toggle mobile sidebar open/closed\r\n   */\r\n  const toggleMobileSidebar = useCallback(() => {\r\n    setIsMobileSidebarOpen((prev) => !prev);\r\n  }, []);\r\n\r\n  /**\r\n   * Set mobile sidebar open/closed explicitly\r\n   */\r\n  const setMobileSidebarOpen = useCallback((open: boolean) => {\r\n    setIsMobileSidebarOpen(open);\r\n  }, []);\r\n\r\n  /**\r\n   * Set the active route and update navigation history\r\n   */\r\n  const setActiveRoute = useCallback((route: string) => {\r\n    setActiveRouteState(route);\r\n\r\n    // Add to history\r\n    setNavigationHistory((prev) => {\r\n      const newEntry: NavigationHistoryEntry = {\r\n        path: route,\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      // Avoid duplicate consecutive entries\r\n      if (prev.length > 0 && prev[prev.length - 1].path === route) {\r\n        return prev;\r\n      }\r\n\r\n      // Keep only maxHistoryEntries\r\n      const updated = [...prev, newEntry];\r\n      return updated.slice(-maxHistoryEntries);\r\n    });\r\n  }, [maxHistoryEntries]);\r\n\r\n  /**\r\n   * Set breadcrumbs for the current view\r\n   */\r\n  const setBreadcrumbs = useCallback((newBreadcrumbs: BreadcrumbItem[]) => {\r\n    setBreadcrumbsState(newBreadcrumbs);\r\n  }, []);\r\n\r\n  /**\r\n   * Add entry to navigation history\r\n   */\r\n  const addToHistory = useCallback((entry: Omit<NavigationHistoryEntry, 'timestamp'>) => {\r\n    setNavigationHistory((prev) => {\r\n      const newEntry: NavigationHistoryEntry = {\r\n        ...entry,\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      // Avoid duplicate consecutive entries\r\n      if (prev.length > 0 && prev[prev.length - 1].path === entry.path) {\r\n        return prev;\r\n      }\r\n\r\n      const updated = [...prev, newEntry];\r\n      return updated.slice(-maxHistoryEntries);\r\n    });\r\n  }, [maxHistoryEntries]);\r\n\r\n  /**\r\n   * Clear navigation history\r\n   */\r\n  const clearHistory = useCallback(() => {\r\n    setNavigationHistory([]);\r\n  }, []);\r\n\r\n  /**\r\n   * Toggle sidebar collapsed state (mini sidebar)\r\n   */\r\n  const toggleSidebarCollapsed = useCallback(() => {\r\n    setIsSidebarCollapsed((prev) => !prev);\r\n  }, []);\r\n\r\n  /**\r\n   * Set sidebar collapsed state explicitly\r\n   */\r\n  const setSidebarCollapsed = useCallback((collapsed: boolean) => {\r\n    setIsSidebarCollapsed(collapsed);\r\n  }, []);\r\n\r\n  /**\r\n   * Navigate back to previous route in history\r\n   * Returns the previous navigation entry or null if history is empty\r\n   */\r\n  const navigateBack = useCallback((): NavigationHistoryEntry | null => {\r\n    if (navigationHistory.length <= 1) {\r\n      return null;\r\n    }\r\n\r\n    // Get the previous entry (second to last)\r\n    const previousEntry = navigationHistory[navigationHistory.length - 2];\r\n\r\n    // Remove the current entry from history\r\n    setNavigationHistory((prev) => prev.slice(0, -1));\r\n\r\n    return previousEntry;\r\n  }, [navigationHistory]);\r\n\r\n  /**\r\n   * Toggle notification center open/closed\r\n   */\r\n  const toggleNotificationCenter = useCallback(() => {\r\n    setNotificationOpenState((prev) => !prev);\r\n  }, []);\r\n\r\n  /**\r\n   * Set notification center open/closed explicitly\r\n   */\r\n  const setNotificationOpen = useCallback((open: boolean) => {\r\n    setNotificationOpenState(open);\r\n  }, []);\r\n\r\n  // Memoize context value to prevent unnecessary re-renders\r\n  const contextValue = useMemo<NavigationContextType>(\r\n    () => ({\r\n      // State\r\n      isSidebarOpen,\r\n      isMobileSidebarOpen,\r\n      activeRoute,\r\n      breadcrumbs,\r\n      navigationHistory,\r\n      isSidebarCollapsed,\r\n      notificationOpen,\r\n      // Actions\r\n      toggleSidebar,\r\n      setSidebarOpen,\r\n      toggleMobileSidebar,\r\n      setMobileSidebarOpen,\r\n      setActiveRoute,\r\n      setBreadcrumbs,\r\n      addToHistory,\r\n      clearHistory,\r\n      toggleSidebarCollapsed,\r\n      setSidebarCollapsed,\r\n      navigateBack,\r\n      toggleNotificationCenter,\r\n      setNotificationOpen,\r\n    }),\r\n    [\r\n      isSidebarOpen,\r\n      isMobileSidebarOpen,\r\n      activeRoute,\r\n      notificationOpen,\r\n      breadcrumbs,\r\n      navigationHistory,\r\n      isSidebarCollapsed,\r\n      toggleSidebar,\r\n      setSidebarOpen,\r\n      toggleMobileSidebar,\r\n      setMobileSidebarOpen,\r\n      setActiveRoute,\r\n      setBreadcrumbs,\r\n      addToHistory,\r\n      clearHistory,\r\n      toggleSidebarCollapsed,\r\n      setSidebarCollapsed,\r\n      navigateBack,\r\n    ]\r\n  );\r\n\r\n  return (\r\n    <NavigationContext.Provider value={contextValue}>\r\n      {children}\r\n    </NavigationContext.Provider>\r\n  );\r\n};\r\n\r\n/**\r\n * useNavigation hook - Access navigation state and actions\r\n *\r\n * @throws {Error} If used outside of NavigationProvider\r\n *\r\n * @example\r\n * ```tsx\r\n * function MyComponent() {\r\n *   const { isSidebarOpen, toggleSidebar, setActiveRoute } = useNavigation();\r\n *\r\n *   return (\r\n *     <button onClick={toggleSidebar}>\r\n *       Toggle Sidebar\r\n *     </button>\r\n *   );\r\n * }\r\n * ```\r\n */\r\nexport const useNavigation = (): NavigationContextType => {\r\n  const context = useContext(NavigationContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      'useNavigation must be used within a NavigationProvider. ' +\r\n      'Wrap your component tree with <NavigationProvider> to use navigation features.'\r\n    );\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\n/**\r\n * NavigationErrorBoundary - Error boundary for navigation-related errors\r\n *\r\n * @example\r\n * ```tsx\r\n * <NavigationErrorBoundary fallback={<ErrorDisplay />}>\r\n *   <NavigationProvider>\r\n *     <App />\r\n *   </NavigationProvider>\r\n * </NavigationErrorBoundary>\r\n * ```\r\n */\r\nexport class NavigationErrorBoundary extends React.Component<\r\n  { children: React.ReactNode; fallback?: React.ReactNode },\r\n  { hasError: boolean; error: Error | null }\r\n> {\r\n  constructor(props: { children: React.ReactNode; fallback?: React.ReactNode }) {\r\n    super(props);\r\n    this.state = { hasError: false, error: null };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    console.error('NavigationContext Error:', error, errorInfo);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.fallback || (\r\n        <div role=\"alert\" style={{ padding: '20px', color: 'red' }}>\r\n          <h2>Navigation Error</h2>\r\n          <p>{this.state.error?.message || 'An error occurred in the navigation system'}</p>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n// Default export for convenience\r\nexport default NavigationContext;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 16140, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/app/providers.tsx"],"sourcesContent":["'use client';\r\n\r\n/**\r\n * Providers Component - Client-side provider setup for Next.js\r\n *\r\n * This component wraps the app with all necessary providers:\r\n * - React Query Provider (server state)\r\n * - Redux Provider (client state)\r\n * - Apollo Provider (GraphQL)\r\n * - Auth Provider (authentication & authorization)\r\n * - Navigation Provider (UI navigation state)\r\n *\r\n * @module app/providers\r\n * @category State Management\r\n */\r\n\r\nimport React, { type ReactNode, useState } from 'react';\r\nimport { QueryClientProvider } from '@tanstack/react-query';\r\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\r\nimport { getQueryClient } from '@/config/queryClient';\r\n\r\n// Import consolidated providers\r\nimport { ReduxProvider } from '@/providers/ReduxProvider';\r\nimport { ApolloProvider } from '@/providers/ApolloProvider';\r\nimport { AuthProvider } from '@/identity-access/contexts/AuthContext';\r\nimport { NavigationProvider } from '@/contexts/NavigationContext';\r\n\r\ninterface ProvidersProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function Providers({ children }: ProvidersProps) {\r\n  // Create a new query client instance per request for SSR\r\n  const [queryClient] = useState(() => getQueryClient());\r\n\r\n  return (\r\n    <ReduxProvider>\r\n      <QueryClientProvider client={queryClient}>\r\n        <ApolloProvider>\r\n          <AuthProvider>\r\n            <NavigationProvider>\r\n              {children}\r\n            </NavigationProvider>\r\n          </AuthProvider>\r\n          {process.env.NODE_ENV === 'development' && (\r\n            <ReactQueryDevtools initialIsOpen={false} />\r\n          )}\r\n        </ApolloProvider>\r\n      </QueryClientProvider>\r\n    </ReduxProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;;;;;;;;;;CAYC,GAED;AACA;AACA;AACA;AAEA,gCAAgC;AAChC;AACA;AACA;AACA;AAzBA;;;;;;;;;;AA+BO,SAAS,UAAU,EAAE,QAAQ,EAAkB;IACpD,yDAAyD;IACzD,MAAM,CAAC,YAAY,GAAG,IAAA,iNAAQ,EAAC,IAAM,IAAA,8IAAc;IAEnD,qBACE,8OAAC,mJAAa;kBACZ,cAAA,8OAAC,6MAAmB;YAAC,QAAQ;sBAC3B,cAAA,8OAAC,qJAAc;;kCACb,8OAAC,qKAAY;kCACX,cAAA,8OAAC,2JAAkB;sCAChB;;;;;;;;;;;oBAGJ,oDAAyB,+BACxB,8OAAC,0MAAkB;wBAAC,eAAe;;;;;;;;;;;;;;;;;;;;;;AAM/C","debugId":null}}]
}