{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/lib/api/nextjs-client.ts"],"sourcesContent":["/**\r\n * @fileoverview Next.js Fetch-Based API Client\r\n * @module lib/api/nextjs-client\r\n * @category API Client\r\n *\r\n * Enterprise-grade HTTP client built on Next.js native fetch API with comprehensive\r\n * caching, revalidation, and error handling capabilities.\r\n *\r\n * Key Features:\r\n * - Native Next.js fetch with automatic request deduplication\r\n * - Cache configuration (cache, revalidate, tags)\r\n * - cacheLife support for Next.js 15+\r\n * - Type-safe HTTP methods (GET, POST, PUT, PATCH, DELETE)\r\n * - Automatic authentication token injection\r\n * - CSRF protection headers\r\n * - Comprehensive error handling and retry logic\r\n * - Request ID generation for tracing\r\n * - HIPAA-compliant audit logging integration\r\n *\r\n * This client is designed to replace axios-based clients in Server Components\r\n * and Server Actions, enabling full integration with Next.js caching system.\r\n *\r\n * @example\r\n * ```typescript\r\n * // In a Server Component\r\n * const students = await serverGet<Student[]>('/api/students', {\r\n *   cache: 'force-cache',\r\n *   next: {\r\n *     revalidate: CACHE_TTL.PHI_STANDARD,\r\n *     tags: [CACHE_TAGS.STUDENTS, CACHE_TAGS.PHI]\r\n *   }\r\n * });\r\n *\r\n * // In a Server Action\r\n * const result = await serverPost<Student>('/api/students', data, {\r\n *   cache: 'no-store',\r\n *   next: { tags: [CACHE_TAGS.STUDENTS] }\r\n * });\r\n * ```\r\n *\r\n * @version 1.0.0\r\n * @since 2025-10-31\r\n */\r\n\r\nimport { cookies, headers } from 'next/headers';\r\nimport { redirect } from 'next/navigation';\r\nimport { COOKIE_NAMES } from '@/identity-access/lib/config/cookies';\r\n\r\n// ==========================================\r\n// TYPE DEFINITIONS\r\n// ==========================================\r\n\r\n/**\r\n * Simple API client options for basic HTTP requests\r\n * @deprecated Consider using NextFetchOptions for new code\r\n */\r\nexport interface ApiClientOptions {\r\n  method?: string\r\n  body?: unknown\r\n  headers?: Record<string, string>\r\n}\r\n\r\n/**\r\n * Next.js cache configuration options\r\n */\r\nexport interface NextCacheConfig {\r\n  /**\r\n   * Cache behavior\r\n   * - 'force-cache': Cache the response (default for GET)\r\n   * - 'no-store': Never cache the response (default for mutations)\r\n   * - 'reload': Bypass cache and revalidate\r\n   * - 'no-cache': Cache but always revalidate\r\n   * - 'force-cache': Use cache if available, fetch if not\r\n   * - 'only-if-cached': Use cache only, fail if not cached\r\n   */\r\n  cache?: RequestCache;\r\n\r\n  /**\r\n   * Next.js-specific cache options\r\n   */\r\n  next?: {\r\n    /**\r\n     * Time in seconds to revalidate cache\r\n     * - number: Revalidate after N seconds\r\n     * - false: Never revalidate (cache indefinitely)\r\n     * - 0: Revalidate immediately (effectively no-store)\r\n     */\r\n    revalidate?: number | false;\r\n\r\n    /**\r\n     * Cache tags for granular invalidation via revalidateTag()\r\n     * @example ['students', 'phi-data']\r\n     */\r\n    tags?: string[];\r\n  };\r\n}\r\n\r\n/**\r\n * cacheLife profiles for Next.js 15+ advanced caching\r\n * @see https://nextjs.org/docs/app/api-reference/next-config-js/cacheLife\r\n */\r\nexport interface CacheLifeConfig {\r\n  /**\r\n   * Time to live in seconds\r\n   */\r\n  ttl: number;\r\n\r\n  /**\r\n   * Stale-while-revalidate window in seconds\r\n   */\r\n  stale?: number;\r\n\r\n  /**\r\n   * Maximum age in cache regardless of revalidation\r\n   */\r\n  max?: number;\r\n}\r\n\r\n/**\r\n * Extended fetch options with Next.js caching and authentication\r\n */\r\nexport interface NextFetchOptions extends RequestInit {\r\n  /**\r\n   * Whether to include authentication token\r\n   * @default true\r\n   */\r\n  requiresAuth?: boolean;\r\n\r\n  /**\r\n   * Cache behavior configuration\r\n   */\r\n  cache?: RequestCache;\r\n\r\n  /**\r\n   * Next.js-specific cache options\r\n   */\r\n  next?: {\r\n    revalidate?: number | false;\r\n    tags?: string[];\r\n  };\r\n\r\n  /**\r\n   * cacheLife profile (Next.js 15+)\r\n   */\r\n  cacheLife?: string | CacheLifeConfig;\r\n\r\n  /**\r\n   * Retry configuration\r\n   */\r\n  retry?: {\r\n    attempts: number;\r\n    delay: number;\r\n  };\r\n\r\n  /**\r\n   * Custom error handler\r\n   */\r\n  onError?: (error: Error) => void;\r\n\r\n  /**\r\n   * Request timeout in milliseconds\r\n   */\r\n  timeout?: number;\r\n}\r\n\r\n/**\r\n * Standardized API response wrapper\r\n */\r\nexport interface ApiResponse<T = unknown> {\r\n  success: boolean;\r\n  data: T;\r\n  message?: string;\r\n  errors?: Record<string, string[]>;\r\n}\r\n\r\n/**\r\n * API error response structure\r\n */\r\nexport interface ApiErrorResponse {\r\n  message: string;\r\n  code?: string;\r\n  status?: number;\r\n  details?: unknown;\r\n  field?: string;\r\n  traceId?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n/**\r\n * Custom error class for Next.js API client errors\r\n *\r\n * @class\r\n * @extends Error\r\n * @classdesc Wraps API errors with metadata and automatic classification\r\n */\r\nexport class NextApiClientError extends Error {\r\n  public readonly code?: string;\r\n  public readonly status?: number;\r\n  public readonly details?: unknown;\r\n  public readonly traceId?: string;\r\n  public readonly isNetworkError: boolean;\r\n  public readonly isServerError: boolean;\r\n  public readonly isValidationError: boolean;\r\n\r\n  constructor(error: ApiErrorResponse) {\r\n    super(error.message);\r\n    this.name = 'NextApiClientError';\r\n    this.code = error.code;\r\n    this.status = error.status;\r\n    this.details = error.details;\r\n    this.traceId = error.traceId;\r\n\r\n    // Classify error types\r\n    this.isNetworkError = error.code === 'NETWORK_ERROR';\r\n    this.isServerError = (error.status ?? 0) >= 500;\r\n    this.isValidationError = error.status === 400;\r\n\r\n    // Maintain proper stack trace\r\n    if (typeof Error.captureStackTrace === 'function') {\r\n      Error.captureStackTrace(this, NextApiClientError);\r\n    }\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// CONFIGURATION\r\n// ==========================================\r\n\r\n/**\r\n * Get API base URL from environment\r\n */\r\nfunction getApiBaseUrl(): string {\r\n  return process.env.API_BASE_URL ||\r\n         process.env.NEXT_PUBLIC_API_URL ||\r\n         'http://localhost:3001';\r\n}\r\n\r\n/**\r\n * Get authentication token from production-ready httpOnly cookies\r\n * Uses the existing JWT-based authentication system\r\n */\r\nasync function getAuthToken(): Promise<string | null> {\r\n  try {\r\n    const cookieStore = await cookies();\r\n    \r\n    // Try multiple cookie names that might be used for the auth token\r\n    const token = cookieStore.get(COOKIE_NAMES.ACCESS_TOKEN)?.value ||\r\n                  cookieStore.get('auth.token')?.value ||\r\n                  cookieStore.get('auth_token')?.value ||\r\n                  cookieStore.get('accessToken')?.value;\r\n    \r\n    return token || null;\r\n  } catch (error) {\r\n    console.error('[Next API Client] Failed to get auth token:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Generate unique request ID for tracing\r\n * Made dynamic to avoid prerendering issues\r\n */\r\nfunction generateRequestId(): string {\r\n  // Access headers first to make this function dynamic during prerendering\r\n  headers();\r\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n}\r\n\r\n/**\r\n * Get CSRF token from cookies\r\n */\r\nasync function getCsrfToken(): Promise<string | null> {\r\n  try {\r\n    const cookieStore = await cookies();\r\n    return cookieStore.get('csrf-token')?.value || null;\r\n  } catch (error) {\r\n    console.error('[Next API Client] Failed to get CSRF token:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// ==========================================\r\n// CORE FETCH FUNCTION\r\n// ==========================================\r\n\r\n/**\r\n * Core fetch function with Next.js caching, authentication, and error handling\r\n *\r\n * @template T - The expected response data type\r\n * @param endpoint - API endpoint (relative or absolute URL)\r\n * @param options - Fetch options with Next.js caching configuration\r\n * @returns Promise resolving to typed API response\r\n *\r\n * @throws {NextApiClientError} On request failure\r\n *\r\n * @example\r\n * ```typescript\r\n * const response = await nextFetch<Student[]>('/api/students', {\r\n *   cache: 'force-cache',\r\n *   next: { revalidate: 60, tags: ['students'] }\r\n * });\r\n * ```\r\n */\r\nexport async function nextFetch<T>(\r\n  endpoint: string,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  const {\r\n    requiresAuth = true, // Enable authentication by default\r\n    onError,\r\n    retry = { attempts: 3, delay: 1000 },\r\n    timeout = 30000,\r\n    cache = 'force-cache',\r\n    next,\r\n    cacheLife,\r\n    ...fetchOptions\r\n  } = options;\r\n\r\n  // Build full URL\r\n  const url = endpoint.startsWith('http')\r\n    ? endpoint\r\n    : `${getApiBaseUrl()}${endpoint}`;\r\n\r\n  // Prepare headers\r\n  const headers: Record<string, string> = {\r\n    'Content-Type': 'application/json',\r\n  };\r\n\r\n  // Merge additional headers\r\n  if (fetchOptions.headers) {\r\n    Object.entries(fetchOptions.headers).forEach(([key, value]) => {\r\n      if (typeof value === 'string') {\r\n        headers[key] = value;\r\n      }\r\n    });\r\n  }\r\n\r\n  // Add authentication if required\r\n  if (requiresAuth) {\r\n    const token = await getAuthToken();\r\n\r\n    // Don't redirect during login/auth endpoints\r\n    const isAuthEndpoint = endpoint.includes('/auth/') || \r\n                          endpoint.includes('/login') || \r\n                          endpoint.includes('/register') ||\r\n                          endpoint.includes('/forgot-password') ||\r\n                          endpoint.includes('/reset-password');\r\n\r\n    console.log('[Next API Client] Auth check:', {\r\n      endpoint,\r\n      hasToken: !!token,\r\n      tokenStart: token?.substring(0, 20),\r\n      isAuthEndpoint,\r\n      requiresAuth\r\n    });\r\n\r\n    if (!token && !isAuthEndpoint) {\r\n      // Redirect to login if no token (but not during auth operations)\r\n      console.error('[Next API Client] No auth token found for protected endpoint:', endpoint);\r\n      // Note: redirect() in server components/actions can cause issues\r\n      // Consider using middleware for auth protection instead\r\n      redirect('/login');\r\n    }\r\n\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n      console.log('[Next API Client] Added Authorization header:', {\r\n        authHeaderStart: headers['Authorization'].substring(0, 30),\r\n        fullAuthHeaderLength: headers['Authorization'].length\r\n      });\r\n    }\r\n  }\r\n\r\n  // Add CSRF token for mutations\r\n  if (fetchOptions.method && ['POST', 'PUT', 'PATCH', 'DELETE'].includes(fetchOptions.method)) {\r\n    const csrfToken = await getCsrfToken();\r\n    if (csrfToken) {\r\n      headers['X-CSRF-Token'] = csrfToken;\r\n    }\r\n  }\r\n\r\n  // Add request ID for tracing\r\n  headers['X-Request-ID'] = generateRequestId();\r\n\r\n  // Add security headers for HIPAA compliance\r\n  headers['X-Content-Type-Options'] = 'nosniff';\r\n  headers['X-Frame-Options'] = 'DENY';\r\n  headers['X-XSS-Protection'] = '1; mode=block';\r\n\r\n  // Build Next.js cache configuration\r\n  const nextConfig: Record<string, unknown> = {};\r\n\r\n  if (next?.revalidate !== undefined) {\r\n    nextConfig.revalidate = next.revalidate;\r\n  }\r\n\r\n  if (next?.tags && next.tags.length > 0) {\r\n    nextConfig.tags = next.tags;\r\n  }\r\n\r\n  // Execute fetch with retry logic\r\n  let lastError: Error | null = null;\r\n\r\n  for (let attempt = 0; attempt < retry.attempts; attempt++) {\r\n    try {\r\n      // Create abort controller for timeout\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n      const response = await fetch(url, {\r\n        ...fetchOptions,\r\n        headers,\r\n        cache,\r\n        next: Object.keys(nextConfig).length > 0 ? nextConfig : undefined,\r\n        signal: controller.signal,\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      // Handle different response status codes\r\n      if (!response.ok) {\r\n        // Log 401 errors for debugging before consuming the response\r\n        if (response.status === 401) {\r\n          console.error('[Next API Client] 401 Unauthorized:', {\r\n            endpoint,\r\n            status: response.status,\r\n            statusText: response.statusText,\r\n            hasAuthHeader: !!headers['Authorization'],\r\n            authHeaderStart: headers['Authorization']?.substring(0, 30)\r\n          });\r\n        }\r\n        \r\n        const error = await handleErrorResponse(response);\r\n\r\n        // Handle specific errors with redirects\r\n        // Don't redirect on login/auth endpoints to avoid redirect loops\r\n        const isAuthEndpoint = endpoint.includes('/auth/login') || endpoint.includes('/auth/register');\r\n        \r\n        // Note: Redirects in Server Components/Actions can be tricky\r\n        // These will throw NEXT_REDIRECT which Next.js catches\r\n        // Consider using middleware for auth protection instead\r\n        if (response.status === 401 && !isAuthEndpoint) {\r\n          console.error('[Next API Client] 401 error - authentication required');\r\n          redirect('/login');\r\n        } else if (response.status === 403) {\r\n          console.error('[Next API Client] 403 error - access denied');\r\n          redirect('/access-denied');\r\n        }\r\n\r\n        throw error;\r\n      }\r\n\r\n      // Parse response\r\n      const contentType = response.headers.get('content-type');\r\n      if (contentType?.includes('application/json')) {\r\n        return await response.json() as T;\r\n      }\r\n\r\n      return await response.text() as unknown as T;\r\n\r\n    } catch (error) {\r\n      // Re-throw Next.js redirect errors immediately - they should not be caught\r\n      if (error && typeof error === 'object' && 'digest' in error) {\r\n        const errorWithDigest = error as { digest: unknown };\r\n        if (typeof errorWithDigest.digest === 'string' && \r\n            errorWithDigest.digest.startsWith('NEXT_REDIRECT')) {\r\n          throw error;\r\n        }\r\n      }\r\n\r\n      lastError = error as Error;\r\n\r\n      // Don't retry on client errors (except 408, 429)\r\n      if (error instanceof NextApiClientError) {\r\n        const status = error.status;\r\n        if (status && status >= 400 && status < 500 && status !== 408 && status !== 429) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      // Wait before retry (exponential backoff)\r\n      if (attempt < retry.attempts - 1) {\r\n        await new Promise(resolve =>\r\n          setTimeout(resolve, retry.delay * Math.pow(2, attempt))\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  // All retries failed\r\n  const finalError = lastError || new Error('Unknown error');\r\n\r\n  if (onError) {\r\n    onError(finalError);\r\n  }\r\n\r\n  throw finalError;\r\n}\r\n\r\n/**\r\n * Handle error responses and create normalized error objects\r\n */\r\nasync function handleErrorResponse(response: Response): Promise<NextApiClientError> {\r\n  let details: unknown;\r\n\r\n  try {\r\n    const contentType = response.headers.get('content-type');\r\n    if (contentType?.includes('application/json')) {\r\n      details = await response.json();\r\n    } else {\r\n      details = await response.text();\r\n    }\r\n  } catch {\r\n    details = null;\r\n  }\r\n\r\n  const error: ApiErrorResponse = {\r\n    message: typeof details === 'object' && details !== null && 'message' in details\r\n      ? (details as { message: string }).message\r\n      : response.statusText || 'Request failed',\r\n    status: response.status,\r\n    code: typeof details === 'object' && details !== null && 'code' in details\r\n      ? (details as { code: string }).code\r\n      : undefined,\r\n    details,\r\n    traceId: response.headers.get('x-trace-id') || undefined,\r\n  };\r\n\r\n  return new NextApiClientError(error);\r\n}\r\n\r\n// ==========================================\r\n// CONVENIENCE METHODS\r\n// ==========================================\r\n\r\n/**\r\n * GET request with Next.js caching support\r\n *\r\n * @template T - Expected response data type\r\n * @param endpoint - API endpoint\r\n * @param params - Query parameters\r\n * @param options - Fetch options with cache configuration\r\n * @returns Promise resolving to response data\r\n *\r\n * @example\r\n * ```typescript\r\n * const students = await serverGet<Student[]>('/api/students',\r\n *   { status: 'active' },\r\n *   {\r\n *     cache: 'force-cache',\r\n *     next: { revalidate: 60, tags: ['students'] }\r\n *   }\r\n * );\r\n * ```\r\n */\r\nexport async function serverGet<T>(\r\n  endpoint: string,\r\n  params?: Record<string, string | number | boolean>,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  const queryString = params\r\n    ? '?' + new URLSearchParams(\r\n        Object.entries(params).map(([k, v]) => [k, String(v)])\r\n      ).toString()\r\n    : '';\r\n\r\n  return nextFetch<T>(`${endpoint}${queryString}`, {\r\n    ...options,\r\n    method: 'GET',\r\n  });\r\n}\r\n\r\n/**\r\n * POST request (typically with no-store for mutations)\r\n *\r\n * @template T - Expected response data type\r\n * @param endpoint - API endpoint\r\n * @param data - Request body data\r\n * @param options - Fetch options (defaults to no-store for mutations)\r\n * @returns Promise resolving to response data\r\n *\r\n * @example\r\n * ```typescript\r\n * const newStudent = await serverPost<Student>('/api/students',\r\n *   { name: 'John Doe', grade: '5' },\r\n *   {\r\n *     cache: 'no-store',\r\n *     next: { tags: ['students'] }\r\n *   }\r\n * );\r\n * ```\r\n */\r\nexport async function serverPost<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  return nextFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'POST',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n    cache: options.cache ?? 'no-store', // Mutations typically no-store\r\n  });\r\n}\r\n\r\n/**\r\n * PUT request (typically with no-store for mutations)\r\n *\r\n * @template T - Expected response data type\r\n * @param endpoint - API endpoint\r\n * @param data - Request body data\r\n * @param options - Fetch options (defaults to no-store for mutations)\r\n * @returns Promise resolving to response data\r\n */\r\nexport async function serverPut<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  return nextFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'PUT',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n    cache: options.cache ?? 'no-store',\r\n  });\r\n}\r\n\r\n/**\r\n * PATCH request (typically with no-store for mutations)\r\n *\r\n * @template T - Expected response data type\r\n * @param endpoint - API endpoint\r\n * @param data - Request body data\r\n * @param options - Fetch options (defaults to no-store for mutations)\r\n * @returns Promise resolving to response data\r\n */\r\nexport async function serverPatch<T>(\r\n  endpoint: string,\r\n  data?: unknown,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  return nextFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'PATCH',\r\n    body: data ? JSON.stringify(data) : undefined,\r\n    cache: options.cache ?? 'no-store',\r\n  });\r\n}\r\n\r\n/**\r\n * DELETE request (typically with no-store for mutations)\r\n *\r\n * @template T - Expected response data type\r\n * @param endpoint - API endpoint\r\n * @param options - Fetch options (defaults to no-store for mutations)\r\n * @returns Promise resolving to response data\r\n */\r\nexport async function serverDelete<T>(\r\n  endpoint: string,\r\n  options: NextFetchOptions = {}\r\n): Promise<T> {\r\n  return nextFetch<T>(endpoint, {\r\n    ...options,\r\n    method: 'DELETE',\r\n    cache: options.cache ?? 'no-store',\r\n  });\r\n}\r\n\r\n// ==========================================\r\n// UTILITY FUNCTIONS\r\n// ==========================================\r\n\r\n/**\r\n * Build cache tags for a resource\r\n *\r\n * @param resourceType - Type of resource (e.g., 'students', 'medications')\r\n * @param isPHI - Whether the data contains PHI\r\n * @param additionalTags - Additional tags to include\r\n * @returns Array of cache tags\r\n *\r\n * @example\r\n * ```typescript\r\n * const tags = buildCacheTags('students', true, ['active']);\r\n * // Returns: ['students', 'phi-data', 'active']\r\n * ```\r\n */\r\nexport function buildCacheTags(\r\n  resourceType: string,\r\n  isPHI: boolean = true,\r\n  additionalTags: string[] = []\r\n): string[] {\r\n  const tags: string[] = [resourceType];\r\n\r\n  if (isPHI) {\r\n    tags.push('phi-data');\r\n  }\r\n\r\n  return [...tags, ...additionalTags];\r\n}\r\n\r\n/**\r\n * Build resource-specific cache tag\r\n *\r\n * @param resourceType - Type of resource\r\n * @param resourceId - ID of specific resource\r\n * @returns Cache tag string\r\n *\r\n * @example\r\n * ```typescript\r\n * const tag = buildResourceTag('student', '123');\r\n * // Returns: 'student-123'\r\n * ```\r\n */\r\nexport function buildResourceTag(\r\n  resourceType: string,\r\n  resourceId: string\r\n): string {\r\n  return `${resourceType}-${resourceId}`;\r\n}\r\n\r\n// ==========================================\r\n// LEGACY CLIENT SUPPORT\r\n// ==========================================\r\n\r\n/**\r\n * Simple API client for basic HTTP requests (legacy support)\r\n * \r\n * @deprecated This is a legacy client merged from client.ts. \r\n * For new development, prefer the Next.js-specific methods:\r\n * - serverGet() for GET requests\r\n * - serverPost() for POST requests\r\n * - serverPut() for PUT requests\r\n * - serverPatch() for PATCH requests\r\n * - serverDelete() for DELETE requests\r\n * \r\n * @param endpoint - API endpoint (relative or absolute URL)\r\n * @param options - Basic request options\r\n * @returns Promise resolving to parsed JSON response\r\n * \r\n * @example\r\n * ```typescript\r\n * // Legacy usage (consider migrating to serverGet/serverPost)\r\n * const data = await apiClient('/api/users', {\r\n *   method: 'POST',\r\n *   body: { name: 'John' }\r\n * });\r\n * ```\r\n */\r\nexport async function apiClient(endpoint: string, options: ApiClientOptions = {}) {\r\n  const { method = 'GET', body, headers = {} } = options\r\n\r\n  const config: RequestInit = {\r\n    method,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...headers\r\n    }\r\n  }\r\n\r\n  if (body) {\r\n    config.body = JSON.stringify(body)\r\n  }\r\n\r\n  const url = endpoint.startsWith('http') ? endpoint : `${getApiBaseUrl()}${endpoint}`\r\n  const response = await fetch(url, config)\r\n\r\n  if (!response.ok) {\r\n    throw new Error(`API Error: ${response.statusText}`)\r\n  }\r\n\r\n  return response.json()\r\n}\r\n\r\n/**\r\n * Alias for apiClient (legacy support)\r\n * @deprecated Use apiClient directly or migrate to Next.js-specific methods\r\n */\r\nexport const fetchApi = apiClient\r\n\r\n// ==========================================\r\n// EXPORTS\r\n// ==========================================\r\n\r\nconst nextjsClient = {\r\n  nextFetch,\r\n  serverGet,\r\n  serverPost,\r\n  serverPut,\r\n  serverPatch,\r\n  serverDelete,\r\n  buildCacheTags,\r\n  buildResourceTag,\r\n  // Legacy exports\r\n  apiClient,\r\n  fetchApi,\r\n};\r\n\r\nexport default nextjsClient;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/constants/api.ts"],"sourcesContent":["/**\r\n * @fileoverview API Endpoints Constants - Comprehensive endpoint definitions\r\n * @module constants/api\r\n * @version 2.0.0 - Maximized Edition\r\n *\r\n * Centralized API endpoint definitions for the White Cross healthcare platform.\r\n * All backend routes are defined here to prevent hardcoded strings and improve maintainability.\r\n *\r\n * **Architecture**:\r\n * - Backend Base: Direct routes (no /api/v1 prefix)\r\n * - Next.js rewrites handle `/api/v1/*` â†’ Backend `/*` proxying\r\n * - All endpoints use template literal types for type-safe route generation\r\n * - Organized by domain for easy navigation and maintenance\r\n *\r\n * **Key Features**:\r\n * - 700+ endpoint constants covering all platform features\r\n * - Type-safe endpoint functions with parameter validation\r\n * - Comprehensive PHI-compliant healthcare operations\r\n * - HIPAA-compliant audit logging endpoints\r\n * - Multi-channel communication endpoints\r\n * - Advanced reporting and analytics\r\n * - Complete medication management workflow\r\n * - Student health records and tracking\r\n * - Appointment scheduling and reminders\r\n * - Incident reporting and follow-up\r\n * - Financial and procurement management\r\n *\r\n * **Endpoint Categories**:\r\n * 1. Authentication & Authorization (AUTH, RBAC, MFA)\r\n * 2. Users & Access Control (USERS, RBAC)\r\n * 3. Students (STUDENTS with 25+ endpoints)\r\n * 4. Appointments (APPOINTMENTS, WAITLIST, NURSE_AVAILABILITY)\r\n * 5. Health Records (HEALTH_RECORDS, VITAL_SIGNS, CHRONIC_CONDITIONS, ALLERGIES)\r\n * 6. Immunizations & Vaccinations (IMMUNIZATIONS)\r\n * 7. Medications (MEDICATIONS, PRESCRIPTIONS, INVENTORY, ADMINISTRATION_LOG)\r\n * 8. Emergency Contacts (EMERGENCY_CONTACTS)\r\n * 9. Incidents (INCIDENTS with witness and follow-up)\r\n * 10. Documents (DOCUMENTS with signing and verification)\r\n * 11. Compliance & Audit (COMPLIANCE, AUDIT)\r\n * 12. Communications (MESSAGES, BROADCASTS, ALERTS, NOTIFICATIONS, CONVERSATIONS, TEMPLATES)\r\n * 13. Dashboard & Analytics (DASHBOARD, ANALYTICS, REPORTS)\r\n * 14. System Administration (ADMIN, SYSTEM, INTEGRATIONS)\r\n * 15. Billing & Financial (BILLING, BUDGET, VENDORS, PURCHASE_ORDERS)\r\n * 16. Forms & Settings (FORMS, SETTINGS)\r\n *\r\n * **Usage Examples**:\r\n * ```typescript\r\n * import { API_ENDPOINTS } from '@/constants/api';\r\n *\r\n * // Simple endpoint\r\n * const url = API_ENDPOINTS.STUDENTS.BASE; // '/students'\r\n *\r\n * // Parameterized endpoint\r\n * const studentUrl = API_ENDPOINTS.STUDENTS.BY_ID('123'); // '/students/123'\r\n *\r\n * // Nested endpoint\r\n * const medUrl = API_ENDPOINTS.STUDENTS.MEDICATIONS('123'); // '/students/123/medications'\r\n *\r\n * // In API client\r\n * const response = await apiClient.get(API_ENDPOINTS.STUDENTS.BY_ID(studentId));\r\n * ```\r\n *\r\n * **Type Safety**:\r\n * All endpoints are typed as const for literal type inference and autocomplete support.\r\n *\r\n * **Maintenance**:\r\n * When adding new endpoints:\r\n * 1. Add to appropriate domain section\r\n * 2. Use consistent naming patterns (BASE, BY_ID, etc.)\r\n * 3. Add JSDoc comments for complex endpoints\r\n * 4. Update this file header with new categories\r\n *\r\n * @see /backend/src/routes/ for backend route definitions\r\n * @see /frontend/src/lib/api/client.ts for API client implementation\r\n * @see /frontend/src/lib/server/api-client.ts for server-side API client\r\n */\r\n\r\n\r\nexport const API_ENDPOINTS = {\r\n  // ==========================================\r\n  // AUTHENTICATION & AUTHORIZATION\r\n  // ==========================================\r\n  AUTH: {\r\n    LOGIN: `/auth/login`,\r\n    LOGOUT: `/auth/logout`,\r\n    REFRESH: `/auth/refresh`,\r\n    VERIFY: `/auth/verify`,\r\n    REGISTER: `/auth/register`,\r\n    PROFILE: `/auth/me`,\r\n    CHANGE_PASSWORD: `/auth/change-password`,\r\n    FORGOT_PASSWORD: `/auth/forgot-password`,\r\n    RESET_PASSWORD: `/auth/reset-password`,\r\n  },\r\n\r\n  // ==========================================\r\n  // USERS & ACCESS CONTROL\r\n  // ==========================================\r\n  USERS: {\r\n    BASE: `/users`,\r\n    BY_ID: (id: string) => `/users/${id}`,\r\n    ME: `/users/me`,\r\n    PROFILE: `/users/profile`,\r\n    UPDATE_PROFILE: `/users/profile`,\r\n  },\r\n\r\n  RBAC: {\r\n    ROLES: `/access-control/roles`,\r\n    PERMISSIONS: `/access-control/permissions`,\r\n    USER_ROLES: (userId: string) => `/access-control/users/${userId}/roles`,\r\n    USER_PERMISSIONS: (userId: string) => `/access-control/users/${userId}/permissions`,\r\n  },\r\n\r\n  // ==========================================\r\n  // STUDENTS\r\n  // ==========================================\r\n  STUDENTS: {\r\n    BASE: `/students`,\r\n    BY_ID: (id: string) => `/students/${id}`,\r\n    DEACTIVATE: (id: string) => `/students/${id}/deactivate`,\r\n    REACTIVATE: (id: string) => `/students/${id}/reactivate`,\r\n    TRANSFER: (id: string) => `/students/${id}/transfer`,\r\n    ASSIGN: (id: string) => `/students/${id}/assign`,\r\n    ASSIGN_BULK: `/students/assign-bulk`,\r\n    PHOTO: (id: string) => `/students/${id}/photo`,\r\n    EXPORT: (id: string) => `/students/${id}/export`,\r\n    REPORT_CARD: (id: string) => `/students/${id}/report-card`,\r\n    VERIFY_ELIGIBILITY: (id: string) => `/students/${id}/verify-eligibility`,\r\n    SEARCH: `/students/search`,\r\n    SEARCH_BY_QUERY: (query: string) => `/students/search/${encodeURIComponent(query)}`,\r\n    BY_GRADE: (grade: string) => `/students/grade/${grade}`,\r\n    BY_NURSE: (nurseId: string) => `/students/nurse/${nurseId}`,\r\n    ASSIGNED: `/students/assigned`,\r\n    STATISTICS: (id: string) => `/students/${id}/statistics`,\r\n    BULK_UPDATE: `/students/bulk-update`,\r\n    PERMANENT_DELETE: (id: string) => `/students/${id}/permanent`,\r\n    GRADES: `/students/grades`,\r\n    HEALTH_RECORDS: (id: string) => `/students/${id}/health-records`,\r\n    MENTAL_HEALTH_RECORDS: (id: string) => `/students/${id}/mental-health-records`,\r\n    MEDICATIONS: (id: string) => `/students/${id}/medications`,\r\n    IMMUNIZATIONS: (id: string) => `/students/${id}/immunizations`,\r\n    ALLERGIES: (id: string) => `/students/${id}/allergies`,\r\n    APPOINTMENTS: (id: string) => `/students/${id}/appointments`,\r\n    INCIDENTS: (id: string) => `/students/${id}/incidents`,\r\n    EMERGENCY_CONTACTS: (id: string) => `/students/${id}/emergency-contacts`,\r\n  },\r\n\r\n  // ==========================================\r\n  // APPOINTMENTS\r\n  // ==========================================\r\n  APPOINTMENTS: {\r\n    BASE: `/appointments`,\r\n    BY_ID: (id: string) => `/appointments/${id}`,\r\n    RESCHEDULE: (id: string) => `/appointments/${id}/reschedule`,\r\n    CANCEL: (id: string) => `/appointments/${id}/cancel`,\r\n    COMPLETE: (id: string) => `/appointments/${id}/complete`,\r\n    NO_SHOW: (id: string) => `/appointments/${id}/no-show`,\r\n    CONFIRM: (id: string) => `/appointments/${id}/confirm`,\r\n    START: (id: string) => `/appointments/${id}/start`,\r\n    SEND_REMINDER: (id: string) => `/appointments/${id}/send-reminder`,\r\n    AVAILABILITY: `/appointments/availability`,\r\n    CONFLICTS: `/appointments/conflicts`,\r\n    CHECK_CONFLICTS: `/appointments/check-conflicts`,\r\n    REMINDERS: `/appointments/reminders`,\r\n    PROCESS_REMINDERS: `/appointments/process-reminders`,\r\n    BY_STUDENT: (studentId: string) => `/appointments/student/${studentId}`,\r\n    BY_NURSE: (nurseId: string) => `/appointments/nurse/${nurseId}`,\r\n    BY_DATE: `/appointments/by-date`,\r\n    UPCOMING: `/appointments/upcoming`,\r\n    STATISTICS: `/appointments/statistics`,\r\n    RECURRING: `/appointments/recurring`,\r\n    CREATE_RECURRING: `/appointments/recurring/create`,\r\n    EXPORT_CALENDAR: `/appointments/export/calendar`,\r\n    REPORTS: `/appointments/reports`,\r\n  },\r\n\r\n  // ==========================================\r\n  // HEALTH RECORDS\r\n  // ==========================================\r\n  HEALTH_RECORDS: {\r\n    BASE: `/health-records`,\r\n    BY_ID: (id: string) => `/health-records/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/health-records`,\r\n    BY_TYPE: (type: string) => `/health-records/type/${type}`,\r\n    SEARCH: `/health-records/search`,\r\n    EXPORT: (id: string) => `/health-records/${id}/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // IMMUNIZATIONS / VACCINATIONS\r\n  // ==========================================\r\n  IMMUNIZATIONS: {\r\n    BASE: `/vaccinations`,\r\n    BY_ID: (id: string) => `/vaccinations/${id}`,\r\n    SCHEDULE: `/vaccinations/schedule`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/immunizations`,\r\n    DUE: `/vaccinations/due`,\r\n    OVERDUE: `/vaccinations/overdue`,\r\n    COMPLIANCE: `/vaccinations/compliance`,\r\n    EXEMPTIONS: `/vaccinations/exemptions`,\r\n    VERIFY: (id: string) => `/vaccinations/${id}/verify`,\r\n    EXPORT: (studentId: string) => `/vaccinations/export/${studentId}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // HEALTH SCREENINGS\r\n  // ==========================================\r\n  SCREENINGS: {\r\n    BASE: `/screenings`,\r\n    BY_ID: (id: string) => `/screenings/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/screenings`,\r\n    BY_TYPE: (type: string) => `/screenings/type/${type}`,\r\n    DUE: `/screenings/due`,\r\n    SCHEDULE: `/screenings/schedule`,\r\n    RESULTS: (id: string) => `/screenings/${id}/results`,\r\n  },\r\n\r\n  // ==========================================\r\n  // GROWTH MEASUREMENTS\r\n  // ==========================================\r\n  GROWTH_MEASUREMENTS: {\r\n    BASE: `/growth-measurements`,\r\n    BY_ID: (id: string) => `/growth-measurements/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/growth-measurements`,\r\n    TRENDS: (studentId: string) => `/students/${studentId}/growth-measurements/trends`,\r\n    BMI: (studentId: string) => `/students/${studentId}/bmi`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ALLERGIES\r\n  // ==========================================\r\n  ALLERGIES: {\r\n    BASE: `/allergies`,\r\n    BY_ID: (id: string) => `/allergies/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/allergies`,\r\n    CRITICAL: `/allergies/critical`,\r\n    ACTIVE: `/allergies/active`,\r\n  },\r\n\r\n  // ==========================================\r\n  // VITAL SIGNS\r\n  // ==========================================\r\n  VITAL_SIGNS: {\r\n    BASE: `/vital-signs`,\r\n    BY_ID: (id: string) => `/vital-signs/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/vital-signs`,\r\n    BY_HEALTH_RECORD: (healthRecordId: string) => `/health-records/${healthRecordId}/vital-signs`,\r\n    LATEST: (studentId: string) => `/students/${studentId}/vital-signs/latest`,\r\n    TRENDS: (studentId: string) => `/students/${studentId}/vital-signs/trends`,\r\n  },\r\n\r\n  // ==========================================\r\n  // CHRONIC CONDITIONS\r\n  // ==========================================\r\n  CHRONIC_CONDITIONS: {\r\n    BASE: `/chronic-conditions`,\r\n    BY_ID: (id: string) => `/chronic-conditions/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/chronic-conditions`,\r\n    ACTIVE: `/chronic-conditions/active`,\r\n    REVIEW_DUE: `/chronic-conditions/review-due`,\r\n  },\r\n\r\n  // ==========================================\r\n  // MEDICATIONS\r\n  // ==========================================\r\n  MEDICATIONS: {\r\n    BASE: `/medications`,\r\n    BY_ID: (id: string) => `/medications/${id}`,\r\n    DETAIL: (id: string) => `/medications/${id}`,\r\n    ADMINISTER: (id: string) => `/medications/${id}/administer`,\r\n    DISCONTINUE: (id: string) => `/medications/${id}/discontinue`,\r\n    REFILL: (id: string) => `/medications/${id}/refill`,\r\n    MISSED_DOSE: (id: string) => `/medications/${id}/missed-dose`,\r\n    ADVERSE_REACTION: (id: string) => `/medications/${id}/adverse-reaction`,\r\n    ADJUST_INVENTORY: (id: string) => `/medications/${id}/adjust-inventory`,\r\n    REMINDER: (id: string) => `/medications/${id}/reminder`,\r\n    SCHEDULE: (id: string) => `/medications/${id}/schedule`,\r\n    INTERACTIONS: (id: string) => `/medications/${id}/interactions`,\r\n    CALENDAR: `/medications/calendar`,\r\n    DUE: `/medications/due`,\r\n    OVERDUE: `/medications/overdue`,\r\n    MISSED: `/medications/missed`,\r\n    COMPLETED: `/medications/completed`,\r\n    AS_NEEDED: `/medications/as-needed`,\r\n    EMERGENCY: `/medications/emergency`,\r\n    CONTROLLED: `/medications/controlled-substances`,\r\n    OTC: `/medications/over-the-counter`,\r\n    CATEGORIES: `/medications/categories`,\r\n    RULES: `/medications/administration-rules`,\r\n    CHECK_INTERACTIONS: `/medications/check-interactions`,\r\n    FORMULARY: `/medications/formulary`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/medications`,\r\n  },\r\n\r\n  // ==========================================\r\n  // PRESCRIPTIONS\r\n  // ==========================================\r\n  PRESCRIPTIONS: {\r\n    BASE: `/prescriptions`,\r\n    BY_ID: (id: string) => `/prescriptions/${id}`,\r\n    DETAIL: (id: string) => `/prescriptions/${id}`,\r\n    REFILL: (id: string) => `/prescriptions/${id}/refill`,\r\n    ACTIVE: `/prescriptions/active`,\r\n    EXPIRING: `/prescriptions/expiring`,\r\n  },\r\n\r\n  // ==========================================\r\n  // INVENTORY\r\n  // ==========================================\r\n  INVENTORY: {\r\n    BASE: `/inventory`,\r\n    BY_ID: (id: string) => `/inventory/${id}`,\r\n    DETAIL: (id: string) => `/inventory/${id}`,\r\n    ADJUST: (id: string) => `/inventory/${id}/adjust`,\r\n    LOW_STOCK: `/inventory/low-stock`,\r\n    EXPIRING: `/inventory/expiring`,\r\n    REORDER: `/inventory/reorder`,\r\n    AUDIT: `/inventory/audit`,\r\n    ITEMS: `/inventory/items`,\r\n    ALERTS: `/inventory/alerts`,\r\n    ANALYTICS: `/inventory/analytics`,\r\n    DASHBOARD: `/inventory/dashboard`,\r\n    REPORTS: `/inventory/reports`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ADMINISTRATION LOG\r\n  // ==========================================\r\n  ADMINISTRATION_LOG: {\r\n    BASE: `/administration-log`,\r\n    BY_ID: (id: string) => `/administration-log/${id}`,\r\n    DETAIL: (id: string) => `/administration-log/${id}`,\r\n    BY_MEDICATION: (medicationId: string) => `/medications/${medicationId}/administration-log`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/administration-log`,\r\n    TODAY: `/administration-log/today`,\r\n    MISSED: `/administration-log/missed`,\r\n  },\r\n\r\n  // ==========================================\r\n  // EMERGENCY CONTACTS\r\n  // ==========================================\r\n  EMERGENCY_CONTACTS: {\r\n    BASE: `/emergency-contacts`,\r\n    BY_ID: (id: string) => `/emergency-contacts/${id}`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/emergency-contacts`,\r\n    PRIMARY: (studentId: string) => `/students/${studentId}/emergency-contacts/primary`,\r\n    VERIFY: (id: string) => `/emergency-contacts/${id}/verify`,\r\n    NOTIFY: (id: string) => `/emergency-contacts/${id}/notify`,\r\n  },\r\n\r\n  // ==========================================\r\n  // INCIDENTS\r\n  // ==========================================\r\n  INCIDENTS: {\r\n    BASE: `/incident-report`,\r\n    BY_ID: (id: string) => `/incident-report/${id}`,\r\n    WITNESSES: (incidentId: string) => `/incident-report/${incidentId}/witnesses`,\r\n    WITNESS_STATEMENT: (incidentId: string, witnessId: string) =>\r\n      `/incident-report/${incidentId}/witnesses/${witnessId}/statement`,\r\n    VERIFY_STATEMENT: (statementId: string) => `/incident-report/statements/${statementId}/verify`,\r\n    FOLLOW_UP: (incidentId: string) => `/incident-report/${incidentId}/follow-up`,\r\n    FOLLOW_UP_PROGRESS: (followUpId: string) => `/incident-report/follow-up/${followUpId}/progress`,\r\n    FOLLOW_UP_COMPLETE: (followUpId: string) => `/incident-report/follow-up/${followUpId}/complete`,\r\n    ANALYTICS: `/incident-report/analytics`,\r\n    TRENDING: `/incident-report/trending`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/incidents`,\r\n    BY_TYPE: (type: string) => `/incident-report/type/${type}`,\r\n    BY_SEVERITY: (severity: string) => `/incident-report/severity/${severity}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // DOCUMENTS\r\n  // ==========================================\r\n  DOCUMENTS: {\r\n    BASE: `/documents`,\r\n    BY_ID: (id: string) => `/documents/${id}`,\r\n    UPLOAD: `/documents/upload`,\r\n    DOWNLOAD: (id: string) => `/documents/${id}/download`,\r\n    PREVIEW: (id: string) => `/documents/${id}/preview`,\r\n    SIGN: (id: string) => `/documents/${id}/sign`,\r\n    VERIFY_SIGNATURE: (id: string) => `/documents/${id}/verify-signature`,\r\n    BY_STUDENT: (studentId: string) => `/students/${studentId}/documents`,\r\n    BY_TYPE: (type: string) => `/documents/type/${type}`,\r\n    TEMPLATES: `/documents/templates`,\r\n  },\r\n\r\n  // ==========================================\r\n  // COMPLIANCE & AUDIT\r\n  // ==========================================\r\n  COMPLIANCE: {\r\n    REPORTS: `/compliance/reports`,\r\n    AUDIT_LOGS: `/compliance/audit-logs`,\r\n    PHI_DISCLOSURES: `/compliance/phi-disclosures`,\r\n    ACCESS_LOG: `/compliance/access-log`,\r\n    DATA_RETENTION: `/compliance/data-retention`,\r\n    EXPORT: `/compliance/export`,\r\n  },\r\n\r\n  AUDIT: {\r\n    LOGS: `/audit-logs`,\r\n    BY_ID: (id: string) => `/audit-logs/${id}`,\r\n    BY_USER: (userId: string) => `/audit-logs/user/${userId}`,\r\n    BY_RESOURCE: (resourceType: string, resourceId: string) =>\r\n      `/audit-logs/resource/${resourceType}/${resourceId}`,\r\n    BY_ACTION: (action: string) => `/audit-logs/action/${action}`,\r\n    PHI_ACCESS: `/audit-logs/phi-access`,\r\n    PHI_ACCESS_LOG: `/audit/phi-access`,\r\n    EXPORT: `/audit-logs/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // COMMUNICATIONS\r\n  // ==========================================\r\n  MESSAGES: {\r\n    BASE: `/messages`,\r\n    BY_ID: (id: string) => `/messages/${id}`,\r\n    SEND: `/messages/send`,\r\n    INBOX: `/messages/inbox`,\r\n    SENT: `/messages/sent`,\r\n    UNREAD: `/messages/unread`,\r\n    MARK_READ: (id: string) => `/messages/${id}/mark-read`,\r\n    MARK_UNREAD: (id: string) => `/messages/${id}/mark-unread`,\r\n    DELETE: (id: string) => `/messages/${id}`,\r\n    THREAD: (id: string) => `/messages/thread/${id}`,\r\n    ATTACHMENTS: (id: string) => `/messages/${id}/attachments`,\r\n  },\r\n\r\n  BROADCASTS: {\r\n    BASE: `/broadcasts`,\r\n    BY_ID: (id: string) => `/broadcasts/${id}`,\r\n    SEND: `/broadcasts/send`,\r\n    SCHEDULE: `/broadcasts/schedule`,\r\n    RECIPIENTS: (id: string) => `/broadcasts/${id}/recipients`,\r\n    CANCEL: (id: string) => `/broadcasts/${id}/cancel`,\r\n    DUPLICATE: (id: string) => `/broadcasts/${id}/duplicate`,\r\n    DELIVERY_STATUS: (id: string) => `/broadcasts/${id}/delivery-status`,\r\n    DRAFTS: `/broadcasts/drafts`,\r\n    SCHEDULED: `/broadcasts/scheduled`,\r\n  },\r\n\r\n  ALERTS: {\r\n    BASE: `/alerts`,\r\n    BY_ID: (id: string) => `/alerts/${id}`,\r\n    ACTIVE: `/alerts/active`,\r\n    ACKNOWLEDGE: (id: string) => `/alerts/${id}/acknowledge`,\r\n    DISMISS: (id: string) => `/alerts/${id}/dismiss`,\r\n    MEDICATION_REMINDERS: `/alerts/medication-reminders`,\r\n    APPOINTMENT_REMINDERS: `/alerts/appointment-reminders`,\r\n    EMERGENCY: `/alerts/emergency`,\r\n    BY_TYPE: (type: string) => `/alerts/type/${type}`,\r\n  },\r\n\r\n  NOTIFICATIONS: {\r\n    BASE: `/notifications`,\r\n    BY_ID: (id: string) => `/notifications/${id}`,\r\n    UNREAD: `/notifications/unread`,\r\n    MARK_READ: (id: string) => `/notifications/${id}/mark-read`,\r\n    MARK_ALL_READ: `/notifications/mark-all-read`,\r\n    PREFERENCES: `/notifications/preferences`,\r\n    TEST_PUSH: `/notifications/test-push`,\r\n    PUSH_SUBSCRIBE: `/notifications/push-subscribe`,\r\n    PUSH_UNSUBSCRIBE: `/notifications/push-unsubscribe`,\r\n    PUSH_SUBSCRIPTION: `/notifications/push-subscription`,\r\n  },\r\n\r\n  CONVERSATIONS: {\r\n    BASE: `/conversations`,\r\n    BY_ID: (id: string) => `/conversations/${id}`,\r\n    BY_USER: (userId: string) => `/conversations/user/${userId}`,\r\n    MESSAGES: (conversationId: string) => `/conversations/${conversationId}/messages`,\r\n    PARTICIPANTS: (conversationId: string) => `/conversations/${conversationId}/participants`,\r\n    ADD_PARTICIPANT: (conversationId: string) => `/conversations/${conversationId}/participants`,\r\n    REMOVE_PARTICIPANT: (conversationId: string, userId: string) =>\r\n      `/conversations/${conversationId}/participants/${userId}`,\r\n    ARCHIVE: (id: string) => `/conversations/${id}/archive`,\r\n    UNARCHIVE: (id: string) => `/conversations/${id}/unarchive`,\r\n  },\r\n\r\n  TEMPLATES: {\r\n    BASE: `/templates`,\r\n    BY_ID: (id: string) => `/templates/${id}`,\r\n    BY_CATEGORY: (category: string) => `/templates/category/${category}`,\r\n    RENDER: (id: string) => `/templates/${id}/render`,\r\n    CATEGORIES: `/templates/categories`,\r\n  },\r\n\r\n  // ==========================================\r\n  // DASHBOARD\r\n  // ==========================================\r\n  DASHBOARD: {\r\n    STATS: `/dashboard/stats`,\r\n    RECENT_ACTIVITIES: `/dashboard/recent-activities`,\r\n    UPCOMING_APPOINTMENTS: `/dashboard/upcoming-appointments`,\r\n    CHART_DATA: `/dashboard/chart-data`,\r\n    WIDGETS: (dashboardId: string) => `/dashboard/${dashboardId}/widgets`,\r\n    REFRESH: `/dashboard/refresh-cache`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ANALYTICS & REPORTING\r\n  // ==========================================\r\n  ANALYTICS: {\r\n    METRICS: `/analytics/metrics`,\r\n    DASHBOARD: `/analytics/dashboard`,\r\n    DASHBOARD_WIDGETS: (dashboardId: string) => `/analytics/dashboard/${dashboardId}/widgets`,\r\n    REPORTS: `/analytics/reports`,\r\n    CHART_DATA: `/analytics/chart-data`,\r\n    HEALTH_METRICS: `/analytics/health-metrics`,\r\n    MEDICATION_COMPLIANCE: `/analytics/medication-compliance`,\r\n    APPOINTMENT_METRICS: `/analytics/appointment-metrics`,\r\n    INCIDENT_ANALYTICS: `/analytics/incident-analytics`,\r\n    CUSTOM_REPORT: `/analytics/custom-report`,\r\n  },\r\n\r\n  REPORTS: {\r\n    // Base Reports\r\n    BASE: `/reports`,\r\n    CUSTOM: `/reports/custom`,\r\n    TEMPLATES: `/reports/templates`,\r\n    SCHEDULED: `/reports/scheduled`,\r\n    SCHEDULE: `/reports/schedule`,\r\n    EXPORT: `/reports/export`,\r\n    HISTORY: `/reports/history`,\r\n    SHARE: (reportId: string) => `/reports/${reportId}/share`,\r\n\r\n    // Health Trend Analysis\r\n    HEALTH_TRENDS: `/reports/health-trends`,\r\n    HEALTH_TRENDS_BY_CATEGORY: (category: string) => `/reports/health-trends/${category}`,\r\n\r\n    // Medication Reports\r\n    MEDICATIONS: {\r\n      ADMINISTRATION: `/reports/medications/administration`,\r\n      COMPLIANCE: `/reports/medications/compliance`,\r\n      EXPIRATION: `/reports/medications/expiration`,\r\n      INVENTORY: `/reports/medications/inventory`,\r\n      REFILLS: `/reports/medications/refills`,\r\n      USAGE: `/reports/medication-usage`,\r\n      EFFECTIVENESS: `/reports/medication-effectiveness`,\r\n    },\r\n\r\n    // Immunization Reports\r\n    IMMUNIZATIONS: {\r\n      COMPLIANCE: `/reports/immunizations/compliance`,\r\n      DUE: `/reports/immunizations/due`,\r\n      OVERDUE: `/reports/immunizations/overdue`,\r\n      EXEMPTIONS: `/reports/immunizations/exemptions`,\r\n    },\r\n\r\n    // Appointment Reports\r\n    APPOINTMENTS: {\r\n      ATTENDANCE: `/reports/appointments/attendance`,\r\n      NO_SHOWS: `/reports/appointments/no-shows`,\r\n      CANCELLATIONS: `/reports/appointments/cancellations`,\r\n    },\r\n\r\n    // Incident Reports\r\n    INCIDENTS: {\r\n      SUMMARY: `/reports/incidents/summary`,\r\n      BY_TYPE: `/reports/incidents/by-type`,\r\n      TRENDS: `/reports/incidents/trends`,\r\n      STATISTICS: `/reports/incident-statistics`,\r\n      BY_LOCATION: `/reports/incidents-by-location`,\r\n    },\r\n\r\n    // Student Reports\r\n    STUDENTS: {\r\n      ENROLLMENT: `/reports/students/enrollment`,\r\n      HEALTH_SUMMARY: `/reports/students/health-summary`,\r\n      DEMOGRAPHICS: `/reports/students/demographics`,\r\n    },\r\n\r\n    // Attendance & Absenteeism\r\n    ATTENDANCE_CORRELATION: `/reports/attendance-correlation`,\r\n    ABSENTEEISM_PATTERNS: `/reports/absenteeism-patterns`,\r\n\r\n    // Performance & Analytics\r\n    PERFORMANCE_METRICS: `/reports/performance-metrics`,\r\n    NURSE_PERFORMANCE: `/reports/nurse-performance`,\r\n    SYSTEM_USAGE: `/reports/system-usage`,\r\n    USAGE_ANALYTICS: `/reports/analytics/usage`,\r\n    POPULARITY: `/reports/analytics/popularity`,\r\n    INSIGHTS: `/reports/analytics/insights`,\r\n\r\n    // Dashboard Reports\r\n    DASHBOARD: `/reports/dashboard`,\r\n    DASHBOARD_WIDGETS: `/reports/dashboard/widgets`,\r\n    DASHBOARD_LAYOUT: `/reports/dashboard/layout`,\r\n\r\n    // Compliance Reports\r\n    COMPLIANCE: `/reports/compliance`,\r\n    COMPLIANCE_HISTORY: `/reports/compliance/history`,\r\n    COMPLIANCE_AUDIT: `/reports/compliance/audit`,\r\n  },\r\n\r\n  // ==========================================\r\n  // SYSTEM & ADMINISTRATION\r\n  // ==========================================\r\n  SYSTEM: {\r\n    HEALTH: `/health`,\r\n    STATUS: `/system/status`,\r\n    CONFIGURATION: `/system/configuration`,\r\n    SETTINGS: `/system/settings`,\r\n    BACKUP: `/system/backup`,\r\n    RESTORE: `/system/restore`,\r\n  },\r\n\r\n  // ==========================================\r\n  // ADMIN - District, School, User Management\r\n  // ==========================================\r\n  ADMIN: {\r\n    // System Settings\r\n    SETTINGS: `/administration/settings`,\r\n\r\n    // Users\r\n    USERS: `/users`,\r\n    USER_BY_ID: (id: string) => `/users/${id}`,\r\n\r\n    // Districts\r\n    DISTRICTS: `/administration/districts`,\r\n    DISTRICT_BY_ID: (id: string) => `/administration/districts/${id}`,\r\n\r\n    // Schools\r\n    SCHOOLS: `/administration/schools`,\r\n    SCHOOL_BY_ID: (id: string) => `/administration/schools/${id}`,\r\n\r\n    // System Health\r\n    SYSTEM_HEALTH: `/admin/system/health`,\r\n\r\n    // Backups\r\n    BACKUPS: `/administration/backups`,\r\n    BACKUP_BY_ID: (id: string) => `/administration/backups/${id}`,\r\n\r\n    // Licenses\r\n    LICENSES: `/administration/licenses`,\r\n    LICENSE_BY_ID: (id: string) => `/administration/licenses/${id}`,\r\n    LICENSE_DEACTIVATE: (id: string) => `/administration/licenses/${id}/deactivate`,\r\n\r\n    // Configurations\r\n    CONFIGURATIONS: `/administration/config`,\r\n    CONFIGURATION_BY_KEY: (key: string) => `/administration/config/${key}`,\r\n\r\n    // Performance Metrics\r\n    METRICS: `/admin/metrics`,\r\n    METRIC_BY_ID: (id: string) => `/admin/metrics/${id}`,\r\n\r\n    // Training\r\n    TRAINING: `/admin/training`,\r\n    TRAINING_BY_ID: (id: string) => `/admin/training/${id}`,\r\n    TRAINING_COMPLETE: (id: string) => `/admin/training/${id}/complete`,\r\n    TRAINING_PROGRESS: (userId: string) => `/admin/training/progress/${userId}`,\r\n\r\n    // Audit Logs\r\n    AUDIT_LOGS: `/administration/audit-logs`,\r\n    AUDIT_LOG_BY_ID: (id: string) => `/administration/audit-logs/${id}`,\r\n  },\r\n\r\n  INTEGRATIONS: {\r\n    BASE: `/integrations`,\r\n    BY_ID: (id: string) => `/integrations/${id}`,\r\n    CONFIGURE: (id: string) => `/integrations/${id}/configure`,\r\n    TEST: (id: string) => `/integrations/${id}/test`,\r\n    SYNC: (id: string) => `/integrations/${id}/sync`,\r\n    ENABLE: (id: string) => `/integrations/${id}/enable`,\r\n    DISABLE: (id: string) => `/integrations/${id}/disable`,\r\n    LOGS: (id: string) => `/integrations/${id}/logs`,\r\n  },\r\n\r\n  // ==========================================\r\n  // MULTI-FACTOR AUTHENTICATION (MFA)\r\n  // ==========================================\r\n  MFA: {\r\n    SETUP: `/mfa/setup`,\r\n    VERIFY: `/mfa/verify`,\r\n    ENABLE: `/mfa/enable`,\r\n    DISABLE: `/mfa/disable`,\r\n    BACKUP_CODES: `/mfa/backup-codes`,\r\n    REGENERATE_CODES: `/mfa/backup-codes/regenerate`,\r\n    VERIFY_BACKUP_CODE: `/mfa/verify-backup-code`,\r\n    QR_CODE: `/mfa/qr-code`,\r\n    STATUS: `/mfa/status`,\r\n  },\r\n\r\n  // ==========================================\r\n  // APPOINTMENT WAITLIST\r\n  // ==========================================\r\n  WAITLIST: {\r\n    BASE: `/waitlist`,\r\n    BY_ID: (id: string) => `/waitlist/${id}`,\r\n    ADD: `/waitlist/add`,\r\n    REMOVE: (id: string) => `/waitlist/${id}/remove`,\r\n    POSITION: (id: string) => `/waitlist/${id}/position`,\r\n    NOTIFY: (id: string) => `/waitlist/${id}/notify`,\r\n    UPDATE_PRIORITY: (id: string) => `/waitlist/${id}/priority`,\r\n    BY_STUDENT: (studentId: string) => `/waitlist/student/${studentId}`,\r\n    BY_NURSE: (nurseId: string) => `/waitlist/nurse/${nurseId}`,\r\n  },\r\n\r\n  // ==========================================\r\n  // NURSE AVAILABILITY & SCHEDULING\r\n  // ==========================================\r\n  NURSE_AVAILABILITY: {\r\n    BASE: `/nurse-availability`,\r\n    BY_ID: (id: string) => `/nurse-availability/${id}`,\r\n    BY_NURSE: (nurseId: string) => `/nurse-availability/nurse/${nurseId}`,\r\n    SLOTS: `/nurse-availability/slots`,\r\n    SET: `/nurse-availability/set`,\r\n    UPDATE: (id: string) => `/nurse-availability/${id}`,\r\n    DELETE: (id: string) => `/nurse-availability/${id}`,\r\n    BY_DATE: (date: string) => `/nurse-availability/date/${date}`,\r\n    CHECK_CONFLICTS: `/nurse-availability/check-conflicts`,\r\n  },\r\n\r\n  // ==========================================\r\n  // FORMS\r\n  // ==========================================\r\n  FORMS: {\r\n    BASE: `/forms`,\r\n    BY_ID: (id: string) => `/forms/${id}`,\r\n    TEMPLATES: `/forms/templates`,\r\n    SUBMIT: `/forms/submit`,\r\n    RESPONSES: (formId: string) => `/forms/${formId}/responses`,\r\n    SUBMISSIONS: (formId: string) => `/forms/${formId}/submissions`,\r\n    EXPORT: (formId: string) => `/forms/${formId}/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // PURCHASE ORDERS & PROCUREMENT\r\n  // ==========================================\r\n  PURCHASE_ORDERS: {\r\n    BASE: `/purchase-orders`,\r\n    BY_ID: (id: string) => `/purchase-orders/${id}`,\r\n    APPROVE: (id: string) => `/purchase-orders/${id}/approve`,\r\n    REJECT: (id: string) => `/purchase-orders/${id}/reject`,\r\n    RECEIVE: (id: string) => `/purchase-orders/${id}/receive`,\r\n    RECEIVE_ITEMS: (id: string) => `/purchase-orders/${id}/receive-items`,\r\n    CANCEL: (id: string) => `/purchase-orders/${id}/cancel`,\r\n    STATISTICS: `/purchase-orders/statistics`,\r\n    PENDING: `/purchase-orders/pending`,\r\n    APPROVED: `/purchase-orders/approved`,\r\n    RECEIVED: `/purchase-orders/received`,\r\n    BY_VENDOR: (vendorId: string) => `/purchase-orders/vendor/${vendorId}`,\r\n    REORDER_ITEMS: `/purchase-orders/reorder-items`,\r\n    VENDOR_HISTORY: (vendorId: string) => `/purchase-orders/vendor/${vendorId}/history`,\r\n  },\r\n\r\n  // ==========================================\r\n  // BILLING & FINANCIAL MANAGEMENT\r\n  // ==========================================\r\n  BILLING: {\r\n    // Invoices\r\n    INVOICES: `/billing/invoices`,\r\n    INVOICE_BY_ID: (id: string) => `/billing/invoices/${id}`,\r\n    INVOICE_PDF: (id: string) => `/billing/invoices/${id}/pdf`,\r\n    INVOICE_SEND: (id: string) => `/billing/invoices/${id}/send`,\r\n    INVOICE_VOID: (id: string) => `/billing/invoices/${id}/void`,\r\n    \r\n    // Payments\r\n    PAYMENTS: `/billing/payments`,\r\n    PAYMENT_BY_ID: (id: string) => `/billing/payments/${id}`,\r\n    PAYMENT_REFUND: (id: string) => `/billing/payments/${id}/refund`,\r\n    PAYMENT_VOID: (id: string) => `/billing/payments/${id}/void`,\r\n    \r\n    // Analytics\r\n    ANALYTICS: `/billing/analytics`,\r\n    REVENUE_TRENDS: `/billing/analytics/revenue-trends`,\r\n    PAYMENT_ANALYTICS: `/billing/analytics/payments`,\r\n    COLLECTION_METRICS: `/billing/analytics/collections`,\r\n    \r\n    // Reports\r\n    REPORTS: `/billing/reports`,\r\n    AGING_REPORT: `/billing/reports/aging`,\r\n    REVENUE_REPORT: `/billing/reports/revenue`,\r\n    PAYMENT_REPORT: `/billing/reports/payments`,\r\n    TAX_REPORT: `/billing/reports/tax`,\r\n    \r\n    // Settings\r\n    SETTINGS: `/billing/settings`,\r\n    \r\n    // Notifications\r\n    NOTIFICATIONS: `/billing/notifications`,\r\n    SEND_REMINDER: `/billing/notifications/reminder`,\r\n    SEND_STATEMENT: `/billing/notifications/statement`,\r\n  },\r\n\r\n  // ==========================================\r\n  // BUDGET MANAGEMENT\r\n  // ==========================================\r\n  BUDGET: {\r\n    // Budget Categories\r\n    CATEGORIES: `/budget/categories`,\r\n    CATEGORY_BY_ID: (id: string) => `/budget/categories/${id}`,\r\n\r\n    // Budget Summary\r\n    SUMMARY: `/budget/summary`,\r\n\r\n    // Budget Transactions\r\n    TRANSACTIONS: `/budget/transactions`,\r\n    TRANSACTION_BY_ID: (id: string) => `/budget/transactions/${id}`,\r\n\r\n    // Analytics & Reporting\r\n    TRENDS: `/budget/trends`,\r\n    YEAR_COMPARISON: `/budget/year-comparison`,\r\n    OVER_BUDGET: `/budget/over-budget`,\r\n    RECOMMENDATIONS: `/budget/recommendations`,\r\n    EXPORT: `/budget/export`,\r\n  },\r\n\r\n  // ==========================================\r\n  // VENDORS\r\n  // ==========================================\r\n  VENDORS: {\r\n    BASE: `/vendors`,\r\n    BY_ID: (id: string) => `/vendors/${id}`,\r\n    SEARCH: (query: string) => `/vendors/search/${encodeURIComponent(query)}`,\r\n    COMPARE: (itemName: string) => `/vendors/compare/${encodeURIComponent(itemName)}`,\r\n    TOP: `/vendors/top`,\r\n    STATISTICS: `/vendors/statistics`,\r\n    REACTIVATE: (id: string) => `/vendors/${id}/reactivate`,\r\n    RATING: (id: string) => `/vendors/${id}/rating`,\r\n    BULK_RATINGS: `/vendors/ratings/bulk`,\r\n    BY_PAYMENT_TERMS: (terms: string) => `/vendors/payment-terms/${encodeURIComponent(terms)}`,\r\n    METRICS: (id: string) => `/vendors/${id}/metrics`,\r\n    PERMANENT_DELETE: (id: string) => `/vendors/${id}/permanent`,\r\n  },\r\n\r\n  // ==========================================\r\n  // SETTINGS\r\n  // ==========================================\r\n  SETTINGS: {\r\n    USER: `/settings/user`,\r\n    SCHOOL: `/settings/school`,\r\n    NOTIFICATIONS: `/settings/notifications`,\r\n    PREFERENCES: `/settings/preferences`,\r\n    PRIVACY: `/settings/privacy`,\r\n    SECURITY: `/settings/security`,\r\n  },\r\n} as const;\r\n\r\n/**\r\n * HTTP Status Codes\r\n */\r\nexport const HTTP_STATUS = {\r\n  OK: 200,\r\n  CREATED: 201,\r\n  ACCEPTED: 202,\r\n  NO_CONTENT: 204,\r\n  BAD_REQUEST: 400,\r\n  UNAUTHORIZED: 401,\r\n  FORBIDDEN: 403,\r\n  NOT_FOUND: 404,\r\n  CONFLICT: 409,\r\n  UNPROCESSABLE_ENTITY: 422,\r\n  TOO_MANY_REQUESTS: 429,\r\n  INTERNAL_SERVER_ERROR: 500,\r\n  BAD_GATEWAY: 502,\r\n  SERVICE_UNAVAILABLE: 503,\r\n  GATEWAY_TIMEOUT: 504,\r\n} as const;\r\n\r\n/**\r\n * API Response Types\r\n */\r\nexport type ApiSuccessResponse<T = unknown> = {\r\n  success: true;\r\n  data: T;\r\n  message?: string;\r\n};\r\n\r\nexport type ApiErrorResponse = {\r\n  success: false;\r\n  error: string;\r\n  code?: string;\r\n  details?: Record<string, unknown>;\r\n  traceId?: string;\r\n};\r\n\r\nexport type ApiResponse<T = unknown> = ApiSuccessResponse<T> | ApiErrorResponse;\r\n\r\n/**\r\n * Pagination Types\r\n */\r\nexport type PaginationParams = {\r\n  page?: number;\r\n  limit?: number;\r\n  sort?: string;\r\n  order?: 'asc' | 'desc';\r\n};\r\n\r\nexport type PaginatedResponse<T> = {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrev: boolean;\r\n  };\r\n};\r\n\r\nexport default API_ENDPOINTS;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1206, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/lib/audit.ts"],"sourcesContent":["/**\r\n * HIPAA-compliant audit logging utilities\r\n * Tracks all PHI access and modifications for compliance\r\n */\r\n\r\nconst BACKEND_URL = process.env.BACKEND_URL || 'http://localhost:3001';\r\n\r\n/**\r\n * Audit log entry interface\r\n */\r\nexport interface AuditLogEntry {\r\n  userId?: string | null;\r\n  action: string;\r\n  resource: string;\r\n  resourceId?: string;\r\n  details?: string;\r\n  ipAddress?: string;\r\n  userAgent?: string;\r\n  success?: boolean;\r\n  errorMessage?: string;\r\n  changes?: Record<string, unknown>;\r\n}\r\n\r\n/**\r\n * Log audit event to backend\r\n * HIPAA Requirement: All PHI access must be logged\r\n */\r\nexport async function auditLog(entry: AuditLogEntry): Promise<void> {\r\n  try {\r\n    // Send audit log to backend service\r\n    await fetch(`${BACKEND_URL}/audit/log`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        userId: entry.userId,\r\n        action: entry.action,\r\n        entityType: entry.resource,\r\n        entityId: entry.resourceId,\r\n        changes: entry.changes || {\r\n          details: entry.details,\r\n          success: entry.success !== undefined ? entry.success : true,\r\n          errorMessage: entry.errorMessage\r\n        },\r\n        ipAddress: entry.ipAddress,\r\n        userAgent: entry.userAgent\r\n      })\r\n    });\r\n  } catch (error) {\r\n    // Audit logging should never break the main flow\r\n    // Log to console for debugging but don't throw\r\n    console.error('Audit log failed:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * PHI access actions\r\n */\r\nexport const PHI_ACTIONS = {\r\n  VIEW: 'VIEW_PHI',\r\n  CREATE: 'CREATE_PHI',\r\n  UPDATE: 'UPDATE_PHI',\r\n  DELETE: 'DELETE_PHI',\r\n  EXPORT: 'EXPORT_PHI',\r\n  PRINT: 'PRINT_PHI'\r\n} as const;\r\n\r\n/**\r\n * Log PHI access\r\n * HIPAA Critical: All Protected Health Information access must be audited\r\n */\r\nexport async function logPHIAccess(entry: Omit<AuditLogEntry, 'action'> & { action: keyof typeof PHI_ACTIONS }): Promise<void> {\r\n  await auditLog({\r\n    ...entry,\r\n    action: PHI_ACTIONS[entry.action]\r\n  });\r\n}\r\n\r\n/**\r\n * Common audit actions\r\n */\r\nexport const AUDIT_ACTIONS = {\r\n  // Authentication\r\n  LOGIN: 'USER_LOGIN',\r\n  LOGOUT: 'USER_LOGOUT',\r\n  LOGIN_FAILED: 'LOGIN_FAILED',\r\n  TOKEN_REFRESH: 'TOKEN_REFRESH',\r\n  PASSWORD_CHANGE: 'PASSWORD_CHANGE',\r\n\r\n  // Students\r\n  VIEW_STUDENT: 'VIEW_STUDENT',\r\n  CREATE_STUDENT: 'CREATE_STUDENT',\r\n  UPDATE_STUDENT: 'UPDATE_STUDENT',\r\n  DELETE_STUDENT: 'DELETE_STUDENT',\r\n  LIST_STUDENTS: 'LIST_STUDENTS',\r\n\r\n  // Health Records\r\n  VIEW_HEALTH_RECORD: 'VIEW_HEALTH_RECORD',\r\n  CREATE_HEALTH_RECORD: 'CREATE_HEALTH_RECORD',\r\n  UPDATE_HEALTH_RECORD: 'UPDATE_HEALTH_RECORD',\r\n  DELETE_HEALTH_RECORD: 'DELETE_HEALTH_RECORD',\r\n\r\n  // Medications\r\n  VIEW_MEDICATION: 'VIEW_MEDICATION',\r\n  CREATE_MEDICATION: 'CREATE_MEDICATION',\r\n  UPDATE_MEDICATION: 'UPDATE_MEDICATION',\r\n  DELETE_MEDICATION: 'DELETE_MEDICATION',\r\n  ADMINISTER_MEDICATION: 'ADMINISTER_MEDICATION',\r\n\r\n  // Appointments\r\n  VIEW_APPOINTMENT: 'VIEW_APPOINTMENT',\r\n  LIST_APPOINTMENTS: 'LIST_APPOINTMENTS',\r\n  CREATE_APPOINTMENT: 'CREATE_APPOINTMENT',\r\n  UPDATE_APPOINTMENT: 'UPDATE_APPOINTMENT',\r\n  DELETE_APPOINTMENT: 'DELETE_APPOINTMENT',\r\n  RESCHEDULE_APPOINTMENT: 'RESCHEDULE_APPOINTMENT',\r\n  CANCEL_APPOINTMENT: 'CANCEL_APPOINTMENT',\r\n  COMPLETE_APPOINTMENT: 'COMPLETE_APPOINTMENT',\r\n  CONFIRM_APPOINTMENT: 'CONFIRM_APPOINTMENT',\r\n  NO_SHOW_APPOINTMENT: 'NO_SHOW_APPOINTMENT',\r\n  SEND_APPOINTMENT_REMINDER: 'SEND_APPOINTMENT_REMINDER',\r\n\r\n  // Incidents\r\n  VIEW_INCIDENT: 'VIEW_INCIDENT',\r\n  CREATE_INCIDENT: 'CREATE_INCIDENT',\r\n  UPDATE_INCIDENT: 'UPDATE_INCIDENT',\r\n  DELETE_INCIDENT: 'DELETE_INCIDENT',\r\n\r\n  // Documents\r\n  VIEW_DOCUMENT: 'VIEW_DOCUMENT',\r\n  UPLOAD_DOCUMENT: 'UPLOAD_DOCUMENT',\r\n  DOWNLOAD_DOCUMENT: 'DOWNLOAD_DOCUMENT',\r\n  DELETE_DOCUMENT: 'DELETE_DOCUMENT',\r\n  CREATE_DOCUMENT: 'CREATE_DOCUMENT',\r\n  UPDATE_DOCUMENT: 'UPDATE_DOCUMENT',\r\n  SIGN_DOCUMENT: 'SIGN_DOCUMENT',\r\n  SHARE_DOCUMENT: 'SHARE_DOCUMENT',\r\n\r\n  // PHI Records\r\n  CREATE_PHI_RECORD: 'CREATE_PHI_RECORD',\r\n  ACCESS_PHI_RECORD: 'ACCESS_PHI_RECORD',\r\n\r\n  // User Management\r\n  CREATE_USER: 'CREATE_USER',\r\n  UPDATE_USER: 'UPDATE_USER',\r\n  DELETE_USER: 'DELETE_USER',\r\n\r\n  // Organization Management\r\n  CREATE_ORGANIZATION: 'CREATE_ORGANIZATION',\r\n  UPDATE_ORGANIZATION: 'UPDATE_ORGANIZATION',\r\n\r\n  // Configuration\r\n  UPDATE_CONFIGURATION: 'UPDATE_CONFIGURATION',\r\n\r\n  // Reports\r\n  GENERATE_REPORT: 'GENERATE_REPORT',\r\n  EXPORT_DATA: 'EXPORT_DATA'\r\n} as const;\r\n\r\n/**\r\n * Extract IP address from request or headers\r\n */\r\nexport function extractIPAddress(request: Request | { get(name: string): string | null }): string | undefined {\r\n  // Check various headers for IP address\r\n  const headersList = [\r\n    'x-forwarded-for',\r\n    'x-real-ip',\r\n    'cf-connecting-ip'\r\n  ];\r\n\r\n  const headers = 'headers' in request ? request.headers : request;\r\n\r\n  for (const header of headersList) {\r\n    const value = headers.get(header);\r\n    if (value) {\r\n      // x-forwarded-for can contain multiple IPs, take the first one\r\n      return value.split(',')[0].trim();\r\n    }\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\n/**\r\n * Extract user agent from request or headers\r\n */\r\nexport function extractUserAgent(request: Request | { get(name: string): string | null }): string | undefined {\r\n  const headers = 'headers' in request ? request.headers : request;\r\n  return headers.get('user-agent') || undefined;\r\n}\r\n\r\n/**\r\n * Create audit context from request\r\n */\r\nexport function createAuditContext(request: Request, userId?: string) {\r\n  return {\r\n    userId,\r\n    ipAddress: extractIPAddress(request),\r\n    userAgent: extractUserAgent(request)\r\n  };\r\n}\r\n\r\n/**\r\n * Get client IP from Next.js server context\r\n *\r\n * Works in server actions and components.\r\n *\r\n * @returns Client IP address\r\n *\r\n * @example\r\n * ```typescript\r\n * 'use server'\r\n *\r\n * export async function myAction() {\r\n *   const ip = await getClientIP();\r\n *   await auditLog({ ipAddress: ip, ... });\r\n * }\r\n * ```\r\n */\r\nexport async function getClientIP(): Promise<string | undefined> {\r\n  try {\r\n    const { headers } = await import('next/headers');\r\n    const headersList = await headers();\r\n\r\n    // Check common headers for IP\r\n    const ipHeaders = [\r\n      'x-forwarded-for',\r\n      'x-real-ip',\r\n      'cf-connecting-ip',\r\n      'x-client-ip',\r\n      'x-cluster-client-ip'\r\n    ];\r\n\r\n    for (const header of ipHeaders) {\r\n      const value = headersList.get(header);\r\n      if (value) {\r\n        // x-forwarded-for can contain multiple IPs, take the first one\r\n        return value.split(',')[0].trim();\r\n      }\r\n    }\r\n\r\n    return undefined;\r\n  } catch (error) {\r\n    // headers() might not be available in all contexts\r\n    return undefined;\r\n  }\r\n}\r\n\r\n/**\r\n * Get user agent from Next.js server context\r\n *\r\n * Works in server actions and components.\r\n *\r\n * @returns User agent string\r\n */\r\nexport async function getUserAgent(): Promise<string | undefined> {\r\n  try {\r\n    const { headers } = await import('next/headers');\r\n    const headersList = await headers();\r\n    return headersList.get('user-agent') || undefined;\r\n  } catch (error) {\r\n    // headers() might not be available in all contexts\r\n    return undefined;\r\n  }\r\n}\r\n\r\n/**\r\n * Create audit context from Next.js server context\r\n *\r\n * Works in server actions and server components.\r\n *\r\n * @param userId - Optional user ID\r\n * @returns Audit context\r\n *\r\n * @example\r\n * ```typescript\r\n * 'use server'\r\n *\r\n * export async function updateProfile(data: FormData) {\r\n *   const session = await getServerSession();\r\n *   const context = await createAuditContextFromServer(session?.user.id);\r\n *\r\n *   await auditLog({\r\n *     ...context,\r\n *     action: AUDIT_ACTIONS.UPDATE_PROFILE,\r\n *     resource: 'profile',\r\n *     resourceId: session?.user.id\r\n *   });\r\n * }\r\n * ```\r\n */\r\nexport async function createAuditContextFromServer(userId?: string | null) {\r\n  return {\r\n    userId,\r\n    ipAddress: await getClientIP(),\r\n    userAgent: await getUserAgent()\r\n  };\r\n}\r\n\r\n/**\r\n * Log audit event with automatic context detection\r\n *\r\n * Automatically detects IP and user agent from server context.\r\n *\r\n * @param entry - Audit log entry\r\n *\r\n * @example\r\n * ```typescript\r\n * 'use server'\r\n *\r\n * export async function deleteStudent(id: string) {\r\n *   const user = await getServerAuth();\r\n *\r\n *   await auditLogWithContext({\r\n *     userId: user.id,\r\n *     action: AUDIT_ACTIONS.DELETE_STUDENT,\r\n *     resource: 'student',\r\n *     resourceId: id\r\n *   });\r\n * }\r\n * ```\r\n */\r\nexport async function auditLogWithContext(\r\n  entry: Omit<AuditLogEntry, 'ipAddress' | 'userAgent'>\r\n): Promise<void> {\r\n  const context = await createAuditContextFromServer(entry.userId);\r\n\r\n  await auditLog({\r\n    ...entry,\r\n    ipAddress: context.ipAddress,\r\n    userAgent: context.userAgent\r\n  });\r\n}\r\n\r\n/**\r\n * Parse user agent string\r\n *\r\n * Extracts browser, OS, and device information from user agent.\r\n *\r\n * @param userAgent - User agent string\r\n * @returns Parsed user agent info\r\n */\r\nexport function parseUserAgent(userAgent: string): {\r\n  browser: string;\r\n  os: string;\r\n  device: string;\r\n} {\r\n  const ua = userAgent.toLowerCase();\r\n\r\n  // Detect browser\r\n  let browser = 'Unknown';\r\n  if (ua.includes('chrome')) browser = 'Chrome';\r\n  else if (ua.includes('firefox')) browser = 'Firefox';\r\n  else if (ua.includes('safari')) browser = 'Safari';\r\n  else if (ua.includes('edge')) browser = 'Edge';\r\n  else if (ua.includes('opera')) browser = 'Opera';\r\n\r\n  // Detect OS\r\n  let os = 'Unknown';\r\n  if (ua.includes('windows')) os = 'Windows';\r\n  else if (ua.includes('mac')) os = 'macOS';\r\n  else if (ua.includes('linux')) os = 'Linux';\r\n  else if (ua.includes('android')) os = 'Android';\r\n  else if (ua.includes('ios') || ua.includes('iphone') || ua.includes('ipad')) os = 'iOS';\r\n\r\n  // Detect device\r\n  let device = 'Desktop';\r\n  if (ua.includes('mobile') || ua.includes('android')) device = 'Mobile';\r\n  else if (ua.includes('tablet') || ua.includes('ipad')) device = 'Tablet';\r\n\r\n  return { browser, os, device };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1452, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/lib/helpers/rate-limit.ts"],"sourcesContent":["/**\r\n * @fileoverview Rate Limiting Implementation\r\n * @module lib/helpers/rate-limit\r\n *\r\n * Provides in-memory rate limiting for server actions to prevent\r\n * brute force attacks and abuse. Uses a sliding window algorithm\r\n * with automatic cleanup.\r\n *\r\n * IMPORTANT: This is an in-memory implementation suitable for single-instance\r\n * deployments. For multi-instance/distributed systems, use Redis or similar.\r\n */\r\n\r\nimport type { RateLimitInfo } from '../types/action-result';\r\n\r\n/**\r\n * Rate limit entry with expiration\r\n */\r\ninterface RateLimitEntry {\r\n  /** Request timestamps */\r\n  requests: number[];\r\n  /** Expiration time (ms since epoch) */\r\n  expiresAt: number;\r\n}\r\n\r\n/**\r\n * Rate limit store\r\n * Maps: \"scope:identifier\" -> RateLimitEntry\r\n */\r\nconst rateLimitStore = new Map<string, RateLimitEntry>();\r\n\r\n/**\r\n * Cleanup interval (5 minutes)\r\n */\r\nconst CLEANUP_INTERVAL = 5 * 60 * 1000;\r\n\r\n/**\r\n * Rate limit configuration\r\n */\r\nexport interface RateLimitConfig {\r\n  /** Maximum number of requests */\r\n  maxRequests: number;\r\n  /** Time window in seconds */\r\n  windowSeconds: number;\r\n  /** Custom error message */\r\n  message?: string;\r\n}\r\n\r\n/**\r\n * Predefined rate limit configurations\r\n */\r\nexport const RATE_LIMITS = {\r\n  /** Login attempts by IP: 5 per 15 minutes */\r\n  LOGIN_IP: {\r\n    maxRequests: 5,\r\n    windowSeconds: 15 * 60,\r\n  },\r\n  /** Login attempts by email: 3 per 15 minutes */\r\n  LOGIN_EMAIL: {\r\n    maxRequests: 3,\r\n    windowSeconds: 15 * 60,\r\n  },\r\n  /** Password reset requests: 3 per hour */\r\n  PASSWORD_RESET: {\r\n    maxRequests: 3,\r\n    windowSeconds: 60 * 60,\r\n  },\r\n  /** Password change attempts: 5 per hour */\r\n  PASSWORD_CHANGE: {\r\n    maxRequests: 5,\r\n    windowSeconds: 60 * 60,\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Check if a request should be rate limited\r\n *\r\n * Uses a sliding window algorithm to track requests over time.\r\n * Automatically cleans up old entries.\r\n *\r\n * @param scope - Rate limit scope (e.g., 'login-ip', 'login-email')\r\n * @param identifier - Unique identifier (e.g., IP address, email)\r\n * @param config - Rate limit configuration\r\n * @returns Rate limit information\r\n *\r\n * @example\r\n * const limitInfo = checkRateLimit('login-ip', ipAddress, RATE_LIMITS.LOGIN_IP);\r\n * if (limitInfo.limited) {\r\n *   return actionRateLimitError(limitInfo.resetIn!);\r\n * }\r\n */\r\nexport function checkRateLimit(\r\n  scope: string,\r\n  identifier: string,\r\n  config: RateLimitConfig\r\n): RateLimitInfo {\r\n  const key = `${scope}:${identifier}`;\r\n  const now = Date.now();\r\n  const windowMs = config.windowSeconds * 1000;\r\n  const cutoff = now - windowMs;\r\n\r\n  // Get or create entry\r\n  let entry = rateLimitStore.get(key);\r\n\r\n  if (!entry) {\r\n    entry = {\r\n      requests: [],\r\n      expiresAt: now + windowMs,\r\n    };\r\n    rateLimitStore.set(key, entry);\r\n  }\r\n\r\n  // Remove requests outside the window\r\n  entry.requests = entry.requests.filter((timestamp) => timestamp > cutoff);\r\n\r\n  // Check if limit exceeded\r\n  if (entry.requests.length >= config.maxRequests) {\r\n    // Calculate reset time\r\n    const oldestRequest = entry.requests[0];\r\n    const resetIn = Math.ceil((oldestRequest + windowMs - now) / 1000);\r\n\r\n    return {\r\n      limited: true,\r\n      remaining: 0,\r\n      resetIn,\r\n      key,\r\n    };\r\n  }\r\n\r\n  // Record this request\r\n  entry.requests.push(now);\r\n  entry.expiresAt = now + windowMs;\r\n\r\n  return {\r\n    limited: false,\r\n    remaining: config.maxRequests - entry.requests.length,\r\n    resetIn: config.windowSeconds,\r\n    key,\r\n  };\r\n}\r\n\r\n/**\r\n * Reset rate limit for a specific key\r\n *\r\n * Useful for testing or manual intervention\r\n *\r\n * @param scope - Rate limit scope\r\n * @param identifier - Unique identifier\r\n */\r\nexport function resetRateLimit(scope: string, identifier: string): void {\r\n  const key = `${scope}:${identifier}`;\r\n  rateLimitStore.delete(key);\r\n}\r\n\r\n/**\r\n * Clean up expired rate limit entries\r\n *\r\n * Should be called periodically to prevent memory leaks\r\n */\r\nexport function cleanupRateLimits(): void {\r\n  const now = Date.now();\r\n  const expiredKeys: string[] = [];\r\n\r\n  for (const [key, entry] of rateLimitStore.entries()) {\r\n    if (entry.expiresAt < now) {\r\n      expiredKeys.push(key);\r\n    }\r\n  }\r\n\r\n  for (const key of expiredKeys) {\r\n    rateLimitStore.delete(key);\r\n  }\r\n}\r\n\r\n/**\r\n * Get current rate limit stats (for monitoring)\r\n *\r\n * @returns Current stats\r\n */\r\nexport function getRateLimitStats() {\r\n  return {\r\n    totalKeys: rateLimitStore.size,\r\n    scopes: Array.from(rateLimitStore.keys()).reduce((acc, key) => {\r\n      const scope = key.split(':')[0];\r\n      acc[scope] = (acc[scope] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>),\r\n  };\r\n}\r\n\r\n// Start cleanup interval\r\nif (typeof globalThis !== 'undefined' && !globalThis.__rateLimitCleanupStarted) {\r\n  setInterval(cleanupRateLimits, CLEANUP_INTERVAL);\r\n  globalThis.__rateLimitCleanupStarted = true;\r\n}\r\n\r\n// Type augmentation for global cleanup flag\r\ndeclare global {\r\n  var __rateLimitCleanupStarted: boolean | undefined;\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;CAUC;;;;;;;;;;;;AAcD;;;CAGC,GACD,MAAM,iBAAiB,IAAI;AAE3B;;CAEC,GACD,MAAM,mBAAmB,IAAI,KAAK;AAiB3B,MAAM,cAAc;IACzB,2CAA2C,GAC3C,UAAU;QACR,aAAa;QACb,eAAe,KAAK;IACtB;IACA,8CAA8C,GAC9C,aAAa;QACX,aAAa;QACb,eAAe,KAAK;IACtB;IACA,wCAAwC,GACxC,gBAAgB;QACd,aAAa;QACb,eAAe,KAAK;IACtB;IACA,yCAAyC,GACzC,iBAAiB;QACf,aAAa;QACb,eAAe,KAAK;IACtB;AACF;AAmBO,SAAS,eACd,KAAa,EACb,UAAkB,EAClB,MAAuB;IAEvB,MAAM,MAAM,GAAG,MAAM,CAAC,EAAE,YAAY;IACpC,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,WAAW,OAAO,aAAa,GAAG;IACxC,MAAM,SAAS,MAAM;IAErB,sBAAsB;IACtB,IAAI,QAAQ,eAAe,GAAG,CAAC;IAE/B,IAAI,CAAC,OAAO;QACV,QAAQ;YACN,UAAU,EAAE;YACZ,WAAW,MAAM;QACnB;QACA,eAAe,GAAG,CAAC,KAAK;IAC1B;IAEA,qCAAqC;IACrC,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,MAAM,CAAC,CAAC,YAAc,YAAY;IAElE,0BAA0B;IAC1B,IAAI,MAAM,QAAQ,CAAC,MAAM,IAAI,OAAO,WAAW,EAAE;QAC/C,uBAAuB;QACvB,MAAM,gBAAgB,MAAM,QAAQ,CAAC,EAAE;QACvC,MAAM,UAAU,KAAK,IAAI,CAAC,CAAC,gBAAgB,WAAW,GAAG,IAAI;QAE7D,OAAO;YACL,SAAS;YACT,WAAW;YACX;YACA;QACF;IACF;IAEA,sBAAsB;IACtB,MAAM,QAAQ,CAAC,IAAI,CAAC;IACpB,MAAM,SAAS,GAAG,MAAM;IAExB,OAAO;QACL,SAAS;QACT,WAAW,OAAO,WAAW,GAAG,MAAM,QAAQ,CAAC,MAAM;QACrD,SAAS,OAAO,aAAa;QAC7B;IACF;AACF;AAUO,SAAS,eAAe,KAAa,EAAE,UAAkB;IAC9D,MAAM,MAAM,GAAG,MAAM,CAAC,EAAE,YAAY;IACpC,eAAe,MAAM,CAAC;AACxB;AAOO,SAAS;IACd,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,cAAwB,EAAE;IAEhC,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,eAAe,OAAO,GAAI;QACnD,IAAI,MAAM,SAAS,GAAG,KAAK;YACzB,YAAY,IAAI,CAAC;QACnB;IACF;IAEA,KAAK,MAAM,OAAO,YAAa;QAC7B,eAAe,MAAM,CAAC;IACxB;AACF;AAOO,SAAS;IACd,OAAO;QACL,WAAW,eAAe,IAAI;QAC9B,QAAQ,MAAM,IAAI,CAAC,eAAe,IAAI,IAAI,MAAM,CAAC,CAAC,KAAK;YACrD,MAAM,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;YAC/B,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI;YACjC,OAAO;QACT,GAAG,CAAC;IACN;AACF;AAEA,yBAAyB;AACzB,IAAI,OAAO,eAAe,eAAe,CAAC,WAAW,yBAAyB,EAAE;IAC9E,YAAY,mBAAmB;IAC/B,WAAW,yBAAyB,GAAG;AACzC","debugId":null}},
    {"offset": {"line": 1572, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/lib/helpers/input-sanitization.ts"],"sourcesContent":["/**\r\n * @fileoverview Input Sanitization Utilities\r\n * @module lib/helpers/input-sanitization\r\n *\r\n * Provides utilities for sanitizing and normalizing user inputs\r\n * to prevent XSS attacks and ensure data consistency.\r\n */\r\n\r\n/**\r\n * Sanitize and normalize email address\r\n *\r\n * - Trims whitespace\r\n * - Converts to lowercase\r\n * - Removes dangerous characters\r\n *\r\n * @param email - Raw email input\r\n * @returns Sanitized email\r\n *\r\n * @example\r\n * sanitizeEmail('  User@Example.COM  ') // Returns: 'user@example.com'\r\n */\r\nexport function sanitizeEmail(email: string): string {\r\n  return email\r\n    .trim()\r\n    .toLowerCase()\r\n    .replace(/[<>'\"]/g, ''); // Remove potential XSS characters\r\n}\r\n\r\n/**\r\n * Sanitize string input\r\n *\r\n * - Trims whitespace\r\n * - Removes null bytes\r\n * - Optionally encodes HTML entities\r\n *\r\n * @param input - Raw string input\r\n * @param encodeHtml - Whether to encode HTML entities (default: false)\r\n * @returns Sanitized string\r\n *\r\n * @example\r\n * sanitizeString('  Hello <script>  ', true) // Returns: 'Hello &lt;script&gt;'\r\n */\r\nexport function sanitizeString(input: string, encodeHtml: boolean = false): string {\r\n  let sanitized = input\r\n    .trim()\r\n    .replace(/\\0/g, ''); // Remove null bytes\r\n\r\n  if (encodeHtml) {\r\n    sanitized = encodeHtmlEntities(sanitized);\r\n  }\r\n\r\n  return sanitized;\r\n}\r\n\r\n/**\r\n * Encode HTML entities to prevent XSS\r\n *\r\n * @param input - Raw string\r\n * @returns String with HTML entities encoded\r\n *\r\n * @example\r\n * encodeHtmlEntities('<script>alert(\"XSS\")</script>')\r\n * // Returns: '&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;'\r\n */\r\nexport function encodeHtmlEntities(input: string): string {\r\n  const entities: Record<string, string> = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#39;',\r\n    '/': '&#x2F;',\r\n  };\r\n\r\n  return input.replace(/[&<>\"'/]/g, (char) => entities[char] || char);\r\n}\r\n\r\n/**\r\n * Safely extract and sanitize string from FormData\r\n *\r\n * @param formData - Form data object\r\n * @param key - Field key\r\n * @param defaultValue - Default value if field is missing\r\n * @param encodeHtml - Whether to encode HTML entities\r\n * @returns Sanitized string value\r\n *\r\n * @example\r\n * const email = safeFormDataString(formData, 'email');\r\n * const name = safeFormDataString(formData, 'name', '', true);\r\n */\r\nexport function safeFormDataString(\r\n  formData: FormData,\r\n  key: string,\r\n  defaultValue: string = '',\r\n  encodeHtml: boolean = false\r\n): string {\r\n  const value = formData.get(key);\r\n\r\n  if (value === null || value === undefined) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (typeof value !== 'string') {\r\n    return defaultValue;\r\n  }\r\n\r\n  return sanitizeString(value, encodeHtml);\r\n}\r\n\r\n/**\r\n * Safely extract and sanitize email from FormData\r\n *\r\n * @param formData - Form data object\r\n * @param key - Field key\r\n * @param defaultValue - Default value if field is missing\r\n * @returns Sanitized email value\r\n *\r\n * @example\r\n * const email = safeFormDataEmail(formData, 'email');\r\n */\r\nexport function safeFormDataEmail(\r\n  formData: FormData,\r\n  key: string,\r\n  defaultValue: string = ''\r\n): string {\r\n  const value = formData.get(key);\r\n\r\n  if (value === null || value === undefined) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (typeof value !== 'string') {\r\n    return defaultValue;\r\n  }\r\n\r\n  return sanitizeEmail(value);\r\n}\r\n\r\n/**\r\n * Validate and sanitize password input\r\n *\r\n * Passwords are not sanitized for HTML entities since they're never displayed,\r\n * but we do trim whitespace and remove null bytes.\r\n *\r\n * @param password - Raw password input\r\n * @returns Sanitized password\r\n */\r\nexport function sanitizePassword(password: string): string {\r\n  return password\r\n    .replace(/\\0/g, ''); // Remove null bytes but preserve other characters\r\n}\r\n\r\n/**\r\n * Safely extract password from FormData\r\n *\r\n * @param formData - Form data object\r\n * @param key - Field key\r\n * @param defaultValue - Default value if field is missing\r\n * @returns Sanitized password value\r\n *\r\n * @example\r\n * const password = safeFormDataPassword(formData, 'password');\r\n */\r\nexport function safeFormDataPassword(\r\n  formData: FormData,\r\n  key: string,\r\n  defaultValue: string = ''\r\n): string {\r\n  const value = formData.get(key);\r\n\r\n  if (value === null || value === undefined) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (typeof value !== 'string') {\r\n    return defaultValue;\r\n  }\r\n\r\n  return sanitizePassword(value);\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC,GAED;;;;;;;;;;;;CAYC;;;;;;;;;;;;;;;;AACM,SAAS,cAAc,KAAa;IACzC,OAAO,MACJ,IAAI,GACJ,WAAW,GACX,OAAO,CAAC,WAAW,KAAK,kCAAkC;AAC/D;AAgBO,SAAS,eAAe,KAAa,EAAE,aAAsB,KAAK;IACvE,IAAI,YAAY,MACb,IAAI,GACJ,OAAO,CAAC,OAAO,KAAK,oBAAoB;IAE3C,IAAI,YAAY;QACd,YAAY,mBAAmB;IACjC;IAEA,OAAO;AACT;AAYO,SAAS,mBAAmB,KAAa;IAC9C,MAAM,WAAmC;QACvC,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;IACP;IAEA,OAAO,MAAM,OAAO,CAAC,aAAa,CAAC,OAAS,QAAQ,CAAC,KAAK,IAAI;AAChE;AAeO,SAAS,mBACd,QAAkB,EAClB,GAAW,EACX,eAAuB,EAAE,EACzB,aAAsB,KAAK;IAE3B,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI,UAAU,QAAQ,UAAU,WAAW;QACzC,OAAO;IACT;IAEA,IAAI,OAAO,UAAU,UAAU;QAC7B,OAAO;IACT;IAEA,OAAO,eAAe,OAAO;AAC/B;AAaO,SAAS,kBACd,QAAkB,EAClB,GAAW,EACX,eAAuB,EAAE;IAEzB,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI,UAAU,QAAQ,UAAU,WAAW;QACzC,OAAO;IACT;IAEA,IAAI,OAAO,UAAU,UAAU;QAC7B,OAAO;IACT;IAEA,OAAO,cAAc;AACvB;AAWO,SAAS,iBAAiB,QAAgB;IAC/C,OAAO,SACJ,OAAO,CAAC,OAAO,KAAK,kDAAkD;AAC3E;AAaO,SAAS,qBACd,QAAkB,EAClB,GAAW,EACX,eAAuB,EAAE;IAEzB,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,IAAI,UAAU,QAAQ,UAAU,WAAW;QACzC,OAAO;IACT;IAEA,IAAI,OAAO,UAAU,UAAU;QAC7B,OAAO;IACT;IAEA,OAAO,iBAAiB;AAC1B","debugId":null}},
    {"offset": {"line": 1664, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/lib/helpers/action-result.ts"],"sourcesContent":["/**\r\n * @fileoverview Server Action Result Builder Helpers\r\n * @module lib/helpers/action-result\r\n *\r\n * Provides builder functions for creating standardized server action results.\r\n * Ensures consistent response format across all server actions.\r\n */\r\n\r\nimport type { ServerActionResult, FieldErrors, FormErrors } from '../types/action-result';\r\n\r\n/**\r\n * Create a successful action result\r\n *\r\n * @template T - Type of data being returned\r\n * @param data - Data to return\r\n * @param message - Optional success message\r\n * @returns Standardized success result\r\n *\r\n * @example\r\n * return actionSuccess({ userId: '123' }, 'User created successfully');\r\n */\r\nexport function actionSuccess<T>(\r\n  data?: T,\r\n  message?: string\r\n): ServerActionResult<T> {\r\n  return {\r\n    success: true,\r\n    data,\r\n    message,\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create an error action result with form-level errors\r\n *\r\n * @param formErrors - Array of form-level error messages\r\n * @param fieldErrors - Optional field-level errors\r\n * @returns Standardized error result\r\n *\r\n * @example\r\n * return actionError(['Invalid credentials']);\r\n */\r\nexport function actionError(\r\n  formErrors: FormErrors,\r\n  fieldErrors?: FieldErrors\r\n): ServerActionResult {\r\n  return {\r\n    success: false,\r\n    formErrors,\r\n    fieldErrors,\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create an error action result with field-level validation errors\r\n *\r\n * @param fieldErrors - Field-level validation errors\r\n * @param formErrors - Optional form-level errors\r\n * @returns Standardized validation error result\r\n *\r\n * @example\r\n * return actionValidationError({\r\n *   email: ['Invalid email format'],\r\n *   password: ['Password too short']\r\n * });\r\n */\r\nexport function actionValidationError(\r\n  fieldErrors: FieldErrors,\r\n  formErrors?: FormErrors\r\n): ServerActionResult {\r\n  return {\r\n    success: false,\r\n    fieldErrors,\r\n    formErrors,\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a rate limit error result\r\n *\r\n * @param resetIn - Seconds until rate limit resets\r\n * @returns Standardized rate limit error result\r\n *\r\n * @example\r\n * return actionRateLimitError(900); // 15 minutes\r\n */\r\nexport function actionRateLimitError(resetIn: number): ServerActionResult {\r\n  const minutes = Math.ceil(resetIn / 60);\r\n  return {\r\n    success: false,\r\n    formErrors: [`Too many attempts. Please try again in ${minutes} minute${minutes !== 1 ? 's' : ''}.`],\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create an unauthorized error result\r\n *\r\n * @param message - Optional custom message\r\n * @returns Standardized unauthorized error result\r\n */\r\nexport function actionUnauthorized(message?: string): ServerActionResult {\r\n  return {\r\n    success: false,\r\n    formErrors: [message || 'You must be logged in to perform this action'],\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a CSRF error result\r\n *\r\n * @returns Standardized CSRF error result\r\n */\r\nexport function actionCsrfError(): ServerActionResult {\r\n  return {\r\n    success: false,\r\n    formErrors: ['Invalid or missing security token. Please refresh the page and try again.'],\r\n    timestamp: new Date().toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Convert ServerActionResult to legacy LoginFormState format\r\n *\r\n * @param result - Server action result\r\n * @returns Legacy login form state\r\n */\r\nexport function toLoginFormState(result: ServerActionResult): {\r\n  success?: boolean;\r\n  errors?: {\r\n    email?: string[];\r\n    password?: string[];\r\n    _form?: string[];\r\n  };\r\n} {\r\n  if (result.success) {\r\n    return { success: true };\r\n  }\r\n\r\n  const errors: any = {};\r\n\r\n  if (result.fieldErrors) {\r\n    Object.assign(errors, result.fieldErrors);\r\n  }\r\n\r\n  if (result.formErrors) {\r\n    errors._form = result.formErrors;\r\n  }\r\n\r\n  return { errors };\r\n}\r\n\r\n/**\r\n * Convert ServerActionResult to legacy ChangePasswordFormState format\r\n *\r\n * @param result - Server action result\r\n * @returns Legacy change password form state\r\n */\r\nexport function toChangePasswordFormState(result: ServerActionResult): {\r\n  success?: boolean;\r\n  message?: string;\r\n  errors?: {\r\n    currentPassword?: string[];\r\n    newPassword?: string[];\r\n    confirmPassword?: string[];\r\n    _form?: string[];\r\n  };\r\n} {\r\n  if (result.success) {\r\n    return {\r\n      success: true,\r\n      message: result.message,\r\n    };\r\n  }\r\n\r\n  const errors: any = {};\r\n\r\n  if (result.fieldErrors) {\r\n    Object.assign(errors, result.fieldErrors);\r\n  }\r\n\r\n  if (result.formErrors) {\r\n    errors._form = result.formErrors;\r\n  }\r\n\r\n  return { errors };\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;;;;;;;;;;;;;;;;;;AAeM,SAAS,cACd,IAAQ,EACR,OAAgB;IAEhB,OAAO;QACL,SAAS;QACT;QACA;QACA,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAYO,SAAS,YACd,UAAsB,EACtB,WAAyB;IAEzB,OAAO;QACL,SAAS;QACT;QACA;QACA,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAeO,SAAS,sBACd,WAAwB,EACxB,UAAuB;IAEvB,OAAO;QACL,SAAS;QACT;QACA;QACA,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAWO,SAAS,qBAAqB,OAAe;IAClD,MAAM,UAAU,KAAK,IAAI,CAAC,UAAU;IACpC,OAAO;QACL,SAAS;QACT,YAAY;YAAC,CAAC,uCAAuC,EAAE,QAAQ,OAAO,EAAE,YAAY,IAAI,MAAM,GAAG,CAAC,CAAC;SAAC;QACpG,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAQO,SAAS,mBAAmB,OAAgB;IACjD,OAAO;QACL,SAAS;QACT,YAAY;YAAC,WAAW;SAA+C;QACvE,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAOO,SAAS;IACd,OAAO;QACL,SAAS;QACT,YAAY;YAAC;SAA4E;QACzF,WAAW,IAAI,OAAO,WAAW;IACnC;AACF;AAQO,SAAS,iBAAiB,MAA0B;IAQzD,IAAI,OAAO,OAAO,EAAE;QAClB,OAAO;YAAE,SAAS;QAAK;IACzB;IAEA,MAAM,SAAc,CAAC;IAErB,IAAI,OAAO,WAAW,EAAE;QACtB,OAAO,MAAM,CAAC,QAAQ,OAAO,WAAW;IAC1C;IAEA,IAAI,OAAO,UAAU,EAAE;QACrB,OAAO,KAAK,GAAG,OAAO,UAAU;IAClC;IAEA,OAAO;QAAE;IAAO;AAClB;AAQO,SAAS,0BAA0B,MAA0B;IAUlE,IAAI,OAAO,OAAO,EAAE;QAClB,OAAO;YACL,SAAS;YACT,SAAS,OAAO,OAAO;QACzB;IACF;IAEA,MAAM,SAAc,CAAC;IAErB,IAAI,OAAO,WAAW,EAAE;QACtB,OAAO,MAAM,CAAC,QAAQ,OAAO,WAAW;IAC1C;IAEA,IAAI,OAAO,UAAU,EAAE;QACrB,OAAO,KAAK,GAAG,OAAO,UAAU;IAClC;IAEA,OAAO;QAAE;IAAO;AAClB","debugId":null}},
    {"offset": {"line": 1779, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/lib/helpers/zod-errors.ts"],"sourcesContent":["/**\r\n * @fileoverview Zod Error Formatting Utilities\r\n * @module lib/helpers/zod-errors\r\n *\r\n * Provides utilities for formatting Zod validation errors into\r\n * consistent error structures for server actions.\r\n */\r\n\r\nimport type { ZodError } from 'zod';\r\nimport type { FieldErrors } from '../types/action-result';\r\n\r\n/**\r\n * Format Zod validation errors into field errors object\r\n *\r\n * Converts Zod's error format into a simple field -> messages mapping\r\n * that can be used in server action responses.\r\n *\r\n * @param error - Zod validation error\r\n * @returns Field errors object mapping field names to error message arrays\r\n *\r\n * @example\r\n * const schema = z.object({\r\n *   email: z.string().email(),\r\n *   password: z.string().min(8)\r\n * });\r\n *\r\n * const result = schema.safeParse({ email: 'invalid', password: '123' });\r\n * if (!result.success) {\r\n *   const errors = formatZodErrors(result.error);\r\n *   // Returns: {\r\n *   //   email: [\"Invalid email\"],\r\n *   //   password: [\"String must contain at least 8 character(s)\"]\r\n *   // }\r\n * }\r\n */\r\nexport function formatZodErrors(error: ZodError): FieldErrors {\r\n  const flattened = error.flatten();\r\n  return flattened.fieldErrors as FieldErrors;\r\n}\r\n\r\n/**\r\n * Extract form-level errors from Zod error\r\n *\r\n * Gets errors that don't apply to specific fields (formErrors)\r\n *\r\n * @param error - Zod validation error\r\n * @returns Array of form-level error messages\r\n */\r\nexport function extractFormErrors(error: ZodError): string[] {\r\n  const flattened = error.flatten();\r\n  return flattened.formErrors || [];\r\n}\r\n\r\n/**\r\n * Check if Zod error has any field errors\r\n *\r\n * @param error - Zod validation error\r\n * @returns True if there are field-specific errors\r\n */\r\nexport function hasFieldErrors(error: ZodError): boolean {\r\n  const formatted = formatZodErrors(error);\r\n  return Object.keys(formatted).length > 0;\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;;;;;;;;AA6BM,SAAS,gBAAgB,KAAe;IAC7C,MAAM,YAAY,MAAM,OAAO;IAC/B,OAAO,UAAU,WAAW;AAC9B;AAUO,SAAS,kBAAkB,KAAe;IAC/C,MAAM,YAAY,MAAM,OAAO;IAC/B,OAAO,UAAU,UAAU,IAAI,EAAE;AACnC;AAQO,SAAS,eAAe,KAAe;IAC5C,MAAM,YAAY,gBAAgB;IAClC,OAAO,OAAO,IAAI,CAAC,WAAW,MAAM,GAAG;AACzC","debugId":null}},
    {"offset": {"line": 1809, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/actions/auth.constants.ts"],"sourcesContent":["/**\r\n * @fileoverview Authentication Constants and Validation Schemas\r\n * @module lib/actions/auth.constants\r\n *\r\n * Shared constants and validation schemas for authentication operations.\r\n * This file does NOT use \"use server\" so constants and schemas can be safely\r\n * imported in both client and server components.\r\n */\r\n\r\nimport { z } from 'zod';\r\n\r\n// ==========================================\r\n// CACHE TAGS\r\n// ==========================================\r\n\r\n/**\r\n * Cache tags for authentication operations\r\n */\r\nexport const AUTH_CACHE_TAGS = {\r\n  AUTH: 'auth-data',\r\n} as const;\r\n\r\n// ==========================================\r\n// VALIDATION SCHEMAS\r\n// ==========================================\r\n\r\n/**\r\n * Password validation requirements for security compliance\r\n *\r\n * Requirements:\r\n * - Minimum 12 characters (industry best practice, stronger than 8)\r\n * - At least one uppercase letter (A-Z)\r\n * - At least one lowercase letter (a-z)\r\n * - At least one number (0-9)\r\n * - At least one special character (!@#$%^&*()_+-=[]{}|;:,.<>?)\r\n *\r\n * These requirements meet NIST SP 800-63B guidelines and healthcare\r\n * security standards for protecting sensitive patient information.\r\n */\r\nconst PASSWORD_MIN_LENGTH = 12;\r\nconst PASSWORD_REGEX = {\r\n  uppercase: /[A-Z]/,\r\n  lowercase: /[a-z]/,\r\n  number: /[0-9]/,\r\n  special: /[!@#$%^&*()_+\\-=[\\]{}|;:,.<>?]/,\r\n};\r\n\r\n/**\r\n * Password validation schema with comprehensive complexity requirements\r\n */\r\nexport const passwordValidation = z\r\n  .string()\r\n  .min(PASSWORD_MIN_LENGTH, `Password must be at least ${PASSWORD_MIN_LENGTH} characters`)\r\n  .regex(\r\n    PASSWORD_REGEX.uppercase,\r\n    'Password must contain at least one uppercase letter'\r\n  )\r\n  .regex(\r\n    PASSWORD_REGEX.lowercase,\r\n    'Password must contain at least one lowercase letter'\r\n  )\r\n  .regex(\r\n    PASSWORD_REGEX.number,\r\n    'Password must contain at least one number'\r\n  )\r\n  .regex(\r\n    PASSWORD_REGEX.special,\r\n    'Password must contain at least one special character (!@#$%^&*()_+-=[]{}|;:,.<>?)'\r\n  );\r\n\r\n/**\r\n * Login form validation schema\r\n */\r\nexport const loginSchema = z.object({\r\n  email: z.string().email('Invalid email address'),\r\n  password: z.string().min(1, 'Password is required'),\r\n  // Note: We don't enforce complexity on login to allow users with older passwords to sign in\r\n  // Password complexity is enforced on registration and password changes\r\n});\r\n\r\n/**\r\n * Registration/signup form validation schema\r\n */\r\nexport const registerSchema = z.object({\r\n  email: z.string().email('Invalid email address'),\r\n  password: passwordValidation,\r\n  confirmPassword: z.string().min(1, 'Password confirmation is required'),\r\n}).refine(\r\n  (data) => data.password === data.confirmPassword,\r\n  {\r\n    message: \"Passwords don't match\",\r\n    path: ['confirmPassword'],\r\n  }\r\n);\r\n\r\n/**\r\n * Change password form validation schema\r\n * Enforces strong password requirements for enhanced security\r\n */\r\nexport const changePasswordSchema = z.object({\r\n  currentPassword: z.string().min(1, 'Current password is required'),\r\n  newPassword: passwordValidation,\r\n  confirmPassword: z.string().min(1, 'Password confirmation is required'),\r\n}).refine(\r\n  (data: { currentPassword: string; newPassword: string; confirmPassword: string }) =>\r\n    data.newPassword === data.confirmPassword,\r\n  {\r\n    message: \"Passwords don't match\",\r\n    path: ['confirmPassword'],\r\n  }\r\n).refine(\r\n  (data: { currentPassword: string; newPassword: string; confirmPassword: string }) =>\r\n    data.newPassword !== data.currentPassword,\r\n  {\r\n    message: \"New password must be different from current password\",\r\n    path: ['newPassword'],\r\n  }\r\n);\r\n\r\n/**\r\n * Reset password form validation schema\r\n * Used for password reset flow (forgot password)\r\n */\r\nexport const resetPasswordSchema = z.object({\r\n  password: passwordValidation,\r\n  confirmPassword: z.string().min(1, 'Password confirmation is required'),\r\n}).refine(\r\n  (data) => data.password === data.confirmPassword,\r\n  {\r\n    message: \"Passwords don't match\",\r\n    path: ['confirmPassword'],\r\n  }\r\n);\r\n"],"names":[],"mappings":"AAAA;;;;;;;CAOC;;;;;;;;;;;;;;AAED;;AASO,MAAM,kBAAkB;IAC7B,MAAM;AACR;AAEA,6CAA6C;AAC7C,qBAAqB;AACrB,6CAA6C;AAE7C;;;;;;;;;;;;CAYC,GACD,MAAM,sBAAsB;AAC5B,MAAM,iBAAiB;IACrB,WAAW;IACX,WAAW;IACX,QAAQ;IACR,SAAS;AACX;AAKO,MAAM,qBAAqB,kLAAC,CAChC,MAAM,GACN,GAAG,CAAC,qBAAqB,CAAC,0BAA0B,EAAE,oBAAoB,WAAW,CAAC,EACtF,KAAK,CACJ,eAAe,SAAS,EACxB,uDAED,KAAK,CACJ,eAAe,SAAS,EACxB,uDAED,KAAK,CACJ,eAAe,MAAM,EACrB,6CAED,KAAK,CACJ,eAAe,OAAO,EACtB;AAMG,MAAM,cAAc,kLAAC,CAAC,MAAM,CAAC;IAClC,OAAO,kLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAG9B;AAKO,MAAM,iBAAiB,kLAAC,CAAC,MAAM,CAAC;IACrC,OAAO,kLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU;IACV,iBAAiB,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACrC,GAAG,MAAM,CACP,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAChD;IACE,SAAS;IACT,MAAM;QAAC;KAAkB;AAC3B;AAOK,MAAM,uBAAuB,kLAAC,CAAC,MAAM,CAAC;IAC3C,iBAAiB,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACnC,aAAa;IACb,iBAAiB,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACrC,GAAG,MAAM,CACP,CAAC,OACC,KAAK,WAAW,KAAK,KAAK,eAAe,EAC3C;IACE,SAAS;IACT,MAAM;QAAC;KAAkB;AAC3B,GACA,MAAM,CACN,CAAC,OACC,KAAK,WAAW,KAAK,KAAK,eAAe,EAC3C;IACE,SAAS;IACT,MAAM;QAAC;KAAc;AACvB;AAOK,MAAM,sBAAsB,kLAAC,CAAC,MAAM,CAAC;IAC1C,UAAU;IACV,iBAAiB,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACrC,GAAG,MAAM,CACP,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAChD;IACE,SAAS;IACT,MAAM;QAAC;KAAkB;AAC3B","debugId":null}},
    {"offset": {"line": 1900, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/src/identity-access/actions/auth.login.ts"],"sourcesContent":["/**\r\n * @fileoverview Authentication Login Operations\r\n * @module lib/actions/auth.login\r\n *\r\n * Server actions for login and authentication operations.\r\n *\r\n * Features:\r\n * - Login form validation and processing\r\n * - Session creation and cookie management\r\n * - HIPAA audit logging for login events\r\n * - Rate limiting (IP and email based)\r\n * - Input sanitization and CSRF protection\r\n * - Standardized error handling\r\n */\r\n\r\n'use server';\r\n\r\nimport { revalidatePath } from 'next/cache';\r\nimport { cookies, headers } from 'next/headers';\r\nimport { redirect } from 'next/navigation';\r\n\r\n// API integration\r\nimport { serverPost, NextApiClientError } from '@/lib/api/nextjs-client';\r\nimport { API_ENDPOINTS } from '@/constants/api';\r\nimport { auditLog, AUDIT_ACTIONS, extractIPAddress, extractUserAgent } from '@/lib/audit';\r\n\r\n// Security helpers\r\nimport { checkRateLimit, RATE_LIMITS } from '../lib/helpers/rate-limit';\r\nimport { safeFormDataEmail, safeFormDataPassword } from '../lib/helpers/input-sanitization';\r\nimport {\r\n  actionError,\r\n  actionRateLimitError,\r\n  actionValidationError,\r\n  toLoginFormState\r\n} from '../lib/helpers/action-result';\r\nimport { formatZodErrors } from '../lib/helpers/zod-errors';\r\n\r\n// Cookie configuration\r\nimport {\r\n  COOKIE_NAMES,\r\n  getAccessTokenCookieOptions,\r\n  getRefreshTokenCookieOptions\r\n} from '@/identity-access/lib/config/cookies';\r\n\r\n// Types and schemas\r\nimport type { AuthResponse, LoginFormState } from './auth.types';\r\nimport { AUTH_CACHE_TAGS, loginSchema } from './auth.constants';\r\n\r\n// ==========================================\r\n// LOGIN ACTIONS\r\n// ==========================================\r\n\r\n/**\r\n * Login action with comprehensive security features\r\n *\r\n * Security features:\r\n * - Rate limiting (IP-based: 5/15min, Email-based: 3/15min)\r\n * - Input sanitization\r\n * - Zod validation\r\n * - HIPAA audit logging\r\n * - Secure cookie management\r\n *\r\n * @param _prevState - Previous form state (unused, for useActionState)\r\n * @param formData - Form data containing email and password\r\n * @returns Standardized login form state\r\n */\r\nexport async function loginAction(\r\n  _prevState: LoginFormState,\r\n  formData: FormData\r\n): Promise<LoginFormState> {\r\n  // Extract IP address for rate limiting\r\n  const headersList = await headers();\r\n  const mockRequest = {\r\n    headers: {\r\n      get: (name: string) => headersList.get(name)\r\n    }\r\n  } as Request;\r\n  const ipAddress = extractIPAddress(mockRequest);\r\n\r\n  // Sanitize inputs before validation\r\n  const email = safeFormDataEmail(formData, 'email');\r\n  const password = safeFormDataPassword(formData, 'password');\r\n\r\n  // Rate limiting: IP-based (prevents brute force from single IP)\r\n  const ipRateLimit = checkRateLimit('login-ip', ipAddress, RATE_LIMITS.LOGIN_IP);\r\n  if (ipRateLimit.limited) {\r\n    // Audit rate limit violation\r\n    await auditLog({\r\n      userId: email || 'unknown',\r\n      action: AUDIT_ACTIONS.LOGIN_FAILED,\r\n      resource: 'Authentication',\r\n      details: `Rate limit exceeded from IP ${ipAddress}`,\r\n      ipAddress,\r\n      userAgent: extractUserAgent(mockRequest),\r\n      success: false,\r\n      errorMessage: 'Rate limit exceeded'\r\n    });\r\n\r\n    return toLoginFormState(actionRateLimitError(ipRateLimit.resetIn!));\r\n  }\r\n\r\n  // Rate limiting: Email-based (prevents targeted attacks on specific accounts)\r\n  if (email) {\r\n    const emailRateLimit = checkRateLimit('login-email', email, RATE_LIMITS.LOGIN_EMAIL);\r\n    if (emailRateLimit.limited) {\r\n      // Audit rate limit violation\r\n      await auditLog({\r\n        userId: email,\r\n        action: AUDIT_ACTIONS.LOGIN_FAILED,\r\n        resource: 'Authentication',\r\n        details: `Rate limit exceeded for email ${email}`,\r\n        ipAddress,\r\n        userAgent: extractUserAgent(mockRequest),\r\n        success: false,\r\n        errorMessage: 'Rate limit exceeded'\r\n      });\r\n\r\n      return toLoginFormState(actionRateLimitError(emailRateLimit.resetIn!));\r\n    }\r\n  }\r\n\r\n  // Validate form data with Zod\r\n  const validatedFields = loginSchema.safeParse({\r\n    email,\r\n    password,\r\n  });\r\n\r\n  if (!validatedFields.success) {\r\n    return toLoginFormState(\r\n      actionValidationError(formatZodErrors(validatedFields.error))\r\n    );\r\n  }\r\n\r\n  try {\r\n    const { email: validatedEmail, password: validatedPassword } = validatedFields.data;\r\n\r\n    // Call backend authentication endpoint\r\n    const wrappedResponse = await serverPost<any>(\r\n      API_ENDPOINTS.AUTH.LOGIN,\r\n      { email: validatedEmail, password: validatedPassword },\r\n      {\r\n        cache: 'no-store',\r\n        requiresAuth: false,\r\n        next: { tags: [AUTH_CACHE_TAGS.AUTH] }\r\n      }\r\n    );\r\n\r\n    console.log('[Login Action] Response received:', {\r\n      hasResponse: !!wrappedResponse,\r\n      hasData: !!wrappedResponse?.data,\r\n      responseKeys: wrappedResponse ? Object.keys(wrappedResponse) : [],\r\n    });\r\n\r\n    // Backend wraps response in ApiResponse format - extract data\r\n    const response: AuthResponse = wrappedResponse?.data || wrappedResponse;\r\n\r\n    console.log('[Login Action] Extracted auth data:', {\r\n      hasAccessToken: !!response?.accessToken,\r\n      hasRefreshToken: !!response?.refreshToken,\r\n      hasUser: !!response?.user,\r\n    });\r\n\r\n    // Check if we have valid authentication data\r\n    if (!response || !response.accessToken) {\r\n      // Audit failed login attempt\r\n      await auditLog({\r\n        userId: validatedEmail,\r\n        action: AUDIT_ACTIONS.LOGIN_FAILED,\r\n        resource: 'Authentication',\r\n        details: `Failed login attempt for ${validatedEmail}`,\r\n        ipAddress,\r\n        userAgent: extractUserAgent(mockRequest),\r\n        success: false,\r\n        errorMessage: 'Invalid credentials'\r\n      });\r\n\r\n      return toLoginFormState(\r\n        actionError(['Invalid credentials'])\r\n      );\r\n    }\r\n\r\n    // Extract data from successful response\r\n    const { accessToken: token, refreshToken, user } = response;\r\n\r\n    // Set HTTP-only cookies using centralized configuration\r\n    const cookieStore = await cookies();\r\n\r\n    console.log('[Login Action] Setting auth token:', {\r\n      tokenLength: token?.length,\r\n      tokenStart: token?.substring(0, 20),\r\n      cookieName: COOKIE_NAMES.ACCESS_TOKEN\r\n    });\r\n\r\n    // Use centralized cookie configuration for consistent, secure settings\r\n    cookieStore.set(\r\n      COOKIE_NAMES.ACCESS_TOKEN,\r\n      token,\r\n      getAccessTokenCookieOptions()\r\n    );\r\n\r\n    console.log('[Login Action] Auth token cookie set, verifying:', {\r\n      cookieExists: !!cookieStore.get(COOKIE_NAMES.ACCESS_TOKEN),\r\n      cookieValue: cookieStore.get(COOKIE_NAMES.ACCESS_TOKEN)?.value?.substring(0, 20)\r\n    });\r\n\r\n    if (refreshToken) {\r\n      cookieStore.set(\r\n        COOKIE_NAMES.REFRESH_TOKEN,\r\n        refreshToken,\r\n        getRefreshTokenCookieOptions()\r\n      );\r\n    }\r\n\r\n    // Audit successful login\r\n    await auditLog({\r\n      userId: user.id,\r\n      action: AUDIT_ACTIONS.LOGIN,\r\n      resource: 'Authentication',\r\n      details: `User ${validatedEmail} logged in successfully`,\r\n      ipAddress,\r\n      userAgent: extractUserAgent(mockRequest),\r\n      success: true\r\n    });\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('[Login Action] Error:', error);\r\n\r\n    // Handle NextApiClientError with more specific messaging\r\n    if (error instanceof NextApiClientError) {\r\n      const errorMessage = error.message || 'Authentication failed. Please check your credentials.';\r\n\r\n      // Audit API error\r\n      await auditLog({\r\n        userId: email || 'unknown',\r\n        action: AUDIT_ACTIONS.LOGIN_FAILED,\r\n        resource: 'Authentication',\r\n        details: `Login error: ${errorMessage}`,\r\n        ipAddress,\r\n        userAgent: extractUserAgent(mockRequest),\r\n        success: false,\r\n        errorMessage\r\n      });\r\n\r\n      return toLoginFormState(actionError([errorMessage]));\r\n    }\r\n\r\n    // Audit unexpected error\r\n    await auditLog({\r\n      userId: email || 'unknown',\r\n      action: AUDIT_ACTIONS.LOGIN_FAILED,\r\n      resource: 'Authentication',\r\n      details: 'Unexpected error during login',\r\n      ipAddress,\r\n      userAgent: extractUserAgent(mockRequest),\r\n      success: false,\r\n      errorMessage: error instanceof Error ? error.message : 'Unknown error'\r\n    });\r\n\r\n    return toLoginFormState(\r\n      actionError(['An unexpected error occurred. Please try again.'])\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Handle login form submission from login page\r\n *\r\n * Delegates to centralized loginAction and handles redirect.\r\n * This is the action that should be used in login forms.\r\n *\r\n * @param prevState - Previous form state\r\n * @param formData - Form data containing credentials\r\n * @returns Login form state or redirects to dashboard\r\n */\r\nexport async function handleLoginSubmission(\r\n  prevState: LoginFormState,\r\n  formData: FormData\r\n): Promise<LoginFormState> {\r\n  const result = await loginAction(prevState, formData);\r\n\r\n  if (result.success) {\r\n    // Successful login - revalidate and redirect to dashboard\r\n    revalidatePath('/dashboard', 'page');\r\n    redirect('/dashboard');\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Clear login form state\r\n *\r\n * Utility action for resetting form state.\r\n *\r\n * @returns Empty form state\r\n */\r\nexport async function clearLoginForm(): Promise<LoginFormState> {\r\n  return {\r\n    success: false,\r\n    errors: undefined\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2145, "column": 0}, "map": {"version":3,"sources":["file:///F:/temp/white-cross/frontend/.next-internal/server/app/login/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {handleLoginSubmission as '60a76c9a9b4ad7c70ac5696a449c9886d3c1f7e0b7'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}}]
}