/**
 * LOC: MLIK1234567
 * File: /reuse/threat/malware-intelligence-kit.ts
 *
 * UPSTREAM (imports from):
 *   - None (leaf node - reusable utilities)
 *
 * DOWNSTREAM (imported by):
 *   - Threat intelligence services
 *   - Malware intelligence controllers
 *   - Security analytics systems
 */
/**
 * File: /reuse/threat/malware-intelligence-kit.ts
 * Locator: WC-UTL-MLIK-001
 * Purpose: Comprehensive Malware Intelligence Utilities - Trend analysis, prevalence scoring, variant detection, C2 tracking
 *
 * Upstream: Independent utility module for malware intelligence and threat analytics
 * Downstream: ../backend/threat/*, intelligence services, analytics dashboards
 * Dependencies: TypeScript 5.x, Node 18+, NestJS 10.x, Swagger/OpenAPI, Sequelize 6.x
 * Exports: 40 utility functions for malware trend analysis, prevalence scoring, variant detection, C2 tracking, kill chain mapping
 *
 * LLM Context: Comprehensive malware intelligence utilities for implementing production-ready threat analytics in White Cross system.
 * Provides malware trend analysis, prevalence scoring, variant detection, signature generation, C2 tracking, distribution analysis,
 * kill chain mapping, and intelligence correlation. Essential for building advanced threat intelligence and security operations capabilities.
 */
interface MalwareTrend {
    familyName: string;
    timeWindow: TimeWindow;
    sampleCount: number;
    growthRate: number;
    peakDate: Date;
    currentPrevalence: number;
    trendDirection: 'rising' | 'falling' | 'stable';
    impactScore: number;
}
interface TimeWindow {
    startDate: Date;
    endDate: Date;
    intervalType: 'hour' | 'day' | 'week' | 'month';
}
interface PrevalenceScore {
    malwareId: string;
    globalPrevalence: number;
    regionalPrevalence: Record<string, number>;
    sectorPrevalence: Record<string, number>;
    detectionRate: number;
    infectionRate: number;
    score: number;
    rank: number;
}
interface MalwareVariant {
    variantId: string;
    parentFamily: string;
    sha256: string;
    firstSeen: Date;
    lastSeen: Date;
    similarity: number;
    mutations: VariantMutation[];
    isActive: boolean;
    prevalence: number;
}
interface VariantMutation {
    type: 'code' | 'packer' | 'obfuscation' | 'payload' | 'c2' | 'persistence';
    description: string;
    offset?: number;
    severity: 'low' | 'medium' | 'high';
}
interface MalwareSignature {
    signatureId: string;
    signatureType: 'yara' | 'snort' | 'clamav' | 'custom';
    name: string;
    content: string;
    malwareFamily: string;
    confidence: number;
    falsePositiveRate: number;
    createdDate: Date;
    lastUpdated: Date;
    detectionCount: number;
}
interface C2Infrastructure {
    c2Id: string;
    type: 'domain' | 'ip' | 'url' | 'tor';
    value: string;
    port?: number;
    protocol: 'http' | 'https' | 'dns' | 'tcp' | 'udp' | 'custom';
    malwareFamilies: string[];
    firstSeen: Date;
    lastSeen: Date;
    isActive: boolean;
    reputation: number;
    geolocation?: GeoLocation;
    asn?: string;
    registrar?: string;
}
interface GeoLocation {
    country: string;
    countryCode: string;
    region?: string;
    city?: string;
    latitude?: number;
    longitude?: number;
}
interface DistributionVector {
    vectorType: 'email' | 'web' | 'exploit' | 'removable_media' | 'network' | 'supply_chain' | 'social_engineering';
    description: string;
    malwareFamily: string;
    firstObserved: Date;
    lastObserved: Date;
    victimCount: number;
    successRate: number;
    targetedSectors: string[];
    targetedRegions: string[];
}
interface KillChainStage {
    stage: 'reconnaissance' | 'weaponization' | 'delivery' | 'exploitation' | 'installation' | 'command_control' | 'actions_on_objective';
    techniques: string[];
    mitreAttackIds: string[];
    indicators: string[];
    timestamp?: Date;
}
interface MalwareCampaign {
    campaignId: string;
    name: string;
    malwareFamilies: string[];
    threatActor?: string;
    startDate: Date;
    endDate?: Date;
    isActive: boolean;
    targets: CampaignTarget[];
    killChain: KillChainStage[];
    c2Infrastructure: string[];
    victimCount: number;
    impactScore: number;
}
interface CampaignTarget {
    targetType: 'sector' | 'organization' | 'region' | 'individual';
    name: string;
    attackCount: number;
    successRate: number;
}
interface ThreatIntelligence {
    intelId: string;
    source: string;
    confidence: 'low' | 'medium' | 'high' | 'confirmed';
    tlpLevel: 'white' | 'green' | 'amber' | 'red';
    malwareFamily?: string;
    indicators: ThreatIndicator[];
    description: string;
    publishedDate: Date;
    expirationDate?: Date;
}
interface ThreatIndicator {
    type: 'hash' | 'ip' | 'domain' | 'url' | 'email' | 'file' | 'registry' | 'mutex';
    value: string;
    context?: string;
}
interface MalwareCorrelation {
    primaryMalware: string;
    relatedMalware: string[];
    correlationType: 'c2_sharing' | 'code_similarity' | 'campaign' | 'threat_actor' | 'infrastructure';
    confidenceScore: number;
    evidence: string[];
}
/**
 * Analyzes malware trends over a time window.
 *
 * @param {string} familyName - Malware family name
 * @param {TimeWindow} timeWindow - Time window for analysis
 * @param {number[]} sampleCounts - Array of sample counts per interval
 * @returns {MalwareTrend} Trend analysis result
 *
 * @example
 * ```typescript
 * const trend = analyzeMalwareTrend('Emotet',
 *   { startDate: new Date('2025-01-01'), endDate: new Date('2025-01-31'), intervalType: 'day' },
 *   [100, 120, 150, 180, 200, ...]
 * );
 * // Result: { familyName: 'Emotet', growthRate: 0.15, trendDirection: 'rising', ... }
 * ```
 */
export declare const analyzeMalwareTrend: (familyName: string, timeWindow: TimeWindow, sampleCounts: number[]) => MalwareTrend;
/**
 * Detects emerging malware families based on growth patterns.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @param {number} [growthThreshold] - Minimum growth rate to be considered emerging (default: 0.5)
 * @returns {MalwareTrend[]} Emerging malware families
 *
 * @example
 * ```typescript
 * const emerging = detectEmergingMalware(trends, 0.5);
 * // Result: [{ familyName: 'NewTrojan', growthRate: 1.2, ... }, ...]
 * ```
 */
export declare const detectEmergingMalware: (trends: MalwareTrend[], growthThreshold?: number) => MalwareTrend[];
/**
 * Identifies declining malware families.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @param {number} [declineThreshold] - Maximum growth rate to be considered declining (default: -0.3)
 * @returns {MalwareTrend[]} Declining malware families
 *
 * @example
 * ```typescript
 * const declining = identifyDecliningMalware(trends, -0.3);
 * // Result: [{ familyName: 'OldWorm', growthRate: -0.6, ... }, ...]
 * ```
 */
export declare const identifyDecliningMalware: (trends: MalwareTrend[], declineThreshold?: number) => MalwareTrend[];
/**
 * Compares malware trends across multiple families.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @returns {Record<string, any>} Comparative analysis
 *
 * @example
 * ```typescript
 * const comparison = compareMalwareTrends(trends);
 * // Result: { topGrowing: 'Emotet', topDeclining: 'Zeus', avgGrowthRate: 0.15, ... }
 * ```
 */
export declare const compareMalwareTrends: (trends: MalwareTrend[]) => Record<string, any>;
/**
 * Calculates malware prevalence score.
 *
 * @param {number} globalSamples - Global sample count
 * @param {number} totalGlobalMalware - Total global malware samples
 * @param {number} detectionRate - Detection rate (0-1)
 * @param {number} infectionRate - Infection rate (0-1)
 * @returns {PrevalenceScore} Prevalence score object
 *
 * @example
 * ```typescript
 * const score = calculatePrevalenceScore('malware123', 5000, 100000, 0.85, 0.15);
 * // Result: { malwareId: 'malware123', globalPrevalence: 5.0, score: 68, ... }
 * ```
 */
export declare const calculatePrevalenceScore: (malwareId: string, globalSamples: number, totalGlobalMalware: number, detectionRate: number, infectionRate: number) => Partial<PrevalenceScore>;
/**
 * Ranks malware by prevalence scores.
 *
 * @param {PrevalenceScore[]} scores - Array of prevalence scores
 * @returns {PrevalenceScore[]} Ranked prevalence scores
 *
 * @example
 * ```typescript
 * const ranked = rankMalwareByPrevalence(scores);
 * // Result: [{ malwareId: 'a', rank: 1, score: 95, ... }, { malwareId: 'b', rank: 2, score: 82, ... }]
 * ```
 */
export declare const rankMalwareByPrevalence: (scores: PrevalenceScore[]) => PrevalenceScore[];
/**
 * Calculates regional prevalence distribution.
 *
 * @param {Record<string, number>} regionalSamples - Regional sample counts
 * @param {number} totalSamples - Total sample count
 * @returns {Record<string, number>} Regional prevalence percentages
 *
 * @example
 * ```typescript
 * const distribution = calculateRegionalPrevalence(
 *   { 'North America': 5000, 'Europe': 3000, 'Asia': 2000 },
 *   10000
 * );
 * // Result: { 'North America': 50.0, 'Europe': 30.0, 'Asia': 20.0 }
 * ```
 */
export declare const calculateRegionalPrevalence: (regionalSamples: Record<string, number>, totalSamples: number) => Record<string, number>;
/**
 * Calculates sector-specific prevalence distribution.
 *
 * @param {Record<string, number>} sectorSamples - Sector sample counts
 * @param {number} totalSamples - Total sample count
 * @returns {Record<string, number>} Sector prevalence percentages
 *
 * @example
 * ```typescript
 * const distribution = calculateSectorPrevalence(
 *   { 'Healthcare': 4000, 'Finance': 3500, 'Government': 2500 },
 *   10000
 * );
 * // Result: { 'Healthcare': 40.0, 'Finance': 35.0, 'Government': 25.0 }
 * ```
 */
export declare const calculateSectorPrevalence: (sectorSamples: Record<string, number>, totalSamples: number) => Record<string, number>;
/**
 * Detects malware variants based on similarity threshold.
 *
 * @param {string} parentFamily - Parent malware family
 * @param {string} sha256 - SHA256 hash of potential variant
 * @param {number} similarity - Similarity score (0-1)
 * @param {VariantMutation[]} mutations - Array of detected mutations
 * @returns {MalwareVariant} Malware variant object
 *
 * @example
 * ```typescript
 * const variant = detectMalwareVariant('Emotet', 'abc123...', 0.85,
 *   [{ type: 'packer', description: 'Changed to UPX', severity: 'low' }]
 * );
 * ```
 */
export declare const detectMalwareVariant: (parentFamily: string, sha256: string, similarity: number, mutations: VariantMutation[]) => Partial<MalwareVariant>;
/**
 * Calculates code similarity between two malware samples.
 *
 * @param {string} hash1 - First malware hash
 * @param {string} hash2 - Second malware hash
 * @param {string[]} commonStrings - Common strings found in both samples
 * @param {number} totalStrings - Total unique strings across both samples
 * @returns {number} Similarity score (0-1)
 *
 * @example
 * ```typescript
 * const similarity = calculateCodeSimilarity('hash1', 'hash2',
 *   ['malicious', 'encrypt', 'download'], 10
 * );
 * // Result: 0.30
 * ```
 */
export declare const calculateCodeSimilarity: (hash1: string, hash2: string, commonStrings: string[], totalStrings: number) => number;
/**
 * Identifies mutation types in malware variant.
 *
 * @param {string} originalHash - Original malware hash
 * @param {string} variantHash - Variant malware hash
 * @param {string[]} differences - Array of detected differences
 * @returns {VariantMutation[]} Array of identified mutations
 *
 * @example
 * ```typescript
 * const mutations = identifyVariantMutations('original', 'variant',
 *   ['packer changed', 'new C2 domain', 'obfuscation added']
 * );
 * // Result: [{ type: 'packer', description: 'packer changed', severity: 'low' }, ...]
 * ```
 */
export declare const identifyVariantMutations: (originalHash: string, variantHash: string, differences: string[]) => VariantMutation[];
/**
 * Groups malware variants by similarity clusters.
 *
 * @param {MalwareVariant[]} variants - Array of malware variants
 * @param {number} [similarityThreshold] - Minimum similarity for clustering (default: 0.7)
 * @returns {Record<string, MalwareVariant[]>} Clustered variants
 *
 * @example
 * ```typescript
 * const clusters = clusterMalwareVariants(variants, 0.7);
 * // Result: { 'cluster1': [variant1, variant2], 'cluster2': [variant3, variant4] }
 * ```
 */
export declare const clusterMalwareVariants: (variants: MalwareVariant[], similarityThreshold?: number) => Record<string, MalwareVariant[]>;
/**
 * Generates YARA signature from malware sample characteristics.
 *
 * @param {string} malwareFamily - Malware family name
 * @param {string[]} uniqueStrings - Unique strings found in malware
 * @param {string[]} hexPatterns - Hex patterns for detection
 * @returns {MalwareSignature} Generated malware signature
 *
 * @example
 * ```typescript
 * const signature = generateYaraSignature('Emotet',
 *   ['C2_connect', 'encrypt_payload'],
 *   ['4D5A', '504B0304']
 * );
 * ```
 */
export declare const generateYaraSignature: (malwareFamily: string, uniqueStrings: string[], hexPatterns: string[]) => Partial<MalwareSignature>;
/**
 * Validates malware signature effectiveness.
 *
 * @param {MalwareSignature} signature - Malware signature
 * @param {number} truePositives - True positive detections
 * @param {number} falsePositives - False positive detections
 * @param {number} totalSamples - Total samples tested
 * @returns {{ confidence: number; falsePositiveRate: number; isEffective: boolean }} Validation result
 *
 * @example
 * ```typescript
 * const validation = validateSignatureEffectiveness(signature, 95, 5, 100);
 * // Result: { confidence: 0.95, falsePositiveRate: 0.05, isEffective: true }
 * ```
 */
export declare const validateSignatureEffectiveness: (signature: MalwareSignature, truePositives: number, falsePositives: number, totalSamples: number) => {
    confidence: number;
    falsePositiveRate: number;
    isEffective: boolean;
};
/**
 * Updates signature detection statistics.
 *
 * @param {MalwareSignature} signature - Malware signature
 * @param {number} newDetections - Number of new detections
 * @returns {MalwareSignature} Updated signature
 *
 * @example
 * ```typescript
 * const updated = updateSignatureDetectionCount(signature, 25);
 * // Increments detection count and updates lastUpdated
 * ```
 */
export declare const updateSignatureDetectionCount: (signature: MalwareSignature, newDetections: number) => MalwareSignature;
/**
 * Creates C2 infrastructure record.
 *
 * @param {string} type - C2 type (domain, IP, URL, tor)
 * @param {string} value - C2 value
 * @param {string[]} malwareFamilies - Associated malware families
 * @param {number} reputation - Reputation score (0-100)
 * @returns {Partial<C2Infrastructure>} C2 infrastructure object
 *
 * @example
 * ```typescript
 * const c2 = createC2Infrastructure('domain', 'evil.com', ['Emotet', 'TrickBot'], 95);
 * ```
 */
export declare const createC2Infrastructure: (type: "domain" | "ip" | "url" | "tor", value: string, malwareFamilies: string[], reputation: number) => Partial<C2Infrastructure>;
/**
 * Tracks C2 communication patterns.
 *
 * @param {string} c2Id - C2 infrastructure ID
 * @param {number[]} communicationTimestamps - Array of communication timestamps (ms)
 * @returns {{ beaconInterval: number; regularity: number; isBeaconing: boolean }} Pattern analysis
 *
 * @example
 * ```typescript
 * const pattern = trackC2Communication('c2_123', [1000, 2000, 3000, 4000]);
 * // Result: { beaconInterval: 1000, regularity: 1.0, isBeaconing: true }
 * ```
 */
export declare const trackC2Communication: (c2Id: string, communicationTimestamps: number[]) => {
    beaconInterval: number;
    regularity: number;
    isBeaconing: boolean;
};
/**
 * Identifies shared C2 infrastructure across malware families.
 *
 * @param {C2Infrastructure[]} c2List - Array of C2 infrastructure
 * @returns {Record<string, string[]>} Map of C2 IDs to malware families
 *
 * @example
 * ```typescript
 * const shared = identifySharedC2Infrastructure(c2List);
 * // Result: { 'c2_1': ['Emotet', 'TrickBot'], 'c2_2': ['Zeus', 'Dridex'] }
 * ```
 */
export declare const identifySharedC2Infrastructure: (c2List: C2Infrastructure[]) => Record<string, string[]>;
/**
 * Calculates C2 reputation score based on malicious activity.
 *
 * @param {number} malwareFamilyCount - Number of associated malware families
 * @param {number} infectionCount - Number of infections attributed to C2
 * @param {number} ageInDays - Age of C2 in days
 * @returns {number} Reputation score (0-100, higher = more malicious)
 *
 * @example
 * ```typescript
 * const reputation = calculateC2Reputation(5, 1000, 30);
 * // Result: 92
 * ```
 */
export declare const calculateC2Reputation: (malwareFamilyCount: number, infectionCount: number, ageInDays: number) => number;
/**
 * Analyzes malware distribution vectors.
 *
 * @param {DistributionVector[]} vectors - Array of distribution vectors
 * @returns {Record<string, any>} Distribution analysis
 *
 * @example
 * ```typescript
 * const analysis = analyzeDistributionVectors(vectors);
 * // Result: { mostCommon: 'email', totalVictims: 5000, avgSuccessRate: 0.35, ... }
 * ```
 */
export declare const analyzeDistributionVectors: (vectors: DistributionVector[]) => Record<string, any>;
/**
 * Identifies targeted sectors from distribution data.
 *
 * @param {DistributionVector[]} vectors - Array of distribution vectors
 * @returns {Record<string, number>} Sector targeting frequency
 *
 * @example
 * ```typescript
 * const sectors = identifyTargetedSectors(vectors);
 * // Result: { 'Healthcare': 150, 'Finance': 120, 'Government': 80 }
 * ```
 */
export declare const identifyTargetedSectors: (vectors: DistributionVector[]) => Record<string, number>;
/**
 * Calculates distribution effectiveness score.
 *
 * @param {number} victimCount - Number of victims
 * @param {number} attemptCount - Number of distribution attempts
 * @param {number} successRate - Success rate (0-1)
 * @returns {number} Effectiveness score (0-100)
 *
 * @example
 * ```typescript
 * const effectiveness = calculateDistributionEffectiveness(500, 1000, 0.5);
 * // Result: 75
 * ```
 */
export declare const calculateDistributionEffectiveness: (victimCount: number, attemptCount: number, successRate: number) => number;
/**
 * Maps malware behavior to cyber kill chain stages.
 *
 * @param {string[]} techniques - Array of observed techniques
 * @param {string[]} mitreAttackIds - Array of MITRE ATT&CK IDs
 * @returns {KillChainStage[]} Array of kill chain stages
 *
 * @example
 * ```typescript
 * const stages = mapToKillChain(
 *   ['Spear Phishing', 'Exploit Public-Facing Application', 'Command and Control'],
 *   ['T1566.001', 'T1190', 'T1071']
 * );
 * // Result: [{ stage: 'delivery', techniques: [...], ... }, ...]
 * ```
 */
export declare const mapToKillChain: (techniques: string[], mitreAttackIds: string[]) => KillChainStage[];
/**
 * Analyzes kill chain completeness for malware campaign.
 *
 * @param {KillChainStage[]} stages - Array of kill chain stages
 * @returns {{ completeness: number; missingStages: string[]; coverage: number }} Analysis result
 *
 * @example
 * ```typescript
 * const analysis = analyzeKillChainCompleteness(stages);
 * // Result: { completeness: 0.85, missingStages: ['reconnaissance'], coverage: 6 }
 * ```
 */
export declare const analyzeKillChainCompleteness: (stages: KillChainStage[]) => {
    completeness: number;
    missingStages: string[];
    coverage: number;
};
/**
 * Generates kill chain visualization data.
 *
 * @param {KillChainStage[]} stages - Array of kill chain stages
 * @returns {Record<string, any>} Visualization data
 *
 * @example
 * ```typescript
 * const vizData = generateKillChainVisualization(stages);
 * // Result: { stages: [...], connections: [...], techniqueCount: 15 }
 * ```
 */
export declare const generateKillChainVisualization: (stages: KillChainStage[]) => Record<string, any>;
/**
 * Creates malware campaign record.
 *
 * @param {string} name - Campaign name
 * @param {string[]} malwareFamilies - Associated malware families
 * @param {CampaignTarget[]} targets - Campaign targets
 * @returns {Partial<MalwareCampaign>} Campaign object
 *
 * @example
 * ```typescript
 * const campaign = createMalwareCampaign('Operation X',
 *   ['Emotet', 'TrickBot'],
 *   [{ targetType: 'sector', name: 'Healthcare', attackCount: 50, successRate: 0.4 }]
 * );
 * ```
 */
export declare const createMalwareCampaign: (name: string, malwareFamilies: string[], targets: CampaignTarget[]) => Partial<MalwareCampaign>;
/**
 * Calculates campaign impact score.
 *
 * @param {number} victimCount - Number of victims
 * @param {CampaignTarget[]} targets - Campaign targets
 * @param {number} duration - Campaign duration in days
 * @returns {number} Impact score (0-100)
 *
 * @example
 * ```typescript
 * const impact = calculateCampaignImpact(1000, targets, 30);
 * // Result: 78
 * ```
 */
export declare const calculateCampaignImpact: (victimCount: number, targets: CampaignTarget[], duration: number) => number;
/**
 * Correlates multiple malware families in campaigns.
 *
 * @param {string} primaryMalware - Primary malware family
 * @param {string[]} relatedMalware - Related malware families
 * @param {'c2_sharing' | 'code_similarity' | 'campaign' | 'threat_actor' | 'infrastructure'} correlationType - Type of correlation
 * @param {string[]} evidence - Evidence of correlation
 * @returns {MalwareCorrelation} Correlation object
 *
 * @example
 * ```typescript
 * const correlation = correlateMalwareFamilies('Emotet', ['TrickBot', 'Ryuk'],
 *   'campaign', ['Shared C2 infrastructure', 'Sequential deployment']
 * );
 * ```
 */
export declare const correlateMalwareFamilies: (primaryMalware: string, relatedMalware: string[], correlationType: "c2_sharing" | "code_similarity" | "campaign" | "threat_actor" | "infrastructure", evidence: string[]) => MalwareCorrelation;
/**
 * Creates threat intelligence report.
 *
 * @param {string} source - Intelligence source
 * @param {'low' | 'medium' | 'high' | 'confirmed'} confidence - Confidence level
 * @param {'white' | 'green' | 'amber' | 'red'} tlpLevel - Traffic Light Protocol level
 * @param {ThreatIndicator[]} indicators - Threat indicators
 * @param {string} description - Report description
 * @returns {Partial<ThreatIntelligence>} Threat intelligence object
 *
 * @example
 * ```typescript
 * const intel = createThreatIntelReport('OSINT', 'high', 'amber',
 *   [{ type: 'hash', value: 'abc123...', context: 'Malware sample' }],
 *   'New Emotet campaign detected'
 * );
 * ```
 */
export declare const createThreatIntelReport: (source: string, confidence: "low" | "medium" | "high" | "confirmed", tlpLevel: "white" | "green" | "amber" | "red", indicators: ThreatIndicator[], description: string) => Partial<ThreatIntelligence>;
/**
 * Validates threat intelligence freshness.
 *
 * @param {ThreatIntelligence} intel - Threat intelligence object
 * @param {number} [maxAgeInDays] - Maximum age in days (default: 90)
 * @returns {boolean} True if intelligence is fresh
 *
 * @example
 * ```typescript
 * const isFresh = validateIntelligenceFreshness(intel, 90);
 * // Result: true or false
 * ```
 */
export declare const validateIntelligenceFreshness: (intel: ThreatIntelligence, maxAgeInDays?: number) => boolean;
/**
 * Enriches malware data with threat intelligence.
 *
 * @param {string} malwareHash - Malware hash
 * @param {ThreatIntelligence[]} intelReports - Array of threat intelligence reports
 * @returns {Record<string, any>} Enriched malware data
 *
 * @example
 * ```typescript
 * const enriched = enrichMalwareWithIntelligence('abc123...', intelReports);
 * // Result: { hash: 'abc123...', intelMatches: 3, highConfidenceMatches: 2, ... }
 * ```
 */
export declare const enrichMalwareWithIntelligence: (malwareHash: string, intelReports: ThreatIntelligence[]) => Record<string, any>;
/**
 * Creates Sequelize query for malware trend analysis.
 *
 * @param {string} familyName - Malware family name
 * @param {Date} startDate - Start date
 * @param {Date} endDate - End date
 * @returns {Record<string, any>} Sequelize query
 *
 * @example
 * ```typescript
 * const query = createMalwareTrendQuery('Emotet', new Date('2025-01-01'), new Date('2025-01-31'));
 * const samples = await MalwareSample.findAll({ where: query });
 * ```
 */
export declare const createMalwareTrendQuery: (familyName: string, startDate: Date, endDate: Date) => Record<string, any>;
/**
 * Creates Sequelize query for C2 infrastructure search.
 *
 * @param {string} [type] - C2 type filter
 * @param {boolean} [activeOnly] - Filter only active C2
 * @param {number} [minReputation] - Minimum reputation score
 * @returns {Record<string, any>} Sequelize query
 *
 * @example
 * ```typescript
 * const query = createC2InfrastructureQuery('domain', true, 80);
 * const c2List = await C2Infrastructure.findAll({ where: query });
 * ```
 */
export declare const createC2InfrastructureQuery: (type?: string, activeOnly?: boolean, minReputation?: number) => Record<string, any>;
/**
 * Creates Sequelize query for malware campaign search.
 *
 * @param {boolean} [activeOnly] - Filter only active campaigns
 * @param {string} [threatActor] - Threat actor filter
 * @returns {Record<string, any>} Sequelize query
 *
 * @example
 * ```typescript
 * const query = createMalwareCampaignQuery(true, 'APT28');
 * const campaigns = await MalwareCampaign.findAll({ where: query });
 * ```
 */
export declare const createMalwareCampaignQuery: (activeOnly?: boolean, threatActor?: string) => Record<string, any>;
/**
 * Creates NestJS provider for malware intelligence analytics.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @returns {Record<string, any>} Analytics dashboard data
 *
 * @example
 * ```typescript
 * // In NestJS provider:
 * async getIntelligenceDashboard(): Promise<Record<string, any>> {
 *   const trends = await this.getTrends();
 *   return await provideIntelligenceAnalytics(trends);
 * }
 * ```
 */
export declare const provideIntelligenceAnalytics: (trends: MalwareTrend[]) => Promise<Record<string, any>>;
/**
 * Creates NestJS provider for C2 infrastructure monitoring.
 *
 * @param {C2Infrastructure[]} c2List - Array of C2 infrastructure
 * @returns {Record<string, any>} C2 monitoring data
 *
 * @example
 * ```typescript
 * // In NestJS provider:
 * async getC2Monitoring(): Promise<Record<string, any>> {
 *   const c2List = await this.getC2Infrastructure();
 *   return await provideC2Monitoring(c2List);
 * }
 * ```
 */
export declare const provideC2Monitoring: (c2List: C2Infrastructure[]) => Promise<Record<string, any>>;
/**
 * Creates NestJS provider for threat intelligence correlation.
 *
 * @param {string} malwareHash - Malware hash
 * @param {ThreatIntelligence[]} intelReports - Threat intelligence reports
 * @param {C2Infrastructure[]} c2List - C2 infrastructure list
 * @returns {Promise<Record<string, any>>} Correlated intelligence data
 *
 * @example
 * ```typescript
 * // In NestJS provider:
 * async getCorrelatedIntelligence(hash: string): Promise<Record<string, any>> {
 *   return await provideThreatCorrelation(hash, intelReports, c2List);
 * }
 * ```
 */
export declare const provideThreatCorrelation: (malwareHash: string, intelReports: ThreatIntelligence[], c2List: C2Infrastructure[]) => Promise<Record<string, any>>;
/**
 * Creates API endpoint response for malware trends.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @param {number} page - Page number
 * @param {number} limit - Items per page
 * @returns {Record<string, any>} Paginated API response
 *
 * @example
 * ```typescript
 * @Get('/intelligence/trends')
 * async getTrends(@Query('page') page: number, @Query('limit') limit: number) {
 *   const trends = await this.getTrendData();
 *   return createTrendsApiResponse(trends, page, limit);
 * }
 * ```
 */
export declare const createTrendsApiResponse: (trends: MalwareTrend[], page?: number, limit?: number) => Record<string, any>;
/**
 * Creates API endpoint response for C2 infrastructure.
 *
 * @param {C2Infrastructure[]} c2List - Array of C2 infrastructure
 * @param {Record<string, any>} [filters] - Applied filters
 * @returns {Record<string, any>} API response
 *
 * @example
 * ```typescript
 * @Get('/intelligence/c2')
 * async getC2Infrastructure(@Query() filters: Record<string, any>) {
 *   const c2List = await this.getC2Data(filters);
 *   return createC2ApiResponse(c2List, filters);
 * }
 * ```
 */
export declare const createC2ApiResponse: (c2List: C2Infrastructure[], filters?: Record<string, any>) => Record<string, any>;
/**
 * Creates Swagger API documentation for threat intelligence endpoint.
 *
 * @returns {Record<string, any>} Swagger API specification
 *
 * @example
 * ```typescript
 * @ApiOperation(createThreatIntelligenceApiDoc())
 * @Get('/intelligence/threats')
 * async getThreatIntelligence() { ... }
 * ```
 */
export declare const createThreatIntelligenceApiDoc: () => Record<string, any>;
/**
 * Creates Swagger API documentation for malware trends endpoint.
 *
 * @returns {Record<string, any>} Swagger API specification
 *
 * @example
 * ```typescript
 * @ApiOperation(createMalwareTrendsApiDoc())
 * @Get('/intelligence/trends')
 * async getMalwareTrends() { ... }
 * ```
 */
export declare const createMalwareTrendsApiDoc: () => Record<string, any>;
/**
 * Validates threat intelligence report input.
 *
 * @param {Partial<ThreatIntelligence>} report - Threat intelligence report
 * @returns {{ isValid: boolean; errors: string[] }} Validation result
 *
 * @example
 * ```typescript
 * const validation = validateThreatIntelReport(report);
 * if (!validation.isValid) throw new BadRequestException(validation.errors);
 * ```
 */
export declare const validateThreatIntelReport: (report: Partial<ThreatIntelligence>) => {
    isValid: boolean;
    errors: string[];
};
/**
 * Aggregates malware statistics over time period.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @param {Date} startDate - Start date
 * @param {Date} endDate - End date
 * @returns {Record<string, any>} Aggregated statistics
 *
 * @example
 * ```typescript
 * const stats = aggregateMalwareStatistics(trends, new Date('2025-01-01'), new Date('2025-01-31'));
 * // Result: { totalSamples: 10000, uniqueFamilies: 150, avgGrowthRate: 0.15, ... }
 * ```
 */
export declare const aggregateMalwareStatistics: (trends: MalwareTrend[], startDate: Date, endDate: Date) => Record<string, any>;
/**
 * Generates intelligence report in structured format.
 *
 * @param {ThreatIntelligence[]} intelReports - Array of threat intelligence
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @param {C2Infrastructure[]} c2List - Array of C2 infrastructure
 * @returns {Record<string, any>} Comprehensive intelligence report
 *
 * @example
 * ```typescript
 * const report = generateIntelligenceReport(intelReports, trends, c2List);
 * // Result: { executive Summary: '...', threats: [...], c2Infrastructure: [...], ... }
 * ```
 */
export declare const generateIntelligenceReport: (intelReports: ThreatIntelligence[], trends: MalwareTrend[], c2List: C2Infrastructure[]) => Record<string, any>;
/**
 * Generates threat mitigation recommendations.
 *
 * @param {MalwareTrend[]} emergingThreats - Emerging malware threats
 * @param {C2Infrastructure[]} activeC2 - Active C2 infrastructure
 * @returns {string[]} Array of recommendations
 *
 * @example
 * ```typescript
 * const recommendations = generateThreatRecommendations(emerging, c2List);
 * // Result: ['Block domains: evil.com, bad.com', 'Monitor for Emotet indicators', ...]
 * ```
 */
export declare const generateThreatRecommendations: (emergingThreats: MalwareTrend[], activeC2: C2Infrastructure[]) => string[];
/**
 * Calculates threat intelligence coverage score.
 *
 * @param {ThreatIntelligence[]} intelReports - Array of threat intelligence
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @returns {{ coverageScore: number; coveredFamilies: string[]; gaps: string[] }} Coverage analysis
 *
 * @example
 * ```typescript
 * const coverage = calculateIntelligenceCoverage(intelReports, trends);
 * // Result: { coverageScore: 75, coveredFamilies: ['Emotet', ...], gaps: ['NewTrojan', ...] }
 * ```
 */
export declare const calculateIntelligenceCoverage: (intelReports: ThreatIntelligence[], trends: MalwareTrend[]) => {
    coverageScore: number;
    coveredFamilies: string[];
    gaps: string[];
};
/**
 * Exports malware intelligence data in CSV format.
 *
 * @param {MalwareTrend[]} trends - Array of malware trends
 * @returns {string} CSV formatted data
 *
 * @example
 * ```typescript
 * const csv = exportIntelligenceToCSV(trends);
 * // Result: "Family,Sample Count,Growth Rate,Trend Direction,Impact Score\nEmotet,1000,0.25,rising,85\n..."
 * ```
 */
export declare const exportIntelligenceToCSV: (trends: MalwareTrend[]) => string;
declare const _default: {
    analyzeMalwareTrend: (familyName: string, timeWindow: TimeWindow, sampleCounts: number[]) => MalwareTrend;
    detectEmergingMalware: (trends: MalwareTrend[], growthThreshold?: number) => MalwareTrend[];
    identifyDecliningMalware: (trends: MalwareTrend[], declineThreshold?: number) => MalwareTrend[];
    compareMalwareTrends: (trends: MalwareTrend[]) => Record<string, any>;
    calculatePrevalenceScore: (malwareId: string, globalSamples: number, totalGlobalMalware: number, detectionRate: number, infectionRate: number) => Partial<PrevalenceScore>;
    rankMalwareByPrevalence: (scores: PrevalenceScore[]) => PrevalenceScore[];
    calculateRegionalPrevalence: (regionalSamples: Record<string, number>, totalSamples: number) => Record<string, number>;
    calculateSectorPrevalence: (sectorSamples: Record<string, number>, totalSamples: number) => Record<string, number>;
    detectMalwareVariant: (parentFamily: string, sha256: string, similarity: number, mutations: VariantMutation[]) => Partial<MalwareVariant>;
    calculateCodeSimilarity: (hash1: string, hash2: string, commonStrings: string[], totalStrings: number) => number;
    identifyVariantMutations: (originalHash: string, variantHash: string, differences: string[]) => VariantMutation[];
    clusterMalwareVariants: (variants: MalwareVariant[], similarityThreshold?: number) => Record<string, MalwareVariant[]>;
    generateYaraSignature: (malwareFamily: string, uniqueStrings: string[], hexPatterns: string[]) => Partial<MalwareSignature>;
    validateSignatureEffectiveness: (signature: MalwareSignature, truePositives: number, falsePositives: number, totalSamples: number) => {
        confidence: number;
        falsePositiveRate: number;
        isEffective: boolean;
    };
    updateSignatureDetectionCount: (signature: MalwareSignature, newDetections: number) => MalwareSignature;
    createC2Infrastructure: (type: "domain" | "ip" | "url" | "tor", value: string, malwareFamilies: string[], reputation: number) => Partial<C2Infrastructure>;
    trackC2Communication: (c2Id: string, communicationTimestamps: number[]) => {
        beaconInterval: number;
        regularity: number;
        isBeaconing: boolean;
    };
    identifySharedC2Infrastructure: (c2List: C2Infrastructure[]) => Record<string, string[]>;
    calculateC2Reputation: (malwareFamilyCount: number, infectionCount: number, ageInDays: number) => number;
    analyzeDistributionVectors: (vectors: DistributionVector[]) => Record<string, any>;
    identifyTargetedSectors: (vectors: DistributionVector[]) => Record<string, number>;
    calculateDistributionEffectiveness: (victimCount: number, attemptCount: number, successRate: number) => number;
    mapToKillChain: (techniques: string[], mitreAttackIds: string[]) => KillChainStage[];
    analyzeKillChainCompleteness: (stages: KillChainStage[]) => {
        completeness: number;
        missingStages: string[];
        coverage: number;
    };
    generateKillChainVisualization: (stages: KillChainStage[]) => Record<string, any>;
    createMalwareCampaign: (name: string, malwareFamilies: string[], targets: CampaignTarget[]) => Partial<MalwareCampaign>;
    calculateCampaignImpact: (victimCount: number, targets: CampaignTarget[], duration: number) => number;
    correlateMalwareFamilies: (primaryMalware: string, relatedMalware: string[], correlationType: "c2_sharing" | "code_similarity" | "campaign" | "threat_actor" | "infrastructure", evidence: string[]) => MalwareCorrelation;
    createThreatIntelReport: (source: string, confidence: "low" | "medium" | "high" | "confirmed", tlpLevel: "white" | "green" | "amber" | "red", indicators: ThreatIndicator[], description: string) => Partial<ThreatIntelligence>;
    validateIntelligenceFreshness: (intel: ThreatIntelligence, maxAgeInDays?: number) => boolean;
    enrichMalwareWithIntelligence: (malwareHash: string, intelReports: ThreatIntelligence[]) => Record<string, any>;
    createMalwareTrendQuery: (familyName: string, startDate: Date, endDate: Date) => Record<string, any>;
    createC2InfrastructureQuery: (type?: string, activeOnly?: boolean, minReputation?: number) => Record<string, any>;
    createMalwareCampaignQuery: (activeOnly?: boolean, threatActor?: string) => Record<string, any>;
    provideIntelligenceAnalytics: (trends: MalwareTrend[]) => Promise<Record<string, any>>;
    provideC2Monitoring: (c2List: C2Infrastructure[]) => Promise<Record<string, any>>;
    provideThreatCorrelation: (malwareHash: string, intelReports: ThreatIntelligence[], c2List: C2Infrastructure[]) => Promise<Record<string, any>>;
    createTrendsApiResponse: (trends: MalwareTrend[], page?: number, limit?: number) => Record<string, any>;
    createC2ApiResponse: (c2List: C2Infrastructure[], filters?: Record<string, any>) => Record<string, any>;
    createThreatIntelligenceApiDoc: () => Record<string, any>;
    createMalwareTrendsApiDoc: () => Record<string, any>;
    validateThreatIntelReport: (report: Partial<ThreatIntelligence>) => {
        isValid: boolean;
        errors: string[];
    };
    aggregateMalwareStatistics: (trends: MalwareTrend[], startDate: Date, endDate: Date) => Record<string, any>;
    generateIntelligenceReport: (intelReports: ThreatIntelligence[], trends: MalwareTrend[], c2List: C2Infrastructure[]) => Record<string, any>;
    generateThreatRecommendations: (emergingThreats: MalwareTrend[], activeC2: C2Infrastructure[]) => string[];
    calculateIntelligenceCoverage: (intelReports: ThreatIntelligence[], trends: MalwareTrend[]) => {
        coverageScore: number;
        coveredFamilies: string[];
        gaps: string[];
    };
    exportIntelligenceToCSV: (trends: MalwareTrend[]) => string;
};
export default _default;
//# sourceMappingURL=malware-intelligence-kit.d.ts.map